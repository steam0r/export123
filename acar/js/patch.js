var CABLES;
/******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	// The require scope
/******/ 	var __webpack_require__ = {};
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
var __webpack_exports__ = {};
/*!****************************************!*\
  !*** ./src/core/index.js + 71 modules ***!
  \****************************************/

// EXPORTS
__webpack_require__.d(__webpack_exports__, {
  "default": () => (/* binding */ core)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/common.js
var common_namespaceObject = {};
__webpack_require__.r(common_namespaceObject);
__webpack_require__.d(common_namespaceObject, {
  ARRAY_TYPE: () => (ARRAY_TYPE),
  EPSILON: () => (EPSILON),
  RANDOM: () => (RANDOM),
  equals: () => (equals),
  setMatrixArrayType: () => (setMatrixArrayType),
  toRadian: () => (toRadian)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/mat2.js
var mat2_namespaceObject = {};
__webpack_require__.r(mat2_namespaceObject);
__webpack_require__.d(mat2_namespaceObject, {
  LDU: () => (LDU),
  add: () => (add),
  adjoint: () => (adjoint),
  clone: () => (clone),
  copy: () => (copy),
  create: () => (create),
  determinant: () => (determinant),
  equals: () => (mat2_equals),
  exactEquals: () => (exactEquals),
  frob: () => (frob),
  fromRotation: () => (fromRotation),
  fromScaling: () => (fromScaling),
  fromValues: () => (fromValues),
  identity: () => (identity),
  invert: () => (invert),
  mul: () => (mul),
  multiply: () => (multiply),
  multiplyScalar: () => (multiplyScalar),
  multiplyScalarAndAdd: () => (multiplyScalarAndAdd),
  rotate: () => (rotate),
  scale: () => (scale),
  set: () => (set),
  str: () => (str),
  sub: () => (sub),
  subtract: () => (subtract),
  transpose: () => (transpose)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/mat2d.js
var mat2d_namespaceObject = {};
__webpack_require__.r(mat2d_namespaceObject);
__webpack_require__.d(mat2d_namespaceObject, {
  add: () => (mat2d_add),
  clone: () => (mat2d_clone),
  copy: () => (mat2d_copy),
  create: () => (mat2d_create),
  determinant: () => (mat2d_determinant),
  equals: () => (mat2d_equals),
  exactEquals: () => (mat2d_exactEquals),
  frob: () => (mat2d_frob),
  fromRotation: () => (mat2d_fromRotation),
  fromScaling: () => (mat2d_fromScaling),
  fromTranslation: () => (fromTranslation),
  fromValues: () => (mat2d_fromValues),
  identity: () => (mat2d_identity),
  invert: () => (mat2d_invert),
  mul: () => (mat2d_mul),
  multiply: () => (mat2d_multiply),
  multiplyScalar: () => (mat2d_multiplyScalar),
  multiplyScalarAndAdd: () => (mat2d_multiplyScalarAndAdd),
  rotate: () => (mat2d_rotate),
  scale: () => (mat2d_scale),
  set: () => (mat2d_set),
  str: () => (mat2d_str),
  sub: () => (mat2d_sub),
  subtract: () => (mat2d_subtract),
  translate: () => (translate)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/mat3.js
var mat3_namespaceObject = {};
__webpack_require__.r(mat3_namespaceObject);
__webpack_require__.d(mat3_namespaceObject, {
  add: () => (mat3_add),
  adjoint: () => (mat3_adjoint),
  clone: () => (mat3_clone),
  copy: () => (mat3_copy),
  create: () => (mat3_create),
  determinant: () => (mat3_determinant),
  equals: () => (mat3_equals),
  exactEquals: () => (mat3_exactEquals),
  frob: () => (mat3_frob),
  fromMat2d: () => (fromMat2d),
  fromMat4: () => (fromMat4),
  fromQuat: () => (fromQuat),
  fromRotation: () => (mat3_fromRotation),
  fromScaling: () => (mat3_fromScaling),
  fromTranslation: () => (mat3_fromTranslation),
  fromValues: () => (mat3_fromValues),
  identity: () => (mat3_identity),
  invert: () => (mat3_invert),
  mul: () => (mat3_mul),
  multiply: () => (mat3_multiply),
  multiplyScalar: () => (mat3_multiplyScalar),
  multiplyScalarAndAdd: () => (mat3_multiplyScalarAndAdd),
  normalFromMat4: () => (normalFromMat4),
  projection: () => (projection),
  rotate: () => (mat3_rotate),
  scale: () => (mat3_scale),
  set: () => (mat3_set),
  str: () => (mat3_str),
  sub: () => (mat3_sub),
  subtract: () => (mat3_subtract),
  translate: () => (mat3_translate),
  transpose: () => (mat3_transpose)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/mat4.js
var mat4_namespaceObject = {};
__webpack_require__.r(mat4_namespaceObject);
__webpack_require__.d(mat4_namespaceObject, {
  add: () => (mat4_add),
  adjoint: () => (mat4_adjoint),
  clone: () => (mat4_clone),
  copy: () => (mat4_copy),
  create: () => (mat4_create),
  determinant: () => (mat4_determinant),
  equals: () => (mat4_equals),
  exactEquals: () => (mat4_exactEquals),
  frob: () => (mat4_frob),
  fromQuat: () => (mat4_fromQuat),
  fromQuat2: () => (fromQuat2),
  fromRotation: () => (mat4_fromRotation),
  fromRotationTranslation: () => (fromRotationTranslation),
  fromRotationTranslationScale: () => (fromRotationTranslationScale),
  fromRotationTranslationScaleOrigin: () => (fromRotationTranslationScaleOrigin),
  fromScaling: () => (mat4_fromScaling),
  fromTranslation: () => (mat4_fromTranslation),
  fromValues: () => (mat4_fromValues),
  fromXRotation: () => (fromXRotation),
  fromYRotation: () => (fromYRotation),
  fromZRotation: () => (fromZRotation),
  frustum: () => (frustum),
  getRotation: () => (getRotation),
  getScaling: () => (getScaling),
  getTranslation: () => (getTranslation),
  identity: () => (mat4_identity),
  invert: () => (mat4_invert),
  lookAt: () => (lookAt),
  mul: () => (mat4_mul),
  multiply: () => (mat4_multiply),
  multiplyScalar: () => (mat4_multiplyScalar),
  multiplyScalarAndAdd: () => (mat4_multiplyScalarAndAdd),
  ortho: () => (ortho),
  perspective: () => (perspective),
  perspectiveFromFieldOfView: () => (perspectiveFromFieldOfView),
  rotate: () => (mat4_rotate),
  rotateX: () => (rotateX),
  rotateY: () => (rotateY),
  rotateZ: () => (rotateZ),
  scale: () => (mat4_scale),
  set: () => (mat4_set),
  str: () => (mat4_str),
  sub: () => (mat4_sub),
  subtract: () => (mat4_subtract),
  targetTo: () => (targetTo),
  translate: () => (mat4_translate),
  transpose: () => (mat4_transpose)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/vec3.js
var vec3_namespaceObject = {};
__webpack_require__.r(vec3_namespaceObject);
__webpack_require__.d(vec3_namespaceObject, {
  add: () => (vec3_add),
  angle: () => (angle),
  bezier: () => (bezier),
  ceil: () => (ceil),
  clone: () => (vec3_clone),
  copy: () => (vec3_copy),
  create: () => (vec3_create),
  cross: () => (cross),
  dist: () => (dist),
  distance: () => (distance),
  div: () => (div),
  divide: () => (divide),
  dot: () => (vec3_dot),
  equals: () => (vec3_equals),
  exactEquals: () => (vec3_exactEquals),
  floor: () => (floor),
  forEach: () => (forEach),
  fromValues: () => (vec3_fromValues),
  hermite: () => (hermite),
  inverse: () => (inverse),
  len: () => (len),
  length: () => (vec3_length),
  lerp: () => (lerp),
  max: () => (max),
  min: () => (min),
  mul: () => (vec3_mul),
  multiply: () => (vec3_multiply),
  negate: () => (negate),
  normalize: () => (normalize),
  random: () => (random),
  rotateX: () => (vec3_rotateX),
  rotateY: () => (vec3_rotateY),
  rotateZ: () => (vec3_rotateZ),
  round: () => (round),
  scale: () => (vec3_scale),
  scaleAndAdd: () => (scaleAndAdd),
  set: () => (vec3_set),
  sqrDist: () => (sqrDist),
  sqrLen: () => (sqrLen),
  squaredDistance: () => (squaredDistance),
  squaredLength: () => (squaredLength),
  str: () => (vec3_str),
  sub: () => (vec3_sub),
  subtract: () => (vec3_subtract),
  transformMat3: () => (transformMat3),
  transformMat4: () => (transformMat4),
  transformQuat: () => (transformQuat),
  zero: () => (zero)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/vec4.js
var vec4_namespaceObject = {};
__webpack_require__.r(vec4_namespaceObject);
__webpack_require__.d(vec4_namespaceObject, {
  add: () => (vec4_add),
  ceil: () => (vec4_ceil),
  clone: () => (vec4_clone),
  copy: () => (vec4_copy),
  create: () => (vec4_create),
  cross: () => (vec4_cross),
  dist: () => (vec4_dist),
  distance: () => (vec4_distance),
  div: () => (vec4_div),
  divide: () => (vec4_divide),
  dot: () => (dot),
  equals: () => (vec4_equals),
  exactEquals: () => (vec4_exactEquals),
  floor: () => (vec4_floor),
  forEach: () => (vec4_forEach),
  fromValues: () => (vec4_fromValues),
  inverse: () => (vec4_inverse),
  len: () => (vec4_len),
  length: () => (vec4_length),
  lerp: () => (vec4_lerp),
  max: () => (vec4_max),
  min: () => (vec4_min),
  mul: () => (vec4_mul),
  multiply: () => (vec4_multiply),
  negate: () => (vec4_negate),
  normalize: () => (vec4_normalize),
  random: () => (vec4_random),
  round: () => (vec4_round),
  scale: () => (vec4_scale),
  scaleAndAdd: () => (vec4_scaleAndAdd),
  set: () => (vec4_set),
  sqrDist: () => (vec4_sqrDist),
  sqrLen: () => (vec4_sqrLen),
  squaredDistance: () => (vec4_squaredDistance),
  squaredLength: () => (vec4_squaredLength),
  str: () => (vec4_str),
  sub: () => (vec4_sub),
  subtract: () => (vec4_subtract),
  transformMat4: () => (vec4_transformMat4),
  transformQuat: () => (vec4_transformQuat),
  zero: () => (vec4_zero)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/quat.js
var quat_namespaceObject = {};
__webpack_require__.r(quat_namespaceObject);
__webpack_require__.d(quat_namespaceObject, {
  add: () => (quat_add),
  calculateW: () => (calculateW),
  clone: () => (quat_clone),
  conjugate: () => (conjugate),
  copy: () => (quat_copy),
  create: () => (quat_create),
  dot: () => (quat_dot),
  equals: () => (quat_equals),
  exactEquals: () => (quat_exactEquals),
  exp: () => (exp),
  fromEuler: () => (fromEuler),
  fromMat3: () => (fromMat3),
  fromValues: () => (quat_fromValues),
  getAngle: () => (getAngle),
  getAxisAngle: () => (getAxisAngle),
  identity: () => (quat_identity),
  invert: () => (quat_invert),
  len: () => (quat_len),
  length: () => (quat_length),
  lerp: () => (quat_lerp),
  ln: () => (ln),
  mul: () => (quat_mul),
  multiply: () => (quat_multiply),
  normalize: () => (quat_normalize),
  pow: () => (pow),
  random: () => (quat_random),
  rotateX: () => (quat_rotateX),
  rotateY: () => (quat_rotateY),
  rotateZ: () => (quat_rotateZ),
  rotationTo: () => (rotationTo),
  scale: () => (quat_scale),
  set: () => (quat_set),
  setAxes: () => (setAxes),
  setAxisAngle: () => (setAxisAngle),
  slerp: () => (slerp),
  sqlerp: () => (sqlerp),
  sqrLen: () => (quat_sqrLen),
  squaredLength: () => (quat_squaredLength),
  str: () => (quat_str)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/quat2.js
var quat2_namespaceObject = {};
__webpack_require__.r(quat2_namespaceObject);
__webpack_require__.d(quat2_namespaceObject, {
  add: () => (quat2_add),
  clone: () => (quat2_clone),
  conjugate: () => (quat2_conjugate),
  copy: () => (quat2_copy),
  create: () => (quat2_create),
  dot: () => (quat2_dot),
  equals: () => (quat2_equals),
  exactEquals: () => (quat2_exactEquals),
  fromMat4: () => (quat2_fromMat4),
  fromRotation: () => (quat2_fromRotation),
  fromRotationTranslation: () => (quat2_fromRotationTranslation),
  fromRotationTranslationValues: () => (fromRotationTranslationValues),
  fromTranslation: () => (quat2_fromTranslation),
  fromValues: () => (quat2_fromValues),
  getDual: () => (getDual),
  getReal: () => (getReal),
  getTranslation: () => (quat2_getTranslation),
  identity: () => (quat2_identity),
  invert: () => (quat2_invert),
  len: () => (quat2_len),
  length: () => (quat2_length),
  lerp: () => (quat2_lerp),
  mul: () => (quat2_mul),
  multiply: () => (quat2_multiply),
  normalize: () => (quat2_normalize),
  rotateAroundAxis: () => (rotateAroundAxis),
  rotateByQuatAppend: () => (rotateByQuatAppend),
  rotateByQuatPrepend: () => (rotateByQuatPrepend),
  rotateX: () => (quat2_rotateX),
  rotateY: () => (quat2_rotateY),
  rotateZ: () => (quat2_rotateZ),
  scale: () => (quat2_scale),
  set: () => (quat2_set),
  setDual: () => (setDual),
  setReal: () => (setReal),
  sqrLen: () => (quat2_sqrLen),
  squaredLength: () => (quat2_squaredLength),
  str: () => (quat2_str),
  translate: () => (quat2_translate)
});

// NAMESPACE OBJECT: ./node_modules/gl-matrix/esm/vec2.js
var vec2_namespaceObject = {};
__webpack_require__.r(vec2_namespaceObject);
__webpack_require__.d(vec2_namespaceObject, {
  add: () => (vec2_add),
  angle: () => (vec2_angle),
  ceil: () => (vec2_ceil),
  clone: () => (vec2_clone),
  copy: () => (vec2_copy),
  create: () => (vec2_create),
  cross: () => (vec2_cross),
  dist: () => (vec2_dist),
  distance: () => (vec2_distance),
  div: () => (vec2_div),
  divide: () => (vec2_divide),
  dot: () => (vec2_dot),
  equals: () => (vec2_equals),
  exactEquals: () => (vec2_exactEquals),
  floor: () => (vec2_floor),
  forEach: () => (vec2_forEach),
  fromValues: () => (vec2_fromValues),
  inverse: () => (vec2_inverse),
  len: () => (vec2_len),
  length: () => (vec2_length),
  lerp: () => (vec2_lerp),
  max: () => (vec2_max),
  min: () => (vec2_min),
  mul: () => (vec2_mul),
  multiply: () => (vec2_multiply),
  negate: () => (vec2_negate),
  normalize: () => (vec2_normalize),
  random: () => (vec2_random),
  rotate: () => (vec2_rotate),
  round: () => (vec2_round),
  scale: () => (vec2_scale),
  scaleAndAdd: () => (vec2_scaleAndAdd),
  set: () => (vec2_set),
  sqrDist: () => (vec2_sqrDist),
  sqrLen: () => (vec2_sqrLen),
  squaredDistance: () => (vec2_squaredDistance),
  squaredLength: () => (vec2_squaredLength),
  str: () => (vec2_str),
  sub: () => (vec2_sub),
  subtract: () => (vec2_subtract),
  transformMat2: () => (transformMat2),
  transformMat2d: () => (transformMat2d),
  transformMat3: () => (vec2_transformMat3),
  transformMat4: () => (vec2_transformMat4),
  zero: () => (vec2_zero)
});

;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/common.js
/**
 * Common utilities
 * @module glMatrix
 */
// Configuration Constants
var EPSILON = 0.000001;
var ARRAY_TYPE = typeof Float32Array !== 'undefined' ? Float32Array : Array;
var RANDOM = Math.random;
/**
 * Sets the type of array used when creating new vectors and matrices
 *
 * @param {Type} type Array type, such as Float32Array or Array
 */

function setMatrixArrayType(type) {
  ARRAY_TYPE = type;
}
var degree = Math.PI / 180;
/**
 * Convert Degree To Radian
 *
 * @param {Number} a Angle in Degrees
 */

function toRadian(a) {
  return a * degree;
}
/**
 * Tests whether or not the arguments have approximately the same value, within an absolute
 * or relative tolerance of glMatrix.EPSILON (an absolute tolerance is used for values less
 * than or equal to 1.0, and a relative tolerance is used for larger values)
 *
 * @param {Number} a The first number to test.
 * @param {Number} b The second number to test.
 * @returns {Boolean} True if the numbers are approximately equal, false otherwise.
 */

function equals(a, b) {
  return Math.abs(a - b) <= EPSILON * Math.max(1.0, Math.abs(a), Math.abs(b));
}
if (!Math.hypot) Math.hypot = function () {
  var y = 0,
      i = arguments.length;

  while (i--) {
    y += arguments[i] * arguments[i];
  }

  return Math.sqrt(y);
};
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/mat2.js

/**
 * 2x2 Matrix
 * @module mat2
 */

/**
 * Creates a new identity mat2
 *
 * @returns {mat2} a new 2x2 matrix
 */

function create() {
  var out = new ARRAY_TYPE(4);

  if (ARRAY_TYPE != Float32Array) {
    out[1] = 0;
    out[2] = 0;
  }

  out[0] = 1;
  out[3] = 1;
  return out;
}
/**
 * Creates a new mat2 initialized with values from an existing matrix
 *
 * @param {mat2} a matrix to clone
 * @returns {mat2} a new 2x2 matrix
 */

function clone(a) {
  var out = new ARRAY_TYPE(4);
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  return out;
}
/**
 * Copy the values from one mat2 to another
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the source matrix
 * @returns {mat2} out
 */

function copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  return out;
}
/**
 * Set a mat2 to the identity matrix
 *
 * @param {mat2} out the receiving matrix
 * @returns {mat2} out
 */

function identity(out) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 1;
  return out;
}
/**
 * Create a new mat2 with the given values
 *
 * @param {Number} m00 Component in column 0, row 0 position (index 0)
 * @param {Number} m01 Component in column 0, row 1 position (index 1)
 * @param {Number} m10 Component in column 1, row 0 position (index 2)
 * @param {Number} m11 Component in column 1, row 1 position (index 3)
 * @returns {mat2} out A new 2x2 matrix
 */

function fromValues(m00, m01, m10, m11) {
  var out = new ARRAY_TYPE(4);
  out[0] = m00;
  out[1] = m01;
  out[2] = m10;
  out[3] = m11;
  return out;
}
/**
 * Set the components of a mat2 to the given values
 *
 * @param {mat2} out the receiving matrix
 * @param {Number} m00 Component in column 0, row 0 position (index 0)
 * @param {Number} m01 Component in column 0, row 1 position (index 1)
 * @param {Number} m10 Component in column 1, row 0 position (index 2)
 * @param {Number} m11 Component in column 1, row 1 position (index 3)
 * @returns {mat2} out
 */

function set(out, m00, m01, m10, m11) {
  out[0] = m00;
  out[1] = m01;
  out[2] = m10;
  out[3] = m11;
  return out;
}
/**
 * Transpose the values of a mat2
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the source matrix
 * @returns {mat2} out
 */

function transpose(out, a) {
  // If we are transposing ourselves we can skip a few steps but have to cache
  // some values
  if (out === a) {
    var a1 = a[1];
    out[1] = a[2];
    out[2] = a1;
  } else {
    out[0] = a[0];
    out[1] = a[2];
    out[2] = a[1];
    out[3] = a[3];
  }

  return out;
}
/**
 * Inverts a mat2
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the source matrix
 * @returns {mat2} out
 */

function invert(out, a) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3]; // Calculate the determinant

  var det = a0 * a3 - a2 * a1;

  if (!det) {
    return null;
  }

  det = 1.0 / det;
  out[0] = a3 * det;
  out[1] = -a1 * det;
  out[2] = -a2 * det;
  out[3] = a0 * det;
  return out;
}
/**
 * Calculates the adjugate of a mat2
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the source matrix
 * @returns {mat2} out
 */

function adjoint(out, a) {
  // Caching this value is nessecary if out == a
  var a0 = a[0];
  out[0] = a[3];
  out[1] = -a[1];
  out[2] = -a[2];
  out[3] = a0;
  return out;
}
/**
 * Calculates the determinant of a mat2
 *
 * @param {mat2} a the source matrix
 * @returns {Number} determinant of a
 */

function determinant(a) {
  return a[0] * a[3] - a[2] * a[1];
}
/**
 * Multiplies two mat2's
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the first operand
 * @param {mat2} b the second operand
 * @returns {mat2} out
 */

function multiply(out, a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3];
  out[0] = a0 * b0 + a2 * b1;
  out[1] = a1 * b0 + a3 * b1;
  out[2] = a0 * b2 + a2 * b3;
  out[3] = a1 * b2 + a3 * b3;
  return out;
}
/**
 * Rotates a mat2 by the given angle
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat2} out
 */

function rotate(out, a, rad) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3];
  var s = Math.sin(rad);
  var c = Math.cos(rad);
  out[0] = a0 * c + a2 * s;
  out[1] = a1 * c + a3 * s;
  out[2] = a0 * -s + a2 * c;
  out[3] = a1 * -s + a3 * c;
  return out;
}
/**
 * Scales the mat2 by the dimensions in the given vec2
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the matrix to rotate
 * @param {vec2} v the vec2 to scale the matrix by
 * @returns {mat2} out
 **/

function scale(out, a, v) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3];
  var v0 = v[0],
      v1 = v[1];
  out[0] = a0 * v0;
  out[1] = a1 * v0;
  out[2] = a2 * v1;
  out[3] = a3 * v1;
  return out;
}
/**
 * Creates a matrix from a given angle
 * This is equivalent to (but much faster than):
 *
 *     mat2.identity(dest);
 *     mat2.rotate(dest, dest, rad);
 *
 * @param {mat2} out mat2 receiving operation result
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat2} out
 */

function fromRotation(out, rad) {
  var s = Math.sin(rad);
  var c = Math.cos(rad);
  out[0] = c;
  out[1] = s;
  out[2] = -s;
  out[3] = c;
  return out;
}
/**
 * Creates a matrix from a vector scaling
 * This is equivalent to (but much faster than):
 *
 *     mat2.identity(dest);
 *     mat2.scale(dest, dest, vec);
 *
 * @param {mat2} out mat2 receiving operation result
 * @param {vec2} v Scaling vector
 * @returns {mat2} out
 */

function fromScaling(out, v) {
  out[0] = v[0];
  out[1] = 0;
  out[2] = 0;
  out[3] = v[1];
  return out;
}
/**
 * Returns a string representation of a mat2
 *
 * @param {mat2} a matrix to represent as a string
 * @returns {String} string representation of the matrix
 */

function str(a) {
  return 'mat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';
}
/**
 * Returns Frobenius norm of a mat2
 *
 * @param {mat2} a the matrix to calculate Frobenius norm of
 * @returns {Number} Frobenius norm
 */

function frob(a) {
  return Math.hypot(a[0], a[1], a[2], a[3]);
}
/**
 * Returns L, D and U matrices (Lower triangular, Diagonal and Upper triangular) by factorizing the input matrix
 * @param {mat2} L the lower triangular matrix
 * @param {mat2} D the diagonal matrix
 * @param {mat2} U the upper triangular matrix
 * @param {mat2} a the input matrix to factorize
 */

function LDU(L, D, U, a) {
  L[2] = a[2] / a[0];
  U[0] = a[0];
  U[1] = a[1];
  U[3] = a[3] - L[2] * U[1];
  return [L, D, U];
}
/**
 * Adds two mat2's
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the first operand
 * @param {mat2} b the second operand
 * @returns {mat2} out
 */

function add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  out[3] = a[3] + b[3];
  return out;
}
/**
 * Subtracts matrix b from matrix a
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the first operand
 * @param {mat2} b the second operand
 * @returns {mat2} out
 */

function subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  out[2] = a[2] - b[2];
  out[3] = a[3] - b[3];
  return out;
}
/**
 * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)
 *
 * @param {mat2} a The first matrix.
 * @param {mat2} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];
}
/**
 * Returns whether or not the matrices have approximately the same elements in the same position.
 *
 * @param {mat2} a The first matrix.
 * @param {mat2} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function mat2_equals(a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));
}
/**
 * Multiply each element of the matrix by a scalar.
 *
 * @param {mat2} out the receiving matrix
 * @param {mat2} a the matrix to scale
 * @param {Number} b amount to scale the matrix's elements by
 * @returns {mat2} out
 */

function multiplyScalar(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  out[3] = a[3] * b;
  return out;
}
/**
 * Adds two mat2's after multiplying each element of the second operand by a scalar value.
 *
 * @param {mat2} out the receiving vector
 * @param {mat2} a the first operand
 * @param {mat2} b the second operand
 * @param {Number} scale the amount to scale b's elements by before adding
 * @returns {mat2} out
 */

function multiplyScalarAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  out[2] = a[2] + b[2] * scale;
  out[3] = a[3] + b[3] * scale;
  return out;
}
/**
 * Alias for {@link mat2.multiply}
 * @function
 */

var mul = multiply;
/**
 * Alias for {@link mat2.subtract}
 * @function
 */

var sub = subtract;
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/mat2d.js

/**
 * 2x3 Matrix
 * @module mat2d
 *
 * @description
 * A mat2d contains six elements defined as:
 * <pre>
 * [a, b, c,
 *  d, tx, ty]
 * </pre>
 * This is a short form for the 3x3 matrix:
 * <pre>
 * [a, b, 0,
 *  c, d, 0,
 *  tx, ty, 1]
 * </pre>
 * The last column is ignored so the array is shorter and operations are faster.
 */

/**
 * Creates a new identity mat2d
 *
 * @returns {mat2d} a new 2x3 matrix
 */

function mat2d_create() {
  var out = new ARRAY_TYPE(6);

  if (ARRAY_TYPE != Float32Array) {
    out[1] = 0;
    out[2] = 0;
    out[4] = 0;
    out[5] = 0;
  }

  out[0] = 1;
  out[3] = 1;
  return out;
}
/**
 * Creates a new mat2d initialized with values from an existing matrix
 *
 * @param {mat2d} a matrix to clone
 * @returns {mat2d} a new 2x3 matrix
 */

function mat2d_clone(a) {
  var out = new ARRAY_TYPE(6);
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  out[4] = a[4];
  out[5] = a[5];
  return out;
}
/**
 * Copy the values from one mat2d to another
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the source matrix
 * @returns {mat2d} out
 */

function mat2d_copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  out[4] = a[4];
  out[5] = a[5];
  return out;
}
/**
 * Set a mat2d to the identity matrix
 *
 * @param {mat2d} out the receiving matrix
 * @returns {mat2d} out
 */

function mat2d_identity(out) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 1;
  out[4] = 0;
  out[5] = 0;
  return out;
}
/**
 * Create a new mat2d with the given values
 *
 * @param {Number} a Component A (index 0)
 * @param {Number} b Component B (index 1)
 * @param {Number} c Component C (index 2)
 * @param {Number} d Component D (index 3)
 * @param {Number} tx Component TX (index 4)
 * @param {Number} ty Component TY (index 5)
 * @returns {mat2d} A new mat2d
 */

function mat2d_fromValues(a, b, c, d, tx, ty) {
  var out = new ARRAY_TYPE(6);
  out[0] = a;
  out[1] = b;
  out[2] = c;
  out[3] = d;
  out[4] = tx;
  out[5] = ty;
  return out;
}
/**
 * Set the components of a mat2d to the given values
 *
 * @param {mat2d} out the receiving matrix
 * @param {Number} a Component A (index 0)
 * @param {Number} b Component B (index 1)
 * @param {Number} c Component C (index 2)
 * @param {Number} d Component D (index 3)
 * @param {Number} tx Component TX (index 4)
 * @param {Number} ty Component TY (index 5)
 * @returns {mat2d} out
 */

function mat2d_set(out, a, b, c, d, tx, ty) {
  out[0] = a;
  out[1] = b;
  out[2] = c;
  out[3] = d;
  out[4] = tx;
  out[5] = ty;
  return out;
}
/**
 * Inverts a mat2d
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the source matrix
 * @returns {mat2d} out
 */

function mat2d_invert(out, a) {
  var aa = a[0],
      ab = a[1],
      ac = a[2],
      ad = a[3];
  var atx = a[4],
      aty = a[5];
  var det = aa * ad - ab * ac;

  if (!det) {
    return null;
  }

  det = 1.0 / det;
  out[0] = ad * det;
  out[1] = -ab * det;
  out[2] = -ac * det;
  out[3] = aa * det;
  out[4] = (ac * aty - ad * atx) * det;
  out[5] = (ab * atx - aa * aty) * det;
  return out;
}
/**
 * Calculates the determinant of a mat2d
 *
 * @param {mat2d} a the source matrix
 * @returns {Number} determinant of a
 */

function mat2d_determinant(a) {
  return a[0] * a[3] - a[1] * a[2];
}
/**
 * Multiplies two mat2d's
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the first operand
 * @param {mat2d} b the second operand
 * @returns {mat2d} out
 */

function mat2d_multiply(out, a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3],
      a4 = a[4],
      a5 = a[5];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3],
      b4 = b[4],
      b5 = b[5];
  out[0] = a0 * b0 + a2 * b1;
  out[1] = a1 * b0 + a3 * b1;
  out[2] = a0 * b2 + a2 * b3;
  out[3] = a1 * b2 + a3 * b3;
  out[4] = a0 * b4 + a2 * b5 + a4;
  out[5] = a1 * b4 + a3 * b5 + a5;
  return out;
}
/**
 * Rotates a mat2d by the given angle
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat2d} out
 */

function mat2d_rotate(out, a, rad) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3],
      a4 = a[4],
      a5 = a[5];
  var s = Math.sin(rad);
  var c = Math.cos(rad);
  out[0] = a0 * c + a2 * s;
  out[1] = a1 * c + a3 * s;
  out[2] = a0 * -s + a2 * c;
  out[3] = a1 * -s + a3 * c;
  out[4] = a4;
  out[5] = a5;
  return out;
}
/**
 * Scales the mat2d by the dimensions in the given vec2
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the matrix to translate
 * @param {vec2} v the vec2 to scale the matrix by
 * @returns {mat2d} out
 **/

function mat2d_scale(out, a, v) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3],
      a4 = a[4],
      a5 = a[5];
  var v0 = v[0],
      v1 = v[1];
  out[0] = a0 * v0;
  out[1] = a1 * v0;
  out[2] = a2 * v1;
  out[3] = a3 * v1;
  out[4] = a4;
  out[5] = a5;
  return out;
}
/**
 * Translates the mat2d by the dimensions in the given vec2
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the matrix to translate
 * @param {vec2} v the vec2 to translate the matrix by
 * @returns {mat2d} out
 **/

function translate(out, a, v) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3],
      a4 = a[4],
      a5 = a[5];
  var v0 = v[0],
      v1 = v[1];
  out[0] = a0;
  out[1] = a1;
  out[2] = a2;
  out[3] = a3;
  out[4] = a0 * v0 + a2 * v1 + a4;
  out[5] = a1 * v0 + a3 * v1 + a5;
  return out;
}
/**
 * Creates a matrix from a given angle
 * This is equivalent to (but much faster than):
 *
 *     mat2d.identity(dest);
 *     mat2d.rotate(dest, dest, rad);
 *
 * @param {mat2d} out mat2d receiving operation result
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat2d} out
 */

function mat2d_fromRotation(out, rad) {
  var s = Math.sin(rad),
      c = Math.cos(rad);
  out[0] = c;
  out[1] = s;
  out[2] = -s;
  out[3] = c;
  out[4] = 0;
  out[5] = 0;
  return out;
}
/**
 * Creates a matrix from a vector scaling
 * This is equivalent to (but much faster than):
 *
 *     mat2d.identity(dest);
 *     mat2d.scale(dest, dest, vec);
 *
 * @param {mat2d} out mat2d receiving operation result
 * @param {vec2} v Scaling vector
 * @returns {mat2d} out
 */

function mat2d_fromScaling(out, v) {
  out[0] = v[0];
  out[1] = 0;
  out[2] = 0;
  out[3] = v[1];
  out[4] = 0;
  out[5] = 0;
  return out;
}
/**
 * Creates a matrix from a vector translation
 * This is equivalent to (but much faster than):
 *
 *     mat2d.identity(dest);
 *     mat2d.translate(dest, dest, vec);
 *
 * @param {mat2d} out mat2d receiving operation result
 * @param {vec2} v Translation vector
 * @returns {mat2d} out
 */

function fromTranslation(out, v) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 1;
  out[4] = v[0];
  out[5] = v[1];
  return out;
}
/**
 * Returns a string representation of a mat2d
 *
 * @param {mat2d} a matrix to represent as a string
 * @returns {String} string representation of the matrix
 */

function mat2d_str(a) {
  return 'mat2d(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ')';
}
/**
 * Returns Frobenius norm of a mat2d
 *
 * @param {mat2d} a the matrix to calculate Frobenius norm of
 * @returns {Number} Frobenius norm
 */

function mat2d_frob(a) {
  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], 1);
}
/**
 * Adds two mat2d's
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the first operand
 * @param {mat2d} b the second operand
 * @returns {mat2d} out
 */

function mat2d_add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  out[3] = a[3] + b[3];
  out[4] = a[4] + b[4];
  out[5] = a[5] + b[5];
  return out;
}
/**
 * Subtracts matrix b from matrix a
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the first operand
 * @param {mat2d} b the second operand
 * @returns {mat2d} out
 */

function mat2d_subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  out[2] = a[2] - b[2];
  out[3] = a[3] - b[3];
  out[4] = a[4] - b[4];
  out[5] = a[5] - b[5];
  return out;
}
/**
 * Multiply each element of the matrix by a scalar.
 *
 * @param {mat2d} out the receiving matrix
 * @param {mat2d} a the matrix to scale
 * @param {Number} b amount to scale the matrix's elements by
 * @returns {mat2d} out
 */

function mat2d_multiplyScalar(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  out[3] = a[3] * b;
  out[4] = a[4] * b;
  out[5] = a[5] * b;
  return out;
}
/**
 * Adds two mat2d's after multiplying each element of the second operand by a scalar value.
 *
 * @param {mat2d} out the receiving vector
 * @param {mat2d} a the first operand
 * @param {mat2d} b the second operand
 * @param {Number} scale the amount to scale b's elements by before adding
 * @returns {mat2d} out
 */

function mat2d_multiplyScalarAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  out[2] = a[2] + b[2] * scale;
  out[3] = a[3] + b[3] * scale;
  out[4] = a[4] + b[4] * scale;
  out[5] = a[5] + b[5] * scale;
  return out;
}
/**
 * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)
 *
 * @param {mat2d} a The first matrix.
 * @param {mat2d} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function mat2d_exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5];
}
/**
 * Returns whether or not the matrices have approximately the same elements in the same position.
 *
 * @param {mat2d} a The first matrix.
 * @param {mat2d} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function mat2d_equals(a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3],
      a4 = a[4],
      a5 = a[5];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3],
      b4 = b[4],
      b5 = b[5];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5));
}
/**
 * Alias for {@link mat2d.multiply}
 * @function
 */

var mat2d_mul = mat2d_multiply;
/**
 * Alias for {@link mat2d.subtract}
 * @function
 */

var mat2d_sub = mat2d_subtract;
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/mat3.js

/**
 * 3x3 Matrix
 * @module mat3
 */

/**
 * Creates a new identity mat3
 *
 * @returns {mat3} a new 3x3 matrix
 */

function mat3_create() {
  var out = new ARRAY_TYPE(9);

  if (ARRAY_TYPE != Float32Array) {
    out[1] = 0;
    out[2] = 0;
    out[3] = 0;
    out[5] = 0;
    out[6] = 0;
    out[7] = 0;
  }

  out[0] = 1;
  out[4] = 1;
  out[8] = 1;
  return out;
}
/**
 * Copies the upper-left 3x3 values into the given mat3.
 *
 * @param {mat3} out the receiving 3x3 matrix
 * @param {mat4} a   the source 4x4 matrix
 * @returns {mat3} out
 */

function fromMat4(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[4];
  out[4] = a[5];
  out[5] = a[6];
  out[6] = a[8];
  out[7] = a[9];
  out[8] = a[10];
  return out;
}
/**
 * Creates a new mat3 initialized with values from an existing matrix
 *
 * @param {mat3} a matrix to clone
 * @returns {mat3} a new 3x3 matrix
 */

function mat3_clone(a) {
  var out = new ARRAY_TYPE(9);
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  out[4] = a[4];
  out[5] = a[5];
  out[6] = a[6];
  out[7] = a[7];
  out[8] = a[8];
  return out;
}
/**
 * Copy the values from one mat3 to another
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the source matrix
 * @returns {mat3} out
 */

function mat3_copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  out[4] = a[4];
  out[5] = a[5];
  out[6] = a[6];
  out[7] = a[7];
  out[8] = a[8];
  return out;
}
/**
 * Create a new mat3 with the given values
 *
 * @param {Number} m00 Component in column 0, row 0 position (index 0)
 * @param {Number} m01 Component in column 0, row 1 position (index 1)
 * @param {Number} m02 Component in column 0, row 2 position (index 2)
 * @param {Number} m10 Component in column 1, row 0 position (index 3)
 * @param {Number} m11 Component in column 1, row 1 position (index 4)
 * @param {Number} m12 Component in column 1, row 2 position (index 5)
 * @param {Number} m20 Component in column 2, row 0 position (index 6)
 * @param {Number} m21 Component in column 2, row 1 position (index 7)
 * @param {Number} m22 Component in column 2, row 2 position (index 8)
 * @returns {mat3} A new mat3
 */

function mat3_fromValues(m00, m01, m02, m10, m11, m12, m20, m21, m22) {
  var out = new ARRAY_TYPE(9);
  out[0] = m00;
  out[1] = m01;
  out[2] = m02;
  out[3] = m10;
  out[4] = m11;
  out[5] = m12;
  out[6] = m20;
  out[7] = m21;
  out[8] = m22;
  return out;
}
/**
 * Set the components of a mat3 to the given values
 *
 * @param {mat3} out the receiving matrix
 * @param {Number} m00 Component in column 0, row 0 position (index 0)
 * @param {Number} m01 Component in column 0, row 1 position (index 1)
 * @param {Number} m02 Component in column 0, row 2 position (index 2)
 * @param {Number} m10 Component in column 1, row 0 position (index 3)
 * @param {Number} m11 Component in column 1, row 1 position (index 4)
 * @param {Number} m12 Component in column 1, row 2 position (index 5)
 * @param {Number} m20 Component in column 2, row 0 position (index 6)
 * @param {Number} m21 Component in column 2, row 1 position (index 7)
 * @param {Number} m22 Component in column 2, row 2 position (index 8)
 * @returns {mat3} out
 */

function mat3_set(out, m00, m01, m02, m10, m11, m12, m20, m21, m22) {
  out[0] = m00;
  out[1] = m01;
  out[2] = m02;
  out[3] = m10;
  out[4] = m11;
  out[5] = m12;
  out[6] = m20;
  out[7] = m21;
  out[8] = m22;
  return out;
}
/**
 * Set a mat3 to the identity matrix
 *
 * @param {mat3} out the receiving matrix
 * @returns {mat3} out
 */

function mat3_identity(out) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 1;
  out[5] = 0;
  out[6] = 0;
  out[7] = 0;
  out[8] = 1;
  return out;
}
/**
 * Transpose the values of a mat3
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the source matrix
 * @returns {mat3} out
 */

function mat3_transpose(out, a) {
  // If we are transposing ourselves we can skip a few steps but have to cache some values
  if (out === a) {
    var a01 = a[1],
        a02 = a[2],
        a12 = a[5];
    out[1] = a[3];
    out[2] = a[6];
    out[3] = a01;
    out[5] = a[7];
    out[6] = a02;
    out[7] = a12;
  } else {
    out[0] = a[0];
    out[1] = a[3];
    out[2] = a[6];
    out[3] = a[1];
    out[4] = a[4];
    out[5] = a[7];
    out[6] = a[2];
    out[7] = a[5];
    out[8] = a[8];
  }

  return out;
}
/**
 * Inverts a mat3
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the source matrix
 * @returns {mat3} out
 */

function mat3_invert(out, a) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2];
  var a10 = a[3],
      a11 = a[4],
      a12 = a[5];
  var a20 = a[6],
      a21 = a[7],
      a22 = a[8];
  var b01 = a22 * a11 - a12 * a21;
  var b11 = -a22 * a10 + a12 * a20;
  var b21 = a21 * a10 - a11 * a20; // Calculate the determinant

  var det = a00 * b01 + a01 * b11 + a02 * b21;

  if (!det) {
    return null;
  }

  det = 1.0 / det;
  out[0] = b01 * det;
  out[1] = (-a22 * a01 + a02 * a21) * det;
  out[2] = (a12 * a01 - a02 * a11) * det;
  out[3] = b11 * det;
  out[4] = (a22 * a00 - a02 * a20) * det;
  out[5] = (-a12 * a00 + a02 * a10) * det;
  out[6] = b21 * det;
  out[7] = (-a21 * a00 + a01 * a20) * det;
  out[8] = (a11 * a00 - a01 * a10) * det;
  return out;
}
/**
 * Calculates the adjugate of a mat3
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the source matrix
 * @returns {mat3} out
 */

function mat3_adjoint(out, a) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2];
  var a10 = a[3],
      a11 = a[4],
      a12 = a[5];
  var a20 = a[6],
      a21 = a[7],
      a22 = a[8];
  out[0] = a11 * a22 - a12 * a21;
  out[1] = a02 * a21 - a01 * a22;
  out[2] = a01 * a12 - a02 * a11;
  out[3] = a12 * a20 - a10 * a22;
  out[4] = a00 * a22 - a02 * a20;
  out[5] = a02 * a10 - a00 * a12;
  out[6] = a10 * a21 - a11 * a20;
  out[7] = a01 * a20 - a00 * a21;
  out[8] = a00 * a11 - a01 * a10;
  return out;
}
/**
 * Calculates the determinant of a mat3
 *
 * @param {mat3} a the source matrix
 * @returns {Number} determinant of a
 */

function mat3_determinant(a) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2];
  var a10 = a[3],
      a11 = a[4],
      a12 = a[5];
  var a20 = a[6],
      a21 = a[7],
      a22 = a[8];
  return a00 * (a22 * a11 - a12 * a21) + a01 * (-a22 * a10 + a12 * a20) + a02 * (a21 * a10 - a11 * a20);
}
/**
 * Multiplies two mat3's
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the first operand
 * @param {mat3} b the second operand
 * @returns {mat3} out
 */

function mat3_multiply(out, a, b) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2];
  var a10 = a[3],
      a11 = a[4],
      a12 = a[5];
  var a20 = a[6],
      a21 = a[7],
      a22 = a[8];
  var b00 = b[0],
      b01 = b[1],
      b02 = b[2];
  var b10 = b[3],
      b11 = b[4],
      b12 = b[5];
  var b20 = b[6],
      b21 = b[7],
      b22 = b[8];
  out[0] = b00 * a00 + b01 * a10 + b02 * a20;
  out[1] = b00 * a01 + b01 * a11 + b02 * a21;
  out[2] = b00 * a02 + b01 * a12 + b02 * a22;
  out[3] = b10 * a00 + b11 * a10 + b12 * a20;
  out[4] = b10 * a01 + b11 * a11 + b12 * a21;
  out[5] = b10 * a02 + b11 * a12 + b12 * a22;
  out[6] = b20 * a00 + b21 * a10 + b22 * a20;
  out[7] = b20 * a01 + b21 * a11 + b22 * a21;
  out[8] = b20 * a02 + b21 * a12 + b22 * a22;
  return out;
}
/**
 * Translate a mat3 by the given vector
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the matrix to translate
 * @param {vec2} v vector to translate by
 * @returns {mat3} out
 */

function mat3_translate(out, a, v) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a10 = a[3],
      a11 = a[4],
      a12 = a[5],
      a20 = a[6],
      a21 = a[7],
      a22 = a[8],
      x = v[0],
      y = v[1];
  out[0] = a00;
  out[1] = a01;
  out[2] = a02;
  out[3] = a10;
  out[4] = a11;
  out[5] = a12;
  out[6] = x * a00 + y * a10 + a20;
  out[7] = x * a01 + y * a11 + a21;
  out[8] = x * a02 + y * a12 + a22;
  return out;
}
/**
 * Rotates a mat3 by the given angle
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat3} out
 */

function mat3_rotate(out, a, rad) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a10 = a[3],
      a11 = a[4],
      a12 = a[5],
      a20 = a[6],
      a21 = a[7],
      a22 = a[8],
      s = Math.sin(rad),
      c = Math.cos(rad);
  out[0] = c * a00 + s * a10;
  out[1] = c * a01 + s * a11;
  out[2] = c * a02 + s * a12;
  out[3] = c * a10 - s * a00;
  out[4] = c * a11 - s * a01;
  out[5] = c * a12 - s * a02;
  out[6] = a20;
  out[7] = a21;
  out[8] = a22;
  return out;
}
;
/**
 * Scales the mat3 by the dimensions in the given vec2
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the matrix to rotate
 * @param {vec2} v the vec2 to scale the matrix by
 * @returns {mat3} out
 **/

function mat3_scale(out, a, v) {
  var x = v[0],
      y = v[1];
  out[0] = x * a[0];
  out[1] = x * a[1];
  out[2] = x * a[2];
  out[3] = y * a[3];
  out[4] = y * a[4];
  out[5] = y * a[5];
  out[6] = a[6];
  out[7] = a[7];
  out[8] = a[8];
  return out;
}
/**
 * Creates a matrix from a vector translation
 * This is equivalent to (but much faster than):
 *
 *     mat3.identity(dest);
 *     mat3.translate(dest, dest, vec);
 *
 * @param {mat3} out mat3 receiving operation result
 * @param {vec2} v Translation vector
 * @returns {mat3} out
 */

function mat3_fromTranslation(out, v) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 1;
  out[5] = 0;
  out[6] = v[0];
  out[7] = v[1];
  out[8] = 1;
  return out;
}
/**
 * Creates a matrix from a given angle
 * This is equivalent to (but much faster than):
 *
 *     mat3.identity(dest);
 *     mat3.rotate(dest, dest, rad);
 *
 * @param {mat3} out mat3 receiving operation result
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat3} out
 */

function mat3_fromRotation(out, rad) {
  var s = Math.sin(rad),
      c = Math.cos(rad);
  out[0] = c;
  out[1] = s;
  out[2] = 0;
  out[3] = -s;
  out[4] = c;
  out[5] = 0;
  out[6] = 0;
  out[7] = 0;
  out[8] = 1;
  return out;
}
/**
 * Creates a matrix from a vector scaling
 * This is equivalent to (but much faster than):
 *
 *     mat3.identity(dest);
 *     mat3.scale(dest, dest, vec);
 *
 * @param {mat3} out mat3 receiving operation result
 * @param {vec2} v Scaling vector
 * @returns {mat3} out
 */

function mat3_fromScaling(out, v) {
  out[0] = v[0];
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = v[1];
  out[5] = 0;
  out[6] = 0;
  out[7] = 0;
  out[8] = 1;
  return out;
}
/**
 * Copies the values from a mat2d into a mat3
 *
 * @param {mat3} out the receiving matrix
 * @param {mat2d} a the matrix to copy
 * @returns {mat3} out
 **/

function fromMat2d(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = 0;
  out[3] = a[2];
  out[4] = a[3];
  out[5] = 0;
  out[6] = a[4];
  out[7] = a[5];
  out[8] = 1;
  return out;
}
/**
* Calculates a 3x3 matrix from the given quaternion
*
* @param {mat3} out mat3 receiving operation result
* @param {quat} q Quaternion to create matrix from
*
* @returns {mat3} out
*/

function fromQuat(out, q) {
  var x = q[0],
      y = q[1],
      z = q[2],
      w = q[3];
  var x2 = x + x;
  var y2 = y + y;
  var z2 = z + z;
  var xx = x * x2;
  var yx = y * x2;
  var yy = y * y2;
  var zx = z * x2;
  var zy = z * y2;
  var zz = z * z2;
  var wx = w * x2;
  var wy = w * y2;
  var wz = w * z2;
  out[0] = 1 - yy - zz;
  out[3] = yx - wz;
  out[6] = zx + wy;
  out[1] = yx + wz;
  out[4] = 1 - xx - zz;
  out[7] = zy - wx;
  out[2] = zx - wy;
  out[5] = zy + wx;
  out[8] = 1 - xx - yy;
  return out;
}
/**
* Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix
*
* @param {mat3} out mat3 receiving operation result
* @param {mat4} a Mat4 to derive the normal matrix from
*
* @returns {mat3} out
*/

function normalFromMat4(out, a) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a03 = a[3];
  var a10 = a[4],
      a11 = a[5],
      a12 = a[6],
      a13 = a[7];
  var a20 = a[8],
      a21 = a[9],
      a22 = a[10],
      a23 = a[11];
  var a30 = a[12],
      a31 = a[13],
      a32 = a[14],
      a33 = a[15];
  var b00 = a00 * a11 - a01 * a10;
  var b01 = a00 * a12 - a02 * a10;
  var b02 = a00 * a13 - a03 * a10;
  var b03 = a01 * a12 - a02 * a11;
  var b04 = a01 * a13 - a03 * a11;
  var b05 = a02 * a13 - a03 * a12;
  var b06 = a20 * a31 - a21 * a30;
  var b07 = a20 * a32 - a22 * a30;
  var b08 = a20 * a33 - a23 * a30;
  var b09 = a21 * a32 - a22 * a31;
  var b10 = a21 * a33 - a23 * a31;
  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant

  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;

  if (!det) {
    return null;
  }

  det = 1.0 / det;
  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;
  out[1] = (a12 * b08 - a10 * b11 - a13 * b07) * det;
  out[2] = (a10 * b10 - a11 * b08 + a13 * b06) * det;
  out[3] = (a02 * b10 - a01 * b11 - a03 * b09) * det;
  out[4] = (a00 * b11 - a02 * b08 + a03 * b07) * det;
  out[5] = (a01 * b08 - a00 * b10 - a03 * b06) * det;
  out[6] = (a31 * b05 - a32 * b04 + a33 * b03) * det;
  out[7] = (a32 * b02 - a30 * b05 - a33 * b01) * det;
  out[8] = (a30 * b04 - a31 * b02 + a33 * b00) * det;
  return out;
}
/**
 * Generates a 2D projection matrix with the given bounds
 *
 * @param {mat3} out mat3 frustum matrix will be written into
 * @param {number} width Width of your gl context
 * @param {number} height Height of gl context
 * @returns {mat3} out
 */

function projection(out, width, height) {
  out[0] = 2 / width;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = -2 / height;
  out[5] = 0;
  out[6] = -1;
  out[7] = 1;
  out[8] = 1;
  return out;
}
/**
 * Returns a string representation of a mat3
 *
 * @param {mat3} a matrix to represent as a string
 * @returns {String} string representation of the matrix
 */

function mat3_str(a) {
  return 'mat3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ')';
}
/**
 * Returns Frobenius norm of a mat3
 *
 * @param {mat3} a the matrix to calculate Frobenius norm of
 * @returns {Number} Frobenius norm
 */

function mat3_frob(a) {
  return Math.hypot(a[0], a[1], a[2], a[3], a[4], a[5], a[6], a[7], a[8]);
}
/**
 * Adds two mat3's
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the first operand
 * @param {mat3} b the second operand
 * @returns {mat3} out
 */

function mat3_add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  out[3] = a[3] + b[3];
  out[4] = a[4] + b[4];
  out[5] = a[5] + b[5];
  out[6] = a[6] + b[6];
  out[7] = a[7] + b[7];
  out[8] = a[8] + b[8];
  return out;
}
/**
 * Subtracts matrix b from matrix a
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the first operand
 * @param {mat3} b the second operand
 * @returns {mat3} out
 */

function mat3_subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  out[2] = a[2] - b[2];
  out[3] = a[3] - b[3];
  out[4] = a[4] - b[4];
  out[5] = a[5] - b[5];
  out[6] = a[6] - b[6];
  out[7] = a[7] - b[7];
  out[8] = a[8] - b[8];
  return out;
}
/**
 * Multiply each element of the matrix by a scalar.
 *
 * @param {mat3} out the receiving matrix
 * @param {mat3} a the matrix to scale
 * @param {Number} b amount to scale the matrix's elements by
 * @returns {mat3} out
 */

function mat3_multiplyScalar(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  out[3] = a[3] * b;
  out[4] = a[4] * b;
  out[5] = a[5] * b;
  out[6] = a[6] * b;
  out[7] = a[7] * b;
  out[8] = a[8] * b;
  return out;
}
/**
 * Adds two mat3's after multiplying each element of the second operand by a scalar value.
 *
 * @param {mat3} out the receiving vector
 * @param {mat3} a the first operand
 * @param {mat3} b the second operand
 * @param {Number} scale the amount to scale b's elements by before adding
 * @returns {mat3} out
 */

function mat3_multiplyScalarAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  out[2] = a[2] + b[2] * scale;
  out[3] = a[3] + b[3] * scale;
  out[4] = a[4] + b[4] * scale;
  out[5] = a[5] + b[5] * scale;
  out[6] = a[6] + b[6] * scale;
  out[7] = a[7] + b[7] * scale;
  out[8] = a[8] + b[8] * scale;
  return out;
}
/**
 * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)
 *
 * @param {mat3} a The first matrix.
 * @param {mat3} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function mat3_exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8];
}
/**
 * Returns whether or not the matrices have approximately the same elements in the same position.
 *
 * @param {mat3} a The first matrix.
 * @param {mat3} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function mat3_equals(a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3],
      a4 = a[4],
      a5 = a[5],
      a6 = a[6],
      a7 = a[7],
      a8 = a[8];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3],
      b4 = b[4],
      b5 = b[5],
      b6 = b[6],
      b7 = b[7],
      b8 = b[8];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8));
}
/**
 * Alias for {@link mat3.multiply}
 * @function
 */

var mat3_mul = mat3_multiply;
/**
 * Alias for {@link mat3.subtract}
 * @function
 */

var mat3_sub = mat3_subtract;
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/mat4.js

/**
 * 4x4 Matrix<br>Format: column-major, when typed out it looks like row-major<br>The matrices are being post multiplied.
 * @module mat4
 */

/**
 * Creates a new identity mat4
 *
 * @returns {mat4} a new 4x4 matrix
 */

function mat4_create() {
  var out = new ARRAY_TYPE(16);

  if (ARRAY_TYPE != Float32Array) {
    out[1] = 0;
    out[2] = 0;
    out[3] = 0;
    out[4] = 0;
    out[6] = 0;
    out[7] = 0;
    out[8] = 0;
    out[9] = 0;
    out[11] = 0;
    out[12] = 0;
    out[13] = 0;
    out[14] = 0;
  }

  out[0] = 1;
  out[5] = 1;
  out[10] = 1;
  out[15] = 1;
  return out;
}
/**
 * Creates a new mat4 initialized with values from an existing matrix
 *
 * @param {mat4} a matrix to clone
 * @returns {mat4} a new 4x4 matrix
 */

function mat4_clone(a) {
  var out = new ARRAY_TYPE(16);
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  out[4] = a[4];
  out[5] = a[5];
  out[6] = a[6];
  out[7] = a[7];
  out[8] = a[8];
  out[9] = a[9];
  out[10] = a[10];
  out[11] = a[11];
  out[12] = a[12];
  out[13] = a[13];
  out[14] = a[14];
  out[15] = a[15];
  return out;
}
/**
 * Copy the values from one mat4 to another
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the source matrix
 * @returns {mat4} out
 */

function mat4_copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  out[4] = a[4];
  out[5] = a[5];
  out[6] = a[6];
  out[7] = a[7];
  out[8] = a[8];
  out[9] = a[9];
  out[10] = a[10];
  out[11] = a[11];
  out[12] = a[12];
  out[13] = a[13];
  out[14] = a[14];
  out[15] = a[15];
  return out;
}
/**
 * Create a new mat4 with the given values
 *
 * @param {Number} m00 Component in column 0, row 0 position (index 0)
 * @param {Number} m01 Component in column 0, row 1 position (index 1)
 * @param {Number} m02 Component in column 0, row 2 position (index 2)
 * @param {Number} m03 Component in column 0, row 3 position (index 3)
 * @param {Number} m10 Component in column 1, row 0 position (index 4)
 * @param {Number} m11 Component in column 1, row 1 position (index 5)
 * @param {Number} m12 Component in column 1, row 2 position (index 6)
 * @param {Number} m13 Component in column 1, row 3 position (index 7)
 * @param {Number} m20 Component in column 2, row 0 position (index 8)
 * @param {Number} m21 Component in column 2, row 1 position (index 9)
 * @param {Number} m22 Component in column 2, row 2 position (index 10)
 * @param {Number} m23 Component in column 2, row 3 position (index 11)
 * @param {Number} m30 Component in column 3, row 0 position (index 12)
 * @param {Number} m31 Component in column 3, row 1 position (index 13)
 * @param {Number} m32 Component in column 3, row 2 position (index 14)
 * @param {Number} m33 Component in column 3, row 3 position (index 15)
 * @returns {mat4} A new mat4
 */

function mat4_fromValues(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {
  var out = new ARRAY_TYPE(16);
  out[0] = m00;
  out[1] = m01;
  out[2] = m02;
  out[3] = m03;
  out[4] = m10;
  out[5] = m11;
  out[6] = m12;
  out[7] = m13;
  out[8] = m20;
  out[9] = m21;
  out[10] = m22;
  out[11] = m23;
  out[12] = m30;
  out[13] = m31;
  out[14] = m32;
  out[15] = m33;
  return out;
}
/**
 * Set the components of a mat4 to the given values
 *
 * @param {mat4} out the receiving matrix
 * @param {Number} m00 Component in column 0, row 0 position (index 0)
 * @param {Number} m01 Component in column 0, row 1 position (index 1)
 * @param {Number} m02 Component in column 0, row 2 position (index 2)
 * @param {Number} m03 Component in column 0, row 3 position (index 3)
 * @param {Number} m10 Component in column 1, row 0 position (index 4)
 * @param {Number} m11 Component in column 1, row 1 position (index 5)
 * @param {Number} m12 Component in column 1, row 2 position (index 6)
 * @param {Number} m13 Component in column 1, row 3 position (index 7)
 * @param {Number} m20 Component in column 2, row 0 position (index 8)
 * @param {Number} m21 Component in column 2, row 1 position (index 9)
 * @param {Number} m22 Component in column 2, row 2 position (index 10)
 * @param {Number} m23 Component in column 2, row 3 position (index 11)
 * @param {Number} m30 Component in column 3, row 0 position (index 12)
 * @param {Number} m31 Component in column 3, row 1 position (index 13)
 * @param {Number} m32 Component in column 3, row 2 position (index 14)
 * @param {Number} m33 Component in column 3, row 3 position (index 15)
 * @returns {mat4} out
 */

function mat4_set(out, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {
  out[0] = m00;
  out[1] = m01;
  out[2] = m02;
  out[3] = m03;
  out[4] = m10;
  out[5] = m11;
  out[6] = m12;
  out[7] = m13;
  out[8] = m20;
  out[9] = m21;
  out[10] = m22;
  out[11] = m23;
  out[12] = m30;
  out[13] = m31;
  out[14] = m32;
  out[15] = m33;
  return out;
}
/**
 * Set a mat4 to the identity matrix
 *
 * @param {mat4} out the receiving matrix
 * @returns {mat4} out
 */

function mat4_identity(out) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = 1;
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[10] = 1;
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Transpose the values of a mat4
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the source matrix
 * @returns {mat4} out
 */

function mat4_transpose(out, a) {
  // If we are transposing ourselves we can skip a few steps but have to cache some values
  if (out === a) {
    var a01 = a[1],
        a02 = a[2],
        a03 = a[3];
    var a12 = a[6],
        a13 = a[7];
    var a23 = a[11];
    out[1] = a[4];
    out[2] = a[8];
    out[3] = a[12];
    out[4] = a01;
    out[6] = a[9];
    out[7] = a[13];
    out[8] = a02;
    out[9] = a12;
    out[11] = a[14];
    out[12] = a03;
    out[13] = a13;
    out[14] = a23;
  } else {
    out[0] = a[0];
    out[1] = a[4];
    out[2] = a[8];
    out[3] = a[12];
    out[4] = a[1];
    out[5] = a[5];
    out[6] = a[9];
    out[7] = a[13];
    out[8] = a[2];
    out[9] = a[6];
    out[10] = a[10];
    out[11] = a[14];
    out[12] = a[3];
    out[13] = a[7];
    out[14] = a[11];
    out[15] = a[15];
  }

  return out;
}
/**
 * Inverts a mat4
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the source matrix
 * @returns {mat4} out
 */

function mat4_invert(out, a) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a03 = a[3];
  var a10 = a[4],
      a11 = a[5],
      a12 = a[6],
      a13 = a[7];
  var a20 = a[8],
      a21 = a[9],
      a22 = a[10],
      a23 = a[11];
  var a30 = a[12],
      a31 = a[13],
      a32 = a[14],
      a33 = a[15];
  var b00 = a00 * a11 - a01 * a10;
  var b01 = a00 * a12 - a02 * a10;
  var b02 = a00 * a13 - a03 * a10;
  var b03 = a01 * a12 - a02 * a11;
  var b04 = a01 * a13 - a03 * a11;
  var b05 = a02 * a13 - a03 * a12;
  var b06 = a20 * a31 - a21 * a30;
  var b07 = a20 * a32 - a22 * a30;
  var b08 = a20 * a33 - a23 * a30;
  var b09 = a21 * a32 - a22 * a31;
  var b10 = a21 * a33 - a23 * a31;
  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant

  var det = b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;

  if (!det) {
    return null;
  }

  det = 1.0 / det;
  out[0] = (a11 * b11 - a12 * b10 + a13 * b09) * det;
  out[1] = (a02 * b10 - a01 * b11 - a03 * b09) * det;
  out[2] = (a31 * b05 - a32 * b04 + a33 * b03) * det;
  out[3] = (a22 * b04 - a21 * b05 - a23 * b03) * det;
  out[4] = (a12 * b08 - a10 * b11 - a13 * b07) * det;
  out[5] = (a00 * b11 - a02 * b08 + a03 * b07) * det;
  out[6] = (a32 * b02 - a30 * b05 - a33 * b01) * det;
  out[7] = (a20 * b05 - a22 * b02 + a23 * b01) * det;
  out[8] = (a10 * b10 - a11 * b08 + a13 * b06) * det;
  out[9] = (a01 * b08 - a00 * b10 - a03 * b06) * det;
  out[10] = (a30 * b04 - a31 * b02 + a33 * b00) * det;
  out[11] = (a21 * b02 - a20 * b04 - a23 * b00) * det;
  out[12] = (a11 * b07 - a10 * b09 - a12 * b06) * det;
  out[13] = (a00 * b09 - a01 * b07 + a02 * b06) * det;
  out[14] = (a31 * b01 - a30 * b03 - a32 * b00) * det;
  out[15] = (a20 * b03 - a21 * b01 + a22 * b00) * det;
  return out;
}
/**
 * Calculates the adjugate of a mat4
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the source matrix
 * @returns {mat4} out
 */

function mat4_adjoint(out, a) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a03 = a[3];
  var a10 = a[4],
      a11 = a[5],
      a12 = a[6],
      a13 = a[7];
  var a20 = a[8],
      a21 = a[9],
      a22 = a[10],
      a23 = a[11];
  var a30 = a[12],
      a31 = a[13],
      a32 = a[14],
      a33 = a[15];
  out[0] = a11 * (a22 * a33 - a23 * a32) - a21 * (a12 * a33 - a13 * a32) + a31 * (a12 * a23 - a13 * a22);
  out[1] = -(a01 * (a22 * a33 - a23 * a32) - a21 * (a02 * a33 - a03 * a32) + a31 * (a02 * a23 - a03 * a22));
  out[2] = a01 * (a12 * a33 - a13 * a32) - a11 * (a02 * a33 - a03 * a32) + a31 * (a02 * a13 - a03 * a12);
  out[3] = -(a01 * (a12 * a23 - a13 * a22) - a11 * (a02 * a23 - a03 * a22) + a21 * (a02 * a13 - a03 * a12));
  out[4] = -(a10 * (a22 * a33 - a23 * a32) - a20 * (a12 * a33 - a13 * a32) + a30 * (a12 * a23 - a13 * a22));
  out[5] = a00 * (a22 * a33 - a23 * a32) - a20 * (a02 * a33 - a03 * a32) + a30 * (a02 * a23 - a03 * a22);
  out[6] = -(a00 * (a12 * a33 - a13 * a32) - a10 * (a02 * a33 - a03 * a32) + a30 * (a02 * a13 - a03 * a12));
  out[7] = a00 * (a12 * a23 - a13 * a22) - a10 * (a02 * a23 - a03 * a22) + a20 * (a02 * a13 - a03 * a12);
  out[8] = a10 * (a21 * a33 - a23 * a31) - a20 * (a11 * a33 - a13 * a31) + a30 * (a11 * a23 - a13 * a21);
  out[9] = -(a00 * (a21 * a33 - a23 * a31) - a20 * (a01 * a33 - a03 * a31) + a30 * (a01 * a23 - a03 * a21));
  out[10] = a00 * (a11 * a33 - a13 * a31) - a10 * (a01 * a33 - a03 * a31) + a30 * (a01 * a13 - a03 * a11);
  out[11] = -(a00 * (a11 * a23 - a13 * a21) - a10 * (a01 * a23 - a03 * a21) + a20 * (a01 * a13 - a03 * a11));
  out[12] = -(a10 * (a21 * a32 - a22 * a31) - a20 * (a11 * a32 - a12 * a31) + a30 * (a11 * a22 - a12 * a21));
  out[13] = a00 * (a21 * a32 - a22 * a31) - a20 * (a01 * a32 - a02 * a31) + a30 * (a01 * a22 - a02 * a21);
  out[14] = -(a00 * (a11 * a32 - a12 * a31) - a10 * (a01 * a32 - a02 * a31) + a30 * (a01 * a12 - a02 * a11));
  out[15] = a00 * (a11 * a22 - a12 * a21) - a10 * (a01 * a22 - a02 * a21) + a20 * (a01 * a12 - a02 * a11);
  return out;
}
/**
 * Calculates the determinant of a mat4
 *
 * @param {mat4} a the source matrix
 * @returns {Number} determinant of a
 */

function mat4_determinant(a) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a03 = a[3];
  var a10 = a[4],
      a11 = a[5],
      a12 = a[6],
      a13 = a[7];
  var a20 = a[8],
      a21 = a[9],
      a22 = a[10],
      a23 = a[11];
  var a30 = a[12],
      a31 = a[13],
      a32 = a[14],
      a33 = a[15];
  var b00 = a00 * a11 - a01 * a10;
  var b01 = a00 * a12 - a02 * a10;
  var b02 = a00 * a13 - a03 * a10;
  var b03 = a01 * a12 - a02 * a11;
  var b04 = a01 * a13 - a03 * a11;
  var b05 = a02 * a13 - a03 * a12;
  var b06 = a20 * a31 - a21 * a30;
  var b07 = a20 * a32 - a22 * a30;
  var b08 = a20 * a33 - a23 * a30;
  var b09 = a21 * a32 - a22 * a31;
  var b10 = a21 * a33 - a23 * a31;
  var b11 = a22 * a33 - a23 * a32; // Calculate the determinant

  return b00 * b11 - b01 * b10 + b02 * b09 + b03 * b08 - b04 * b07 + b05 * b06;
}
/**
 * Multiplies two mat4s
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the first operand
 * @param {mat4} b the second operand
 * @returns {mat4} out
 */

function mat4_multiply(out, a, b) {
  var a00 = a[0],
      a01 = a[1],
      a02 = a[2],
      a03 = a[3];
  var a10 = a[4],
      a11 = a[5],
      a12 = a[6],
      a13 = a[7];
  var a20 = a[8],
      a21 = a[9],
      a22 = a[10],
      a23 = a[11];
  var a30 = a[12],
      a31 = a[13],
      a32 = a[14],
      a33 = a[15]; // Cache only the current line of the second matrix

  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3];
  out[0] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[1] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[2] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[3] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  b0 = b[4];
  b1 = b[5];
  b2 = b[6];
  b3 = b[7];
  out[4] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[5] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[6] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[7] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  b0 = b[8];
  b1 = b[9];
  b2 = b[10];
  b3 = b[11];
  out[8] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[9] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[10] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[11] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  b0 = b[12];
  b1 = b[13];
  b2 = b[14];
  b3 = b[15];
  out[12] = b0 * a00 + b1 * a10 + b2 * a20 + b3 * a30;
  out[13] = b0 * a01 + b1 * a11 + b2 * a21 + b3 * a31;
  out[14] = b0 * a02 + b1 * a12 + b2 * a22 + b3 * a32;
  out[15] = b0 * a03 + b1 * a13 + b2 * a23 + b3 * a33;
  return out;
}
/**
 * Translate a mat4 by the given vector
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the matrix to translate
 * @param {vec3} v vector to translate by
 * @returns {mat4} out
 */

function mat4_translate(out, a, v) {
  var x = v[0],
      y = v[1],
      z = v[2];
  var a00, a01, a02, a03;
  var a10, a11, a12, a13;
  var a20, a21, a22, a23;

  if (a === out) {
    out[12] = a[0] * x + a[4] * y + a[8] * z + a[12];
    out[13] = a[1] * x + a[5] * y + a[9] * z + a[13];
    out[14] = a[2] * x + a[6] * y + a[10] * z + a[14];
    out[15] = a[3] * x + a[7] * y + a[11] * z + a[15];
  } else {
    a00 = a[0];
    a01 = a[1];
    a02 = a[2];
    a03 = a[3];
    a10 = a[4];
    a11 = a[5];
    a12 = a[6];
    a13 = a[7];
    a20 = a[8];
    a21 = a[9];
    a22 = a[10];
    a23 = a[11];
    out[0] = a00;
    out[1] = a01;
    out[2] = a02;
    out[3] = a03;
    out[4] = a10;
    out[5] = a11;
    out[6] = a12;
    out[7] = a13;
    out[8] = a20;
    out[9] = a21;
    out[10] = a22;
    out[11] = a23;
    out[12] = a00 * x + a10 * y + a20 * z + a[12];
    out[13] = a01 * x + a11 * y + a21 * z + a[13];
    out[14] = a02 * x + a12 * y + a22 * z + a[14];
    out[15] = a03 * x + a13 * y + a23 * z + a[15];
  }

  return out;
}
/**
 * Scales the mat4 by the dimensions in the given vec3 not using vectorization
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the matrix to scale
 * @param {vec3} v the vec3 to scale the matrix by
 * @returns {mat4} out
 **/

function mat4_scale(out, a, v) {
  var x = v[0],
      y = v[1],
      z = v[2];
  out[0] = a[0] * x;
  out[1] = a[1] * x;
  out[2] = a[2] * x;
  out[3] = a[3] * x;
  out[4] = a[4] * y;
  out[5] = a[5] * y;
  out[6] = a[6] * y;
  out[7] = a[7] * y;
  out[8] = a[8] * z;
  out[9] = a[9] * z;
  out[10] = a[10] * z;
  out[11] = a[11] * z;
  out[12] = a[12];
  out[13] = a[13];
  out[14] = a[14];
  out[15] = a[15];
  return out;
}
/**
 * Rotates a mat4 by the given angle around the given axis
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @param {vec3} axis the axis to rotate around
 * @returns {mat4} out
 */

function mat4_rotate(out, a, rad, axis) {
  var x = axis[0],
      y = axis[1],
      z = axis[2];
  var len = Math.hypot(x, y, z);
  var s, c, t;
  var a00, a01, a02, a03;
  var a10, a11, a12, a13;
  var a20, a21, a22, a23;
  var b00, b01, b02;
  var b10, b11, b12;
  var b20, b21, b22;

  if (len < EPSILON) {
    return null;
  }

  len = 1 / len;
  x *= len;
  y *= len;
  z *= len;
  s = Math.sin(rad);
  c = Math.cos(rad);
  t = 1 - c;
  a00 = a[0];
  a01 = a[1];
  a02 = a[2];
  a03 = a[3];
  a10 = a[4];
  a11 = a[5];
  a12 = a[6];
  a13 = a[7];
  a20 = a[8];
  a21 = a[9];
  a22 = a[10];
  a23 = a[11]; // Construct the elements of the rotation matrix

  b00 = x * x * t + c;
  b01 = y * x * t + z * s;
  b02 = z * x * t - y * s;
  b10 = x * y * t - z * s;
  b11 = y * y * t + c;
  b12 = z * y * t + x * s;
  b20 = x * z * t + y * s;
  b21 = y * z * t - x * s;
  b22 = z * z * t + c; // Perform rotation-specific matrix multiplication

  out[0] = a00 * b00 + a10 * b01 + a20 * b02;
  out[1] = a01 * b00 + a11 * b01 + a21 * b02;
  out[2] = a02 * b00 + a12 * b01 + a22 * b02;
  out[3] = a03 * b00 + a13 * b01 + a23 * b02;
  out[4] = a00 * b10 + a10 * b11 + a20 * b12;
  out[5] = a01 * b10 + a11 * b11 + a21 * b12;
  out[6] = a02 * b10 + a12 * b11 + a22 * b12;
  out[7] = a03 * b10 + a13 * b11 + a23 * b12;
  out[8] = a00 * b20 + a10 * b21 + a20 * b22;
  out[9] = a01 * b20 + a11 * b21 + a21 * b22;
  out[10] = a02 * b20 + a12 * b21 + a22 * b22;
  out[11] = a03 * b20 + a13 * b21 + a23 * b22;

  if (a !== out) {
    // If the source and destination differ, copy the unchanged last row
    out[12] = a[12];
    out[13] = a[13];
    out[14] = a[14];
    out[15] = a[15];
  }

  return out;
}
/**
 * Rotates a matrix by the given angle around the X axis
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat4} out
 */

function rotateX(out, a, rad) {
  var s = Math.sin(rad);
  var c = Math.cos(rad);
  var a10 = a[4];
  var a11 = a[5];
  var a12 = a[6];
  var a13 = a[7];
  var a20 = a[8];
  var a21 = a[9];
  var a22 = a[10];
  var a23 = a[11];

  if (a !== out) {
    // If the source and destination differ, copy the unchanged rows
    out[0] = a[0];
    out[1] = a[1];
    out[2] = a[2];
    out[3] = a[3];
    out[12] = a[12];
    out[13] = a[13];
    out[14] = a[14];
    out[15] = a[15];
  } // Perform axis-specific matrix multiplication


  out[4] = a10 * c + a20 * s;
  out[5] = a11 * c + a21 * s;
  out[6] = a12 * c + a22 * s;
  out[7] = a13 * c + a23 * s;
  out[8] = a20 * c - a10 * s;
  out[9] = a21 * c - a11 * s;
  out[10] = a22 * c - a12 * s;
  out[11] = a23 * c - a13 * s;
  return out;
}
/**
 * Rotates a matrix by the given angle around the Y axis
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat4} out
 */

function rotateY(out, a, rad) {
  var s = Math.sin(rad);
  var c = Math.cos(rad);
  var a00 = a[0];
  var a01 = a[1];
  var a02 = a[2];
  var a03 = a[3];
  var a20 = a[8];
  var a21 = a[9];
  var a22 = a[10];
  var a23 = a[11];

  if (a !== out) {
    // If the source and destination differ, copy the unchanged rows
    out[4] = a[4];
    out[5] = a[5];
    out[6] = a[6];
    out[7] = a[7];
    out[12] = a[12];
    out[13] = a[13];
    out[14] = a[14];
    out[15] = a[15];
  } // Perform axis-specific matrix multiplication


  out[0] = a00 * c - a20 * s;
  out[1] = a01 * c - a21 * s;
  out[2] = a02 * c - a22 * s;
  out[3] = a03 * c - a23 * s;
  out[8] = a00 * s + a20 * c;
  out[9] = a01 * s + a21 * c;
  out[10] = a02 * s + a22 * c;
  out[11] = a03 * s + a23 * c;
  return out;
}
/**
 * Rotates a matrix by the given angle around the Z axis
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the matrix to rotate
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat4} out
 */

function rotateZ(out, a, rad) {
  var s = Math.sin(rad);
  var c = Math.cos(rad);
  var a00 = a[0];
  var a01 = a[1];
  var a02 = a[2];
  var a03 = a[3];
  var a10 = a[4];
  var a11 = a[5];
  var a12 = a[6];
  var a13 = a[7];

  if (a !== out) {
    // If the source and destination differ, copy the unchanged last row
    out[8] = a[8];
    out[9] = a[9];
    out[10] = a[10];
    out[11] = a[11];
    out[12] = a[12];
    out[13] = a[13];
    out[14] = a[14];
    out[15] = a[15];
  } // Perform axis-specific matrix multiplication


  out[0] = a00 * c + a10 * s;
  out[1] = a01 * c + a11 * s;
  out[2] = a02 * c + a12 * s;
  out[3] = a03 * c + a13 * s;
  out[4] = a10 * c - a00 * s;
  out[5] = a11 * c - a01 * s;
  out[6] = a12 * c - a02 * s;
  out[7] = a13 * c - a03 * s;
  return out;
}
/**
 * Creates a matrix from a vector translation
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.translate(dest, dest, vec);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {vec3} v Translation vector
 * @returns {mat4} out
 */

function mat4_fromTranslation(out, v) {
  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = 1;
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[10] = 1;
  out[11] = 0;
  out[12] = v[0];
  out[13] = v[1];
  out[14] = v[2];
  out[15] = 1;
  return out;
}
/**
 * Creates a matrix from a vector scaling
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.scale(dest, dest, vec);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {vec3} v Scaling vector
 * @returns {mat4} out
 */

function mat4_fromScaling(out, v) {
  out[0] = v[0];
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = v[1];
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[10] = v[2];
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Creates a matrix from a given angle around a given axis
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.rotate(dest, dest, rad, axis);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {Number} rad the angle to rotate the matrix by
 * @param {vec3} axis the axis to rotate around
 * @returns {mat4} out
 */

function mat4_fromRotation(out, rad, axis) {
  var x = axis[0],
      y = axis[1],
      z = axis[2];
  var len = Math.hypot(x, y, z);
  var s, c, t;

  if (len < EPSILON) {
    return null;
  }

  len = 1 / len;
  x *= len;
  y *= len;
  z *= len;
  s = Math.sin(rad);
  c = Math.cos(rad);
  t = 1 - c; // Perform rotation-specific matrix multiplication

  out[0] = x * x * t + c;
  out[1] = y * x * t + z * s;
  out[2] = z * x * t - y * s;
  out[3] = 0;
  out[4] = x * y * t - z * s;
  out[5] = y * y * t + c;
  out[6] = z * y * t + x * s;
  out[7] = 0;
  out[8] = x * z * t + y * s;
  out[9] = y * z * t - x * s;
  out[10] = z * z * t + c;
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Creates a matrix from the given angle around the X axis
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.rotateX(dest, dest, rad);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat4} out
 */

function fromXRotation(out, rad) {
  var s = Math.sin(rad);
  var c = Math.cos(rad); // Perform axis-specific matrix multiplication

  out[0] = 1;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = c;
  out[6] = s;
  out[7] = 0;
  out[8] = 0;
  out[9] = -s;
  out[10] = c;
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Creates a matrix from the given angle around the Y axis
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.rotateY(dest, dest, rad);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat4} out
 */

function fromYRotation(out, rad) {
  var s = Math.sin(rad);
  var c = Math.cos(rad); // Perform axis-specific matrix multiplication

  out[0] = c;
  out[1] = 0;
  out[2] = -s;
  out[3] = 0;
  out[4] = 0;
  out[5] = 1;
  out[6] = 0;
  out[7] = 0;
  out[8] = s;
  out[9] = 0;
  out[10] = c;
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Creates a matrix from the given angle around the Z axis
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.rotateZ(dest, dest, rad);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {Number} rad the angle to rotate the matrix by
 * @returns {mat4} out
 */

function fromZRotation(out, rad) {
  var s = Math.sin(rad);
  var c = Math.cos(rad); // Perform axis-specific matrix multiplication

  out[0] = c;
  out[1] = s;
  out[2] = 0;
  out[3] = 0;
  out[4] = -s;
  out[5] = c;
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[10] = 1;
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Creates a matrix from a quaternion rotation and vector translation
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.translate(dest, vec);
 *     let quatMat = mat4.create();
 *     quat4.toMat4(quat, quatMat);
 *     mat4.multiply(dest, quatMat);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {quat4} q Rotation quaternion
 * @param {vec3} v Translation vector
 * @returns {mat4} out
 */

function fromRotationTranslation(out, q, v) {
  // Quaternion math
  var x = q[0],
      y = q[1],
      z = q[2],
      w = q[3];
  var x2 = x + x;
  var y2 = y + y;
  var z2 = z + z;
  var xx = x * x2;
  var xy = x * y2;
  var xz = x * z2;
  var yy = y * y2;
  var yz = y * z2;
  var zz = z * z2;
  var wx = w * x2;
  var wy = w * y2;
  var wz = w * z2;
  out[0] = 1 - (yy + zz);
  out[1] = xy + wz;
  out[2] = xz - wy;
  out[3] = 0;
  out[4] = xy - wz;
  out[5] = 1 - (xx + zz);
  out[6] = yz + wx;
  out[7] = 0;
  out[8] = xz + wy;
  out[9] = yz - wx;
  out[10] = 1 - (xx + yy);
  out[11] = 0;
  out[12] = v[0];
  out[13] = v[1];
  out[14] = v[2];
  out[15] = 1;
  return out;
}
/**
 * Creates a new mat4 from a dual quat.
 *
 * @param {mat4} out Matrix
 * @param {quat2} a Dual Quaternion
 * @returns {mat4} mat4 receiving operation result
 */

function fromQuat2(out, a) {
  var translation = new ARRAY_TYPE(3);
  var bx = -a[0],
      by = -a[1],
      bz = -a[2],
      bw = a[3],
      ax = a[4],
      ay = a[5],
      az = a[6],
      aw = a[7];
  var magnitude = bx * bx + by * by + bz * bz + bw * bw; //Only scale if it makes sense

  if (magnitude > 0) {
    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2 / magnitude;
    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2 / magnitude;
    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2 / magnitude;
  } else {
    translation[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;
    translation[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;
    translation[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;
  }

  fromRotationTranslation(out, a, translation);
  return out;
}
/**
 * Returns the translation vector component of a transformation
 *  matrix. If a matrix is built with fromRotationTranslation,
 *  the returned vector will be the same as the translation vector
 *  originally supplied.
 * @param  {vec3} out Vector to receive translation component
 * @param  {mat4} mat Matrix to be decomposed (input)
 * @return {vec3} out
 */

function getTranslation(out, mat) {
  out[0] = mat[12];
  out[1] = mat[13];
  out[2] = mat[14];
  return out;
}
/**
 * Returns the scaling factor component of a transformation
 *  matrix. If a matrix is built with fromRotationTranslationScale
 *  with a normalized Quaternion paramter, the returned vector will be
 *  the same as the scaling vector
 *  originally supplied.
 * @param  {vec3} out Vector to receive scaling factor component
 * @param  {mat4} mat Matrix to be decomposed (input)
 * @return {vec3} out
 */

function getScaling(out, mat) {
  var m11 = mat[0];
  var m12 = mat[1];
  var m13 = mat[2];
  var m21 = mat[4];
  var m22 = mat[5];
  var m23 = mat[6];
  var m31 = mat[8];
  var m32 = mat[9];
  var m33 = mat[10];
  out[0] = Math.hypot(m11, m12, m13);
  out[1] = Math.hypot(m21, m22, m23);
  out[2] = Math.hypot(m31, m32, m33);
  return out;
}
/**
 * Returns a quaternion representing the rotational component
 *  of a transformation matrix. If a matrix is built with
 *  fromRotationTranslation, the returned quaternion will be the
 *  same as the quaternion originally supplied.
 * @param {quat} out Quaternion to receive the rotation component
 * @param {mat4} mat Matrix to be decomposed (input)
 * @return {quat} out
 */

function getRotation(out, mat) {
  var scaling = new ARRAY_TYPE(3);
  getScaling(scaling, mat);
  var is1 = 1 / scaling[0];
  var is2 = 1 / scaling[1];
  var is3 = 1 / scaling[2];
  var sm11 = mat[0] * is1;
  var sm12 = mat[1] * is2;
  var sm13 = mat[2] * is3;
  var sm21 = mat[4] * is1;
  var sm22 = mat[5] * is2;
  var sm23 = mat[6] * is3;
  var sm31 = mat[8] * is1;
  var sm32 = mat[9] * is2;
  var sm33 = mat[10] * is3;
  var trace = sm11 + sm22 + sm33;
  var S = 0;

  if (trace > 0) {
    S = Math.sqrt(trace + 1.0) * 2;
    out[3] = 0.25 * S;
    out[0] = (sm23 - sm32) / S;
    out[1] = (sm31 - sm13) / S;
    out[2] = (sm12 - sm21) / S;
  } else if (sm11 > sm22 && sm11 > sm33) {
    S = Math.sqrt(1.0 + sm11 - sm22 - sm33) * 2;
    out[3] = (sm23 - sm32) / S;
    out[0] = 0.25 * S;
    out[1] = (sm12 + sm21) / S;
    out[2] = (sm31 + sm13) / S;
  } else if (sm22 > sm33) {
    S = Math.sqrt(1.0 + sm22 - sm11 - sm33) * 2;
    out[3] = (sm31 - sm13) / S;
    out[0] = (sm12 + sm21) / S;
    out[1] = 0.25 * S;
    out[2] = (sm23 + sm32) / S;
  } else {
    S = Math.sqrt(1.0 + sm33 - sm11 - sm22) * 2;
    out[3] = (sm12 - sm21) / S;
    out[0] = (sm31 + sm13) / S;
    out[1] = (sm23 + sm32) / S;
    out[2] = 0.25 * S;
  }

  return out;
}
/**
 * Creates a matrix from a quaternion rotation, vector translation and vector scale
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.translate(dest, vec);
 *     let quatMat = mat4.create();
 *     quat4.toMat4(quat, quatMat);
 *     mat4.multiply(dest, quatMat);
 *     mat4.scale(dest, scale)
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {quat4} q Rotation quaternion
 * @param {vec3} v Translation vector
 * @param {vec3} s Scaling vector
 * @returns {mat4} out
 */

function fromRotationTranslationScale(out, q, v, s) {
  // Quaternion math
  var x = q[0],
      y = q[1],
      z = q[2],
      w = q[3];
  var x2 = x + x;
  var y2 = y + y;
  var z2 = z + z;
  var xx = x * x2;
  var xy = x * y2;
  var xz = x * z2;
  var yy = y * y2;
  var yz = y * z2;
  var zz = z * z2;
  var wx = w * x2;
  var wy = w * y2;
  var wz = w * z2;
  var sx = s[0];
  var sy = s[1];
  var sz = s[2];
  out[0] = (1 - (yy + zz)) * sx;
  out[1] = (xy + wz) * sx;
  out[2] = (xz - wy) * sx;
  out[3] = 0;
  out[4] = (xy - wz) * sy;
  out[5] = (1 - (xx + zz)) * sy;
  out[6] = (yz + wx) * sy;
  out[7] = 0;
  out[8] = (xz + wy) * sz;
  out[9] = (yz - wx) * sz;
  out[10] = (1 - (xx + yy)) * sz;
  out[11] = 0;
  out[12] = v[0];
  out[13] = v[1];
  out[14] = v[2];
  out[15] = 1;
  return out;
}
/**
 * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin
 * This is equivalent to (but much faster than):
 *
 *     mat4.identity(dest);
 *     mat4.translate(dest, vec);
 *     mat4.translate(dest, origin);
 *     let quatMat = mat4.create();
 *     quat4.toMat4(quat, quatMat);
 *     mat4.multiply(dest, quatMat);
 *     mat4.scale(dest, scale)
 *     mat4.translate(dest, negativeOrigin);
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {quat4} q Rotation quaternion
 * @param {vec3} v Translation vector
 * @param {vec3} s Scaling vector
 * @param {vec3} o The origin vector around which to scale and rotate
 * @returns {mat4} out
 */

function fromRotationTranslationScaleOrigin(out, q, v, s, o) {
  // Quaternion math
  var x = q[0],
      y = q[1],
      z = q[2],
      w = q[3];
  var x2 = x + x;
  var y2 = y + y;
  var z2 = z + z;
  var xx = x * x2;
  var xy = x * y2;
  var xz = x * z2;
  var yy = y * y2;
  var yz = y * z2;
  var zz = z * z2;
  var wx = w * x2;
  var wy = w * y2;
  var wz = w * z2;
  var sx = s[0];
  var sy = s[1];
  var sz = s[2];
  var ox = o[0];
  var oy = o[1];
  var oz = o[2];
  var out0 = (1 - (yy + zz)) * sx;
  var out1 = (xy + wz) * sx;
  var out2 = (xz - wy) * sx;
  var out4 = (xy - wz) * sy;
  var out5 = (1 - (xx + zz)) * sy;
  var out6 = (yz + wx) * sy;
  var out8 = (xz + wy) * sz;
  var out9 = (yz - wx) * sz;
  var out10 = (1 - (xx + yy)) * sz;
  out[0] = out0;
  out[1] = out1;
  out[2] = out2;
  out[3] = 0;
  out[4] = out4;
  out[5] = out5;
  out[6] = out6;
  out[7] = 0;
  out[8] = out8;
  out[9] = out9;
  out[10] = out10;
  out[11] = 0;
  out[12] = v[0] + ox - (out0 * ox + out4 * oy + out8 * oz);
  out[13] = v[1] + oy - (out1 * ox + out5 * oy + out9 * oz);
  out[14] = v[2] + oz - (out2 * ox + out6 * oy + out10 * oz);
  out[15] = 1;
  return out;
}
/**
 * Calculates a 4x4 matrix from the given quaternion
 *
 * @param {mat4} out mat4 receiving operation result
 * @param {quat} q Quaternion to create matrix from
 *
 * @returns {mat4} out
 */

function mat4_fromQuat(out, q) {
  var x = q[0],
      y = q[1],
      z = q[2],
      w = q[3];
  var x2 = x + x;
  var y2 = y + y;
  var z2 = z + z;
  var xx = x * x2;
  var yx = y * x2;
  var yy = y * y2;
  var zx = z * x2;
  var zy = z * y2;
  var zz = z * z2;
  var wx = w * x2;
  var wy = w * y2;
  var wz = w * z2;
  out[0] = 1 - yy - zz;
  out[1] = yx + wz;
  out[2] = zx - wy;
  out[3] = 0;
  out[4] = yx - wz;
  out[5] = 1 - xx - zz;
  out[6] = zy + wx;
  out[7] = 0;
  out[8] = zx + wy;
  out[9] = zy - wx;
  out[10] = 1 - xx - yy;
  out[11] = 0;
  out[12] = 0;
  out[13] = 0;
  out[14] = 0;
  out[15] = 1;
  return out;
}
/**
 * Generates a frustum matrix with the given bounds
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {Number} left Left bound of the frustum
 * @param {Number} right Right bound of the frustum
 * @param {Number} bottom Bottom bound of the frustum
 * @param {Number} top Top bound of the frustum
 * @param {Number} near Near bound of the frustum
 * @param {Number} far Far bound of the frustum
 * @returns {mat4} out
 */

function frustum(out, left, right, bottom, top, near, far) {
  var rl = 1 / (right - left);
  var tb = 1 / (top - bottom);
  var nf = 1 / (near - far);
  out[0] = near * 2 * rl;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = near * 2 * tb;
  out[6] = 0;
  out[7] = 0;
  out[8] = (right + left) * rl;
  out[9] = (top + bottom) * tb;
  out[10] = (far + near) * nf;
  out[11] = -1;
  out[12] = 0;
  out[13] = 0;
  out[14] = far * near * 2 * nf;
  out[15] = 0;
  return out;
}
/**
 * Generates a perspective projection matrix with the given bounds.
 * Passing null/undefined/no value for far will generate infinite projection matrix.
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {number} fovy Vertical field of view in radians
 * @param {number} aspect Aspect ratio. typically viewport width/height
 * @param {number} near Near bound of the frustum
 * @param {number} far Far bound of the frustum, can be null or Infinity
 * @returns {mat4} out
 */

function perspective(out, fovy, aspect, near, far) {
  var f = 1.0 / Math.tan(fovy / 2),
      nf;
  out[0] = f / aspect;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = f;
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[11] = -1;
  out[12] = 0;
  out[13] = 0;
  out[15] = 0;

  if (far != null && far !== Infinity) {
    nf = 1 / (near - far);
    out[10] = (far + near) * nf;
    out[14] = 2 * far * near * nf;
  } else {
    out[10] = -1;
    out[14] = -2 * near;
  }

  return out;
}
/**
 * Generates a perspective projection matrix with the given field of view.
 * This is primarily useful for generating projection matrices to be used
 * with the still experiemental WebVR API.
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees
 * @param {number} near Near bound of the frustum
 * @param {number} far Far bound of the frustum
 * @returns {mat4} out
 */

function perspectiveFromFieldOfView(out, fov, near, far) {
  var upTan = Math.tan(fov.upDegrees * Math.PI / 180.0);
  var downTan = Math.tan(fov.downDegrees * Math.PI / 180.0);
  var leftTan = Math.tan(fov.leftDegrees * Math.PI / 180.0);
  var rightTan = Math.tan(fov.rightDegrees * Math.PI / 180.0);
  var xScale = 2.0 / (leftTan + rightTan);
  var yScale = 2.0 / (upTan + downTan);
  out[0] = xScale;
  out[1] = 0.0;
  out[2] = 0.0;
  out[3] = 0.0;
  out[4] = 0.0;
  out[5] = yScale;
  out[6] = 0.0;
  out[7] = 0.0;
  out[8] = -((leftTan - rightTan) * xScale * 0.5);
  out[9] = (upTan - downTan) * yScale * 0.5;
  out[10] = far / (near - far);
  out[11] = -1.0;
  out[12] = 0.0;
  out[13] = 0.0;
  out[14] = far * near / (near - far);
  out[15] = 0.0;
  return out;
}
/**
 * Generates a orthogonal projection matrix with the given bounds
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {number} left Left bound of the frustum
 * @param {number} right Right bound of the frustum
 * @param {number} bottom Bottom bound of the frustum
 * @param {number} top Top bound of the frustum
 * @param {number} near Near bound of the frustum
 * @param {number} far Far bound of the frustum
 * @returns {mat4} out
 */

function ortho(out, left, right, bottom, top, near, far) {
  var lr = 1 / (left - right);
  var bt = 1 / (bottom - top);
  var nf = 1 / (near - far);
  out[0] = -2 * lr;
  out[1] = 0;
  out[2] = 0;
  out[3] = 0;
  out[4] = 0;
  out[5] = -2 * bt;
  out[6] = 0;
  out[7] = 0;
  out[8] = 0;
  out[9] = 0;
  out[10] = 2 * nf;
  out[11] = 0;
  out[12] = (left + right) * lr;
  out[13] = (top + bottom) * bt;
  out[14] = (far + near) * nf;
  out[15] = 1;
  return out;
}
/**
 * Generates a look-at matrix with the given eye position, focal point, and up axis.
 * If you want a matrix that actually makes an object look at another object, you should use targetTo instead.
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {vec3} eye Position of the viewer
 * @param {vec3} center Point the viewer is looking at
 * @param {vec3} up vec3 pointing up
 * @returns {mat4} out
 */

function lookAt(out, eye, center, up) {
  var x0, x1, x2, y0, y1, y2, z0, z1, z2, len;
  var eyex = eye[0];
  var eyey = eye[1];
  var eyez = eye[2];
  var upx = up[0];
  var upy = up[1];
  var upz = up[2];
  var centerx = center[0];
  var centery = center[1];
  var centerz = center[2];

  if (Math.abs(eyex - centerx) < EPSILON && Math.abs(eyey - centery) < EPSILON && Math.abs(eyez - centerz) < EPSILON) {
    return mat4_identity(out);
  }

  z0 = eyex - centerx;
  z1 = eyey - centery;
  z2 = eyez - centerz;
  len = 1 / Math.hypot(z0, z1, z2);
  z0 *= len;
  z1 *= len;
  z2 *= len;
  x0 = upy * z2 - upz * z1;
  x1 = upz * z0 - upx * z2;
  x2 = upx * z1 - upy * z0;
  len = Math.hypot(x0, x1, x2);

  if (!len) {
    x0 = 0;
    x1 = 0;
    x2 = 0;
  } else {
    len = 1 / len;
    x0 *= len;
    x1 *= len;
    x2 *= len;
  }

  y0 = z1 * x2 - z2 * x1;
  y1 = z2 * x0 - z0 * x2;
  y2 = z0 * x1 - z1 * x0;
  len = Math.hypot(y0, y1, y2);

  if (!len) {
    y0 = 0;
    y1 = 0;
    y2 = 0;
  } else {
    len = 1 / len;
    y0 *= len;
    y1 *= len;
    y2 *= len;
  }

  out[0] = x0;
  out[1] = y0;
  out[2] = z0;
  out[3] = 0;
  out[4] = x1;
  out[5] = y1;
  out[6] = z1;
  out[7] = 0;
  out[8] = x2;
  out[9] = y2;
  out[10] = z2;
  out[11] = 0;
  out[12] = -(x0 * eyex + x1 * eyey + x2 * eyez);
  out[13] = -(y0 * eyex + y1 * eyey + y2 * eyez);
  out[14] = -(z0 * eyex + z1 * eyey + z2 * eyez);
  out[15] = 1;
  return out;
}
/**
 * Generates a matrix that makes something look at something else.
 *
 * @param {mat4} out mat4 frustum matrix will be written into
 * @param {vec3} eye Position of the viewer
 * @param {vec3} center Point the viewer is looking at
 * @param {vec3} up vec3 pointing up
 * @returns {mat4} out
 */

function targetTo(out, eye, target, up) {
  var eyex = eye[0],
      eyey = eye[1],
      eyez = eye[2],
      upx = up[0],
      upy = up[1],
      upz = up[2];
  var z0 = eyex - target[0],
      z1 = eyey - target[1],
      z2 = eyez - target[2];
  var len = z0 * z0 + z1 * z1 + z2 * z2;

  if (len > 0) {
    len = 1 / Math.sqrt(len);
    z0 *= len;
    z1 *= len;
    z2 *= len;
  }

  var x0 = upy * z2 - upz * z1,
      x1 = upz * z0 - upx * z2,
      x2 = upx * z1 - upy * z0;
  len = x0 * x0 + x1 * x1 + x2 * x2;

  if (len > 0) {
    len = 1 / Math.sqrt(len);
    x0 *= len;
    x1 *= len;
    x2 *= len;
  }

  out[0] = x0;
  out[1] = x1;
  out[2] = x2;
  out[3] = 0;
  out[4] = z1 * x2 - z2 * x1;
  out[5] = z2 * x0 - z0 * x2;
  out[6] = z0 * x1 - z1 * x0;
  out[7] = 0;
  out[8] = z0;
  out[9] = z1;
  out[10] = z2;
  out[11] = 0;
  out[12] = eyex;
  out[13] = eyey;
  out[14] = eyez;
  out[15] = 1;
  return out;
}
;
/**
 * Returns a string representation of a mat4
 *
 * @param {mat4} a matrix to represent as a string
 * @returns {String} string representation of the matrix
 */

function mat4_str(a) {
  return 'mat4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' + a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ')';
}
/**
 * Returns Frobenius norm of a mat4
 *
 * @param {mat4} a the matrix to calculate Frobenius norm of
 * @returns {Number} Frobenius norm
 */

function mat4_frob(a) {
  return Math.hypot(a[0], a[1], a[3], a[4], a[5], a[6], a[7], a[8], a[9], a[10], a[11], a[12], a[13], a[14], a[15]);
}
/**
 * Adds two mat4's
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the first operand
 * @param {mat4} b the second operand
 * @returns {mat4} out
 */

function mat4_add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  out[3] = a[3] + b[3];
  out[4] = a[4] + b[4];
  out[5] = a[5] + b[5];
  out[6] = a[6] + b[6];
  out[7] = a[7] + b[7];
  out[8] = a[8] + b[8];
  out[9] = a[9] + b[9];
  out[10] = a[10] + b[10];
  out[11] = a[11] + b[11];
  out[12] = a[12] + b[12];
  out[13] = a[13] + b[13];
  out[14] = a[14] + b[14];
  out[15] = a[15] + b[15];
  return out;
}
/**
 * Subtracts matrix b from matrix a
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the first operand
 * @param {mat4} b the second operand
 * @returns {mat4} out
 */

function mat4_subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  out[2] = a[2] - b[2];
  out[3] = a[3] - b[3];
  out[4] = a[4] - b[4];
  out[5] = a[5] - b[5];
  out[6] = a[6] - b[6];
  out[7] = a[7] - b[7];
  out[8] = a[8] - b[8];
  out[9] = a[9] - b[9];
  out[10] = a[10] - b[10];
  out[11] = a[11] - b[11];
  out[12] = a[12] - b[12];
  out[13] = a[13] - b[13];
  out[14] = a[14] - b[14];
  out[15] = a[15] - b[15];
  return out;
}
/**
 * Multiply each element of the matrix by a scalar.
 *
 * @param {mat4} out the receiving matrix
 * @param {mat4} a the matrix to scale
 * @param {Number} b amount to scale the matrix's elements by
 * @returns {mat4} out
 */

function mat4_multiplyScalar(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  out[3] = a[3] * b;
  out[4] = a[4] * b;
  out[5] = a[5] * b;
  out[6] = a[6] * b;
  out[7] = a[7] * b;
  out[8] = a[8] * b;
  out[9] = a[9] * b;
  out[10] = a[10] * b;
  out[11] = a[11] * b;
  out[12] = a[12] * b;
  out[13] = a[13] * b;
  out[14] = a[14] * b;
  out[15] = a[15] * b;
  return out;
}
/**
 * Adds two mat4's after multiplying each element of the second operand by a scalar value.
 *
 * @param {mat4} out the receiving vector
 * @param {mat4} a the first operand
 * @param {mat4} b the second operand
 * @param {Number} scale the amount to scale b's elements by before adding
 * @returns {mat4} out
 */

function mat4_multiplyScalarAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  out[2] = a[2] + b[2] * scale;
  out[3] = a[3] + b[3] * scale;
  out[4] = a[4] + b[4] * scale;
  out[5] = a[5] + b[5] * scale;
  out[6] = a[6] + b[6] * scale;
  out[7] = a[7] + b[7] * scale;
  out[8] = a[8] + b[8] * scale;
  out[9] = a[9] + b[9] * scale;
  out[10] = a[10] + b[10] * scale;
  out[11] = a[11] + b[11] * scale;
  out[12] = a[12] + b[12] * scale;
  out[13] = a[13] + b[13] * scale;
  out[14] = a[14] + b[14] * scale;
  out[15] = a[15] + b[15] * scale;
  return out;
}
/**
 * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)
 *
 * @param {mat4} a The first matrix.
 * @param {mat4} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function mat4_exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7] && a[8] === b[8] && a[9] === b[9] && a[10] === b[10] && a[11] === b[11] && a[12] === b[12] && a[13] === b[13] && a[14] === b[14] && a[15] === b[15];
}
/**
 * Returns whether or not the matrices have approximately the same elements in the same position.
 *
 * @param {mat4} a The first matrix.
 * @param {mat4} b The second matrix.
 * @returns {Boolean} True if the matrices are equal, false otherwise.
 */

function mat4_equals(a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3];
  var a4 = a[4],
      a5 = a[5],
      a6 = a[6],
      a7 = a[7];
  var a8 = a[8],
      a9 = a[9],
      a10 = a[10],
      a11 = a[11];
  var a12 = a[12],
      a13 = a[13],
      a14 = a[14],
      a15 = a[15];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3];
  var b4 = b[4],
      b5 = b[5],
      b6 = b[6],
      b7 = b[7];
  var b8 = b[8],
      b9 = b[9],
      b10 = b[10],
      b11 = b[11];
  var b12 = b[12],
      b13 = b[13],
      b14 = b[14],
      b15 = b[15];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7)) && Math.abs(a8 - b8) <= EPSILON * Math.max(1.0, Math.abs(a8), Math.abs(b8)) && Math.abs(a9 - b9) <= EPSILON * Math.max(1.0, Math.abs(a9), Math.abs(b9)) && Math.abs(a10 - b10) <= EPSILON * Math.max(1.0, Math.abs(a10), Math.abs(b10)) && Math.abs(a11 - b11) <= EPSILON * Math.max(1.0, Math.abs(a11), Math.abs(b11)) && Math.abs(a12 - b12) <= EPSILON * Math.max(1.0, Math.abs(a12), Math.abs(b12)) && Math.abs(a13 - b13) <= EPSILON * Math.max(1.0, Math.abs(a13), Math.abs(b13)) && Math.abs(a14 - b14) <= EPSILON * Math.max(1.0, Math.abs(a14), Math.abs(b14)) && Math.abs(a15 - b15) <= EPSILON * Math.max(1.0, Math.abs(a15), Math.abs(b15));
}
/**
 * Alias for {@link mat4.multiply}
 * @function
 */

var mat4_mul = mat4_multiply;
/**
 * Alias for {@link mat4.subtract}
 * @function
 */

var mat4_sub = mat4_subtract;
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/vec3.js

/**
 * 3 Dimensional Vector
 * @module vec3
 */

/**
 * Creates a new, empty vec3
 *
 * @returns {vec3} a new 3D vector
 */

function vec3_create() {
  var out = new ARRAY_TYPE(3);

  if (ARRAY_TYPE != Float32Array) {
    out[0] = 0;
    out[1] = 0;
    out[2] = 0;
  }

  return out;
}
/**
 * Creates a new vec3 initialized with values from an existing vector
 *
 * @param {vec3} a vector to clone
 * @returns {vec3} a new 3D vector
 */

function vec3_clone(a) {
  var out = new ARRAY_TYPE(3);
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  return out;
}
/**
 * Calculates the length of a vec3
 *
 * @param {vec3} a vector to calculate length of
 * @returns {Number} length of a
 */

function vec3_length(a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  return Math.hypot(x, y, z);
}
/**
 * Creates a new vec3 initialized with the given values
 *
 * @param {Number} x X component
 * @param {Number} y Y component
 * @param {Number} z Z component
 * @returns {vec3} a new 3D vector
 */

function vec3_fromValues(x, y, z) {
  var out = new ARRAY_TYPE(3);
  out[0] = x;
  out[1] = y;
  out[2] = z;
  return out;
}
/**
 * Copy the values from one vec3 to another
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the source vector
 * @returns {vec3} out
 */

function vec3_copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  return out;
}
/**
 * Set the components of a vec3 to the given values
 *
 * @param {vec3} out the receiving vector
 * @param {Number} x X component
 * @param {Number} y Y component
 * @param {Number} z Z component
 * @returns {vec3} out
 */

function vec3_set(out, x, y, z) {
  out[0] = x;
  out[1] = y;
  out[2] = z;
  return out;
}
/**
 * Adds two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {vec3} out
 */

function vec3_add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  return out;
}
/**
 * Subtracts vector b from vector a
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {vec3} out
 */

function vec3_subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  out[2] = a[2] - b[2];
  return out;
}
/**
 * Multiplies two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {vec3} out
 */

function vec3_multiply(out, a, b) {
  out[0] = a[0] * b[0];
  out[1] = a[1] * b[1];
  out[2] = a[2] * b[2];
  return out;
}
/**
 * Divides two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {vec3} out
 */

function divide(out, a, b) {
  out[0] = a[0] / b[0];
  out[1] = a[1] / b[1];
  out[2] = a[2] / b[2];
  return out;
}
/**
 * Math.ceil the components of a vec3
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a vector to ceil
 * @returns {vec3} out
 */

function ceil(out, a) {
  out[0] = Math.ceil(a[0]);
  out[1] = Math.ceil(a[1]);
  out[2] = Math.ceil(a[2]);
  return out;
}
/**
 * Math.floor the components of a vec3
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a vector to floor
 * @returns {vec3} out
 */

function floor(out, a) {
  out[0] = Math.floor(a[0]);
  out[1] = Math.floor(a[1]);
  out[2] = Math.floor(a[2]);
  return out;
}
/**
 * Returns the minimum of two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {vec3} out
 */

function min(out, a, b) {
  out[0] = Math.min(a[0], b[0]);
  out[1] = Math.min(a[1], b[1]);
  out[2] = Math.min(a[2], b[2]);
  return out;
}
/**
 * Returns the maximum of two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {vec3} out
 */

function max(out, a, b) {
  out[0] = Math.max(a[0], b[0]);
  out[1] = Math.max(a[1], b[1]);
  out[2] = Math.max(a[2], b[2]);
  return out;
}
/**
 * Math.round the components of a vec3
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a vector to round
 * @returns {vec3} out
 */

function round(out, a) {
  out[0] = Math.round(a[0]);
  out[1] = Math.round(a[1]);
  out[2] = Math.round(a[2]);
  return out;
}
/**
 * Scales a vec3 by a scalar number
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the vector to scale
 * @param {Number} b amount to scale the vector by
 * @returns {vec3} out
 */

function vec3_scale(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  return out;
}
/**
 * Adds two vec3's after scaling the second operand by a scalar value
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @param {Number} scale the amount to scale b by before adding
 * @returns {vec3} out
 */

function scaleAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  out[2] = a[2] + b[2] * scale;
  return out;
}
/**
 * Calculates the euclidian distance between two vec3's
 *
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {Number} distance between a and b
 */

function distance(a, b) {
  var x = b[0] - a[0];
  var y = b[1] - a[1];
  var z = b[2] - a[2];
  return Math.hypot(x, y, z);
}
/**
 * Calculates the squared euclidian distance between two vec3's
 *
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {Number} squared distance between a and b
 */

function squaredDistance(a, b) {
  var x = b[0] - a[0];
  var y = b[1] - a[1];
  var z = b[2] - a[2];
  return x * x + y * y + z * z;
}
/**
 * Calculates the squared length of a vec3
 *
 * @param {vec3} a vector to calculate squared length of
 * @returns {Number} squared length of a
 */

function squaredLength(a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  return x * x + y * y + z * z;
}
/**
 * Negates the components of a vec3
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a vector to negate
 * @returns {vec3} out
 */

function negate(out, a) {
  out[0] = -a[0];
  out[1] = -a[1];
  out[2] = -a[2];
  return out;
}
/**
 * Returns the inverse of the components of a vec3
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a vector to invert
 * @returns {vec3} out
 */

function inverse(out, a) {
  out[0] = 1.0 / a[0];
  out[1] = 1.0 / a[1];
  out[2] = 1.0 / a[2];
  return out;
}
/**
 * Normalize a vec3
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a vector to normalize
 * @returns {vec3} out
 */

function normalize(out, a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  var len = x * x + y * y + z * z;

  if (len > 0) {
    //TODO: evaluate use of glm_invsqrt here?
    len = 1 / Math.sqrt(len);
  }

  out[0] = a[0] * len;
  out[1] = a[1] * len;
  out[2] = a[2] * len;
  return out;
}
/**
 * Calculates the dot product of two vec3's
 *
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {Number} dot product of a and b
 */

function vec3_dot(a, b) {
  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];
}
/**
 * Computes the cross product of two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @returns {vec3} out
 */

function cross(out, a, b) {
  var ax = a[0],
      ay = a[1],
      az = a[2];
  var bx = b[0],
      by = b[1],
      bz = b[2];
  out[0] = ay * bz - az * by;
  out[1] = az * bx - ax * bz;
  out[2] = ax * by - ay * bx;
  return out;
}
/**
 * Performs a linear interpolation between two vec3's
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {vec3} out
 */

function lerp(out, a, b, t) {
  var ax = a[0];
  var ay = a[1];
  var az = a[2];
  out[0] = ax + t * (b[0] - ax);
  out[1] = ay + t * (b[1] - ay);
  out[2] = az + t * (b[2] - az);
  return out;
}
/**
 * Performs a hermite interpolation with two control points
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @param {vec3} c the third operand
 * @param {vec3} d the fourth operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {vec3} out
 */

function hermite(out, a, b, c, d, t) {
  var factorTimes2 = t * t;
  var factor1 = factorTimes2 * (2 * t - 3) + 1;
  var factor2 = factorTimes2 * (t - 2) + t;
  var factor3 = factorTimes2 * (t - 1);
  var factor4 = factorTimes2 * (3 - 2 * t);
  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;
  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;
  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;
  return out;
}
/**
 * Performs a bezier interpolation with two control points
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the first operand
 * @param {vec3} b the second operand
 * @param {vec3} c the third operand
 * @param {vec3} d the fourth operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {vec3} out
 */

function bezier(out, a, b, c, d, t) {
  var inverseFactor = 1 - t;
  var inverseFactorTimesTwo = inverseFactor * inverseFactor;
  var factorTimes2 = t * t;
  var factor1 = inverseFactorTimesTwo * inverseFactor;
  var factor2 = 3 * t * inverseFactorTimesTwo;
  var factor3 = 3 * factorTimes2 * inverseFactor;
  var factor4 = factorTimes2 * t;
  out[0] = a[0] * factor1 + b[0] * factor2 + c[0] * factor3 + d[0] * factor4;
  out[1] = a[1] * factor1 + b[1] * factor2 + c[1] * factor3 + d[1] * factor4;
  out[2] = a[2] * factor1 + b[2] * factor2 + c[2] * factor3 + d[2] * factor4;
  return out;
}
/**
 * Generates a random vector with the given scale
 *
 * @param {vec3} out the receiving vector
 * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned
 * @returns {vec3} out
 */

function random(out, scale) {
  scale = scale || 1.0;
  var r = RANDOM() * 2.0 * Math.PI;
  var z = RANDOM() * 2.0 - 1.0;
  var zScale = Math.sqrt(1.0 - z * z) * scale;
  out[0] = Math.cos(r) * zScale;
  out[1] = Math.sin(r) * zScale;
  out[2] = z * scale;
  return out;
}
/**
 * Transforms the vec3 with a mat4.
 * 4th vector component is implicitly '1'
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the vector to transform
 * @param {mat4} m matrix to transform with
 * @returns {vec3} out
 */

function transformMat4(out, a, m) {
  var x = a[0],
      y = a[1],
      z = a[2];
  var w = m[3] * x + m[7] * y + m[11] * z + m[15];
  w = w || 1.0;
  out[0] = (m[0] * x + m[4] * y + m[8] * z + m[12]) / w;
  out[1] = (m[1] * x + m[5] * y + m[9] * z + m[13]) / w;
  out[2] = (m[2] * x + m[6] * y + m[10] * z + m[14]) / w;
  return out;
}
/**
 * Transforms the vec3 with a mat3.
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the vector to transform
 * @param {mat3} m the 3x3 matrix to transform with
 * @returns {vec3} out
 */

function transformMat3(out, a, m) {
  var x = a[0],
      y = a[1],
      z = a[2];
  out[0] = x * m[0] + y * m[3] + z * m[6];
  out[1] = x * m[1] + y * m[4] + z * m[7];
  out[2] = x * m[2] + y * m[5] + z * m[8];
  return out;
}
/**
 * Transforms the vec3 with a quat
 * Can also be used for dual quaternions. (Multiply it with the real part)
 *
 * @param {vec3} out the receiving vector
 * @param {vec3} a the vector to transform
 * @param {quat} q quaternion to transform with
 * @returns {vec3} out
 */

function transformQuat(out, a, q) {
  // benchmarks: https://jsperf.com/quaternion-transform-vec3-implementations-fixed
  var qx = q[0],
      qy = q[1],
      qz = q[2],
      qw = q[3];
  var x = a[0],
      y = a[1],
      z = a[2]; // var qvec = [qx, qy, qz];
  // var uv = vec3.cross([], qvec, a);

  var uvx = qy * z - qz * y,
      uvy = qz * x - qx * z,
      uvz = qx * y - qy * x; // var uuv = vec3.cross([], qvec, uv);

  var uuvx = qy * uvz - qz * uvy,
      uuvy = qz * uvx - qx * uvz,
      uuvz = qx * uvy - qy * uvx; // vec3.scale(uv, uv, 2 * w);

  var w2 = qw * 2;
  uvx *= w2;
  uvy *= w2;
  uvz *= w2; // vec3.scale(uuv, uuv, 2);

  uuvx *= 2;
  uuvy *= 2;
  uuvz *= 2; // return vec3.add(out, a, vec3.add(out, uv, uuv));

  out[0] = x + uvx + uuvx;
  out[1] = y + uvy + uuvy;
  out[2] = z + uvz + uuvz;
  return out;
}
/**
 * Rotate a 3D vector around the x-axis
 * @param {vec3} out The receiving vec3
 * @param {vec3} a The vec3 point to rotate
 * @param {vec3} b The origin of the rotation
 * @param {Number} c The angle of rotation
 * @returns {vec3} out
 */

function vec3_rotateX(out, a, b, c) {
  var p = [],
      r = []; //Translate point to the origin

  p[0] = a[0] - b[0];
  p[1] = a[1] - b[1];
  p[2] = a[2] - b[2]; //perform rotation

  r[0] = p[0];
  r[1] = p[1] * Math.cos(c) - p[2] * Math.sin(c);
  r[2] = p[1] * Math.sin(c) + p[2] * Math.cos(c); //translate to correct position

  out[0] = r[0] + b[0];
  out[1] = r[1] + b[1];
  out[2] = r[2] + b[2];
  return out;
}
/**
 * Rotate a 3D vector around the y-axis
 * @param {vec3} out The receiving vec3
 * @param {vec3} a The vec3 point to rotate
 * @param {vec3} b The origin of the rotation
 * @param {Number} c The angle of rotation
 * @returns {vec3} out
 */

function vec3_rotateY(out, a, b, c) {
  var p = [],
      r = []; //Translate point to the origin

  p[0] = a[0] - b[0];
  p[1] = a[1] - b[1];
  p[2] = a[2] - b[2]; //perform rotation

  r[0] = p[2] * Math.sin(c) + p[0] * Math.cos(c);
  r[1] = p[1];
  r[2] = p[2] * Math.cos(c) - p[0] * Math.sin(c); //translate to correct position

  out[0] = r[0] + b[0];
  out[1] = r[1] + b[1];
  out[2] = r[2] + b[2];
  return out;
}
/**
 * Rotate a 3D vector around the z-axis
 * @param {vec3} out The receiving vec3
 * @param {vec3} a The vec3 point to rotate
 * @param {vec3} b The origin of the rotation
 * @param {Number} c The angle of rotation
 * @returns {vec3} out
 */

function vec3_rotateZ(out, a, b, c) {
  var p = [],
      r = []; //Translate point to the origin

  p[0] = a[0] - b[0];
  p[1] = a[1] - b[1];
  p[2] = a[2] - b[2]; //perform rotation

  r[0] = p[0] * Math.cos(c) - p[1] * Math.sin(c);
  r[1] = p[0] * Math.sin(c) + p[1] * Math.cos(c);
  r[2] = p[2]; //translate to correct position

  out[0] = r[0] + b[0];
  out[1] = r[1] + b[1];
  out[2] = r[2] + b[2];
  return out;
}
/**
 * Get the angle between two 3D vectors
 * @param {vec3} a The first operand
 * @param {vec3} b The second operand
 * @returns {Number} The angle in radians
 */

function angle(a, b) {
  var tempA = vec3_fromValues(a[0], a[1], a[2]);
  var tempB = vec3_fromValues(b[0], b[1], b[2]);
  normalize(tempA, tempA);
  normalize(tempB, tempB);
  var cosine = vec3_dot(tempA, tempB);

  if (cosine > 1.0) {
    return 0;
  } else if (cosine < -1.0) {
    return Math.PI;
  } else {
    return Math.acos(cosine);
  }
}
/**
 * Set the components of a vec3 to zero
 *
 * @param {vec3} out the receiving vector
 * @returns {vec3} out
 */

function zero(out) {
  out[0] = 0.0;
  out[1] = 0.0;
  out[2] = 0.0;
  return out;
}
/**
 * Returns a string representation of a vector
 *
 * @param {vec3} a vector to represent as a string
 * @returns {String} string representation of the vector
 */

function vec3_str(a) {
  return 'vec3(' + a[0] + ', ' + a[1] + ', ' + a[2] + ')';
}
/**
 * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)
 *
 * @param {vec3} a The first vector.
 * @param {vec3} b The second vector.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

function vec3_exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2];
}
/**
 * Returns whether or not the vectors have approximately the same elements in the same position.
 *
 * @param {vec3} a The first vector.
 * @param {vec3} b The second vector.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

function vec3_equals(a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2));
}
/**
 * Alias for {@link vec3.subtract}
 * @function
 */

var vec3_sub = vec3_subtract;
/**
 * Alias for {@link vec3.multiply}
 * @function
 */

var vec3_mul = vec3_multiply;
/**
 * Alias for {@link vec3.divide}
 * @function
 */

var div = divide;
/**
 * Alias for {@link vec3.distance}
 * @function
 */

var dist = distance;
/**
 * Alias for {@link vec3.squaredDistance}
 * @function
 */

var sqrDist = squaredDistance;
/**
 * Alias for {@link vec3.length}
 * @function
 */

var len = vec3_length;
/**
 * Alias for {@link vec3.squaredLength}
 * @function
 */

var sqrLen = squaredLength;
/**
 * Perform some operation over an array of vec3s.
 *
 * @param {Array} a the array of vectors to iterate over
 * @param {Number} stride Number of elements between the start of each vec3. If 0 assumes tightly packed
 * @param {Number} offset Number of elements to skip at the beginning of the array
 * @param {Number} count Number of vec3s to iterate over. If 0 iterates over entire array
 * @param {Function} fn Function to call for each vector in the array
 * @param {Object} [arg] additional argument to pass to fn
 * @returns {Array} a
 * @function
 */

var forEach = function () {
  var vec = vec3_create();
  return function (a, stride, offset, count, fn, arg) {
    var i, l;

    if (!stride) {
      stride = 3;
    }

    if (!offset) {
      offset = 0;
    }

    if (count) {
      l = Math.min(count * stride + offset, a.length);
    } else {
      l = a.length;
    }

    for (i = offset; i < l; i += stride) {
      vec[0] = a[i];
      vec[1] = a[i + 1];
      vec[2] = a[i + 2];
      fn(vec, vec, arg);
      a[i] = vec[0];
      a[i + 1] = vec[1];
      a[i + 2] = vec[2];
    }

    return a;
  };
}();
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/vec4.js

/**
 * 4 Dimensional Vector
 * @module vec4
 */

/**
 * Creates a new, empty vec4
 *
 * @returns {vec4} a new 4D vector
 */

function vec4_create() {
  var out = new ARRAY_TYPE(4);

  if (ARRAY_TYPE != Float32Array) {
    out[0] = 0;
    out[1] = 0;
    out[2] = 0;
    out[3] = 0;
  }

  return out;
}
/**
 * Creates a new vec4 initialized with values from an existing vector
 *
 * @param {vec4} a vector to clone
 * @returns {vec4} a new 4D vector
 */

function vec4_clone(a) {
  var out = new ARRAY_TYPE(4);
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  return out;
}
/**
 * Creates a new vec4 initialized with the given values
 *
 * @param {Number} x X component
 * @param {Number} y Y component
 * @param {Number} z Z component
 * @param {Number} w W component
 * @returns {vec4} a new 4D vector
 */

function vec4_fromValues(x, y, z, w) {
  var out = new ARRAY_TYPE(4);
  out[0] = x;
  out[1] = y;
  out[2] = z;
  out[3] = w;
  return out;
}
/**
 * Copy the values from one vec4 to another
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the source vector
 * @returns {vec4} out
 */

function vec4_copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  return out;
}
/**
 * Set the components of a vec4 to the given values
 *
 * @param {vec4} out the receiving vector
 * @param {Number} x X component
 * @param {Number} y Y component
 * @param {Number} z Z component
 * @param {Number} w W component
 * @returns {vec4} out
 */

function vec4_set(out, x, y, z, w) {
  out[0] = x;
  out[1] = y;
  out[2] = z;
  out[3] = w;
  return out;
}
/**
 * Adds two vec4's
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {vec4} out
 */

function vec4_add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  out[3] = a[3] + b[3];
  return out;
}
/**
 * Subtracts vector b from vector a
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {vec4} out
 */

function vec4_subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  out[2] = a[2] - b[2];
  out[3] = a[3] - b[3];
  return out;
}
/**
 * Multiplies two vec4's
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {vec4} out
 */

function vec4_multiply(out, a, b) {
  out[0] = a[0] * b[0];
  out[1] = a[1] * b[1];
  out[2] = a[2] * b[2];
  out[3] = a[3] * b[3];
  return out;
}
/**
 * Divides two vec4's
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {vec4} out
 */

function vec4_divide(out, a, b) {
  out[0] = a[0] / b[0];
  out[1] = a[1] / b[1];
  out[2] = a[2] / b[2];
  out[3] = a[3] / b[3];
  return out;
}
/**
 * Math.ceil the components of a vec4
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a vector to ceil
 * @returns {vec4} out
 */

function vec4_ceil(out, a) {
  out[0] = Math.ceil(a[0]);
  out[1] = Math.ceil(a[1]);
  out[2] = Math.ceil(a[2]);
  out[3] = Math.ceil(a[3]);
  return out;
}
/**
 * Math.floor the components of a vec4
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a vector to floor
 * @returns {vec4} out
 */

function vec4_floor(out, a) {
  out[0] = Math.floor(a[0]);
  out[1] = Math.floor(a[1]);
  out[2] = Math.floor(a[2]);
  out[3] = Math.floor(a[3]);
  return out;
}
/**
 * Returns the minimum of two vec4's
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {vec4} out
 */

function vec4_min(out, a, b) {
  out[0] = Math.min(a[0], b[0]);
  out[1] = Math.min(a[1], b[1]);
  out[2] = Math.min(a[2], b[2]);
  out[3] = Math.min(a[3], b[3]);
  return out;
}
/**
 * Returns the maximum of two vec4's
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {vec4} out
 */

function vec4_max(out, a, b) {
  out[0] = Math.max(a[0], b[0]);
  out[1] = Math.max(a[1], b[1]);
  out[2] = Math.max(a[2], b[2]);
  out[3] = Math.max(a[3], b[3]);
  return out;
}
/**
 * Math.round the components of a vec4
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a vector to round
 * @returns {vec4} out
 */

function vec4_round(out, a) {
  out[0] = Math.round(a[0]);
  out[1] = Math.round(a[1]);
  out[2] = Math.round(a[2]);
  out[3] = Math.round(a[3]);
  return out;
}
/**
 * Scales a vec4 by a scalar number
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the vector to scale
 * @param {Number} b amount to scale the vector by
 * @returns {vec4} out
 */

function vec4_scale(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  out[3] = a[3] * b;
  return out;
}
/**
 * Adds two vec4's after scaling the second operand by a scalar value
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @param {Number} scale the amount to scale b by before adding
 * @returns {vec4} out
 */

function vec4_scaleAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  out[2] = a[2] + b[2] * scale;
  out[3] = a[3] + b[3] * scale;
  return out;
}
/**
 * Calculates the euclidian distance between two vec4's
 *
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {Number} distance between a and b
 */

function vec4_distance(a, b) {
  var x = b[0] - a[0];
  var y = b[1] - a[1];
  var z = b[2] - a[2];
  var w = b[3] - a[3];
  return Math.hypot(x, y, z, w);
}
/**
 * Calculates the squared euclidian distance between two vec4's
 *
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {Number} squared distance between a and b
 */

function vec4_squaredDistance(a, b) {
  var x = b[0] - a[0];
  var y = b[1] - a[1];
  var z = b[2] - a[2];
  var w = b[3] - a[3];
  return x * x + y * y + z * z + w * w;
}
/**
 * Calculates the length of a vec4
 *
 * @param {vec4} a vector to calculate length of
 * @returns {Number} length of a
 */

function vec4_length(a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  var w = a[3];
  return Math.hypot(x, y, z, w);
}
/**
 * Calculates the squared length of a vec4
 *
 * @param {vec4} a vector to calculate squared length of
 * @returns {Number} squared length of a
 */

function vec4_squaredLength(a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  var w = a[3];
  return x * x + y * y + z * z + w * w;
}
/**
 * Negates the components of a vec4
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a vector to negate
 * @returns {vec4} out
 */

function vec4_negate(out, a) {
  out[0] = -a[0];
  out[1] = -a[1];
  out[2] = -a[2];
  out[3] = -a[3];
  return out;
}
/**
 * Returns the inverse of the components of a vec4
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a vector to invert
 * @returns {vec4} out
 */

function vec4_inverse(out, a) {
  out[0] = 1.0 / a[0];
  out[1] = 1.0 / a[1];
  out[2] = 1.0 / a[2];
  out[3] = 1.0 / a[3];
  return out;
}
/**
 * Normalize a vec4
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a vector to normalize
 * @returns {vec4} out
 */

function vec4_normalize(out, a) {
  var x = a[0];
  var y = a[1];
  var z = a[2];
  var w = a[3];
  var len = x * x + y * y + z * z + w * w;

  if (len > 0) {
    len = 1 / Math.sqrt(len);
  }

  out[0] = x * len;
  out[1] = y * len;
  out[2] = z * len;
  out[3] = w * len;
  return out;
}
/**
 * Calculates the dot product of two vec4's
 *
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @returns {Number} dot product of a and b
 */

function dot(a, b) {
  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];
}
/**
 * Returns the cross-product of three vectors in a 4-dimensional space
 *
 * @param {vec4} result the receiving vector
 * @param {vec4} U the first vector
 * @param {vec4} V the second vector
 * @param {vec4} W the third vector
 * @returns {vec4} result
 */

function vec4_cross(out, u, v, w) {
  var A = v[0] * w[1] - v[1] * w[0],
      B = v[0] * w[2] - v[2] * w[0],
      C = v[0] * w[3] - v[3] * w[0],
      D = v[1] * w[2] - v[2] * w[1],
      E = v[1] * w[3] - v[3] * w[1],
      F = v[2] * w[3] - v[3] * w[2];
  var G = u[0];
  var H = u[1];
  var I = u[2];
  var J = u[3];
  out[0] = H * F - I * E + J * D;
  out[1] = -(G * F) + I * C - J * B;
  out[2] = G * E - H * C + J * A;
  out[3] = -(G * D) + H * B - I * A;
  return out;
}
;
/**
 * Performs a linear interpolation between two vec4's
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the first operand
 * @param {vec4} b the second operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {vec4} out
 */

function vec4_lerp(out, a, b, t) {
  var ax = a[0];
  var ay = a[1];
  var az = a[2];
  var aw = a[3];
  out[0] = ax + t * (b[0] - ax);
  out[1] = ay + t * (b[1] - ay);
  out[2] = az + t * (b[2] - az);
  out[3] = aw + t * (b[3] - aw);
  return out;
}
/**
 * Generates a random vector with the given scale
 *
 * @param {vec4} out the receiving vector
 * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned
 * @returns {vec4} out
 */

function vec4_random(out, scale) {
  scale = scale || 1.0; // Marsaglia, George. Choosing a Point from the Surface of a
  // Sphere. Ann. Math. Statist. 43 (1972), no. 2, 645--646.
  // http://projecteuclid.org/euclid.aoms/1177692644;

  var v1, v2, v3, v4;
  var s1, s2;

  do {
    v1 = RANDOM() * 2 - 1;
    v2 = RANDOM() * 2 - 1;
    s1 = v1 * v1 + v2 * v2;
  } while (s1 >= 1);

  do {
    v3 = RANDOM() * 2 - 1;
    v4 = RANDOM() * 2 - 1;
    s2 = v3 * v3 + v4 * v4;
  } while (s2 >= 1);

  var d = Math.sqrt((1 - s1) / s2);
  out[0] = scale * v1;
  out[1] = scale * v2;
  out[2] = scale * v3 * d;
  out[3] = scale * v4 * d;
  return out;
}
/**
 * Transforms the vec4 with a mat4.
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the vector to transform
 * @param {mat4} m matrix to transform with
 * @returns {vec4} out
 */

function vec4_transformMat4(out, a, m) {
  var x = a[0],
      y = a[1],
      z = a[2],
      w = a[3];
  out[0] = m[0] * x + m[4] * y + m[8] * z + m[12] * w;
  out[1] = m[1] * x + m[5] * y + m[9] * z + m[13] * w;
  out[2] = m[2] * x + m[6] * y + m[10] * z + m[14] * w;
  out[3] = m[3] * x + m[7] * y + m[11] * z + m[15] * w;
  return out;
}
/**
 * Transforms the vec4 with a quat
 *
 * @param {vec4} out the receiving vector
 * @param {vec4} a the vector to transform
 * @param {quat} q quaternion to transform with
 * @returns {vec4} out
 */

function vec4_transformQuat(out, a, q) {
  var x = a[0],
      y = a[1],
      z = a[2];
  var qx = q[0],
      qy = q[1],
      qz = q[2],
      qw = q[3]; // calculate quat * vec

  var ix = qw * x + qy * z - qz * y;
  var iy = qw * y + qz * x - qx * z;
  var iz = qw * z + qx * y - qy * x;
  var iw = -qx * x - qy * y - qz * z; // calculate result * inverse quat

  out[0] = ix * qw + iw * -qx + iy * -qz - iz * -qy;
  out[1] = iy * qw + iw * -qy + iz * -qx - ix * -qz;
  out[2] = iz * qw + iw * -qz + ix * -qy - iy * -qx;
  out[3] = a[3];
  return out;
}
/**
 * Set the components of a vec4 to zero
 *
 * @param {vec4} out the receiving vector
 * @returns {vec4} out
 */

function vec4_zero(out) {
  out[0] = 0.0;
  out[1] = 0.0;
  out[2] = 0.0;
  out[3] = 0.0;
  return out;
}
/**
 * Returns a string representation of a vector
 *
 * @param {vec4} a vector to represent as a string
 * @returns {String} string representation of the vector
 */

function vec4_str(a) {
  return 'vec4(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';
}
/**
 * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)
 *
 * @param {vec4} a The first vector.
 * @param {vec4} b The second vector.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

function vec4_exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3];
}
/**
 * Returns whether or not the vectors have approximately the same elements in the same position.
 *
 * @param {vec4} a The first vector.
 * @param {vec4} b The second vector.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

function vec4_equals(a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3));
}
/**
 * Alias for {@link vec4.subtract}
 * @function
 */

var vec4_sub = vec4_subtract;
/**
 * Alias for {@link vec4.multiply}
 * @function
 */

var vec4_mul = vec4_multiply;
/**
 * Alias for {@link vec4.divide}
 * @function
 */

var vec4_div = vec4_divide;
/**
 * Alias for {@link vec4.distance}
 * @function
 */

var vec4_dist = vec4_distance;
/**
 * Alias for {@link vec4.squaredDistance}
 * @function
 */

var vec4_sqrDist = vec4_squaredDistance;
/**
 * Alias for {@link vec4.length}
 * @function
 */

var vec4_len = vec4_length;
/**
 * Alias for {@link vec4.squaredLength}
 * @function
 */

var vec4_sqrLen = vec4_squaredLength;
/**
 * Perform some operation over an array of vec4s.
 *
 * @param {Array} a the array of vectors to iterate over
 * @param {Number} stride Number of elements between the start of each vec4. If 0 assumes tightly packed
 * @param {Number} offset Number of elements to skip at the beginning of the array
 * @param {Number} count Number of vec4s to iterate over. If 0 iterates over entire array
 * @param {Function} fn Function to call for each vector in the array
 * @param {Object} [arg] additional argument to pass to fn
 * @returns {Array} a
 * @function
 */

var vec4_forEach = function () {
  var vec = vec4_create();
  return function (a, stride, offset, count, fn, arg) {
    var i, l;

    if (!stride) {
      stride = 4;
    }

    if (!offset) {
      offset = 0;
    }

    if (count) {
      l = Math.min(count * stride + offset, a.length);
    } else {
      l = a.length;
    }

    for (i = offset; i < l; i += stride) {
      vec[0] = a[i];
      vec[1] = a[i + 1];
      vec[2] = a[i + 2];
      vec[3] = a[i + 3];
      fn(vec, vec, arg);
      a[i] = vec[0];
      a[i + 1] = vec[1];
      a[i + 2] = vec[2];
      a[i + 3] = vec[3];
    }

    return a;
  };
}();
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/quat.js




/**
 * Quaternion
 * @module quat
 */

/**
 * Creates a new identity quat
 *
 * @returns {quat} a new quaternion
 */

function quat_create() {
  var out = new ARRAY_TYPE(4);

  if (ARRAY_TYPE != Float32Array) {
    out[0] = 0;
    out[1] = 0;
    out[2] = 0;
  }

  out[3] = 1;
  return out;
}
/**
 * Set a quat to the identity quaternion
 *
 * @param {quat} out the receiving quaternion
 * @returns {quat} out
 */

function quat_identity(out) {
  out[0] = 0;
  out[1] = 0;
  out[2] = 0;
  out[3] = 1;
  return out;
}
/**
 * Sets a quat from the given angle and rotation axis,
 * then returns it.
 *
 * @param {quat} out the receiving quaternion
 * @param {vec3} axis the axis around which to rotate
 * @param {Number} rad the angle in radians
 * @returns {quat} out
 **/

function setAxisAngle(out, axis, rad) {
  rad = rad * 0.5;
  var s = Math.sin(rad);
  out[0] = s * axis[0];
  out[1] = s * axis[1];
  out[2] = s * axis[2];
  out[3] = Math.cos(rad);
  return out;
}
/**
 * Gets the rotation axis and angle for a given
 *  quaternion. If a quaternion is created with
 *  setAxisAngle, this method will return the same
 *  values as providied in the original parameter list
 *  OR functionally equivalent values.
 * Example: The quaternion formed by axis [0, 0, 1] and
 *  angle -90 is the same as the quaternion formed by
 *  [0, 0, 1] and 270. This method favors the latter.
 * @param  {vec3} out_axis  Vector receiving the axis of rotation
 * @param  {quat} q     Quaternion to be decomposed
 * @return {Number}     Angle, in radians, of the rotation
 */

function getAxisAngle(out_axis, q) {
  var rad = Math.acos(q[3]) * 2.0;
  var s = Math.sin(rad / 2.0);

  if (s > EPSILON) {
    out_axis[0] = q[0] / s;
    out_axis[1] = q[1] / s;
    out_axis[2] = q[2] / s;
  } else {
    // If s is zero, return any axis (no rotation - axis does not matter)
    out_axis[0] = 1;
    out_axis[1] = 0;
    out_axis[2] = 0;
  }

  return rad;
}
/**
 * Gets the angular distance between two unit quaternions
 *
 * @param  {quat} a     Origin unit quaternion 
 * @param  {quat} b     Destination unit quaternion
 * @return {Number}     Angle, in radians, between the two quaternions
 */

function getAngle(a, b) {
  var dotproduct = quat_dot(a, b);
  return Math.acos(2 * dotproduct * dotproduct - 1);
}
/**
 * Multiplies two quat's
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a the first operand
 * @param {quat} b the second operand
 * @returns {quat} out
 */

function quat_multiply(out, a, b) {
  var ax = a[0],
      ay = a[1],
      az = a[2],
      aw = a[3];
  var bx = b[0],
      by = b[1],
      bz = b[2],
      bw = b[3];
  out[0] = ax * bw + aw * bx + ay * bz - az * by;
  out[1] = ay * bw + aw * by + az * bx - ax * bz;
  out[2] = az * bw + aw * bz + ax * by - ay * bx;
  out[3] = aw * bw - ax * bx - ay * by - az * bz;
  return out;
}
/**
 * Rotates a quaternion by the given angle about the X axis
 *
 * @param {quat} out quat receiving operation result
 * @param {quat} a quat to rotate
 * @param {number} rad angle (in radians) to rotate
 * @returns {quat} out
 */

function quat_rotateX(out, a, rad) {
  rad *= 0.5;
  var ax = a[0],
      ay = a[1],
      az = a[2],
      aw = a[3];
  var bx = Math.sin(rad),
      bw = Math.cos(rad);
  out[0] = ax * bw + aw * bx;
  out[1] = ay * bw + az * bx;
  out[2] = az * bw - ay * bx;
  out[3] = aw * bw - ax * bx;
  return out;
}
/**
 * Rotates a quaternion by the given angle about the Y axis
 *
 * @param {quat} out quat receiving operation result
 * @param {quat} a quat to rotate
 * @param {number} rad angle (in radians) to rotate
 * @returns {quat} out
 */

function quat_rotateY(out, a, rad) {
  rad *= 0.5;
  var ax = a[0],
      ay = a[1],
      az = a[2],
      aw = a[3];
  var by = Math.sin(rad),
      bw = Math.cos(rad);
  out[0] = ax * bw - az * by;
  out[1] = ay * bw + aw * by;
  out[2] = az * bw + ax * by;
  out[3] = aw * bw - ay * by;
  return out;
}
/**
 * Rotates a quaternion by the given angle about the Z axis
 *
 * @param {quat} out quat receiving operation result
 * @param {quat} a quat to rotate
 * @param {number} rad angle (in radians) to rotate
 * @returns {quat} out
 */

function quat_rotateZ(out, a, rad) {
  rad *= 0.5;
  var ax = a[0],
      ay = a[1],
      az = a[2],
      aw = a[3];
  var bz = Math.sin(rad),
      bw = Math.cos(rad);
  out[0] = ax * bw + ay * bz;
  out[1] = ay * bw - ax * bz;
  out[2] = az * bw + aw * bz;
  out[3] = aw * bw - az * bz;
  return out;
}
/**
 * Calculates the W component of a quat from the X, Y, and Z components.
 * Assumes that quaternion is 1 unit in length.
 * Any existing W component will be ignored.
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a quat to calculate W component of
 * @returns {quat} out
 */

function calculateW(out, a) {
  var x = a[0],
      y = a[1],
      z = a[2];
  out[0] = x;
  out[1] = y;
  out[2] = z;
  out[3] = Math.sqrt(Math.abs(1.0 - x * x - y * y - z * z));
  return out;
}
/**
 * Calculate the exponential of a unit quaternion.
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a quat to calculate the exponential of
 * @returns {quat} out
 */

function exp(out, a) {
  var x = a[0],
      y = a[1],
      z = a[2],
      w = a[3];
  var r = Math.sqrt(x * x + y * y + z * z);
  var et = Math.exp(w);
  var s = r > 0 ? et * Math.sin(r) / r : 0;
  out[0] = x * s;
  out[1] = y * s;
  out[2] = z * s;
  out[3] = et * Math.cos(r);
  return out;
}
/**
 * Calculate the natural logarithm of a unit quaternion.
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a quat to calculate the exponential of
 * @returns {quat} out
 */

function ln(out, a) {
  var x = a[0],
      y = a[1],
      z = a[2],
      w = a[3];
  var r = Math.sqrt(x * x + y * y + z * z);
  var t = r > 0 ? Math.atan2(r, w) / r : 0;
  out[0] = x * t;
  out[1] = y * t;
  out[2] = z * t;
  out[3] = 0.5 * Math.log(x * x + y * y + z * z + w * w);
  return out;
}
/**
 * Calculate the scalar power of a unit quaternion.
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a quat to calculate the exponential of
 * @param {Number} b amount to scale the quaternion by
 * @returns {quat} out
 */

function pow(out, a, b) {
  ln(out, a);
  quat_scale(out, out, b);
  exp(out, out);
  return out;
}
/**
 * Performs a spherical linear interpolation between two quat
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a the first operand
 * @param {quat} b the second operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {quat} out
 */

function slerp(out, a, b, t) {
  // benchmarks:
  //    http://jsperf.com/quaternion-slerp-implementations
  var ax = a[0],
      ay = a[1],
      az = a[2],
      aw = a[3];
  var bx = b[0],
      by = b[1],
      bz = b[2],
      bw = b[3];
  var omega, cosom, sinom, scale0, scale1; // calc cosine

  cosom = ax * bx + ay * by + az * bz + aw * bw; // adjust signs (if necessary)

  if (cosom < 0.0) {
    cosom = -cosom;
    bx = -bx;
    by = -by;
    bz = -bz;
    bw = -bw;
  } // calculate coefficients


  if (1.0 - cosom > EPSILON) {
    // standard case (slerp)
    omega = Math.acos(cosom);
    sinom = Math.sin(omega);
    scale0 = Math.sin((1.0 - t) * omega) / sinom;
    scale1 = Math.sin(t * omega) / sinom;
  } else {
    // "from" and "to" quaternions are very close
    //  ... so we can do a linear interpolation
    scale0 = 1.0 - t;
    scale1 = t;
  } // calculate final values


  out[0] = scale0 * ax + scale1 * bx;
  out[1] = scale0 * ay + scale1 * by;
  out[2] = scale0 * az + scale1 * bz;
  out[3] = scale0 * aw + scale1 * bw;
  return out;
}
/**
 * Generates a random unit quaternion
 * 
 * @param {quat} out the receiving quaternion
 * @returns {quat} out
 */

function quat_random(out) {
  // Implementation of http://planning.cs.uiuc.edu/node198.html
  // TODO: Calling random 3 times is probably not the fastest solution
  var u1 = RANDOM();
  var u2 = RANDOM();
  var u3 = RANDOM();
  var sqrt1MinusU1 = Math.sqrt(1 - u1);
  var sqrtU1 = Math.sqrt(u1);
  out[0] = sqrt1MinusU1 * Math.sin(2.0 * Math.PI * u2);
  out[1] = sqrt1MinusU1 * Math.cos(2.0 * Math.PI * u2);
  out[2] = sqrtU1 * Math.sin(2.0 * Math.PI * u3);
  out[3] = sqrtU1 * Math.cos(2.0 * Math.PI * u3);
  return out;
}
/**
 * Calculates the inverse of a quat
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a quat to calculate inverse of
 * @returns {quat} out
 */

function quat_invert(out, a) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3];
  var dot = a0 * a0 + a1 * a1 + a2 * a2 + a3 * a3;
  var invDot = dot ? 1.0 / dot : 0; // TODO: Would be faster to return [0,0,0,0] immediately if dot == 0

  out[0] = -a0 * invDot;
  out[1] = -a1 * invDot;
  out[2] = -a2 * invDot;
  out[3] = a3 * invDot;
  return out;
}
/**
 * Calculates the conjugate of a quat
 * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a quat to calculate conjugate of
 * @returns {quat} out
 */

function conjugate(out, a) {
  out[0] = -a[0];
  out[1] = -a[1];
  out[2] = -a[2];
  out[3] = a[3];
  return out;
}
/**
 * Creates a quaternion from the given 3x3 rotation matrix.
 *
 * NOTE: The resultant quaternion is not normalized, so you should be sure
 * to renormalize the quaternion yourself where necessary.
 *
 * @param {quat} out the receiving quaternion
 * @param {mat3} m rotation matrix
 * @returns {quat} out
 * @function
 */

function fromMat3(out, m) {
  // Algorithm in Ken Shoemake's article in 1987 SIGGRAPH course notes
  // article "Quaternion Calculus and Fast Animation".
  var fTrace = m[0] + m[4] + m[8];
  var fRoot;

  if (fTrace > 0.0) {
    // |w| > 1/2, may as well choose w > 1/2
    fRoot = Math.sqrt(fTrace + 1.0); // 2w

    out[3] = 0.5 * fRoot;
    fRoot = 0.5 / fRoot; // 1/(4w)

    out[0] = (m[5] - m[7]) * fRoot;
    out[1] = (m[6] - m[2]) * fRoot;
    out[2] = (m[1] - m[3]) * fRoot;
  } else {
    // |w| <= 1/2
    var i = 0;
    if (m[4] > m[0]) i = 1;
    if (m[8] > m[i * 3 + i]) i = 2;
    var j = (i + 1) % 3;
    var k = (i + 2) % 3;
    fRoot = Math.sqrt(m[i * 3 + i] - m[j * 3 + j] - m[k * 3 + k] + 1.0);
    out[i] = 0.5 * fRoot;
    fRoot = 0.5 / fRoot;
    out[3] = (m[j * 3 + k] - m[k * 3 + j]) * fRoot;
    out[j] = (m[j * 3 + i] + m[i * 3 + j]) * fRoot;
    out[k] = (m[k * 3 + i] + m[i * 3 + k]) * fRoot;
  }

  return out;
}
/**
 * Creates a quaternion from the given euler angle x, y, z.
 *
 * @param {quat} out the receiving quaternion
 * @param {x} Angle to rotate around X axis in degrees.
 * @param {y} Angle to rotate around Y axis in degrees.
 * @param {z} Angle to rotate around Z axis in degrees.
 * @returns {quat} out
 * @function
 */

function fromEuler(out, x, y, z) {
  var halfToRad = 0.5 * Math.PI / 180.0;
  x *= halfToRad;
  y *= halfToRad;
  z *= halfToRad;
  var sx = Math.sin(x);
  var cx = Math.cos(x);
  var sy = Math.sin(y);
  var cy = Math.cos(y);
  var sz = Math.sin(z);
  var cz = Math.cos(z);
  out[0] = sx * cy * cz - cx * sy * sz;
  out[1] = cx * sy * cz + sx * cy * sz;
  out[2] = cx * cy * sz - sx * sy * cz;
  out[3] = cx * cy * cz + sx * sy * sz;
  return out;
}
/**
 * Returns a string representation of a quatenion
 *
 * @param {quat} a vector to represent as a string
 * @returns {String} string representation of the vector
 */

function quat_str(a) {
  return 'quat(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ')';
}
/**
 * Creates a new quat initialized with values from an existing quaternion
 *
 * @param {quat} a quaternion to clone
 * @returns {quat} a new quaternion
 * @function
 */

var quat_clone = vec4_clone;
/**
 * Creates a new quat initialized with the given values
 *
 * @param {Number} x X component
 * @param {Number} y Y component
 * @param {Number} z Z component
 * @param {Number} w W component
 * @returns {quat} a new quaternion
 * @function
 */

var quat_fromValues = vec4_fromValues;
/**
 * Copy the values from one quat to another
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a the source quaternion
 * @returns {quat} out
 * @function
 */

var quat_copy = vec4_copy;
/**
 * Set the components of a quat to the given values
 *
 * @param {quat} out the receiving quaternion
 * @param {Number} x X component
 * @param {Number} y Y component
 * @param {Number} z Z component
 * @param {Number} w W component
 * @returns {quat} out
 * @function
 */

var quat_set = vec4_set;
/**
 * Adds two quat's
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a the first operand
 * @param {quat} b the second operand
 * @returns {quat} out
 * @function
 */

var quat_add = vec4_add;
/**
 * Alias for {@link quat.multiply}
 * @function
 */

var quat_mul = quat_multiply;
/**
 * Scales a quat by a scalar number
 *
 * @param {quat} out the receiving vector
 * @param {quat} a the vector to scale
 * @param {Number} b amount to scale the vector by
 * @returns {quat} out
 * @function
 */

var quat_scale = vec4_scale;
/**
 * Calculates the dot product of two quat's
 *
 * @param {quat} a the first operand
 * @param {quat} b the second operand
 * @returns {Number} dot product of a and b
 * @function
 */

var quat_dot = dot;
/**
 * Performs a linear interpolation between two quat's
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a the first operand
 * @param {quat} b the second operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {quat} out
 * @function
 */

var quat_lerp = vec4_lerp;
/**
 * Calculates the length of a quat
 *
 * @param {quat} a vector to calculate length of
 * @returns {Number} length of a
 */

var quat_length = vec4_length;
/**
 * Alias for {@link quat.length}
 * @function
 */

var quat_len = quat_length;
/**
 * Calculates the squared length of a quat
 *
 * @param {quat} a vector to calculate squared length of
 * @returns {Number} squared length of a
 * @function
 */

var quat_squaredLength = vec4_squaredLength;
/**
 * Alias for {@link quat.squaredLength}
 * @function
 */

var quat_sqrLen = quat_squaredLength;
/**
 * Normalize a quat
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a quaternion to normalize
 * @returns {quat} out
 * @function
 */

var quat_normalize = vec4_normalize;
/**
 * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)
 *
 * @param {quat} a The first quaternion.
 * @param {quat} b The second quaternion.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

var quat_exactEquals = vec4_exactEquals;
/**
 * Returns whether or not the quaternions have approximately the same elements in the same position.
 *
 * @param {quat} a The first vector.
 * @param {quat} b The second vector.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

var quat_equals = vec4_equals;
/**
 * Sets a quaternion to represent the shortest rotation from one
 * vector to another.
 *
 * Both vectors are assumed to be unit length.
 *
 * @param {quat} out the receiving quaternion.
 * @param {vec3} a the initial vector
 * @param {vec3} b the destination vector
 * @returns {quat} out
 */

var rotationTo = function () {
  var tmpvec3 = vec3_create();
  var xUnitVec3 = vec3_fromValues(1, 0, 0);
  var yUnitVec3 = vec3_fromValues(0, 1, 0);
  return function (out, a, b) {
    var dot = vec3_dot(a, b);

    if (dot < -0.999999) {
      cross(tmpvec3, xUnitVec3, a);
      if (len(tmpvec3) < 0.000001) cross(tmpvec3, yUnitVec3, a);
      normalize(tmpvec3, tmpvec3);
      setAxisAngle(out, tmpvec3, Math.PI);
      return out;
    } else if (dot > 0.999999) {
      out[0] = 0;
      out[1] = 0;
      out[2] = 0;
      out[3] = 1;
      return out;
    } else {
      cross(tmpvec3, a, b);
      out[0] = tmpvec3[0];
      out[1] = tmpvec3[1];
      out[2] = tmpvec3[2];
      out[3] = 1 + dot;
      return quat_normalize(out, out);
    }
  };
}();
/**
 * Performs a spherical linear interpolation with two control points
 *
 * @param {quat} out the receiving quaternion
 * @param {quat} a the first operand
 * @param {quat} b the second operand
 * @param {quat} c the third operand
 * @param {quat} d the fourth operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {quat} out
 */

var sqlerp = function () {
  var temp1 = quat_create();
  var temp2 = quat_create();
  return function (out, a, b, c, d, t) {
    slerp(temp1, a, d, t);
    slerp(temp2, b, c, t);
    slerp(out, temp1, temp2, 2 * t * (1 - t));
    return out;
  };
}();
/**
 * Sets the specified quaternion with values corresponding to the given
 * axes. Each axis is a vec3 and is expected to be unit length and
 * perpendicular to all other specified axes.
 *
 * @param {vec3} view  the vector representing the viewing direction
 * @param {vec3} right the vector representing the local "right" direction
 * @param {vec3} up    the vector representing the local "up" direction
 * @returns {quat} out
 */

var setAxes = function () {
  var matr = mat3_create();
  return function (out, view, right, up) {
    matr[0] = right[0];
    matr[3] = right[1];
    matr[6] = right[2];
    matr[1] = up[0];
    matr[4] = up[1];
    matr[7] = up[2];
    matr[2] = -view[0];
    matr[5] = -view[1];
    matr[8] = -view[2];
    return quat_normalize(out, fromMat3(out, matr));
  };
}();
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/quat2.js



/**
 * Dual Quaternion<br>
 * Format: [real, dual]<br>
 * Quaternion format: XYZW<br>
 * Make sure to have normalized dual quaternions, otherwise the functions may not work as intended.<br>
 * @module quat2
 */

/**
 * Creates a new identity dual quat
 *
 * @returns {quat2} a new dual quaternion [real -> rotation, dual -> translation]
 */

function quat2_create() {
  var dq = new ARRAY_TYPE(8);

  if (ARRAY_TYPE != Float32Array) {
    dq[0] = 0;
    dq[1] = 0;
    dq[2] = 0;
    dq[4] = 0;
    dq[5] = 0;
    dq[6] = 0;
    dq[7] = 0;
  }

  dq[3] = 1;
  return dq;
}
/**
 * Creates a new quat initialized with values from an existing quaternion
 *
 * @param {quat2} a dual quaternion to clone
 * @returns {quat2} new dual quaternion
 * @function
 */

function quat2_clone(a) {
  var dq = new ARRAY_TYPE(8);
  dq[0] = a[0];
  dq[1] = a[1];
  dq[2] = a[2];
  dq[3] = a[3];
  dq[4] = a[4];
  dq[5] = a[5];
  dq[6] = a[6];
  dq[7] = a[7];
  return dq;
}
/**
 * Creates a new dual quat initialized with the given values
 *
 * @param {Number} x1 X component
 * @param {Number} y1 Y component
 * @param {Number} z1 Z component
 * @param {Number} w1 W component
 * @param {Number} x2 X component
 * @param {Number} y2 Y component
 * @param {Number} z2 Z component
 * @param {Number} w2 W component
 * @returns {quat2} new dual quaternion
 * @function
 */

function quat2_fromValues(x1, y1, z1, w1, x2, y2, z2, w2) {
  var dq = new ARRAY_TYPE(8);
  dq[0] = x1;
  dq[1] = y1;
  dq[2] = z1;
  dq[3] = w1;
  dq[4] = x2;
  dq[5] = y2;
  dq[6] = z2;
  dq[7] = w2;
  return dq;
}
/**
 * Creates a new dual quat from the given values (quat and translation)
 *
 * @param {Number} x1 X component
 * @param {Number} y1 Y component
 * @param {Number} z1 Z component
 * @param {Number} w1 W component
 * @param {Number} x2 X component (translation)
 * @param {Number} y2 Y component (translation)
 * @param {Number} z2 Z component (translation)
 * @returns {quat2} new dual quaternion
 * @function
 */

function fromRotationTranslationValues(x1, y1, z1, w1, x2, y2, z2) {
  var dq = new ARRAY_TYPE(8);
  dq[0] = x1;
  dq[1] = y1;
  dq[2] = z1;
  dq[3] = w1;
  var ax = x2 * 0.5,
      ay = y2 * 0.5,
      az = z2 * 0.5;
  dq[4] = ax * w1 + ay * z1 - az * y1;
  dq[5] = ay * w1 + az * x1 - ax * z1;
  dq[6] = az * w1 + ax * y1 - ay * x1;
  dq[7] = -ax * x1 - ay * y1 - az * z1;
  return dq;
}
/**
 * Creates a dual quat from a quaternion and a translation
 *
 * @param {quat2} dual quaternion receiving operation result
 * @param {quat} q a normalized quaternion
 * @param {vec3} t tranlation vector
 * @returns {quat2} dual quaternion receiving operation result
 * @function
 */

function quat2_fromRotationTranslation(out, q, t) {
  var ax = t[0] * 0.5,
      ay = t[1] * 0.5,
      az = t[2] * 0.5,
      bx = q[0],
      by = q[1],
      bz = q[2],
      bw = q[3];
  out[0] = bx;
  out[1] = by;
  out[2] = bz;
  out[3] = bw;
  out[4] = ax * bw + ay * bz - az * by;
  out[5] = ay * bw + az * bx - ax * bz;
  out[6] = az * bw + ax * by - ay * bx;
  out[7] = -ax * bx - ay * by - az * bz;
  return out;
}
/**
 * Creates a dual quat from a translation
 *
 * @param {quat2} dual quaternion receiving operation result
 * @param {vec3} t translation vector
 * @returns {quat2} dual quaternion receiving operation result
 * @function
 */

function quat2_fromTranslation(out, t) {
  out[0] = 0;
  out[1] = 0;
  out[2] = 0;
  out[3] = 1;
  out[4] = t[0] * 0.5;
  out[5] = t[1] * 0.5;
  out[6] = t[2] * 0.5;
  out[7] = 0;
  return out;
}
/**
 * Creates a dual quat from a quaternion
 *
 * @param {quat2} dual quaternion receiving operation result
 * @param {quat} q the quaternion
 * @returns {quat2} dual quaternion receiving operation result
 * @function
 */

function quat2_fromRotation(out, q) {
  out[0] = q[0];
  out[1] = q[1];
  out[2] = q[2];
  out[3] = q[3];
  out[4] = 0;
  out[5] = 0;
  out[6] = 0;
  out[7] = 0;
  return out;
}
/**
 * Creates a new dual quat from a matrix (4x4)
 *
 * @param {quat2} out the dual quaternion
 * @param {mat4} a the matrix
 * @returns {quat2} dual quat receiving operation result
 * @function
 */

function quat2_fromMat4(out, a) {
  //TODO Optimize this
  var outer = quat_create();
  getRotation(outer, a);
  var t = new ARRAY_TYPE(3);
  getTranslation(t, a);
  quat2_fromRotationTranslation(out, outer, t);
  return out;
}
/**
 * Copy the values from one dual quat to another
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the source dual quaternion
 * @returns {quat2} out
 * @function
 */

function quat2_copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  out[2] = a[2];
  out[3] = a[3];
  out[4] = a[4];
  out[5] = a[5];
  out[6] = a[6];
  out[7] = a[7];
  return out;
}
/**
 * Set a dual quat to the identity dual quaternion
 *
 * @param {quat2} out the receiving quaternion
 * @returns {quat2} out
 */

function quat2_identity(out) {
  out[0] = 0;
  out[1] = 0;
  out[2] = 0;
  out[3] = 1;
  out[4] = 0;
  out[5] = 0;
  out[6] = 0;
  out[7] = 0;
  return out;
}
/**
 * Set the components of a dual quat to the given values
 *
 * @param {quat2} out the receiving quaternion
 * @param {Number} x1 X component
 * @param {Number} y1 Y component
 * @param {Number} z1 Z component
 * @param {Number} w1 W component
 * @param {Number} x2 X component
 * @param {Number} y2 Y component
 * @param {Number} z2 Z component
 * @param {Number} w2 W component
 * @returns {quat2} out
 * @function
 */

function quat2_set(out, x1, y1, z1, w1, x2, y2, z2, w2) {
  out[0] = x1;
  out[1] = y1;
  out[2] = z1;
  out[3] = w1;
  out[4] = x2;
  out[5] = y2;
  out[6] = z2;
  out[7] = w2;
  return out;
}
/**
 * Gets the real part of a dual quat
 * @param  {quat} out real part
 * @param  {quat2} a Dual Quaternion
 * @return {quat} real part
 */

var getReal = quat_copy;
/**
 * Gets the dual part of a dual quat
 * @param  {quat} out dual part
 * @param  {quat2} a Dual Quaternion
 * @return {quat} dual part
 */

function getDual(out, a) {
  out[0] = a[4];
  out[1] = a[5];
  out[2] = a[6];
  out[3] = a[7];
  return out;
}
/**
 * Set the real component of a dual quat to the given quaternion
 *
 * @param {quat2} out the receiving quaternion
 * @param {quat} q a quaternion representing the real part
 * @returns {quat2} out
 * @function
 */

var setReal = quat_copy;
/**
 * Set the dual component of a dual quat to the given quaternion
 *
 * @param {quat2} out the receiving quaternion
 * @param {quat} q a quaternion representing the dual part
 * @returns {quat2} out
 * @function
 */

function setDual(out, q) {
  out[4] = q[0];
  out[5] = q[1];
  out[6] = q[2];
  out[7] = q[3];
  return out;
}
/**
 * Gets the translation of a normalized dual quat
 * @param  {vec3} out translation
 * @param  {quat2} a Dual Quaternion to be decomposed
 * @return {vec3} translation
 */

function quat2_getTranslation(out, a) {
  var ax = a[4],
      ay = a[5],
      az = a[6],
      aw = a[7],
      bx = -a[0],
      by = -a[1],
      bz = -a[2],
      bw = a[3];
  out[0] = (ax * bw + aw * bx + ay * bz - az * by) * 2;
  out[1] = (ay * bw + aw * by + az * bx - ax * bz) * 2;
  out[2] = (az * bw + aw * bz + ax * by - ay * bx) * 2;
  return out;
}
/**
 * Translates a dual quat by the given vector
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the dual quaternion to translate
 * @param {vec3} v vector to translate by
 * @returns {quat2} out
 */

function quat2_translate(out, a, v) {
  var ax1 = a[0],
      ay1 = a[1],
      az1 = a[2],
      aw1 = a[3],
      bx1 = v[0] * 0.5,
      by1 = v[1] * 0.5,
      bz1 = v[2] * 0.5,
      ax2 = a[4],
      ay2 = a[5],
      az2 = a[6],
      aw2 = a[7];
  out[0] = ax1;
  out[1] = ay1;
  out[2] = az1;
  out[3] = aw1;
  out[4] = aw1 * bx1 + ay1 * bz1 - az1 * by1 + ax2;
  out[5] = aw1 * by1 + az1 * bx1 - ax1 * bz1 + ay2;
  out[6] = aw1 * bz1 + ax1 * by1 - ay1 * bx1 + az2;
  out[7] = -ax1 * bx1 - ay1 * by1 - az1 * bz1 + aw2;
  return out;
}
/**
 * Rotates a dual quat around the X axis
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the dual quaternion to rotate
 * @param {number} rad how far should the rotation be
 * @returns {quat2} out
 */

function quat2_rotateX(out, a, rad) {
  var bx = -a[0],
      by = -a[1],
      bz = -a[2],
      bw = a[3],
      ax = a[4],
      ay = a[5],
      az = a[6],
      aw = a[7],
      ax1 = ax * bw + aw * bx + ay * bz - az * by,
      ay1 = ay * bw + aw * by + az * bx - ax * bz,
      az1 = az * bw + aw * bz + ax * by - ay * bx,
      aw1 = aw * bw - ax * bx - ay * by - az * bz;
  quat_rotateX(out, a, rad);
  bx = out[0];
  by = out[1];
  bz = out[2];
  bw = out[3];
  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;
  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;
  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;
  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;
  return out;
}
/**
 * Rotates a dual quat around the Y axis
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the dual quaternion to rotate
 * @param {number} rad how far should the rotation be
 * @returns {quat2} out
 */

function quat2_rotateY(out, a, rad) {
  var bx = -a[0],
      by = -a[1],
      bz = -a[2],
      bw = a[3],
      ax = a[4],
      ay = a[5],
      az = a[6],
      aw = a[7],
      ax1 = ax * bw + aw * bx + ay * bz - az * by,
      ay1 = ay * bw + aw * by + az * bx - ax * bz,
      az1 = az * bw + aw * bz + ax * by - ay * bx,
      aw1 = aw * bw - ax * bx - ay * by - az * bz;
  quat_rotateY(out, a, rad);
  bx = out[0];
  by = out[1];
  bz = out[2];
  bw = out[3];
  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;
  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;
  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;
  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;
  return out;
}
/**
 * Rotates a dual quat around the Z axis
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the dual quaternion to rotate
 * @param {number} rad how far should the rotation be
 * @returns {quat2} out
 */

function quat2_rotateZ(out, a, rad) {
  var bx = -a[0],
      by = -a[1],
      bz = -a[2],
      bw = a[3],
      ax = a[4],
      ay = a[5],
      az = a[6],
      aw = a[7],
      ax1 = ax * bw + aw * bx + ay * bz - az * by,
      ay1 = ay * bw + aw * by + az * bx - ax * bz,
      az1 = az * bw + aw * bz + ax * by - ay * bx,
      aw1 = aw * bw - ax * bx - ay * by - az * bz;
  quat_rotateZ(out, a, rad);
  bx = out[0];
  by = out[1];
  bz = out[2];
  bw = out[3];
  out[4] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;
  out[5] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;
  out[6] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;
  out[7] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;
  return out;
}
/**
 * Rotates a dual quat by a given quaternion (a * q)
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the dual quaternion to rotate
 * @param {quat} q quaternion to rotate by
 * @returns {quat2} out
 */

function rotateByQuatAppend(out, a, q) {
  var qx = q[0],
      qy = q[1],
      qz = q[2],
      qw = q[3],
      ax = a[0],
      ay = a[1],
      az = a[2],
      aw = a[3];
  out[0] = ax * qw + aw * qx + ay * qz - az * qy;
  out[1] = ay * qw + aw * qy + az * qx - ax * qz;
  out[2] = az * qw + aw * qz + ax * qy - ay * qx;
  out[3] = aw * qw - ax * qx - ay * qy - az * qz;
  ax = a[4];
  ay = a[5];
  az = a[6];
  aw = a[7];
  out[4] = ax * qw + aw * qx + ay * qz - az * qy;
  out[5] = ay * qw + aw * qy + az * qx - ax * qz;
  out[6] = az * qw + aw * qz + ax * qy - ay * qx;
  out[7] = aw * qw - ax * qx - ay * qy - az * qz;
  return out;
}
/**
 * Rotates a dual quat by a given quaternion (q * a)
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat} q quaternion to rotate by
 * @param {quat2} a the dual quaternion to rotate
 * @returns {quat2} out
 */

function rotateByQuatPrepend(out, q, a) {
  var qx = q[0],
      qy = q[1],
      qz = q[2],
      qw = q[3],
      bx = a[0],
      by = a[1],
      bz = a[2],
      bw = a[3];
  out[0] = qx * bw + qw * bx + qy * bz - qz * by;
  out[1] = qy * bw + qw * by + qz * bx - qx * bz;
  out[2] = qz * bw + qw * bz + qx * by - qy * bx;
  out[3] = qw * bw - qx * bx - qy * by - qz * bz;
  bx = a[4];
  by = a[5];
  bz = a[6];
  bw = a[7];
  out[4] = qx * bw + qw * bx + qy * bz - qz * by;
  out[5] = qy * bw + qw * by + qz * bx - qx * bz;
  out[6] = qz * bw + qw * bz + qx * by - qy * bx;
  out[7] = qw * bw - qx * bx - qy * by - qz * bz;
  return out;
}
/**
 * Rotates a dual quat around a given axis. Does the normalisation automatically
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the dual quaternion to rotate
 * @param {vec3} axis the axis to rotate around
 * @param {Number} rad how far the rotation should be
 * @returns {quat2} out
 */

function rotateAroundAxis(out, a, axis, rad) {
  //Special case for rad = 0
  if (Math.abs(rad) < EPSILON) {
    return quat2_copy(out, a);
  }

  var axisLength = Math.hypot(axis[0], axis[1], axis[2]);
  rad = rad * 0.5;
  var s = Math.sin(rad);
  var bx = s * axis[0] / axisLength;
  var by = s * axis[1] / axisLength;
  var bz = s * axis[2] / axisLength;
  var bw = Math.cos(rad);
  var ax1 = a[0],
      ay1 = a[1],
      az1 = a[2],
      aw1 = a[3];
  out[0] = ax1 * bw + aw1 * bx + ay1 * bz - az1 * by;
  out[1] = ay1 * bw + aw1 * by + az1 * bx - ax1 * bz;
  out[2] = az1 * bw + aw1 * bz + ax1 * by - ay1 * bx;
  out[3] = aw1 * bw - ax1 * bx - ay1 * by - az1 * bz;
  var ax = a[4],
      ay = a[5],
      az = a[6],
      aw = a[7];
  out[4] = ax * bw + aw * bx + ay * bz - az * by;
  out[5] = ay * bw + aw * by + az * bx - ax * bz;
  out[6] = az * bw + aw * bz + ax * by - ay * bx;
  out[7] = aw * bw - ax * bx - ay * by - az * bz;
  return out;
}
/**
 * Adds two dual quat's
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the first operand
 * @param {quat2} b the second operand
 * @returns {quat2} out
 * @function
 */

function quat2_add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  out[2] = a[2] + b[2];
  out[3] = a[3] + b[3];
  out[4] = a[4] + b[4];
  out[5] = a[5] + b[5];
  out[6] = a[6] + b[6];
  out[7] = a[7] + b[7];
  return out;
}
/**
 * Multiplies two dual quat's
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a the first operand
 * @param {quat2} b the second operand
 * @returns {quat2} out
 */

function quat2_multiply(out, a, b) {
  var ax0 = a[0],
      ay0 = a[1],
      az0 = a[2],
      aw0 = a[3],
      bx1 = b[4],
      by1 = b[5],
      bz1 = b[6],
      bw1 = b[7],
      ax1 = a[4],
      ay1 = a[5],
      az1 = a[6],
      aw1 = a[7],
      bx0 = b[0],
      by0 = b[1],
      bz0 = b[2],
      bw0 = b[3];
  out[0] = ax0 * bw0 + aw0 * bx0 + ay0 * bz0 - az0 * by0;
  out[1] = ay0 * bw0 + aw0 * by0 + az0 * bx0 - ax0 * bz0;
  out[2] = az0 * bw0 + aw0 * bz0 + ax0 * by0 - ay0 * bx0;
  out[3] = aw0 * bw0 - ax0 * bx0 - ay0 * by0 - az0 * bz0;
  out[4] = ax0 * bw1 + aw0 * bx1 + ay0 * bz1 - az0 * by1 + ax1 * bw0 + aw1 * bx0 + ay1 * bz0 - az1 * by0;
  out[5] = ay0 * bw1 + aw0 * by1 + az0 * bx1 - ax0 * bz1 + ay1 * bw0 + aw1 * by0 + az1 * bx0 - ax1 * bz0;
  out[6] = az0 * bw1 + aw0 * bz1 + ax0 * by1 - ay0 * bx1 + az1 * bw0 + aw1 * bz0 + ax1 * by0 - ay1 * bx0;
  out[7] = aw0 * bw1 - ax0 * bx1 - ay0 * by1 - az0 * bz1 + aw1 * bw0 - ax1 * bx0 - ay1 * by0 - az1 * bz0;
  return out;
}
/**
 * Alias for {@link quat2.multiply}
 * @function
 */

var quat2_mul = quat2_multiply;
/**
 * Scales a dual quat by a scalar number
 *
 * @param {quat2} out the receiving dual quat
 * @param {quat2} a the dual quat to scale
 * @param {Number} b amount to scale the dual quat by
 * @returns {quat2} out
 * @function
 */

function quat2_scale(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  out[2] = a[2] * b;
  out[3] = a[3] * b;
  out[4] = a[4] * b;
  out[5] = a[5] * b;
  out[6] = a[6] * b;
  out[7] = a[7] * b;
  return out;
}
/**
 * Calculates the dot product of two dual quat's (The dot product of the real parts)
 *
 * @param {quat2} a the first operand
 * @param {quat2} b the second operand
 * @returns {Number} dot product of a and b
 * @function
 */

var quat2_dot = quat_dot;
/**
 * Performs a linear interpolation between two dual quats's
 * NOTE: The resulting dual quaternions won't always be normalized (The error is most noticeable when t = 0.5)
 *
 * @param {quat2} out the receiving dual quat
 * @param {quat2} a the first operand
 * @param {quat2} b the second operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {quat2} out
 */

function quat2_lerp(out, a, b, t) {
  var mt = 1 - t;
  if (quat2_dot(a, b) < 0) t = -t;
  out[0] = a[0] * mt + b[0] * t;
  out[1] = a[1] * mt + b[1] * t;
  out[2] = a[2] * mt + b[2] * t;
  out[3] = a[3] * mt + b[3] * t;
  out[4] = a[4] * mt + b[4] * t;
  out[5] = a[5] * mt + b[5] * t;
  out[6] = a[6] * mt + b[6] * t;
  out[7] = a[7] * mt + b[7] * t;
  return out;
}
/**
 * Calculates the inverse of a dual quat. If they are normalized, conjugate is cheaper
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a dual quat to calculate inverse of
 * @returns {quat2} out
 */

function quat2_invert(out, a) {
  var sqlen = quat2_squaredLength(a);
  out[0] = -a[0] / sqlen;
  out[1] = -a[1] / sqlen;
  out[2] = -a[2] / sqlen;
  out[3] = a[3] / sqlen;
  out[4] = -a[4] / sqlen;
  out[5] = -a[5] / sqlen;
  out[6] = -a[6] / sqlen;
  out[7] = a[7] / sqlen;
  return out;
}
/**
 * Calculates the conjugate of a dual quat
 * If the dual quaternion is normalized, this function is faster than quat2.inverse and produces the same result.
 *
 * @param {quat2} out the receiving quaternion
 * @param {quat2} a quat to calculate conjugate of
 * @returns {quat2} out
 */

function quat2_conjugate(out, a) {
  out[0] = -a[0];
  out[1] = -a[1];
  out[2] = -a[2];
  out[3] = a[3];
  out[4] = -a[4];
  out[5] = -a[5];
  out[6] = -a[6];
  out[7] = a[7];
  return out;
}
/**
 * Calculates the length of a dual quat
 *
 * @param {quat2} a dual quat to calculate length of
 * @returns {Number} length of a
 * @function
 */

var quat2_length = quat_length;
/**
 * Alias for {@link quat2.length}
 * @function
 */

var quat2_len = quat2_length;
/**
 * Calculates the squared length of a dual quat
 *
 * @param {quat2} a dual quat to calculate squared length of
 * @returns {Number} squared length of a
 * @function
 */

var quat2_squaredLength = quat_squaredLength;
/**
 * Alias for {@link quat2.squaredLength}
 * @function
 */

var quat2_sqrLen = quat2_squaredLength;
/**
 * Normalize a dual quat
 *
 * @param {quat2} out the receiving dual quaternion
 * @param {quat2} a dual quaternion to normalize
 * @returns {quat2} out
 * @function
 */

function quat2_normalize(out, a) {
  var magnitude = quat2_squaredLength(a);

  if (magnitude > 0) {
    magnitude = Math.sqrt(magnitude);
    var a0 = a[0] / magnitude;
    var a1 = a[1] / magnitude;
    var a2 = a[2] / magnitude;
    var a3 = a[3] / magnitude;
    var b0 = a[4];
    var b1 = a[5];
    var b2 = a[6];
    var b3 = a[7];
    var a_dot_b = a0 * b0 + a1 * b1 + a2 * b2 + a3 * b3;
    out[0] = a0;
    out[1] = a1;
    out[2] = a2;
    out[3] = a3;
    out[4] = (b0 - a0 * a_dot_b) / magnitude;
    out[5] = (b1 - a1 * a_dot_b) / magnitude;
    out[6] = (b2 - a2 * a_dot_b) / magnitude;
    out[7] = (b3 - a3 * a_dot_b) / magnitude;
  }

  return out;
}
/**
 * Returns a string representation of a dual quatenion
 *
 * @param {quat2} a dual quaternion to represent as a string
 * @returns {String} string representation of the dual quat
 */

function quat2_str(a) {
  return 'quat2(' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ')';
}
/**
 * Returns whether or not the dual quaternions have exactly the same elements in the same position (when compared with ===)
 *
 * @param {quat2} a the first dual quaternion.
 * @param {quat2} b the second dual quaternion.
 * @returns {Boolean} true if the dual quaternions are equal, false otherwise.
 */

function quat2_exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1] && a[2] === b[2] && a[3] === b[3] && a[4] === b[4] && a[5] === b[5] && a[6] === b[6] && a[7] === b[7];
}
/**
 * Returns whether or not the dual quaternions have approximately the same elements in the same position.
 *
 * @param {quat2} a the first dual quat.
 * @param {quat2} b the second dual quat.
 * @returns {Boolean} true if the dual quats are equal, false otherwise.
 */

function quat2_equals(a, b) {
  var a0 = a[0],
      a1 = a[1],
      a2 = a[2],
      a3 = a[3],
      a4 = a[4],
      a5 = a[5],
      a6 = a[6],
      a7 = a[7];
  var b0 = b[0],
      b1 = b[1],
      b2 = b[2],
      b3 = b[3],
      b4 = b[4],
      b5 = b[5],
      b6 = b[6],
      b7 = b[7];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1)) && Math.abs(a2 - b2) <= EPSILON * Math.max(1.0, Math.abs(a2), Math.abs(b2)) && Math.abs(a3 - b3) <= EPSILON * Math.max(1.0, Math.abs(a3), Math.abs(b3)) && Math.abs(a4 - b4) <= EPSILON * Math.max(1.0, Math.abs(a4), Math.abs(b4)) && Math.abs(a5 - b5) <= EPSILON * Math.max(1.0, Math.abs(a5), Math.abs(b5)) && Math.abs(a6 - b6) <= EPSILON * Math.max(1.0, Math.abs(a6), Math.abs(b6)) && Math.abs(a7 - b7) <= EPSILON * Math.max(1.0, Math.abs(a7), Math.abs(b7));
}
;// CONCATENATED MODULE: ./node_modules/gl-matrix/esm/vec2.js

/**
 * 2 Dimensional Vector
 * @module vec2
 */

/**
 * Creates a new, empty vec2
 *
 * @returns {vec2} a new 2D vector
 */

function vec2_create() {
  var out = new ARRAY_TYPE(2);

  if (ARRAY_TYPE != Float32Array) {
    out[0] = 0;
    out[1] = 0;
  }

  return out;
}
/**
 * Creates a new vec2 initialized with values from an existing vector
 *
 * @param {vec2} a vector to clone
 * @returns {vec2} a new 2D vector
 */

function vec2_clone(a) {
  var out = new ARRAY_TYPE(2);
  out[0] = a[0];
  out[1] = a[1];
  return out;
}
/**
 * Creates a new vec2 initialized with the given values
 *
 * @param {Number} x X component
 * @param {Number} y Y component
 * @returns {vec2} a new 2D vector
 */

function vec2_fromValues(x, y) {
  var out = new ARRAY_TYPE(2);
  out[0] = x;
  out[1] = y;
  return out;
}
/**
 * Copy the values from one vec2 to another
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the source vector
 * @returns {vec2} out
 */

function vec2_copy(out, a) {
  out[0] = a[0];
  out[1] = a[1];
  return out;
}
/**
 * Set the components of a vec2 to the given values
 *
 * @param {vec2} out the receiving vector
 * @param {Number} x X component
 * @param {Number} y Y component
 * @returns {vec2} out
 */

function vec2_set(out, x, y) {
  out[0] = x;
  out[1] = y;
  return out;
}
/**
 * Adds two vec2's
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {vec2} out
 */

function vec2_add(out, a, b) {
  out[0] = a[0] + b[0];
  out[1] = a[1] + b[1];
  return out;
}
/**
 * Subtracts vector b from vector a
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {vec2} out
 */

function vec2_subtract(out, a, b) {
  out[0] = a[0] - b[0];
  out[1] = a[1] - b[1];
  return out;
}
/**
 * Multiplies two vec2's
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {vec2} out
 */

function vec2_multiply(out, a, b) {
  out[0] = a[0] * b[0];
  out[1] = a[1] * b[1];
  return out;
}
/**
 * Divides two vec2's
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {vec2} out
 */

function vec2_divide(out, a, b) {
  out[0] = a[0] / b[0];
  out[1] = a[1] / b[1];
  return out;
}
/**
 * Math.ceil the components of a vec2
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a vector to ceil
 * @returns {vec2} out
 */

function vec2_ceil(out, a) {
  out[0] = Math.ceil(a[0]);
  out[1] = Math.ceil(a[1]);
  return out;
}
/**
 * Math.floor the components of a vec2
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a vector to floor
 * @returns {vec2} out
 */

function vec2_floor(out, a) {
  out[0] = Math.floor(a[0]);
  out[1] = Math.floor(a[1]);
  return out;
}
/**
 * Returns the minimum of two vec2's
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {vec2} out
 */

function vec2_min(out, a, b) {
  out[0] = Math.min(a[0], b[0]);
  out[1] = Math.min(a[1], b[1]);
  return out;
}
/**
 * Returns the maximum of two vec2's
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {vec2} out
 */

function vec2_max(out, a, b) {
  out[0] = Math.max(a[0], b[0]);
  out[1] = Math.max(a[1], b[1]);
  return out;
}
/**
 * Math.round the components of a vec2
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a vector to round
 * @returns {vec2} out
 */

function vec2_round(out, a) {
  out[0] = Math.round(a[0]);
  out[1] = Math.round(a[1]);
  return out;
}
/**
 * Scales a vec2 by a scalar number
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the vector to scale
 * @param {Number} b amount to scale the vector by
 * @returns {vec2} out
 */

function vec2_scale(out, a, b) {
  out[0] = a[0] * b;
  out[1] = a[1] * b;
  return out;
}
/**
 * Adds two vec2's after scaling the second operand by a scalar value
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @param {Number} scale the amount to scale b by before adding
 * @returns {vec2} out
 */

function vec2_scaleAndAdd(out, a, b, scale) {
  out[0] = a[0] + b[0] * scale;
  out[1] = a[1] + b[1] * scale;
  return out;
}
/**
 * Calculates the euclidian distance between two vec2's
 *
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {Number} distance between a and b
 */

function vec2_distance(a, b) {
  var x = b[0] - a[0],
      y = b[1] - a[1];
  return Math.hypot(x, y);
}
/**
 * Calculates the squared euclidian distance between two vec2's
 *
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {Number} squared distance between a and b
 */

function vec2_squaredDistance(a, b) {
  var x = b[0] - a[0],
      y = b[1] - a[1];
  return x * x + y * y;
}
/**
 * Calculates the length of a vec2
 *
 * @param {vec2} a vector to calculate length of
 * @returns {Number} length of a
 */

function vec2_length(a) {
  var x = a[0],
      y = a[1];
  return Math.hypot(x, y);
}
/**
 * Calculates the squared length of a vec2
 *
 * @param {vec2} a vector to calculate squared length of
 * @returns {Number} squared length of a
 */

function vec2_squaredLength(a) {
  var x = a[0],
      y = a[1];
  return x * x + y * y;
}
/**
 * Negates the components of a vec2
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a vector to negate
 * @returns {vec2} out
 */

function vec2_negate(out, a) {
  out[0] = -a[0];
  out[1] = -a[1];
  return out;
}
/**
 * Returns the inverse of the components of a vec2
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a vector to invert
 * @returns {vec2} out
 */

function vec2_inverse(out, a) {
  out[0] = 1.0 / a[0];
  out[1] = 1.0 / a[1];
  return out;
}
/**
 * Normalize a vec2
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a vector to normalize
 * @returns {vec2} out
 */

function vec2_normalize(out, a) {
  var x = a[0],
      y = a[1];
  var len = x * x + y * y;

  if (len > 0) {
    //TODO: evaluate use of glm_invsqrt here?
    len = 1 / Math.sqrt(len);
  }

  out[0] = a[0] * len;
  out[1] = a[1] * len;
  return out;
}
/**
 * Calculates the dot product of two vec2's
 *
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {Number} dot product of a and b
 */

function vec2_dot(a, b) {
  return a[0] * b[0] + a[1] * b[1];
}
/**
 * Computes the cross product of two vec2's
 * Note that the cross product must by definition produce a 3D vector
 *
 * @param {vec3} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @returns {vec3} out
 */

function vec2_cross(out, a, b) {
  var z = a[0] * b[1] - a[1] * b[0];
  out[0] = out[1] = 0;
  out[2] = z;
  return out;
}
/**
 * Performs a linear interpolation between two vec2's
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the first operand
 * @param {vec2} b the second operand
 * @param {Number} t interpolation amount, in the range [0-1], between the two inputs
 * @returns {vec2} out
 */

function vec2_lerp(out, a, b, t) {
  var ax = a[0],
      ay = a[1];
  out[0] = ax + t * (b[0] - ax);
  out[1] = ay + t * (b[1] - ay);
  return out;
}
/**
 * Generates a random vector with the given scale
 *
 * @param {vec2} out the receiving vector
 * @param {Number} [scale] Length of the resulting vector. If ommitted, a unit vector will be returned
 * @returns {vec2} out
 */

function vec2_random(out, scale) {
  scale = scale || 1.0;
  var r = RANDOM() * 2.0 * Math.PI;
  out[0] = Math.cos(r) * scale;
  out[1] = Math.sin(r) * scale;
  return out;
}
/**
 * Transforms the vec2 with a mat2
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the vector to transform
 * @param {mat2} m matrix to transform with
 * @returns {vec2} out
 */

function transformMat2(out, a, m) {
  var x = a[0],
      y = a[1];
  out[0] = m[0] * x + m[2] * y;
  out[1] = m[1] * x + m[3] * y;
  return out;
}
/**
 * Transforms the vec2 with a mat2d
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the vector to transform
 * @param {mat2d} m matrix to transform with
 * @returns {vec2} out
 */

function transformMat2d(out, a, m) {
  var x = a[0],
      y = a[1];
  out[0] = m[0] * x + m[2] * y + m[4];
  out[1] = m[1] * x + m[3] * y + m[5];
  return out;
}
/**
 * Transforms the vec2 with a mat3
 * 3rd vector component is implicitly '1'
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the vector to transform
 * @param {mat3} m matrix to transform with
 * @returns {vec2} out
 */

function vec2_transformMat3(out, a, m) {
  var x = a[0],
      y = a[1];
  out[0] = m[0] * x + m[3] * y + m[6];
  out[1] = m[1] * x + m[4] * y + m[7];
  return out;
}
/**
 * Transforms the vec2 with a mat4
 * 3rd vector component is implicitly '0'
 * 4th vector component is implicitly '1'
 *
 * @param {vec2} out the receiving vector
 * @param {vec2} a the vector to transform
 * @param {mat4} m matrix to transform with
 * @returns {vec2} out
 */

function vec2_transformMat4(out, a, m) {
  var x = a[0];
  var y = a[1];
  out[0] = m[0] * x + m[4] * y + m[12];
  out[1] = m[1] * x + m[5] * y + m[13];
  return out;
}
/**
 * Rotate a 2D vector
 * @param {vec2} out The receiving vec2
 * @param {vec2} a The vec2 point to rotate
 * @param {vec2} b The origin of the rotation
 * @param {Number} c The angle of rotation
 * @returns {vec2} out
 */

function vec2_rotate(out, a, b, c) {
  //Translate point to the origin
  var p0 = a[0] - b[0],
      p1 = a[1] - b[1],
      sinC = Math.sin(c),
      cosC = Math.cos(c); //perform rotation and translate to correct position

  out[0] = p0 * cosC - p1 * sinC + b[0];
  out[1] = p0 * sinC + p1 * cosC + b[1];
  return out;
}
/**
 * Get the angle between two 2D vectors
 * @param {vec2} a The first operand
 * @param {vec2} b The second operand
 * @returns {Number} The angle in radians
 */

function vec2_angle(a, b) {
  var x1 = a[0],
      y1 = a[1],
      x2 = b[0],
      y2 = b[1];
  var len1 = x1 * x1 + y1 * y1;

  if (len1 > 0) {
    //TODO: evaluate use of glm_invsqrt here?
    len1 = 1 / Math.sqrt(len1);
  }

  var len2 = x2 * x2 + y2 * y2;

  if (len2 > 0) {
    //TODO: evaluate use of glm_invsqrt here?
    len2 = 1 / Math.sqrt(len2);
  }

  var cosine = (x1 * x2 + y1 * y2) * len1 * len2;

  if (cosine > 1.0) {
    return 0;
  } else if (cosine < -1.0) {
    return Math.PI;
  } else {
    return Math.acos(cosine);
  }
}
/**
 * Set the components of a vec2 to zero
 *
 * @param {vec2} out the receiving vector
 * @returns {vec2} out
 */

function vec2_zero(out) {
  out[0] = 0.0;
  out[1] = 0.0;
  return out;
}
/**
 * Returns a string representation of a vector
 *
 * @param {vec2} a vector to represent as a string
 * @returns {String} string representation of the vector
 */

function vec2_str(a) {
  return 'vec2(' + a[0] + ', ' + a[1] + ')';
}
/**
 * Returns whether or not the vectors exactly have the same elements in the same position (when compared with ===)
 *
 * @param {vec2} a The first vector.
 * @param {vec2} b The second vector.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

function vec2_exactEquals(a, b) {
  return a[0] === b[0] && a[1] === b[1];
}
/**
 * Returns whether or not the vectors have approximately the same elements in the same position.
 *
 * @param {vec2} a The first vector.
 * @param {vec2} b The second vector.
 * @returns {Boolean} True if the vectors are equal, false otherwise.
 */

function vec2_equals(a, b) {
  var a0 = a[0],
      a1 = a[1];
  var b0 = b[0],
      b1 = b[1];
  return Math.abs(a0 - b0) <= EPSILON * Math.max(1.0, Math.abs(a0), Math.abs(b0)) && Math.abs(a1 - b1) <= EPSILON * Math.max(1.0, Math.abs(a1), Math.abs(b1));
}
/**
 * Alias for {@link vec2.length}
 * @function
 */

var vec2_len = vec2_length;
/**
 * Alias for {@link vec2.subtract}
 * @function
 */

var vec2_sub = vec2_subtract;
/**
 * Alias for {@link vec2.multiply}
 * @function
 */

var vec2_mul = vec2_multiply;
/**
 * Alias for {@link vec2.divide}
 * @function
 */

var vec2_div = vec2_divide;
/**
 * Alias for {@link vec2.distance}
 * @function
 */

var vec2_dist = vec2_distance;
/**
 * Alias for {@link vec2.squaredDistance}
 * @function
 */

var vec2_sqrDist = vec2_squaredDistance;
/**
 * Alias for {@link vec2.squaredLength}
 * @function
 */

var vec2_sqrLen = vec2_squaredLength;
/**
 * Perform some operation over an array of vec2s.
 *
 * @param {Array} a the array of vectors to iterate over
 * @param {Number} stride Number of elements between the start of each vec2. If 0 assumes tightly packed
 * @param {Number} offset Number of elements to skip at the beginning of the array
 * @param {Number} count Number of vec2s to iterate over. If 0 iterates over entire array
 * @param {Function} fn Function to call for each vector in the array
 * @param {Object} [arg] additional argument to pass to fn
 * @returns {Array} a
 * @function
 */

var vec2_forEach = function () {
  var vec = vec2_create();
  return function (a, stride, offset, count, fn, arg) {
    var i, l;

    if (!stride) {
      stride = 2;
    }

    if (!offset) {
      offset = 0;
    }

    if (count) {
      l = Math.min(count * stride + offset, a.length);
    } else {
      l = a.length;
    }

    for (i = offset; i < l; i += stride) {
      vec[0] = a[i];
      vec[1] = a[i + 1];
      fn(vec, vec, arg);
      a[i] = vec[0];
      a[i + 1] = vec[1];
    }

    return a;
  };
}();
;// CONCATENATED MODULE: ../shared/client/src/helper.js
/**
 * Shared helper methods for cables uis
 */
class Helper
{
    constructor()
    {
        this._simpleIdCounter = 0;
    }

    /**
     * generate a random v4 uuid
     *
     * @return {string}
     */
    uuid()
    {
        let d = new Date().getTime();
        return "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (c) =>
        {
            const r = (d + Math.random() * 16) % 16 | 0;
            d = Math.floor(d / 16);
            return (c === "x" ? r : (r & 0x3) | 0x8).toString(16);
        });
    }

    /**
     * checks value for !isNan and isFinite
     *
     * @param {string} n
     * @return {boolean}
     */
    isNumeric(n)
    {
        const nn = parseFloat(n);
        return !isNaN(nn) && isFinite(nn);
    }

    /**
     * generate a simple ID using an internal counter
     *
     * @return {Number} new id
     * @static
     */
    simpleId()
    {
        this._simpleIdCounter++;
        return this._simpleIdCounter;
    }

}
/* harmony default export */ const helper = (new Helper());

;// CONCATENATED MODULE: ../shared/client/src/logger.js
/* eslint-disable no-console */

class Logger
{

    /**
     * @param {any} initiator
     * @param {Object} options
     */
    constructor(initiator, options)
    {
        this.initiator = initiator;
        this._options = options;
    }

    stack(t)
    {
        console.info("[" + this.initiator + "] ", t);
        console.log((new Error()).stack);
    }

    groupCollapsed(t)
    {
        if ((CABLES.UI && CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 0 }, ...arguments)) || !CABLES.logSilent) console.log("[" + this.initiator + "]", ...arguments);

        console.groupCollapsed("[" + this.initiator + "] " + t);
    }

    table(t)
    {
        console.table(t);
    }

    groupEnd()
    {
        console.groupEnd();
    }

    error()
    {
        if ((CABLES.UI && CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 2 }, ...arguments)) || !CABLES.UI)
        {
            console.error("[" + this.initiator + "]", ...arguments);
        }

        if (this._options && this._options.onError)
        {
            this._options.onError(this.initiator, ...arguments);
            // console.log("emitevent onerror...");
            // CABLES.patch.emitEvent("onError", this.initiator, ...arguments);
            // CABLES.logErrorConsole("[" + this.initiator + "]", ...arguments);
        }
    }

    errorGui()
    {
        if (CABLES.UI) CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 2 }, ...arguments);
    }

    warn()
    {
        if ((CABLES.UI && CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 1 }, ...arguments)) || !CABLES.logSilent)
            console.warn("[" + this.initiator + "]", ...arguments);
    }

    verbose()
    {
        if ((CABLES.UI && CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 0 }, ...arguments)) || !CABLES.logSilent)
            console.log("[" + this.initiator + "]", ...arguments);
    }

    info()
    {
        if ((CABLES.UI && CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 0 }, ...arguments)) || !CABLES.logSilent)
            console.info("[" + this.initiator + "]", ...arguments);
    }

    log()
    {
        if ((CABLES.UI && CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 0 }, ...arguments)) || !CABLES.logSilent)
            console.log("[" + this.initiator + "]", ...arguments);
    }

    logGui()
    {
        if (CABLES.UI) CABLES.UI.logFilter.filterLog({ "initiator": this.initiator, "level": 0 }, ...arguments);
    }

    userInteraction(text)
    {
        // this.log({ "initiator": "userinteraction", "text": text });
    }
}

;// CONCATENATED MODULE: ../shared/client/src/eventtarget.js



/**
 * add eventlistener functionality to classes
 */
class Events
{
    #eventLog;
    constructor()
    {
        this.#eventLog = new Logger("eventtarget");
        this._eventCallbacks = {};
        this._logName = "";
        this._logEvents = false;
        this._listeners = {};

        this._countErrorUnknowns = 0;
    }

    /**
     * add event listener
     * @param {string} which event name
     * @param {function} cb callback
     * @param {string} idPrefix prefix for id, default empty
     * @return {string} event id
     */
    on(which, cb, idPrefix = "")
    {
        const event =
            {
                "id": (idPrefix || "") + helper.simpleId(),
                "name": which,
                "cb": cb,
            };
        if (!this._eventCallbacks[which]) this._eventCallbacks[which] = [event];
        else this._eventCallbacks[which].push(event);

        this._listeners[event.id] = event;

        return event.id;
    }

    /** @deprecated */
    addEventListener(which, cb, idPrefix = "")
    {
        return this.on(which, cb, idPrefix);
    }

    /**
     * check event listener registration
     * @param {string} id event id
     * @param {function} cb callback - deprecated
     * @return {boolean}
     */
    hasEventListener(id, cb = null)
    {
        if (id && !cb)
        {
            // check by id
            return !!this._listeners[id];
        }
        else
        {
            this.#eventLog.warn("old eventtarget function haseventlistener!");
            if (id && cb)
            {
                if (this._eventCallbacks[id])
                {
                    const idx = this._eventCallbacks[id].indexOf(cb);
                    return idx !== -1;
                }
            }
        }
    }

    /**
     * check event listener by name
     * @param eventName event name
     * @return {boolean}
     */
    hasListenerForEventName(eventName)
    {
        return this._eventCallbacks[eventName] && this._eventCallbacks[eventName].length > 0;
    }

    /** @deprecated */
    removeEventListener(id)
    {
        return this.off(id);
    }

    /**
     * remove event listener registration
     * @param {string} id event id
     * @return
     */
    off(id)
    {
        if (id === null || id === undefined)
        {
            this.#eventLog.warn("removeEventListener id null", id);
            return;
        }

        if (typeof id == "string") // new style, remove by id, not by name/callback
        {
            const event = this._listeners[id];
            if (!event)
            {
                if (this._countErrorUnknowns == 20) this.#eventLog.warn("stopped reporting unknown events");
                if (this._countErrorUnknowns < 20) this.#eventLog.warn("could not find event...", id);
                this._countErrorUnknowns++;
                return;
            }

            let removeCount = 0;

            let found = true;
            while (found)
            {
                found = false;
                let index = -1;
                for (let i = 0; i < this._eventCallbacks[event.name].length; i++)
                {
                    if (this._eventCallbacks[event.name][i].id.indexOf(id) === 0) // this._eventCallbacks[event.name][i].id == which ||
                    {
                        found = true;
                        index = i;
                    }
                }

                if (index !== -1)
                {
                    this._eventCallbacks[event.name].splice(index, 1);
                    delete this._listeners[id];
                    removeCount++;
                }
            }

            if (removeCount == 0)console.log("no events removed", event.name, id);

            return;
        }
        else
        {
            console.log("old function signature: removeEventListener! use listener id");
        }
    }

    /**
     * enable/disable logging of events for the class
     *
     * @param {boolean} enabled
     * @param {string} logName
     */
    logEvents(enabled, logName)
    {
        this._logEvents = enabled;
        this._logName = logName;
    }

    /**
     * emit event
     *
     * @param {string} which event name
     * @param {*} param1
     * @param {*} param2
     * @param {*} param3
     * @param {*} param4
     * @param {*} param5
     * @param {*} param6
     */
    emitEvent(which, param1 = null, param2 = null, param3 = null, param4 = null, param5 = null, param6 = null)
    {
        if (this._logEvents) this.#eventLog.log("[event] ", this._logName, which, this._eventCallbacks);

        if (this._eventCallbacks[which])
        {
            for (let i = 0; i < this._eventCallbacks[which].length; i++)
            {
                if (this._eventCallbacks[which][i])
                {
                    this._eventCallbacks[which][i].cb(param1, param2, param3, param4, param5, param6);
                }
            }
        }
        else
        {
            if (this._logEvents) this.#eventLog.log("[event] has no event callback", which, this._eventCallbacks);
        }
    }
}

;// CONCATENATED MODULE: ./src/core/anim_key.js


class AnimKey
{
    constructor(obj, an)
    {
        this.id = CABLES.shortId();
        this.time = 0.0;
        this.value = 0.0;
        this.selected = false;

        this.anim = obj.anim || an || null;

        // this.ui = null;
        this.onChange = null;
        this._easing = 0;
        // this.bezTangIn = 0;
        // this.bezTangOut = 0;
        // this.bezTime = 0.5;
        // this.bezValue = 0;
        // this.bezTimeIn = -0.5;
        // this.bezValueIn = 0;

        this.cb = null;
        this.cbTriggered = false;

        // const bezierAnim = null;
        // this._updateBezier = false;

        this.setEasing(Anim.EASING_LINEAR);
        this.set(obj);
    }

    delete()
    {
        if (this.anim) this.anim.remove(this);
        else console.log("animkey without anim...");
    }

    /**
     * @param {Number} e
     */
    setEasing(e)
    {
        this._easing = e;

        if (this._easing == Anim.EASING_LINEAR) this.ease = AnimKey.easeLinear;
        else if (this._easing == Anim.EASING_ABSOLUTE) this.ease = AnimKey.easeAbsolute;
        else if (this._easing == Anim.EASING_SMOOTHSTEP) this.ease = AnimKey.easeSmoothStep;
        else if (this._easing == Anim.EASING_SMOOTHERSTEP) this.ease = AnimKey.easeSmootherStep;
        else if (this._easing == Anim.EASING_CUBIC_IN) this.ease = AnimKey.easeCubicIn;
        else if (this._easing == Anim.EASING_CUBIC_OUT) this.ease = AnimKey.easeCubicOut;
        else if (this._easing == Anim.EASING_CUBIC_INOUT) this.ease = AnimKey.easeCubicInOut;
        else if (this._easing == Anim.EASING_EXPO_IN) this.ease = AnimKey.easeExpoIn;
        else if (this._easing == Anim.EASING_EXPO_OUT) this.ease = AnimKey.easeExpoOut;
        else if (this._easing == Anim.EASING_EXPO_INOUT) this.ease = AnimKey.easeExpoInOut;
        else if (this._easing == Anim.EASING_SIN_IN) this.ease = AnimKey.easeSinIn;
        else if (this._easing == Anim.EASING_SIN_OUT) this.ease = AnimKey.easeSinOut;
        else if (this._easing == Anim.EASING_SIN_INOUT) this.ease = AnimKey.easeSinInOut;
        else if (this._easing == Anim.EASING_BACK_OUT) this.ease = AnimKey.easeOutBack;
        else if (this._easing == Anim.EASING_BACK_IN) this.ease = AnimKey.easeInBack;
        else if (this._easing == Anim.EASING_BACK_INOUT) this.ease = AnimKey.easeInOutBack;
        else if (this._easing == Anim.EASING_ELASTIC_IN) this.ease = AnimKey.easeInElastic;
        else if (this._easing == Anim.EASING_ELASTIC_OUT) this.ease = AnimKey.easeOutElastic;
        // else if (this._easing == Anim.EASING_ELASTIC_INOUT) this.ease = AnimKey.easeElasticInOut;
        else if (this._easing == Anim.EASING_BOUNCE_IN) this.ease = AnimKey.easeInBounce;
        else if (this._easing == Anim.EASING_BOUNCE_OUT) this.ease = AnimKey.easeOutBounce;
        else if (this._easing == Anim.EASING_QUART_OUT) this.ease = AnimKey.easeOutQuart;
        else if (this._easing == Anim.EASING_QUART_IN) this.ease = AnimKey.easeInQuart;
        else if (this._easing == Anim.EASING_QUART_INOUT) this.ease = AnimKey.easeInOutQuart;
        else if (this._easing == Anim.EASING_QUINT_OUT) this.ease = AnimKey.easeOutQuint;
        else if (this._easing == Anim.EASING_QUINT_IN) this.ease = AnimKey.easeInQuint;
        else if (this._easing == Anim.EASING_QUINT_INOUT) this.ease = AnimKey.easeInOutQuint;
        else if (this._easing == Anim.EASING_CUBICSPLINE)
        {
            // this._updateBezier = true;
            this.ease = AnimKey.easeCubicSpline;
        }
        else
        {
            this._easing = Anim.EASING_LINEAR;
            this.ease = AnimKey.easeLinear;
        }
    }

    trigger()
    {
        this.cb();
        this.cbTriggered = true;
    }

    setValue(v)
    {
        this.value = v;
        if (this.onChange !== null) this.onChange();
    }

    set(obj)
    {
        if (obj)
        {
            if (obj.e) this.setEasing(obj.e);
            if (obj.cb)
            {
                this.cb = obj.cb;
                this.cbTriggered = false;
            }

            if (obj.b)
            {
                // this.bezTime = obj.b[0];
                // this.bezValue = obj.b[1];
                // this.bezTimeIn = obj.b[2];
                // this.bezValueIn = obj.b[3];
                // this._updateBezier = true;
            }

            if (obj.hasOwnProperty("t")) this.time = obj.t;
            if (obj.hasOwnProperty("time")) this.time = obj.time;
            if (obj.hasOwnProperty("v")) this.value = obj.v;
            else if (obj.hasOwnProperty("value")) this.value = obj.value;
        }
        if (this.onChange !== null) this.onChange();
    }

    /**
   * @returns {Object}
   */
    getSerialized()
    {
        const obj = {};
        obj.t = this.time;
        obj.v = this.value;
        obj.e = this._easing;

        return obj;
    }

    getEasing()
    {
        return this._easing;
    }
}

AnimKey.cubicSpline = function (perc, key1, key2)
{
    let
        previousPoint = key1.value,
        previousTangent = key1.bezTangOut,
        nextPoint = key2.value,
        nextTangent = key2.bezTangIn;
    let t = perc;
    let t2 = t * t;
    let t3 = t2 * t;

    return (2 * t3 - 3 * t2 + 1) * previousPoint + (t3 - 2 * t2 + t) * previousTangent + (-2 * t3 + 3 * t2) * nextPoint + (t3 - t2) * nextTangent;
};

AnimKey.easeCubicSpline = function (perc, key2)
{
    return AnimKey.cubicSpline(perc, this, key2);
};

AnimKey.linear = function (perc, key1, key2)
{
    return parseFloat(key1.value) + parseFloat(key2.value - key1.value) * perc;
};

AnimKey.easeLinear = function (perc, key2)
{
    return AnimKey.linear(perc, this, key2);
};

AnimKey.easeAbsolute = function (perc, key2)
{
    return this.value;
};

const easeExpoIn = function (t)
{
    return (t = 2 ** (10 * (t - 1)));
};

AnimKey.easeExpoIn = function (t, key2)
{
    t = easeExpoIn(t);
    return AnimKey.linear(t, this, key2);
};

const easeExpoOut = function (t)
{
    t = -(2 ** (-10 * t)) + 1;
    return t;
};

AnimKey.easeExpoOut = function (t, key2)
{
    t = easeExpoOut(t);
    return AnimKey.linear(t, this, key2);
};

const easeExpoInOut = function (t)
{
    t *= 2;
    if (t < 1)
    {
        t = 0.5 * 2 ** (10 * (t - 1));
    }
    else
    {
        t--;
        t = 0.5 * (-(2 ** (-10 * t)) + 2);
    }
    return t;
};

AnimKey.easeExpoInOut = function (t, key2)
{
    t = easeExpoInOut(t);
    return AnimKey.linear(t, this, key2);
};

AnimKey.easeSinIn = function (t, key2)
{
    t = -1 * Math.cos((t * Math.PI) / 2) + 1;
    return AnimKey.linear(t, this, key2);
};

AnimKey.easeSinOut = function (t, key2)
{
    t = Math.sin((t * Math.PI) / 2);
    return AnimKey.linear(t, this, key2);
};

AnimKey.easeSinInOut = function (t, key2)
{
    t = -0.5 * (Math.cos(Math.PI * t) - 1.0);
    return AnimKey.linear(t, this, key2);
};

const easeCubicIn = function (t)
{
    t = t * t * t;
    return t;
};

AnimKey.easeCubicIn = function (t, key2)
{
    t = easeCubicIn(t);
    return AnimKey.linear(t, this, key2);
};

// b 0
// c 1/2 or 1
// d always 1
// easeOutCubic: function (x, t, b, c, d) {
//     return c*((t=t/d-1)*t*t + 1) + b;

AnimKey.easeInQuint = function (t, key2)
{
    t = t * t * t * t * t;
    return AnimKey.linear(t, this, key2);
};
AnimKey.easeOutQuint = function (t, key2)
{
    t = (t -= 1) * t * t * t * t + 1;
    return AnimKey.linear(t, this, key2);
};
AnimKey.easeInOutQuint = function (t, key2)
{
    if ((t /= 0.5) < 1) t = 0.5 * t * t * t * t * t;
    else t = 0.5 * ((t -= 2) * t * t * t * t + 2);
    return AnimKey.linear(t, this, key2);
};

AnimKey.easeInQuart = function (t, key2)
{
    t = t * t * t * t;
    return AnimKey.linear(t, this, key2);
};

AnimKey.easeOutQuart = function (t, key2)
{
    // return -c * ((t=t/d-1)*t*t*t - 1) + b;
    t = -1 * ((t -= 1) * t * t * t - 1);
    return AnimKey.linear(t, this, key2);
};

AnimKey.easeInOutQuart = function (t, key2)
{
    if ((t /= 0.5) < 1) t = 0.5 * t * t * t * t;
    else t = -0.5 * ((t -= 2) * t * t * t - 2);
    return AnimKey.linear(t, this, key2);
};

AnimKey.bounce = function (t)
{
    if ((t /= 1) < 1 / 2.75) t = 7.5625 * t * t;
    else if (t < 2 / 2.75) t = 7.5625 * (t -= 1.5 / 2.75) * t + 0.75;
    else if (t < 2.5 / 2.75) t = 7.5625 * (t -= 2.25 / 2.75) * t + 0.9375;
    else t = 7.5625 * (t -= 2.625 / 2.75) * t + 0.984375;
    return t;
};

AnimKey.easeInBounce = function (t, key2)
{
    return AnimKey.linear(AnimKey.bounce(t), this, key2);
    // return c - jQuery.easing.easeOutBounce (x, d-t, 0, c, d);
};

AnimKey.easeOutBounce = function (t, key2)
{
    return AnimKey.linear(AnimKey.bounce(t), this, key2);
};

AnimKey.easeInElastic = function (t, key2)
{
    let s = 1.70158;
    let p = 0;
    let a = 1;

    const b = 0;
    const d = 1;
    const c = 1;

    if (t === 0) t = b;
    else if ((t /= d) == 1) t = b + c;
    else
    {
        if (!p) p = d * 0.3;
        if (a < Math.abs(c))
        {
            a = c;
            s = p / 4;
        }
        else s = (p / (2 * Math.PI)) * Math.asin(c / a);
        t = -(a * 2 ** (10 * (t -= 1)) * Math.sin(((t * d - s) * (2 * Math.PI)) / p)) + b;
    }

    return AnimKey.linear(t, this, key2);
};

AnimKey.easeOutElastic = function (t, key2)
{
    let s = 1.70158;
    let p = 0;
    let a = 1;

    const b = 0;
    const d = 1;
    const c = 1;

    if (t === 0) t = b;
    else if ((t /= d) == 1) t = b + c;
    else
    {
        if (!p) p = d * 0.3;
        if (a < Math.abs(c))
        {
            a = c;
            s = p / 4;
        }
        else s = (p / (2 * Math.PI)) * Math.asin(c / a);
        t = a * 2 ** (-10 * t) * Math.sin(((t * d - s) * (2 * Math.PI)) / p) + c + b;
    }

    return AnimKey.linear(t, this, key2);
};

AnimKey.easeInBack = function (t, key2)
{
    const s = 1.70158;
    t = t * t * ((s + 1) * t - s);

    return AnimKey.linear(t, this, key2);
};

AnimKey.easeOutBack = function (t, key2)
{
    const s = 1.70158;
    t = (t = t / 1 - 1) * t * ((s + 1) * t + s) + 1;

    return AnimKey.linear(t, this, key2);
};

AnimKey.easeInOutBack = function (t, key2)
{
    let s = 1.70158;
    const c = 1 / 2;
    if ((t /= 1 / 2) < 1) t = c * (t * t * (((s *= 1.525) + 1) * t - s));
    else t = c * ((t -= 2) * t * (((s *= 1.525) + 1) * t + s) + 2);

    return AnimKey.linear(t, this, key2);
};

const easeCubicOut = function (t)
{
    t--;
    t = t * t * t + 1;
    return t;
};

AnimKey.easeCubicOut = function (t, key2)
{
    t = easeCubicOut(t);
    return AnimKey.linear(t, this, key2);
};

const easeCubicInOut = function (t)
{
    t *= 2;
    if (t < 1) t = 0.5 * t * t * t;
    else
    {
        t -= 2;
        t = 0.5 * (t * t * t + 2);
    }
    return t;
};

AnimKey.easeCubicInOut = function (t, key2)
{
    t = easeCubicInOut(t);
    return AnimKey.linear(t, this, key2);
};

AnimKey.easeSmoothStep = function (perc, key2)
{
    // var x = Math.max(0, Math.min(1, (perc-0)/(1-0)));
    const x = Math.max(0, Math.min(1, perc));
    perc = x * x * (3 - 2 * x); // smoothstep
    return AnimKey.linear(perc, this, key2);
};

AnimKey.easeSmootherStep = function (perc, key2)
{
    const x = Math.max(0, Math.min(1, (perc - 0) / (1 - 0)));
    perc = x * x * x * (x * (x * 6 - 15) + 10); // smootherstep
    return AnimKey.linear(perc, this, key2);
};

;// CONCATENATED MODULE: ./src/core/anim.js






/**
 * configuration object for loading a patch
 * @typedef {Object} AnimCfg
 * @property {number} [defaultEasing] use easing index as default
 * @property {string} [name] anim name
 */

/**
 * Keyframed interpolated animation.
 *
 * @class
 * @param cfg
 * @example
 * var anim=new CABLES.Anim();
 * anim.setValue(0,0);  // set value 0 at 0 seconds
 * anim.setValue(10,1); // set value 1 at 10 seconds
 * anim.getValue(5);    // get value at 5 seconds - this returns 0.5
 */

class Anim extends Events
{
    static EASING_LINEAR = 0;
    static EASING_ABSOLUTE = 1;
    static EASING_SMOOTHSTEP = 2;
    static EASING_SMOOTHERSTEP = 3;
    static EASING_CUBICSPLINE = 4;

    static EASING_CUBIC_IN = 5;
    static EASING_CUBIC_OUT = 6;
    static EASING_CUBIC_INOUT = 7;

    static EASING_EXPO_IN = 8;
    static EASING_EXPO_OUT = 9;
    static EASING_EXPO_INOUT = 10;

    static EASING_SIN_IN = 11;
    static EASING_SIN_OUT = 12;
    static EASING_SIN_INOUT = 13;

    static EASING_BACK_IN = 14;
    static EASING_BACK_OUT = 15;
    static EASING_BACK_INOUT = 16;

    static EASING_ELASTIC_IN = 17;
    static EASING_ELASTIC_OUT = 18;

    static EASING_BOUNCE_IN = 19;
    static EASING_BOUNCE_OUT = 21;

    static EASING_QUART_IN = 22;
    static EASING_QUART_OUT = 23;
    static EASING_QUART_INOUT = 24;

    static EASING_QUINT_IN = 25;
    static EASING_QUINT_OUT = 26;
    static EASING_QUINT_INOUT = 27;

    static EASINGNAMES = ["linear", "absolute", "smoothstep", "smootherstep", "Cubic In", "Cubic Out", "Cubic In Out", "Expo In", "Expo Out", "Expo In Out", "Sin In", "Sin Out", "Sin In Out", "Quart In", "Quart Out", "Quart In Out", "Quint In", "Quint Out", "Quint In Out", "Back In", "Back Out", "Back In Out", "Elastic In", "Elastic Out", "Bounce In", "Bounce Out"];

    /**
     * @param {AnimCfg} cfg
     */
    constructor(cfg)
    {
        super();
        cfg = cfg || {};
        this.id = uuid();
        this.keys = [];
        this.onChange = null;
        this.stayInTimeline = false;
        this.loop = false;
        this._log = new Logger("Anim");
        this._lastKeyIndex = 0;
        this._cachedIndex = 0;
        this.name = cfg.name || null;

        /**
         * @type {Number}
         */
        this.defaultEasing = cfg.defaultEasing || Anim.EASING_LINEAR;
        this.onLooped = null;

        this._timesLooped = 0;
        this._needsSort = false;
    }

    forceChangeCallback()
    {
        if (this.onChange !== null) this.onChange();
        this.emitEvent("onChange", this);
    }

    getLoop()
    {
        return this.loop;
    }

    setLoop(target)
    {
        this.loop = target;
        this.emitEvent("onChange", this);
    }

    /**
     * returns true if animation has ended at @time
     * checks if last key time is < time
     * @param {Number} time
     * @returns {Boolean}
     * @memberof Anim
     * @instance
     * @function
     */
    hasEnded(time)
    {
        if (this.keys.length === 0) return true;
        if (this.keys[this._lastKeyIndex].time <= time) return true;
        return false;
    }

    /**
     * @param {number} time
     */
    isRising(time)
    {
        if (this.hasEnded(time)) return false;
        const ki = this.getKeyIndex(time);
        if (this.keys[ki].value < this.keys[ki + 1].value) return true;
        return false;
    }

    /**
     * remove all keys from animation before time
     * @param {Number} time
     * @memberof Anim
     * @instance
     * @function
     */
    clearBefore(time)
    {
        const v = this.getValue(time);
        const ki = this.getKeyIndex(time);

        this.setValue(time, v);

        if (ki > 1) this.keys.splice(0, ki);
        this._updateLastIndex();
    }

    /**
     * remove all keys from animation
     * @param {Number} [time=0] set a new key at time with the old value at time
     * @memberof Anim
     * @instance
     * @function
     */
    clear(time)
    {
        let v = 0;
        if (time) v = this.getValue(time);
        this.keys.length = 0;
        this._updateLastIndex();
        if (time) this.setValue(time, v);
        if (this.onChange !== null) this.onChange();
        this.emitEvent("onChange", this);
    }

    sortKeys()
    {
        this.keys.sort((a, b) => { return parseFloat(a.time) - parseFloat(b.time); });
        this._updateLastIndex();
        this._needsSort = false;
        if (this.keys.length > 999 && this.keys.length % 1000 == 0)console.log(this.name, this.keys.length);
    }

    hasDuplicates()
    {
        const test = {};
        let count = 0;
        for (let i = 0; i < this.keys.length; i++)
        {
            test[this.keys[i].time] = 1;
            count++;
        }

        const keys = Object.keys(test);
        if (keys.length != count)
        {
            return true;
        }
        return false;
    }

    removeDuplicates()
    {
        if (this.hasDuplicates())
        {
            this.sortKeys();
            let count = 0;

            while (this.hasDuplicates())
            {
                for (let i = 0; i < this.keys.length - 1; i++)
                {
                    if (this.keys[i].time == this.keys[i + 1].time) this.keys.splice(i, 1);
                    count++;
                }
            }
            this._updateLastIndex();
        }
    }

    getLength()
    {
        if (this.keys.length === 0) return 0;
        return this.keys[this.keys.length - 1].time;
    }

    /**
     * @param {number} time
     */
    getKeyIndex(time)
    {
        let index = 0;
        let start = 0;
        if (this._cachedIndex && this.keys.length > this._cachedIndex && time >= this.keys[this._cachedIndex].time) start = this._cachedIndex;
        for (let i = start; i < this.keys.length; i++)
        {
            if (time >= this.keys[i].time) index = i;
            if (this.keys[i].time > time)
            {
                if (time != 0) this._cachedIndex = index;
                return index;
            }
        }

        return index;
    }

    /**
     * set value at time
     * @function setValue
     * @memberof Anim
     * @instance
     * @param {Number} time
     * @param {Number} value
     * @param {Function} cb callback
     */
    setValue(time, value, cb = null)
    {
        let found = null;

        if (this.keys.length == 0 || time <= this.keys[this.keys.length - 1].time)
            for (let i = 0; i < this.keys.length; i++)
                if (this.keys[i].time == time)
                {
                    found = this.keys[i];
                    this.keys[i].setValue(value);
                    this.keys[i].cb = cb;
                    break;
                }

        if (!found)
        {
            found = new AnimKey(
                {
                    "time": time,
                    "value": value,
                    "e": this.defaultEasing,
                    "cb": cb,
                    "anim": this
                });
            this.keys.push(found);

            // if (this.keys.length % 1000 == 0)console.log(this.name, this.keys.length);
            this._updateLastIndex();
        }

        if (this.onChange) this.onChange();
        this.emitEvent("onChange", this);
        this._needsSort = true;
        return found;
    }

    /**
     * @param {number} index
     * @param {number} easing
     */
    setKeyEasing(index, easing)
    {
        if (this.keys[index])
        {
            this.keys[index].setEasing(easing);
            this.emitEvent("onChange", this);
        }
    }

    /**
     * @returns {Object}
     */
    getSerialized()
    {
        const obj = {};
        obj.keys = [];
        obj.loop = this.loop;

        for (let i = 0; i < this.keys.length; i++)
            obj.keys.push(this.keys[i].getSerialized());

        return obj;
    }

    /**
     * @param {number} time
     */
    getKey(time)
    {
        const index = this.getKeyIndex(time);
        return this.keys[index];
    }

    /**
     * @param {number} time
     */
    getNextKey(time)
    {
        let index = this.getKeyIndex(time) + 1;
        if (index >= this.keys.length) index = this.keys.length - 1;

        return this.keys[index];
    }

    /**
     * @param {number} time
     */
    isFinished(time)
    {
        if (this.keys.length <= 0) return true;
        return time > this.keys[this.keys.length - 1].time;
    }

    /**
     * @param {number} time
     */
    isStarted(time)
    {
        if (this.keys.length <= 0) return false;
        return time >= this.keys[0].time;
    }

    /**
     * @param {AnimKey} k
     */
    remove(k)
    {
        for (let i = 0; i < this.keys.length; i++)
        {
            if (this.keys[i] == k)
            {
                this.keys.splice(i, 1);
                this._updateLastIndex();
                return;
            }
        }
        console.log("key remove not found", k);
    }

    /**
     * get value at time
     * @function getValue
     * @memberof Anim
     * @instance
     * @param {Number} [time] time
     * @returns {Number} interpolated value at time
     */
    getValue(time)
    {
        if (this.keys.length === 0)
        {
            return 0;
        }
        if (this._needsSort) this.sortKeys();

        if (!this.loop && time > this.keys[this._lastKeyIndex].time)
        {
            if (this.keys[this._lastKeyIndex].cb && !this.keys[this._lastKeyIndex].cbTriggered) this.keys[this._lastKeyIndex].trigger();

            return this.keys[this._lastKeyIndex].value;
        }

        if (time < this.keys[0].time)
        {
            return this.keys[0].value;
        }

        if (this.loop && time > this.keys[this._lastKeyIndex].time)
        {
            const currentLoop = time / this.keys[this._lastKeyIndex].time;
            if (currentLoop > this._timesLooped)
            {
                this._timesLooped++;
                if (this.onLooped) this.onLooped();
            }
            time = (time - this.keys[0].time) % (this.keys[this._lastKeyIndex].time - this.keys[0].time);
            time += this.keys[0].time;
        }

        const index = this.getKeyIndex(time);
        if (index >= this._lastKeyIndex)
        {
            if (this.keys[this._lastKeyIndex].cb && !this.keys[this._lastKeyIndex].cbTriggered) this.keys[this._lastKeyIndex].trigger();

            return this.keys[this._lastKeyIndex].value;
        }

        const index2 = index + 1;
        const key1 = this.keys[index];
        const key2 = this.keys[index2];

        if (key1.cb && !key1.cbTriggered) key1.trigger();

        if (!key2) return -1;

        const perc = (time - key1.time) / (key2.time - key1.time);

        return key1.ease(perc, key2);
    }

    _updateLastIndex()
    {
        this._lastKeyIndex = this.keys.length - 1;
    }

    /**
     * @param {AnimKey} k
     */
    addKey(k)
    {
        if (k.time === undefined)
        {
            this._log.warn("key time undefined, ignoring!");
        }
        else
        {
            this.keys.push(k);
            if (this.onChange !== null) this.onChange();
            this.emitEvent("onChange", this);
            this._needsSort = true;
        }
        this._updateLastIndex();
    }

    /**
     * @param {string} str
     */
    easingFromString(str)
    {
        // todo smarter way to map ?
        if (str == "linear") return Anim.EASING_LINEAR;
        if (str == "absolute") return Anim.EASING_ABSOLUTE;
        if (str == "smoothstep") return Anim.EASING_SMOOTHSTEP;
        if (str == "smootherstep") return Anim.EASING_SMOOTHERSTEP;

        if (str == "Cubic In") return Anim.EASING_CUBIC_IN;
        if (str == "Cubic Out") return Anim.EASING_CUBIC_OUT;
        if (str == "Cubic In Out") return Anim.EASING_CUBIC_INOUT;

        if (str == "Expo In") return Anim.EASING_EXPO_IN;
        if (str == "Expo Out") return Anim.EASING_EXPO_OUT;
        if (str == "Expo In Out") return Anim.EASING_EXPO_INOUT;

        if (str == "Sin In") return Anim.EASING_SIN_IN;
        if (str == "Sin Out") return Anim.EASING_SIN_OUT;
        if (str == "Sin In Out") return Anim.EASING_SIN_INOUT;

        if (str == "Back In") return Anim.EASING_BACK_IN;
        if (str == "Back Out") return Anim.EASING_BACK_OUT;
        if (str == "Back In Out") return Anim.EASING_BACK_INOUT;

        if (str == "Elastic In") return Anim.EASING_ELASTIC_IN;
        if (str == "Elastic Out") return Anim.EASING_ELASTIC_OUT;

        if (str == "Bounce In") return Anim.EASING_BOUNCE_IN;
        if (str == "Bounce Out") return Anim.EASING_BOUNCE_OUT;

        if (str == "Quart Out") return Anim.EASING_QUART_OUT;
        if (str == "Quart In") return Anim.EASING_QUART_IN;
        if (str == "Quart In Out") return Anim.EASING_QUART_INOUT;

        if (str == "Quint Out") return Anim.EASING_QUINT_OUT;
        if (str == "Quint In") return Anim.EASING_QUINT_IN;
        if (str == "Quint In Out") return Anim.EASING_QUINT_INOUT;

        console.log("unknown anim easing?", str);
    }

    /**
     * @param {Op} op
     * @param {string} title
     * @param {function} cb
     * @returns {Port}
     */
    createPort(op, title, cb)
    {
        const port = op.inDropDown(title, Anim.EASINGNAMES, "linear");
        port.set("linear");
        port.defaultValue = "linear";

        port.onChange = () =>
        {
            this.defaultEasing = this.easingFromString(port.get());
            this.emitEvent("onChangeDefaultEasing", this);

            if (cb) cb();
        };

        return port;
    }
}

// ------------------------------

/**
 * @param {number} time
 * @param {number} q
 * @param {number} animx
 * @param {number} animy
 * @param {number} animz
 * @param {number} animw
 */
Anim.slerpQuaternion = function (time, q, animx, animy, animz, animw)
{
    if (!Anim.slerpQuaternion.q1)
    {
        Anim.slerpQuaternion.q1 = quat.create();
        Anim.slerpQuaternion.q2 = quat.create();
    }

    const i1 = animx.getKeyIndex(time);
    let i2 = i1 + 1;
    if (i2 >= animx.keys.length) i2 = animx.keys.length - 1;

    if (i1 == i2)
    {
        quat.set(q, animx.keys[i1].value, animy.keys[i1].value, animz.keys[i1].value, animw.keys[i1].value);
    }
    else
    {
        const key1Time = animx.keys[i1].time;
        const key2Time = animx.keys[i2].time;
        const perc = (time - key1Time) / (key2Time - key1Time);

        quat.set(Anim.slerpQuaternion.q1, animx.keys[i1].value, animy.keys[i1].value, animz.keys[i1].value, animw.keys[i1].value);

        quat.set(Anim.slerpQuaternion.q2, animx.keys[i2].value, animy.keys[i2].value, animz.keys[i2].value, animw.keys[i2].value);

        quat.slerp(q, Anim.slerpQuaternion.q1, Anim.slerpQuaternion.q2, perc);
    }
    return q;
};

;// CONCATENATED MODULE: ./src/core/constants.js


const CONSTANTS = {
    "ANIM": {
        "EASINGS": Anim.EASINGNAMES,
        "EASING_LINEAR": 0,
        "EASING_ABSOLUTE": 1,
        "EASING_SMOOTHSTEP": 2,
        "EASING_SMOOTHERSTEP": 3,
        "EASING_CUBICSPLINE": 4,

        "EASING_CUBIC_IN": 5,
        "EASING_CUBIC_OUT": 6,
        "EASING_CUBIC_INOUT": 7,

        "EASING_EXPO_IN": 8,
        "EASING_EXPO_OUT": 9,
        "EASING_EXPO_INOUT": 10,

        "EASING_SIN_IN": 11,
        "EASING_SIN_OUT": 12,
        "EASING_SIN_INOUT": 13,

        "EASING_BACK_IN": 14,
        "EASING_BACK_OUT": 15,
        "EASING_BACK_INOUT": 16,

        "EASING_ELASTIC_IN": 17,
        "EASING_ELASTIC_OUT": 18,

        "EASING_BOUNCE_IN": 19,
        "EASING_BOUNCE_OUT": 21,

        "EASING_QUART_IN": 22,
        "EASING_QUART_OUT": 23,
        "EASING_QUART_INOUT": 24,

        "EASING_QUINT_IN": 25,
        "EASING_QUINT_OUT": 26,
        "EASING_QUINT_INOUT": 27,
    },

    "OP": {
        "OP_PORT_TYPE_VALUE": 0,
        "OP_PORT_TYPE_NUMBER": 0,
        "OP_PORT_TYPE_FUNCTION": 1,
        "OP_PORT_TYPE_TRIGGER": 1,
        "OP_PORT_TYPE_OBJECT": 2,
        "OP_PORT_TYPE_TEXTURE": 2,
        "OP_PORT_TYPE_ARRAY": 3,
        "OP_PORT_TYPE_DYNAMIC": 4,
        "OP_PORT_TYPE_STRING": 5,

        "OP_VERSION_PREFIX": "_v",
    },

    "PORT": {
        "PORT_DIR_IN": 0,
        "PORT_DIR_OUT": 1,
    },

    "PACO": {
        "PACO_CLEAR": 0,
        "PACO_VALUECHANGE": 1,
        "PACO_OP_DELETE": 2,
        "PACO_UNLINK": 3,
        "PACO_LINK": 4,
        "PACO_LOAD": 5,
        "PACO_OP_CREATE": 6,
        "PACO_OP_ENABLE": 7,
        "PACO_OP_DISABLE": 8,
        "PACO_UIATTRIBS": 9,
        "PACO_VARIABLES": 10,
        "PACO_TRIGGERS": 11,
        "PACO_PORT_SETVARIABLE": 12,
        "PACO_PORT_SETANIMATED": 13,
        "PACO_PORT_ANIM_UPDATED": 14,
        "PACO_DESERIALIZE": 15,
        "PACO_OP_RELOAD": 16
    },
};

;// CONCATENATED MODULE: ./src/core/extendjs.js
/**
 * extend javascript functionality
 */

/**
 * @external Math
 */

/**
 * set random seed for seededRandom()
 * @type Number
 * @static
 */
Math.randomSeed = 1;

/**
 * @function external:Math#setRandomSeed
 * @param {number} seed
 */
Math.setRandomSeed = function (seed)
{
    // https://github.com/cables-gl/cables_docs/issues/622
    Math.randomSeed = seed * 50728129;
    if (seed != 0)
    {
        Math.randomSeed = Math.seededRandom() * 17624813;
        Math.randomSeed = Math.seededRandom() * 9737333;
    }
};

/**
 * generate a seeded random number
 * @function seededRandom
 * @memberof Math
 * @param {Number} max minimum possible random number
 * @param {Number} min maximum possible random number
 * @return {Number} random value
 * @static
 */
Math.seededRandom = function (max, min)
{
    if (Math.randomSeed === 0) Math.randomSeed = Math.random() * 999;
    max = max || 1;
    min = min || 0;

    Math.randomSeed = (Math.randomSeed * 9301 + 49297) % 233280;
    const rnd = Math.randomSeed / 233280.0;

    return min + rnd * (max - min);
};

/**
     * @namespace String
     */

/**
 * append a linebreak to a string
 * @function endl
 * @extends String
 * @return {String} string with newline break appended ('\n')
 */
String.prototype.endl = function ()
{
    return this + "\n";
};

String.prototype.contains = function (str)
{
    console.warn("string.contains deprecated, use string.includes");
    console.log((new Error()).stack);
    return this.includes(str);

};

function extendJs()
{

}

;// CONCATENATED MODULE: ./src/core/utils.js
/**
 * @namespace external:CABLES#Utils
 */




extendJs();

/**
 * Merge two Float32Arrays.
 * @function float32Concat
 * @param {Float32Array} first Left-hand side array
 * @param {Float32Array} second Right-hand side array
 * @return {Float32Array}
 * @static
 */
function float32Concat(first, second)
{
    if (!(first instanceof Float32Array)) first = new Float32Array(first);
    if (!(second instanceof Float32Array)) second = new Float32Array(second);

    const result = new Float32Array(first.length + second.length);

    result.set(first);
    result.set(second, first.length);

    return result;
}

/**
 * get op shortname: only last part of fullname and without version
 * @function getShortOpName
 * @memberof CABLES
 * @param {string} fullname full op name
 * @static
 */
const getShortOpName = function (fullname)
{
    let name = fullname.split(".")[fullname.split(".").length - 1];

    if (name.includes(CONSTANTS.OP.OP_VERSION_PREFIX))
    {
        const n = name.split(CONSTANTS.OP.OP_VERSION_PREFIX)[1];
        name = name.substring(0, name.length - (CONSTANTS.OP.OP_VERSION_PREFIX + n).length);
    }
    return name;
};

/**
 * randomize order of an array
 * @function shuffleArray
 * @param {Array|Float32Array} array {Array} original
 * @return {Array|Float32Array} shuffled array
 * @static
 */
const shuffleArray = function (array)
{
    for (let i = array.length - 1; i > 0; i--)
    {
        const j = Math.floor(Math.seededRandom() * (i + 1));
        const temp = array[i];
        array[i] = array[j];
        array[j] = temp;
    }
    return array;
};

/**
 * generate a short "relativly unique" id
 * @function shortId
 * @return {String} generated ID
 * @static
 */

const _shortIds = {};
const shortId = function ()
{
    let str = Math.random().toString(36).substr(2, 9);

    if (_shortIds.hasOwnProperty(str)) str = shortId();
    _shortIds[str] = true;
    return str;
};

/**
 * @typedef {String} UUID
*/

/**
 * generate a UUID
 * @function uuid
 * @return {UUID} generated UUID
 * @static
 */
const uuid = function ()
{
    let d = new Date().getTime();
    const uuidStr = "xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g, (c) =>
    {
        const r = (d + Math.random() * 16) % 16 | 0;
        d = Math.floor(d / 16);
        return (c == "x" ? r : (r & 0x3) | 0x8).toString(16);
    });
    return uuidStr;
};
const generateUUID = uuid;

function cleanJson(obj)
{
    for (const i in obj)
    {
        if (obj[i] && typeof objValue === "object" && obj[i].constructor === Object) obj[i] = cleanJson(obj[i]);

        if (obj[i] === null || obj[i] === undefined) delete obj[i];
        else if (Array.isArray(obj[i]) && obj[i].length == 0) delete obj[i];
    }

    return obj;
}

/**
 * @see http://stackoverflow.com/q/7616461/940217
 * @param {string} str
 * @param {string} prefix
 * @return {string}
 */
const prefixedHash = function (str, prefix = "id")
{
    let hash = 0;
    if (str.length > 0)
    {
        for (let i = 0; i < str.length; i++)
        {
            let character = str.charCodeAt(i);
            hash = ((hash << 5) - hash) + character;
            hash &= hash; // Convert to 32bit integer
        }
    }
    return prefix + "" + hash;
};

/**
 * generate a simple ID
 * @function simpleId
 * @return {Number} new id
 * @static
 */
let simpleIdCounter = 0;
const simpleId = function ()
{
    simpleIdCounter++;
    return simpleIdCounter;
};

/**
 * smoothStep a value
 * @function smoothStep
 * @function
 * @param {Number} perc value value to be smoothed [0-1]
 * @return {Number} smoothed value
 * @static
 */
const smoothStep = function (perc)
{
    const x = Math.max(0, Math.min(1, (perc - 0) / (1 - 0)));
    perc = x * x * (3 - 2 * x); // smoothstep
    return perc;
};

/**
 * smootherstep a value
 * @function smootherStep
 * @param {Number} perc value to be smoothed [0-1]
 * @return {Number} smoothed value
 * @static
 */
const smootherStep = function (perc)
{
    const x = Math.max(0, Math.min(1, (perc - 0) / (1 - 0)));
    perc = x * x * x * (x * (x * 6 - 15) + 10); // smootherstep
    return perc;
};

/**
 * clamp number / make sure its between min/max
 * @function clamp
 * @param {Number} value value to be mapped
 * @param {Number} min minimum value
 * @param {Number} max maximum value
 * @static
 */
const clamp = function (value, min, max)
{
    return Math.min(Math.max(value, min), max);
};

/**
 * map a value in a range to a value in another range
 * @function map
 * @param {Number} x value to be mapped
 * @param {Number} _oldMin old range minimum value
 * @param {Number} _oldMax old range maximum value
 * @param {Number} _newMin new range minimum value
 * @param {Number} _newMax new range maximum value
 * @param {Number} _easing
 * @return {Number} mapped value
 * @static
 */
const map = function (x, _oldMin, _oldMax, _newMin, _newMax, _easing = 0)
{
    if (x >= _oldMax) return _newMax;
    if (x <= _oldMin) return _newMin;

    let reverseInput = false;
    const oldMin = Math.min(_oldMin, _oldMax);
    const oldMax = Math.max(_oldMin, _oldMax);
    if (oldMin != _oldMin) reverseInput = true;

    let reverseOutput = false;
    const newMin = Math.min(_newMin, _newMax);
    const newMax = Math.max(_newMin, _newMax);
    if (newMin != _newMin) reverseOutput = true;

    let portion = 0;
    let r = 0;

    if (reverseInput) portion = ((oldMax - x) * (newMax - newMin)) / (oldMax - oldMin);
    else portion = ((x - oldMin) * (newMax - newMin)) / (oldMax - oldMin);

    if (reverseOutput) r = newMax - portion;
    else r = portion + newMin;

    if (!_easing) return r;
    if (_easing == 1)
    {
        // smoothstep
        x = Math.max(0, Math.min(1, (r - _newMin) / (_newMax - _newMin)));
        return _newMin + x * x * (3 - 2 * x) * (_newMax - _newMin);
    }
    if (_easing == 2)
    {
        // smootherstep
        x = Math.max(0, Math.min(1, (r - _newMin) / (_newMax - _newMin)));
        return _newMin + x * x * x * (x * (x * 6 - 15) + 10) * (_newMax - _newMin);
    }

    return r;
};

// ----------------------------------------------------------------

/**
 * returns true if parameter is a number
 * @function isNumeric
 * @param {Any} n value The value to check.
 * @return {Boolean}
 * @static
 */
function isNumeric(n)
{
    return !isNaN(parseFloat(n)) && isFinite(n);
}

/**
 * returns true if parameter is array
 * @function isArray
 * @param {any} v value Value to check
 * @return {Boolean}
 * @static
 */
function isArray(v)
{
    return Object.prototype.toString.call(v) === "[object Array]";
}

// ----------------------------------------------------------------

/**
 * append a unique/random parameter to a url, so the browser is forced to reload the file, even if its cached
 * @function cacheBust
 * @static
 * @param {String} url The url to append the cachebuster parameter to.
 * @return {String} url with cachebuster parameter
 */
const cacheBust = function (url = "")
{
    if (!url) return "";
    if (url.startsWith("data:")) return;
    if (url.includes("?")) url += "&";
    else url += "?";
    return url + "cache=" + CABLES.uuid();
};

/**
 * copy the content of an array
 * @function copyArray
 * @static
 * @param {Array} src sourceArray
 * @param {Array} dst optional
 * @return {Array} dst
 */
const copyArray = function (src, dst)
{
    if (!src) return null;
    dst = dst || [];
    dst.length = src.length;
    for (let i = 0; i < src.length; i++)
        dst[i] = src[i];

    return dst;
};

/**
 * return the filename part of a url without extension
 * @function basename
 * @static
 * @param {String} url
 * @return {String} just the filename
 */
const basename = function (url)
{
    let name = CABLES.filename(url);

    const parts2 = name.split(".");
    name = parts2[0];

    return name;
};

/**
 * output a stacktrace to the console
 * @function logStack
 * @static
 */
const logStack = function ()
{
    console.log("logstack", (new Error()).stack);
};

/**
 * return the filename part of a url
 * @function filename
 * @static
 * @param {String} url
 * @return {String} just the filename
 */
const filename = function (url)
{
    let name = "";
    if (!url) return "";

    if (url.startsWith("data:") && url.includes(":"))
    {
        const parts = url.split(",");
        return parts[0];
    }

    let parts = (url + "").split("/");
    if (parts.length > 0)
    {
        const str = parts[parts.length - 1];
        let parts2 = str.split("?");
        name = parts2[0];
    }

    return name || "";
};

const ajaxSync = function (url, cb, method, post, contenttype)
{
    request({
        "url": url,
        "cb": cb,
        "method": method,
        "data": post,
        "contenttype": contenttype,
        "sync": true,
    });
};

/**
 * make an ajax request
 * @static
 * @function ajax
 * @param url
 * @param cb
 * @param method
 * @param post
 * @param contenttype
 * @param jsonP
 * @param headers
 * @param options
 */
const ajax = function (url, cb, method, post, contenttype, jsonP, headers = {}, options = {})
{
    const requestOptions = {
        "url": url,
        "cb": cb,
        "method": method,
        "data": post,
        "contenttype": contenttype,
        "sync": false,
        "jsonP": jsonP,
        "headers": headers,
    };
    if (options && options.credentials) requestOptions.credentials = options.credentials;
    request(requestOptions);
};

const request = function (options)
{
    if (!options.hasOwnProperty("asynch")) options.asynch = true;

    let xhr;
    try
    {
        xhr = new XMLHttpRequest();
    }
    catch (e) {}

    xhr.onreadystatechange = function ()
    {
        if (xhr.readyState != 4) return;

        if (options.cb)
        {
            if (xhr.status == 200 || xhr.status == 0) options.cb(false, xhr.responseText, xhr);
            else options.cb(true, xhr.responseText, xhr);
        }
    };

    try
    {
        xhr.open(options.method ? options.method.toUpperCase() : "GET", options.url, !options.sync);
    }
    catch (e)
    {
        if (options.cb && e) options.cb(true, e.msg, xhr);
    }

    if (typeof options.headers === "object")
    {
        if (options.headers)
        {
            const keys = Object.keys(options.headers);
            for (let i = 0; i < keys.length; i++)
            {
                const name = keys[i];
                const value = options.headers[name];
                xhr.setRequestHeader(name, value);
            }
        }
    }

    if (options.credentials && options.credentials !== "omit")
    {
        xhr.withCredentials = true;
    }

    try
    {
        if (!options.post && !options.data)
        {
            xhr.send();
        }
        else
        {
            xhr.setRequestHeader(
                "Content-type",
                options.contenttype ? options.contenttype : "application/x-www-form-urlencoded",
            );
            xhr.send(options.data || options.post);
        }
    }
    catch (e)
    {
        if (options.cb) options.cb(true, e.msg, xhr);
    }
};

// ----------------------------------------------------------------

const logErrorConsole = function (initiator)
{
    CABLES.errorConsole = CABLES.errorConsole || { "log": [] };
    CABLES.errorConsole.log.push({ "initiator": initiator, "arguments": arguments });

    if (!CABLES.errorConsole.ele)
    {
        const ele = document.createElement("div");
        ele.id = "cablesErrorConsole";
        ele.style.width = "90%";
        ele.style.height = "300px";
        ele.style.zIndex = "9999999";
        ele.style.display = "inline-block";
        ele.style.position = "absolute";
        ele.style.padding = "10px";
        ele.style.fontFamily = "monospace";
        ele.style.color = "red";
        ele.style.backgroundColor = "#200";

        CABLES.errorConsole.ele = ele;
        document.body.appendChild(ele);
    }

    let logHtml = "ERROR<br/>for more info, open your browsers dev tools console (Ctrl+Shift+I or Command+Alt+I)<br/>";

    for (let l = 0; l < CABLES.errorConsole.log.length; l++)
    {
        logHtml += CABLES.errorConsole.log[l].initiator + " ";
        for (let i = 1; i < CABLES.errorConsole.log[l].arguments.length; i++)
        {
            if (i > 2)logHtml += ", ";
            let arg = CABLES.errorConsole.log[l].arguments[i];
            if (arg.constructor.name.indexOf("Error") > -1 || arg.constructor.name.indexOf("error") > -1)
            {
                let txt = "Uncaught ErrorEvent ";
                if (arg.message)txt += " message: " + arg.message;
                logHtml += txt;
            }
            else if (typeof arg == "string")
                logHtml += arg;
            else if (typeof arg == "number")
                logHtml += String(arg) + " ";
        }
        logHtml += "<br/>";
    }

    CABLES.errorConsole.ele.innerHTML = logHtml;
};

/**
 * @param {Array<any>} arr
 */
function uniqueArray(arr)
{
    const u = {}, a = [];
    for (let i = 0, l = arr.length; i < l; ++i)
    {
        if (!u.hasOwnProperty(arr[i]))
        {
            a.push(arr[i]);
            u[arr[i]] = 1;
        }
    }
    return a;
}

;// CONCATENATED MODULE: ./src/core/core_port.js







/**
 * @property  {String} [title=''] overwrite title of port (by default this is portname)
 * @property  {String} [display=''] how the port is displayed and interacted in the paramerer panel
 * @property  {Boolean} [greyout=false] port paramater will appear greyed out, can not be
 * @property  {Boolean} [hidePort] port will be hidden from op
 * @property  {Boolean} [hideParam] port params will be hidden from parameter panel
 * @property  {Boolean} [showIndex] only for dropdowns - show value index (e.g. `0 - normal` )
 * @property  {String} [editorSyntax] set syntax highlighting theme for editor port
 * @property  {Boolean} [ignoreObjTypeErrors] do not auto check object types
 * @property  {string} [group] do not set manually - group ports, usually set by op.setPortGroup...
 * @property  {Boolean} [isAnimated] internal: do not set manually
 * @property  {Boolean} [useVariable] internal: do not set manually
 * @property  {string} [variableName] internal: do not set manually
 * @property  {Number} [order] internal: do not set manually
 * @property  {Boolean} [expose] internal: do not set manually
 * @property  {Boolean} [multiPortManual] internal: do not set manually
 * @property  {Number} [multiPortNum] internal: do not set manually
 * @property  {String} [display] internal: do not set manually
 *
 */
class PortUiAttribs {}

/**
 * data is coming into and out of ops through input and output ports
 * @namespace external:CABLES#Port
 * @module Port
 * @class
 * @example
 * const myPort=op.inString("String Port");
 */
class Port extends Events
{
    static DIR_IN = 0;
    static DIR_OUT = 1;

    static TYPE_VALUE = 0;
    static TYPE_NUMBER = 0;
    static TYPE_FUNCTION = 1;
    static TYPE_TRIGGER = 1;
    static TYPE_OBJECT = 2;
    static TYPE_TEXTURE = 2;
    static TYPE_ARRAY = 3;
    static TYPE_DYNAMIC = 4;
    static TYPE_STRING = 5;

    #oldAnimVal = -5711;

    #uiActiveState = true;
    #valueBeforeLink = null;
    // #lastAnimFrame = -1;
    #animated = false;
    // #tempLastUiValue = null;
    #useVariableName = null;

    /**
     * @param {Op} ___op
     * @param {string} name
     * @param {number} type
     * @param {PortUiAttribs} uiAttribs
     */
    constructor(___op, name, type, uiAttribs = {})
    {
        super();
        this.data = {}; // UNUSED, DEPRECATED, only left in for backwards compatibility with userops
        this._log = new Logger("core_port");

        /**
         * @type {Number}
         * @name direction
         * @instance
         * @memberof Port
         * @description direction of port (input(0) or output(1))
         */
        this.direction = Port.DIR_IN;
        this.id = String(CABLES.simpleId());

        /** @type {Op} */
        this._op = ___op;

        /** @type {Array<Link>} */
        this.links = [];

        /** @type {any} */
        this.value = 0.0;

        this.name = name;

        /** @type {number} */
        this.type = type || Port.TYPE_VALUE;

        /** @type {PortUiAttribs} */
        this.uiAttribs = uiAttribs || {};

        /** @type {Anim} */
        this.anim = null;

        this.defaultValue = null;

        this.ignoreValueSerialize = false;
        this.onLinkChanged = null;
        this.crashed = false;

        this.onValueChanged = null;
        this.onTriggered = null;
        this.changeAlways = false;
        this.forceRefChange = false;

        this.activityCounter = 0;
        this.apf = 0;
        this.activityCounterStartFrame = 0;

        this.canLink = null; // function fan be overwritten
        this.checkLinkTimeWarnings = null; // function fan be overwritten
    }

    get parent()
    {
        this._log.stack("use port.op, not .parent");
        return this.op;
    }

    get title()
    {
        return this.uiAttribs.title || this.name;
    }

    get op()
    {
        return this._op;
    }

    get val()
    {
        return this.get();
    }

    set val(v)
    {
        this.setValue(v);
    }

    /**
     * copy over a uiattrib from an external connected port to another port
     * @function copyLinkedUiAttrib
     * @memberof Port
     * @param {string} which attrib name
     * @param {Port} port source port
     * @instance
     * @example
     *
     *  inArray.onLinkChanged=()=>
     *  {
     *      if(inArray) inArray.copyLinkedUiAttrib("stride", outArray);
     *  };
     */
    copyLinkedUiAttrib(which, port)
    {
        if (!CABLES.UI) return;
        if (!this.isLinked()) return;

        const attr = {};
        attr[which] = this.links[0].getOtherPort(this).getUiAttrib(which);
        port.setUiAttribs(attr);
    }

    /*
     * sdjksdjklsd
     * TODO make extend class for ports, like for ops only for ui
     */
    getValueForDisplay()
    {
        let str = this.value;

        if (typeof this.value === "string" || this.value instanceof String)
        {
            if (str.length > 1000)
            {
                str = str.substring(0, 999);
                str += "...";
            }
            if (this.uiAttribs && (this.uiAttribs.display == "boolnum"))
            {
                str += " - ";

                if (!this.value) str += "false";
                else str += "true";
            }

            str = str.replace(/[\u00A0-\u9999<>\&]/g, function (i)
            {
                return "&#" + i.charCodeAt(0) + ";";
            });

            if (str.length > 100) str = str.substring(0, 100);
        }
        else
        {
            str = this.value;
        }
        return str;
    }

    /**
     * change listener for input value ports, overwrite to react to changes
     * @function onChange
     * @memberof Port
     * @instance
     * @example
     * const myPort=op.inString("MyPort");
     * myPort.onChange=function()
     * {
     *   console.log("was changed to: ",myPort.get());
     * }
     *
     */
    onAnimToggle() {}

    _onAnimToggle()
    {
        this.onAnimToggle();
    }

    /**
     * @function remove
     * @memberof Port
     * @instance
     * @description remove port
     */
    remove()
    {
        this.removeLinks();
        this._op.removePort(this);
    }

    /**
     * set ui attributes
     * @function setUiAttribs
     * @memberof Port
     * @instance
     * @param {PortUiAttribs} newAttribs

     * @example
     * myPort.setUiAttribs({greyout:true});
     */
    setUiAttribs(newAttribs)
    {
        let changed = false;
        if (!this.uiAttribs) this.uiAttribs = {};

        for (const p in newAttribs)
        {
            if (newAttribs[p] === undefined)
            {
                delete this.uiAttribs[p];
                continue;
            }
            if (this.uiAttribs[p] != newAttribs[p]) changed = true;
            this.uiAttribs[p] = newAttribs[p];

            if (p == "group" && this.indexPort) this.indexPort.setUiAttribs({ "group": newAttribs[p] });
        }

        if (newAttribs.hasOwnProperty("expose")) this._op.patch.emitEvent("subpatchExpose", this._op.uiAttribs.subPatch);

        if (changed) this.emitEvent("onUiAttrChange", newAttribs, this);
    }

    /**
     * get ui attributes
     * @function getUiAttribs
     * @memberof Port
     * @example
     * myPort.getUiAttribs();
     */
    getUiAttribs()
    {
        return this.uiAttribs;
    }

    /**
     * get ui attribute
     * @function getUiAttrib
     * @memberof Port
     * @instance
     * @param {String} attribName
     * <pre>
     * attribName - return value of the ui-attribute, or null on unknown attribute
     * </pre>
     * @example
     * myPort.setUiAttribs("values");
     */
    getUiAttrib(attribName)
    {
        if (!this.uiAttribs || !this.uiAttribs.hasOwnProperty(attribName)) return null;
        return this.uiAttribs[attribName];
    }

    /**
     * @function get
     * @memberof Port
     * @instance
     * @description get value of port
     */
    get()
    {
        if (this.#animated && this.lastAnimFrame != this._op.patch.getFrameNum())
        {
            this.lastAnimFrame = this._op.patch.getFrameNum();

            let animval = this.anim.getValue(this._op.patch.timer.getTime());

            if (this.value != animval)
            {
                this.value = animval;
                this.#oldAnimVal = this.value;
                this.forceChange();
            }
        }

        return this.value;
    }

    setRef(v)
    {
        this.forceRefChange = true;
        this.set(v);
    }

    /**
     * @function setValue
     * @memberof Port
     * @instance
     * @description set value of port / will send value to all linked ports (only for output ports)
     */
    set(v)
    {
        this.setValue(v);
    }

    setValue(v)
    {
        if (v === undefined) v = null;

        if (CABLES.UI && CABLES.UI.showDevInfos)
            if (this.direction == CONSTANTS.PORT.PORT_DIR_OUT && this.type == Port.TYPE_OBJECT && v && !this.forceRefChange)
                this._log.warn("object port [" + this.name + "] uses .set [" + this.op.objName + "]");

        if (this._op.enabled && !this.crashed)
        {
            if (v !== this.value || this.changeAlways || this.type == Port.TYPE_TEXTURE || this.type == Port.TYPE_ARRAY)
            {
                if (this.#animated)
                {
                    this.anim.setValue(this._op.patch.timer.getTime(), v);
                }
                else
                {
                    try
                    {
                        this.value = v;
                        this.forceChange();
                    }
                    catch (ex)
                    {
                        this.crashed = true;

                        this.setValue = function (_v) {};
                        this.onTriggered = function () {};

                        this._log.error("exception in ", this._op);
                        this._log.error(ex);

                        this._op.patch.emitEvent("exception", ex, this._op);
                    }

                    if (this._op && this._op.patch && this._op.patch.isEditorMode() && this.type == Port.TYPE_TEXTURE) gui.texturePreview().updateTexturePort(this);
                }

                if (this.direction == CONSTANTS.PORT.PORT_DIR_OUT) for (let i = 0; i < this.links.length; ++i) this.links[i].setValue();
            }
        }
    }

    updateAnim()
    {
        if (this.#animated)
        {
            this.value = this.get();

            if (this.#oldAnimVal != this.value || this.changeAlways)
            {
                this.#oldAnimVal = this.value;
                this.forceChange();
            }
            this.#oldAnimVal = this.value;
        }
    }

    forceChange()
    {
        if (this.onValueChanged || this.onChange)
        {

        /*
         * very temporary: deprecated warning!!!!!!!!!
         * if(params.length>0) this._log.warn('TOM: port has onchange params!',this._op.objName,this.name);
         */
        }
        this._activity();
        this.emitEvent("change", this.value, this);

        if (this.onChange) this.onChange(this, this.value);
        else if (this.onValueChanged) this.onValueChanged(this, this.value); // deprecated
    }

    /**
     * @function getTypeString
     * @memberof Port
     * @instance
     * @description get port type as string, e.g. "Function","Value"...
     * @return {String} type
     */
    getTypeString()
    {
        if (this.type == Port.TYPE_VALUE) return "Number";
        if (this.type == Port.TYPE_FUNCTION) return "Trigger";
        if (this.type == Port.TYPE_OBJECT) return "Object";
        if (this.type == Port.TYPE_DYNAMIC) return "Dynamic";
        if (this.type == Port.TYPE_ARRAY) return "Array";
        if (this.type == Port.TYPE_STRING) return "String";
        return "Unknown";
    }

    deSerializeSettings(objPort)
    {
        if (!objPort) return;
        if (objPort.animated) this.setAnimated(objPort.animated);
        if (objPort.useVariable) this.setVariableName(objPort.useVariable);
        if (objPort.title) this.setUiAttribs({ "title": objPort.title });
        if (objPort.expose) this.setUiAttribs({ "expose": true });
        if (objPort.order) this.setUiAttribs({ "order": objPort.order });

        if (objPort.multiPortManual) this.setUiAttribs({ "multiPortManual": objPort.multiPortManual });
        if (objPort.multiPortNum) this.setUiAttribs({ "multiPortNum": objPort.multiPortNum });

        if (objPort.anim)
        {
            if (!this.anim) this.anim = new Anim({ "name": "port " + this.name });
            this._op.hasAnimPort = true;
            this.anim.on("onChange", () =>
            {
                this._op.patch.emitEvent("portAnimUpdated", this._op, this, this.anim);
            });
            if (objPort.anim.loop) this.anim.loop = objPort.anim.loop;
            for (const ani in objPort.anim.keys)
            {
                this.anim.keys.push(new CABLES.AnimKey(objPort.anim.keys[ani], this.anim));
            }
            this._op.patch.emitEvent("portAnimUpdated", this._op, this, this.anim);

            this.anim.sortKeys();
        }
    }

    setInitialValue(v)
    {
        if (this.op.preservedPortLinks[this.name])
        {
            for (let i = 0; i < this.op.preservedPortLinks[this.name].length; i++)
            {
                const lobj = this.op.preservedPortLinks[this.name][i];
                this.op.patch._addLink(
                    lobj.objIn,
                    lobj.objOut,
                    lobj.portIn,
                    lobj.portOut);
            }
        }

        if (this.op.preservedPortValues && this.op.preservedPortValues.hasOwnProperty(this.name) && this.op.preservedPortValues[this.name] !== undefined)
        {
            this.set(this.op.preservedPortValues[this.name]);
        }
        else
        if (v !== undefined) this.set(v);
        if (v !== undefined) this.defaultValue = v;
    }

    getSerialized()
    {
        let obj = { "name": this.getName() };

        if (!this.ignoreValueSerialize && this.links.length === 0)
        {
            if (this.type == Port.TYPE_OBJECT && this.value && this.value.tex) {}
            else obj.value = this.value;
        }
        if (this.#useVariableName) obj.useVariable = this.#useVariableName;
        if (this.#animated) obj.animated = true;
        if (this.anim) obj.anim = this.anim.getSerialized();
        if (this.uiAttribs.multiPortNum) obj.multiPortNum = this.uiAttribs.multiPortNum;
        if (this.uiAttribs.multiPortManual) obj.multiPortManual = this.uiAttribs.multiPortManual;

        if (this.uiAttribs.display == "file") obj.display = this.uiAttribs.display;
        if (this.uiAttribs.expose)
        {
            obj.expose = true;
            if (this.uiAttribs.hasOwnProperty("order")) obj.order = this.uiAttribs.order;
        }
        if (this.uiAttribs.title) obj.title = this.uiAttribs.title;
        if ((this.preserveLinks || this.direction == CONSTANTS.PORT.PORT_DIR_OUT) && this.links.length > 0)
        {
            obj.links = [];
            for (const i in this.links)
            {
                if (!this.links[i].ignoreInSerialize && (this.links[i].portIn && this.links[i].portOut)) obj.links.push(this.links[i].getSerialized());
            }
        }

        if (this.direction == Port.DIR_IN && this.links.length > 0)
        {
            for (const i in this.links)
            {
                if (!this.links[i].portIn || !this.links[i].portOut) continue;

                const otherp = this.links[i].getOtherPort(this);
                // check if functions exist, are defined in core_extend_ops code in ui
                if (otherp.op.isInBlueprint2 && this.op.isInBlueprint2)
                {
                    if (otherp.op.isInBlueprint2() && !this.op.isInBlueprint2())
                    {
                        obj.links = obj.links || [];
                        obj.links.push(this.links[i].getSerialized());
                    }
                }
            }
        }

        if (obj.links && obj.links.length == 0) delete obj.links;
        if (this.type === Port.TYPE_FUNCTION) delete obj.value;
        if (this.type === Port.TYPE_FUNCTION && this.links.length == 0) obj = null;
        if (obj && Object.keys(obj).length == 1 && obj.name)obj = null; // obj is null if there is no real information other than name

        // console.log(obj);
        cleanJson(obj);

        return obj;
    }

    /**
     * will be overwritten in ui
     * @param {Port} port1
     * @param {Port} port2
     */
    shouldLink(port1, port2)
    {
        return port1 && port2;
    }

    /**
     * @function removeLinks
     * @memberof Port
     * @instance
     * @description remove all links from port
     */
    removeLinks()
    {
        let count = 0;
        while (this.links.length > 0)
        {
            count++;
            if (count > 5000)
            {
                this._log.warn("could not delete links... / infinite loop");
                this.links.length = 0;
                break;
            }
            this.links[0].remove();
        }
    }

    /**
     * @function removeLink
     * @memberof Port
     * @instance
     * @description remove all link from port
     * @param {Link} link
     */
    removeLink(link)
    {
        for (const i in this.links)
            if (this.links[i] == link)
                this.links.splice(i, 1);

        if (this.direction == Port.DIR_IN)
        {
            if (this.type == Port.TYPE_VALUE) this.setValue(this.#valueBeforeLink || 0);
            else this.setValue(this.#valueBeforeLink || null);
        }

        if (CABLES.UI && this._op.checkLinkTimeWarnings) this._op.checkLinkTimeWarnings();

        try
        {
            if (this.onLinkChanged) this.onLinkChanged();
            this.emitEvent("onLinkChanged");
            this.emitEvent("onLinkRemoved");
            this._op.emitEvent("onLinkChanged");
        }
        catch (e)
        {
            this._log.error(e);
        }
    }

    /**
     * @function getName
     * @memberof Port
     * @instance
     * @description return port name
     */
    getName()
    {
        return this.name;
    }

    /**
     * @function getTitle
     * @memberof Port
     * @instance
     * @description return port name or title
     */
    getTitle()
    {
        if (this.uiAttribs.title) return this.uiAttribs.title;
        return this.name;
    }

    addLink(l)
    {
        this.#valueBeforeLink = this.value;
        this.links.push(l);
        if (CABLES.UI && this._op.checkLinkTimeWarnings) this._op.checkLinkTimeWarnings();

        try
        {
            if (this.onLinkChanged) this.onLinkChanged();
            this.emitEvent("onLinkChanged");
            this._op.emitEvent("onLinkChanged");
        }
        catch (e)
        {
            this._log.error(e);
        }
    }

    /**
     * @function getLinkTo
     * @memberof Port
     * @instance
     * @param {Port} p2 otherPort
     * @description return link, which is linked to otherPort
     */
    getLinkTo(p2)
    {
        for (const i in this.links) if (this.links[i].portIn == p2 || this.links[i].portOut == p2) return this.links[i];
    }

    /**
     * @function removeLinkTo
     * @memberof Port
     * @instance
     * @param {Port} p2 otherPort
     * @description removes link, which is linked to otherPort
     */
    removeLinkTo(p2)
    {
        for (const i in this.links)
        {
            if (this.links[i].portIn == p2 || this.links[i].portOut == p2)
            {
                this.links[i].remove();
                if (CABLES.UI && this._op.checkLinkTimeWarnings) this._op.checkLinkTimeWarnings();

                if (this.onLinkChanged) this.onLinkChanged();
                this.emitEvent("onLinkChanged");
                this.emitEvent("onLinkRemoved");
                return;
            }
        }
    }

    /**
     * @function isLinkedTo
     * @memberof Port
     * @instance
     * @param {Port} p2 otherPort
     * @description returns true if port is linked to otherPort
     */
    isLinkedTo(p2)
    {
        for (const i in this.links) if (this.links[i].portIn == p2 || this.links[i].portOut == p2) return true;

        return false;
    }

    _activity()
    {
        this.activityCounter++;
    }

    /**
     * @function trigger
     * @memberof Port
     * @instance
     * @description trigger the linked port (usually invoked on an output function port)
     */
    trigger()
    {
        const linksLength = this.links.length;

        this._activity();
        if (linksLength === 0) return;
        if (!this._op.enabled) return;

        let portTriggered = null;
        try
        {
            for (let i = 0; i < linksLength; ++i)
            {
                if (this.links[i].portIn)
                {
                    portTriggered = this.links[i].portIn;

                    portTriggered.op.patch.pushTriggerStack(portTriggered);
                    if (!portTriggered._onTriggered)
                    {
                        console.log(portTriggered, portTriggered._onTriggered);
                    }
                    portTriggered._onTriggered(null);

                    portTriggered.op.patch.popTriggerStack();
                }
                if (this.links[i]) this.links[i].activity();
            }
        }
        catch (ex)
        {
            portTriggered.op.enabled = false;

            if (this._op.patch.isEditorMode())
            {
                if (portTriggered.op.onError) portTriggered.op.onError(ex);
            }
            this._log.error("exception in port: ", portTriggered.name, portTriggered.op.name, portTriggered.op);
            this._log.error(ex);
        }
    }

    call()
    {
        this._log.warn("call deprecated - use trigger() ");
        this.trigger();
    }

    execute()
    {
        this._log.warn("### execute port: " + this.getName(), this.goals.length);
    }

    setVariableName(n)
    {
        this.#useVariableName = n;

        this._op.patch.on("variableRename", (oldname, newname) =>
        {
            if (oldname != this.#useVariableName) return;
            this.#useVariableName = newname;
        });
    }

    getVariableName()
    {
        return this.#useVariableName;
    }

    setVariable(v)
    {
        this.setAnimated(false);
        const attr = { "useVariable": false };

        if (this._variableIn && this._varChangeListenerId)
        {
            this._variableIn.off(this._varChangeListenerId);
            this._variableIn = null;
        }

        if (v)
        {
            this._variableIn = this._op.patch.getVar(v);

            if (!this._variableIn)
            {
                this._log.warn("PORT VAR NOT FOUND!!!", v);
            }
            else
            {
                if (this.type == Port.TYPE_OBJECT)
                {
                    this._varChangeListenerId = this._variableIn.on("change", () => { this.set(null); this.set(this._variableIn.getValue()); });
                }
                else
                {
                    this._varChangeListenerId = this._variableIn.on("change", this.set.bind(this));
                }
                this.set(this._variableIn.getValue());
            }
            this.#useVariableName = v;
            attr.useVariable = true;
            attr.variableName = this.#useVariableName;
        }
        else
        {
            attr.variableName = this.#useVariableName = null;
            attr.useVariable = false;
        }

        this.setUiAttribs(attr);
        this._op.patch.emitEvent("portSetVariable", this._op, this, v);
    }

    _handleNoTriggerOpAnimUpdates(a)
    {
        let hasTriggerPort = false;
        for (let i = 0; i < this._op.portsIn.length; i++)
        {
            if (this._op.portsIn[i].type == Port.TYPE_FUNCTION)
            {
                hasTriggerPort = true;
                break;
            }
        }

        if (!hasTriggerPort)
        {
            if (a) this._notriggerAnimUpdate = this._op.patch.on("onRenderFrame", () =>
            {
                this.updateAnim();
            });
            else if (this._notriggerAnimUpdate) this._notriggerAnimUpdate = this._op.patch.removeEventListener(this._notriggerAnimUpdate);
        }
    }

    /**
     * @param {boolean} a
     */
    setAnimated(a)
    {
        if (this.#animated != a)
        {
            this.#animated = a;
            this._op.hasAnimPort = true;

            if (this.#animated && !this.anim)
            {
                this.anim = new Anim({ "name": "port " + this.name });
                this.anim.on("onChange", () =>
                {
                    this._op.patch.emitEvent("portAnimUpdated", this._op, this, this.anim);
                });
            }
            this._onAnimToggle();
        }

        this._handleNoTriggerOpAnimUpdates(a);
        if (!a)
        {
            this.anim = null;
        }

        this._op.patch.emitEvent("portAnimToggle", this._op, this, this.anim);

        this.setUiAttribs({ "isAnimated": this.#animated });
    }

    toggleAnim()
    {
        this.#animated = !this.#animated;
        if (this.#animated && !this.anim)
        {
            this.anim = new Anim({ "name": "port " + this.name });
            this.anim.on("onChange", () =>
            {
                this._op.patch.emitEvent("portAnimUpdated", this._op, this, this.anim);
            });
        }
        this.setAnimated(this.#animated);
        this._onAnimToggle();
        this.setUiAttribs({ "isAnimated": this.#animated });
        this._op.patch.emitEvent("portAnimUpdated", this._op, this, this.anim);
    }

    /**
     * <pre>
     * CABLES.Port.TYPE_VALUE = 0;
     * CABLES.Port.TYPE_FUNCTION = 1;
     * CABLES.Port.TYPE_OBJECT = 2;
     * CABLES.Port.TYPE_TEXTURE = 2;
     * CABLES.Port.TYPE_ARRAY = 3;
     * CABLES.Port.TYPE_DYNAMIC = 4;
     * CABLES.Port.TYPE_STRING = 5;
     * </pre>
     * @function getType
     * @memberof Port
     * @instance
     * @return {Number} type of port
     */
    getType()
    {
        return this.type;
    }

    /**
     * @function isLinked
     * @memberof Port
     * @instance
     * @return {Boolean} true if port is linked
     */
    isLinked()
    {
        return this.links.length > 0 || this.#animated || this.#useVariableName != null;
    }

    isBoundToVar()
    {
        const b = this.#useVariableName != null;
        this.uiAttribs.boundToVar = b;
        return b;
    }

    /**
     * @return {Boolean} true if port is animated
     */
    isAnimated()
    {
        return this.#animated;
    }

    /**
     * @function isHidden
     * @memberof Port
     * @instance
     * @return {Boolean} true if port is hidden
     */
    isHidden()
    {
        return this.uiAttribs.hidePort;
    }

    /**
     * @function onTriggered
     * @memberof Port
     * @instance
     * @param {function} a onTriggeredCallback
     * @description set callback, which will be executed when port was triggered (usually output port)
     */
    _onTriggered(a)
    {
        this._activity();
        this._op.updateAnims();
        if (this._op.enabled && this.onTriggered) this.onTriggered(a);

        if (this._op.enabled) this.emitEvent("trigger");
    }

    _onSetProfiling(v) // used in editor: profiler tab
    {
        this._op.patch.profiler.add("port", this);
        this.setValue(v);
        this._op.patch.profiler.add("port", null);
    }

    _onTriggeredProfiling() // used in editor: profiler tab
    {
        if (this._op.enabled && this.onTriggered)
        {
            this._op.patch.profiler.add("port", this);
            this.onTriggered();
            this._op.patch.profiler.add("port", null);
        }
    }

    // getUiActiveState()
    // {
    //     return this.#uiActiveState;
    // }

    // setUiActiveState(onoff)
    // {
    //     this._uiActiveState = onoff;
    //     if (this.onUiActiveStateChange) this.onUiActiveStateChange();
    // }

    /**
     * @deprecated
     * @param {function} cb
     */
    onValueChange(cb)
    {
        this.onChange = cb;
    }

    /**
     * @deprecated
     */
    hidePort() {}
}

/**
 * Returns the port type string, e.g. "value" based on the port type number
 * @function portTypeNumberToString
 * @instance
 * @memberof Port
 * @param {Number} type - The port type number
 * @returns {String} - The port type as string
 */
Port.portTypeNumberToString = function (type)
{
    if (type == Port.TYPE_VALUE) return "value";
    if (type == Port.TYPE_FUNCTION) return "function";
    if (type == Port.TYPE_OBJECT) return "object";
    if (type == Port.TYPE_ARRAY) return "array";
    if (type == Port.TYPE_STRING) return "string";
    if (type == Port.TYPE_DYNAMIC) return "dynamic";
    return "unknown";
};

;// CONCATENATED MODULE: ./src/core/core_link.js




/**
 * @namespace external:CABLES#Link
 * @description a link is a connection between two ops/ports -> one input and one output port
 * @hideconstructor
 * @class
 */
class Link extends Events
{

    /**
     * @param {Patch} p
     */
    constructor(p)
    {
        super();

        this.id = CABLES.simpleId();

        /**
         * @type {Port}
         */
        this.portIn = null;

        /**
         * @type {Port}
         */
        this.portOut = null;

        /**
         * @type {Patch}
         */
        this._patch = p;
        this.activityCounter = 0;
        this.ignoreInSerialize = false;
    }

    setValue(v)
    {
        if (v === undefined) this._setValue();
        else this.portIn.set(v);
    }

    activity()
    {
        this.activityCounter++;
    }

    _setValue()
    {
        if (!this.portOut)
        {
            this.remove();
            return;
        }
        const v = this.portOut.get();

        if (v == v) // NaN is the only JavaScript value that is treated as unequal to itself
        {
            if (this.portIn.type != Port.TYPE_FUNCTION) this.activity();

            if (this.portIn.get() !== v)
            {
                this.portIn.set(v);
            }
            else
            {
                if (this.portIn.changeAlways) this.portIn.set(v);
                if (this.portOut.forceRefChange) this.portIn.forceChange();
            }
        }
    }

    /**
     * @function getOtherPort
     * @memberof Link
     * @instance
     * @param {Port} p port
     * @description returns the port of the link, which is not port
     */
    getOtherPort(p)
    {
        if (p == this.portIn) return this.portOut;
        return this.portIn;
    }

    /**
     * @function remove
     * @memberof Link
     * @instance
     * @description unlink/remove this link from all ports
     */
    remove()
    {
        if (this.portIn) this.portIn.removeLink(this);
        if (this.portOut) this.portOut.removeLink(this);
        if (this._patch)
        {
            this._patch.emitEvent("onUnLink", this.portIn, this.portOut, this);
        }

        if (this.portIn && (this.portIn.type == Port.TYPE_OBJECT || this.portIn.type == Port.TYPE_ARRAY))
        {
            this.portIn.set(null);
            if (this.portIn.links.length > 0) this.portIn.set(this.portIn.links[0].getOtherPort(this.portIn).get());
        }

        if (this.portIn) this.portIn.op._checkLinksNeededToWork();
        if (this.portOut) this.portOut.op._checkLinksNeededToWork();

        this.portIn = null;
        this.portOut = null;
        this._patch = null;
    }

    /**
     * @function link
     * @memberof Link
     * @instance
     * @description link those two ports
     * @param {Port} p1 port1
     * @param {Port} p2 port2
     */
    link(p1, p2)
    {
        if (!Link.canLink(p1, p2))
        {
            console.warn("[core_link] cannot link ports!", p1, p2);
            return false;
        }

        if (p1.direction == Port.DIR_IN)
        {
            this.portIn = p1;
            this.portOut = p2;
        }
        else
        {
            this.portIn = p2;
            this.portOut = p1;
        }

        p1.addLink(this);
        p2.addLink(this);

        this.setValue();

        p1.op._checkLinksNeededToWork();
        p2.op._checkLinksNeededToWork();
    }

    getSerialized()
    {
        const obj = {};

        obj.portIn = this.portIn.getName();
        obj.portOut = this.portOut.getName();
        obj.objIn = this.portIn.op.id;
        obj.objOut = this.portOut.op.id;

        return obj;
    }
}

// --------------------------------------------

/**
 * @function canLinkText
 * @memberof Link
 * @instance
 * @description return a text message with human readable reason if ports can not be linked, or can be
 * @param {Port} p1 port1
 * @param {Port} p2 port2
 */
Link.canLinkText = function (p1, p2)
{
    if (p1.direction == p2.direction)
    {
        let txt = "(out)";
        if (p2.direction == Port.DIR_IN) txt = "(in)";
        return "can not link: same direction " + txt;
    }
    if (p1.op == p2.op) return "can not link: same op";
    if (p1.type != Port.TYPE_DYNAMIC && p2.type != Port.TYPE_DYNAMIC)
    {
        if (p1.type != p2.type) return "can not link: different type";
    }

    if (CABLES.UI && p1.type == Port.TYPE_OBJECT && p2.type == Port.TYPE_OBJECT)
    {
        if (p1.uiAttribs.objType && p2.uiAttribs.objType)
            if (p1.uiAttribs.objType != p2.uiAttribs.objType)
                return "incompatible objects";
    }

    if (!p1) return "can not link: port 1 invalid";
    if (!p2) return "can not link: port 2 invalid";

    if (p1.direction == Port.DIR_IN && p1.isAnimated()) return "can not link: is animated";
    if (p2.direction == Port.DIR_IN && p2.isAnimated()) return "can not link: is animated";

    if (p1.isLinkedTo(p2)) return "ports already linked";

    if ((p1.canLink && !p1.canLink(p2)) || (p2.canLink && !p2.canLink(p1))) return "Incompatible";

    return "can link";
};

/**
 * @function canLink
 * @memberof Link
 * @instance
 * @description return true if ports can be linked
 * @param {Port} p1 port1
 * @param {Port} p2 port2
 * @returns {Boolean}
 */
Link.canLink = function (p1, p2)
{
    if (!p1) return false;
    if (!p2) return false;
    if (p1.direction == Port.DIR_IN && p1.isAnimated()) return false;
    if (p2.direction == Port.DIR_IN && p2.isAnimated()) return false;

    if (p1.isHidden() || p2.isHidden()) return false;

    if (p1.isLinkedTo(p2)) return false;

    if (p1.direction == p2.direction) return false;

    if (CABLES.UI && p1.type == Port.TYPE_OBJECT && p2.type == Port.TYPE_OBJECT)
    {
        if (p1.uiAttribs.objType && p2.uiAttribs.objType)
        {
            if (p1.uiAttribs.objType.indexOf("sg_") == 0 && p2.uiAttribs.objType.indexOf("sg_") == 0) return true;
            if (p1.uiAttribs.objType != p2.uiAttribs.objType)
                return false;
        }
    }

    if (p1.type != p2.type && (p1.type != Port.TYPE_DYNAMIC && p2.type != Port.TYPE_DYNAMIC)) return false;
    if (p1.type == Port.TYPE_DYNAMIC || p2.type == Port.TYPE_DYNAMIC) return true;

    if (p1.op == p2.op) return false;

    if (p1.canLink && !p1.canLink(p2)) return false;
    if (p2.canLink && !p2.canLink(p1)) return false;

    return true;
};

;// CONCATENATED MODULE: ./src/core/core_port_switch.js


class SwitchPort extends Port
{
    constructor(__parent, name, type, uiAttribs, indexPort)
    {
        super(__parent, name, type, uiAttribs);

        this.get = () =>
        {
            let s = super.get();

            if (CABLES.UI)
            {
                if (
                    s === "" ||
                    s === null ||
                    s === undefined ||
                    (uiAttribs.values && uiAttribs.values.indexOf(String(s)) === -1)
                )
                {
                    this.op.setUiError("invalidswitch", "Invalid Value [" + this.name + "]: \"" + s + "\"", 1);
                }
                else this.op.setUiError("invalidswitch", null);
            }

            if (s === null || s === undefined)s = "";

            return s;
        };

        this.indexPort = indexPort;
        this.indexPort.set = (value) =>
        {
            const values = uiAttribs.values;

            if (!values)
            {
                // console.log("switch port has no values", this);
                return;
            }

            let intValue = Math.floor(value);

            intValue = Math.min(intValue, values.length - 1);
            intValue = Math.max(intValue, 0);

            this.indexPort.setValue(intValue);
            this.set(values[intValue]);

            if (this.op.patch.isEditorMode() && performance.now() - (this.lastTime || 0) > 100 && window.gui && gui.patchView.isCurrentOp(this.op))
            {
                gui.opParams.show(this.op);
                this.lastTime = performance.now();
            }
        };
    }

    setUiAttribs(attribs)
    {
        const hidePort = attribs.hidePort;
        attribs.hidePort = true;
        super.setUiAttribs(attribs);
        if (typeof hidePort !== "undefined")
        {
            this.indexPort.setUiAttribs({ hidePort });
        }
    }
}

;// CONCATENATED MODULE: ./src/core/core_port_select.js


class ValueSelectPort extends SwitchPort
{
    setUiAttribs(newAttribs)
    {
        // never unhide valuePort when indexPort is linked
        if (this.indexPort.isLinked())
        {
            for (const p in newAttribs)
            {
                if (p == "greyout" && !newAttribs[p]) newAttribs[p] = "true";
            }
        }
        super.setUiAttribs(newAttribs);
    }
}

;// CONCATENATED MODULE: ./src/core/core_port_multi.js



const MIN_NUM_PORTS = 2;

class MultiPort extends Port
{
    constructor(__parent, name, type, dir, uiAttribs, uiAttribsPorts)
    {
        super(__parent, name, Port.TYPE_ARRAY, uiAttribs);

        this.setUiAttribs({ "multiPort": true, "group": this.name, "order": -1 });
        this.ports = [];
        this.direction = dir;
        this._uiAttribsPorts = uiAttribsPorts;

        const updateArray = () =>
        {
            const arr = [];

            let ll = 1;
            if (this.uiAttribs.multiPortManual)ll = 0;

            for (let i = 0; i < this.ports.length - ll; i++)
                arr[i] = this.ports[i];

            this.setRef(arr);
        };

        const updateUi = () =>
        {
            let grey = !this.uiAttribs.multiPortManual || false;

            if (this.direction == CONSTANTS.PORT.PORT_DIR_OUT)grey = false;

            for (let i = 0; i < this.ports.length; i++)
            {
                let lp; // undefined to remove/not set it
                // let opacity;// undefined to remove/not set it
                // let grey;// undefined to remove/not set it
                let addPort = false;
                let title;
                let o = {};

                // console.log("this.op.preservedPortTitles", this.op.preservedPortTitles, this.op.preservedPortTitles[po.name], po.name);
                if (this.op.preservedPortTitles && this.op.preservedPortTitles[this.ports[i].name]) title = this.op.preservedPortTitles[this.ports[i].name];

                // if (!this.uiAttribs.multiPortManual)grey = true;
                if (i == 0) lp = this.ports.length;

                if (!this.uiAttribs.multiPortManual)
                    if (i == this.ports.length - 1)
                    {
                        title = "add port";
                        addPort = true;
                        grey = true;
                    }

                for (const attin in this._uiAttribsPorts)
                {
                    o[attin] = this._uiAttribsPorts[attin];
                }

                o.addPort = addPort;
                o.longPort = lp;
                o.title = title;
                o.greyout = grey;
                o.group = this.name;

                this.ports[i].setUiAttribs(o);
            }
        };

        this.removeInvalidPorts = () =>
        {
            for (let i = 0; i < this.ports.length; i++)
            {
                if (!this.ports[i]) this.ports.splice(i, 1);
            }

            if (!this.uiAttribs.multiPortManual)
            {
                if (this.ports.length > MIN_NUM_PORTS)

                    for (let i = this.ports.length - 1; i > 1; i--)
                    {
                        if (!this.ports[i].isLinked()) this.uiAttribs.multiPortNum = i;
                        else break;
                    }
            }

            updateArray();
        };

        this.countPorts = () =>
        {
            if (CABLES.UI && !gui.isRemoteClient && gui.patchView && gui.patchView.patchRenderer && gui.patchView.patchRenderer.isDraggingPort())
            {
                clearTimeout(this.retryTo);
                this.retryTo = setTimeout(this.countPorts.bind(this));
                return;
            }
            this.retryTo = null;

            let redo = false;
            this.removeListeners();
            this.removeInvalidPorts();

            for (let i = 0; i < this.ports.length; i++)
            {
                if (this.ports[i] && this.ports[i].links.length > 1)
                {
                    const po = this.ports[i + 1];
                    const otherPort = this.ports[i].links[0].getOtherPort(this.ports[i]);

                    if (!po || !otherPort)
                    {
                        this._log.warn("no port found?");
                    }
                    else
                    {
                        this.ports[i].links[0].remove();
                        this.op.patch.link(this.op, po.name, otherPort.op, otherPort.name);
                        redo = true;
                    }
                    break;
                }
            }

            if (!this.uiAttribs.multiPortManual)
            {
                let foundHole = true;
                while (foundHole)
                {
                    // console.log("search holes...");
                    foundHole = false;

                    for (let i = this.ports.length - 1; i > 1; i--)
                    {
                        if (this.ports[i] && this.ports[i].links.length > 0 && this.ports[i - 1].links.length == 0)
                        {
                            // console.log("found hole!");

                            // found hole
                            const otherPort = this.ports[i].links[0].getOtherPort(this.ports[i]);
                            this.ports[i].links[0].remove();

                            const po = this.ports[i - 1];

                            if (po && this.ports[i])
                            {
                                // console.log("move ", this.ports[i].name, "to", po.name);
                                this.op.patch.link(this.op, po.name, otherPort.op, otherPort.name);
                                foundHole = true;
                                redo = true;
                                break;
                            }
                        }
                    }

                    // this.checkNum();
                }

                // this.removeInvalidPorts();
            }

            if (!this.uiAttribs.multiPortManual) // if auto
            {
                while (this.ports.length > MIN_NUM_PORTS && !this.ports[this.ports.length - 1].isLinked() && !this.ports[this.ports.length - 2].isLinked())
                {
                    let i = this.ports.length - 1;
                    if (!this.ports[i].isLinked() && this.ports[i - 1] && !this.ports[i - 1].isLinked())
                    {
                        this.ports[i].setUiAttribs({ "removed": true });
                        this.ports[i].remove();
                        // this.ports[i] = null;
                        this.ports.splice(i, 1);
                    }
                }
            }

            this.removeInvalidPorts();

            if (!this.uiAttribs.multiPortManual && this.ports.length > 0 && this.ports[this.ports.length - 1].isLinked()) this.newPort();

            updateArray();
            updateUi();

            if (redo) this.countPorts();
            else this.addListeners();
        };

        this.removeListeners = () =>
        {
            for (let i = 0; i < this.ports.length; i++)
            {
                const po = this.ports[i];
                if (po.multiPortChangeListener) po.multiPortChangeListener = po.off(po.multiPortChangeListener);
                if (po.multiLinkChangeListener) po.multiLinkChangeListener = po.off(po.multiLinkChangeListener);
            }
        };

        this.addListeners = () =>
        {
            for (let i = 0; i < this.ports.length; i++)
            {
                const po = this.ports[i];
                const idx = i;

                if (po.multiPortChangeListener)po.multiPortChangeListener = po.off(po.multiPortChangeListener);
                po.multiPortChangeListener = po.on("change", updateArray.bind(this));

                if (po.multiPortTriggerListener)po.multiPortTriggerListener = po.off(po.multiPortTriggerListener);
                po.multiPortTriggerListener = po.on("trigger", () => { this._onTriggered(idx); });

                if (po.multiLinkChangeListener)po.multiLinkChangeListener = po.off(po.multiLinkChangeListener);
                po.multiLinkChangeListener = po.on("onLinkChanged", () =>
                {
                    this.countPorts();
                    this.emitEvent("onLinkChanged");
                });

                if (po.multiLinkRemoveListener)po.multiLinkRemoveListener = po.off(po.multiLinkRemoveListener);
                po.multiLinkRemoveListener = po.on("onLinkRemoved", () =>
                {
                    // this.removeInvalidPorts();
                    // this.checkNum();
                    // this.countPorts();
                    updateUi();
                    this.emitEvent("onLinkChanged");
                    // this.countPorts.bind(this);
                });
            }
        };

        this.newPort = () =>
        {
            const attrs = {};
            // if (type == CABLES.OP_PORT_TYPE_STRING) attrs.type = "string";
            attrs.type = type;
            const po = new Port(this.op, name + "_" + this.ports.length, type, attrs);

            po.direction = dir;
            this.ports.push(po);
            // console.log("CONSTANTS.PORT_DIR_OUT", CONSTANTS.PORT.PORT_DIR_OUT, this.direction);
            if (this.direction == CONSTANTS.PORT.PORT_DIR_OUT) this.op.addOutPort(po);
            else this.op.addInPort(po);

            if (type == Port.TYPE_NUMBER) po.setInitialValue(0);
            else if (type == Port.TYPE_STRING) po.setInitialValue("");

            this.addListeners();

            updateUi();
            updateArray();
            this.emitEvent("onLinkChanged");
            // console.log("this.op.preservedPortTitles", this.op.preservedPortTitles, this.op.preservedPortTitles[po.name], po.name);
            if (this.op.preservedPortTitles && this.op.preservedPortTitles[po.name]) po.setUiAttribs({ "title": this.op.preservedPortTitles[po.name] });

            return po;
        };

        this.initPorts = () =>
        {
            for (let i = 0; i < MIN_NUM_PORTS; i++) this.newPort();
            updateArray();
            updateUi();
        };

        this.checkNum = () =>
        {
            this.uiAttribs.multiPortNum = Math.max(MIN_NUM_PORTS, this.uiAttribs.multiPortNum);

            while (this.ports.length < this.uiAttribs.multiPortNum) this.newPort();
            while (this.ports.length > this.uiAttribs.multiPortNum) if (this.ports[this.ports.length - 1]) this.ports.pop().remove();

            this.removeInvalidPorts();
        };

        this.incDec = (incDir) =>
        {
            this.uiAttribs.multiPortNum = this.uiAttribs.multiPortNum || MIN_NUM_PORTS;
            // console.log("this.uiAttribs.multiPortNum", this.uiAttribs.multiPortNum, this.uiAttribs.multiPortNum + incDir);
            this.setUiAttribs({ "multiPortNum": this.uiAttribs.multiPortNum + incDir });
            this.checkNum();

            updateUi();
        };

        this.toggleManual = () =>
        {
            this.setUiAttribs({ "multiPortManual": !this.uiAttribs.multiPortManual });
            this.op.refreshParams();
        };

        this.on("onUiAttrChange", (attribs) =>
        {
            if (attribs.hasOwnProperty("multiPortManual"))
            {
                updateUi();
                this.removeInvalidPorts();
                this.checkNum();
                this.countPorts();
                updateUi();
            }
        });

        this.on("onUiAttrChange", this.checkNum.bind(this));
        this.checkNum();
        this.countPorts();
        this.removeInvalidPorts();
        updateUi();
    }
}

;// CONCATENATED MODULE: ./src/core/core_op.js









/**
 * configuration object for loading a patch
 * @typedef OpUiAttribs
 * @property {string} [title] overwrite op title
 * @property {string} [hidePort] hidePort
 * @property {string} [title] overwrite op title
 * @property {String} [title=''] overwrite title of port (by default this is portname)
 * @property {object} [storage] internal - do not use manualy
 * @property {boolean} [working] internal - do not use manualy
 * @property {boolean} [bookmarked] internal - do not use manualy
 * @property {object} [uierrors] internal - do not use manualy - use op.setUiError
 * @property {string} [color]
 * @property {string} [comment]
 * @property {object} [translate]
 * @property {string} [subPatch] internal - do not use manualy - use op.setUiError
 */

class Op extends Events
{
    static OP_VERSION_PREFIX = "_v";

    #objName = "";
    _log = new Logger("core_op");
    #name = "";
    #shortOpName = "";

    opId = ""; // unique op id

    /** @type {Array<Port>} */
    portsOut = [];

    /** @type {Patch} */
    patch = null;

    data = {}; // UNUSED, DEPRECATED, only left in for backwards compatibility with userops
    storage = {}; // op-specific data to be included in export

    /** @type {Array<Port>} */
    portsIn = [];
    portsInData = []; // original loaded patch data

    /** @type {OpUiAttribs} */
    uiAttribs = {};
    enabled = true;

    onAnimFrame = null;

    preservedPortTitles = {};
    preservedPortValues = {};
    preservedPortLinks = {};

    linkTimeRules = {
        "needsLinkedToWork": [],
        "needsStringToWork": [],
        "needsParentOp": null
    };

    shouldWork = {};
    hasUiErrors = false;

    /** @type {Object} */
    uiErrors = {};
    hasAnimPort = false;

    /**
     * Description
     * @param {Patch} _patch
     * @param {String} _name
     * @param {String} _id=null
    */
    constructor(_patch, _name, _id = null)
    {
        super();

        this.#name = _name;
        this.patch = _patch;

        this.#shortOpName = CABLES.getShortOpName(_name);
        this.getTitle();

        this.id = _id || shortId(); // instance id
        this.onAddPort = null;
        this.onCreate = null;
        this.onResize = null;
        this.onLoaded = null;
        this.onDelete = null;
        this.onError = null;

        this._instances = null;

        /**
         * overwrite this to prerender shader and meshes / will be called by op `loadingStatus`
         * @function preRender
         * @memberof Op
         * @instance
         */
        this.preRender = null;

        /**
         * overwrite this to initialize your op
         * @function init
         * @memberof Op
         * @instance
         */
        this.init = null;

        /**
         * Implement to render 2d canvas based graphics from in an op - optionaly defined in op instance
         * @function renderVizLayer
         * @instance
         * @memberof Op
         * @param {CanvasRenderingContext2D} context of canvas 2d
         * @param {Object} layer info
         * @param {number} layer.x x position on canvas
         * @param {number} layer.y y position on canvas
         * @param {number} layer.width width of canvas
         * @param {number} layer.height height of canvas
         * @param {number} layer.scale current scaling of patchfield view
         */
        this.renderVizLayer = null;

        if (this.initUi) this.initUi();
    }

    get name()
    {
        return this.getTitle();
    }

    set name(n)
    {
        this.setTitle(n);
    }

    set _objName(on)
    {
        this.#objName = on;
        this._log = new Logger("op " + on);
    }

    get objName()
    {
        return this.#objName;
    }

    get shortName()
    {
        return this.#shortOpName;
    }

    /**
     * op.require
     *
     * @param {String} name - module name
     * @returns {Object}
     */
    require(name)
    {
        if (CABLES.platform && CABLES.StandaloneElectron && !CABLES.platform.frontendOptions.isElectron)
            this.setUiError("notstandalone", "This op will only work in cables standalone version", 3);

        return null;
    }

    checkMainloopExists()
    {
        if (!CABLES.UI) return;
        if (!this.patch.tempData.mainloopOp) this.setUiError("nomainloop", "patch should have a mainloop to use this op");
        else this.setUiError("nomainloop", null);
    }

    /** @returns {string} */
    getTitle()
    {
        if (!this.uiAttribs) return "nouiattribs" + this.#name;

        /*
         * if ((this.uiAttribs.title === undefined || this.uiAttribs.title === "") && this.objName.indexOf("Ops.Ui.") == -1)
         *     this.uiAttribs.title = this._shortOpName;
         */

        return this.uiAttribs.title || this.#shortOpName;
    }

    /**
     * @param {string} title
     */
    setTitle(title)
    {

        /*
         * this._log.log("settitle", title);
         * this._log.log(
         *     (new Error()).stack
         * );
         */

        if (title != this.getTitle()) this._setUiAttrib({ "title": title });
    }

    /**
     * @param {Object} newAttribs
     */
    setStorage(newAttribs)
    {
        if (!newAttribs) return;
        this.storage = this.storage || {};

        let changed = false;
        for (const p in newAttribs)
        {
            if (this.storage[p] != newAttribs[p]) changed = true;
            this.storage[p] = newAttribs[p];
        }

        if (changed) this.emitEvent("onStorageChange", newAttribs);
    }

    isSubPatchOp()
    {
        if (this.patchId && this.storage) return (this.storage.subPatchVer || this.storage.blueprintVer || 0);
        return false;
    }

    /**
     * setUiAttrib
     * possible values:
     * <pre>
     * warning - warning message - showing up in op parameter panel
     * error - error message - showing up in op parameter panel
     * extendTitle - op title extension, e.g. [ + ]
     * </pre>
     * @function setUiAttrib
     * @param {OpUiAttribs} newAttribs, e.g. {"attrib":value}
     * @memberof Op
     * @instance
     * @example
     * op.setUiAttrib({"extendTitle":str});
     */
    setUiAttrib(newAttribs)
    {
        this._setUiAttrib(newAttribs);
    }

    /**
     * @deprecated
     * @param {OpUiAttribs} a
     */
    setUiAttribs(a)
    {
        this._setUiAttrib(a);
    }

    /**
     * @deprecated
     * @param {OpUiAttribs} a
     */
    uiAttr(a)
    {
        this._setUiAttrib(a);
    }

    /**
     * @param {OpUiAttribs} newAttribs
     */
    _setUiAttrib(newAttribs)
    {
        if (!newAttribs) return;

        if (newAttribs.error || newAttribs.warning || newAttribs.hint)
            this._log.warn("old ui error/warning attribute in " + this.#name + ", use op.setUiError !", newAttribs);

        if (typeof newAttribs != "object") this._log.error("op.uiAttrib attribs are not of type object");
        if (!this.uiAttribs) this.uiAttribs = {};

        let changed = false;
        let emitMove = false;
        if (
            CABLES.UI &&
            newAttribs.hasOwnProperty("translate") &&
            (
                !this.uiAttribs.translate ||
                this.uiAttribs.translate.x != newAttribs.translate.x ||
                this.uiAttribs.translate.y != newAttribs.translate.y
            )) emitMove = true;

        if (newAttribs.hasOwnProperty("title") && newAttribs.title != this.uiAttribs.title)
        {
            // const doEmitEvent = newAttribs.title != this.getTitle();
            this.uiAttribs.title = newAttribs.title;
            // if (doEmitEvent) this.emitEvent("onTitleChange", newAttribs.title);
            changed = true;
            // this.setTitle(newAttribs.title);
        }

        if (newAttribs.hasOwnProperty("disabled")) this.setEnabled(!newAttribs.disabled);

        for (const p in newAttribs)
        {
            if (this.uiAttribs[p] != newAttribs[p]) changed = true;
            this.uiAttribs[p] = newAttribs[p];
        }

        if (this.uiAttribs.hasOwnProperty("selected") && this.uiAttribs.selected == false) delete this.uiAttribs.selected;

        if (changed)
        {
            this.emitEvent("onUiAttribsChange", newAttribs);
            this.patch.emitEvent("onUiAttribsChange", this, newAttribs);
        }

        if (emitMove) this.emitEvent("move");
    }

    getName()
    {
        if (this.uiAttribs.name) return this.uiAttribs.name;
        return this.#name;
    }

    /**
     * @param {Port} p
     */
    addOutPort(p)
    {
        p.direction = CONSTANTS.PORT.PORT_DIR_OUT;
        p._op = this;
        this.portsOut.push(p);
        this.emitEvent("onPortAdd", p);
        return p;
    }

    hasDynamicPort()
    {
        let i = 0;
        for (i = 0; i < this.portsIn.length; i++)
        {
            if (this.portsIn[i].type == Port.TYPE_DYNAMIC) return true;
            if (this.portsIn[i].getName() == "dyn") return true;
        }
        for (i = 0; i < this.portsOut.length; i++)
        {
            if (this.portsOut[i].type == Port.TYPE_DYNAMIC) return true;
            if (this.portsOut[i].getName() == "dyn") return true;
        }

        return false;
    }

    addInPort(p)
    {
        if (!(p instanceof Port)) throw new Error("parameter is not a port!");

        p.direction = Port.DIR_IN;
        p._op = this;

        this.portsIn.push(p);
        this.emitEvent("onPortAdd", p);

        return p;
    }

    /**
     * @deprecated
     */
    inFunction(name, v)
    {
        return this.inTrigger(name, v);
    }

    /**
     * create a trigger input port
     * @function inTrigger
     * @instance
     * @memberof Op
     * @param {String} v
     * @return {Port} created port
     *
     */
    inTrigger(name, v)
    {
        const p = this.addInPort(new Port(this, name, Port.TYPE_FUNCTION));
        if (v !== undefined) p.set(v);
        return p;
    }

    /**
     * create multiple UI trigger buttons
     * @function inTriggerButton
     * @memberof Op
     * @instance
     * @param {String} name
     * @param {Array} v
     * @return {Port} created port
     */

    inTriggerButton(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_FUNCTION, {
                "display": "button"
            })
        );
        if (v !== undefined) p.set(v);
        return p;
    }

    inUiTriggerButtons(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_FUNCTION, {
                "display": "buttons"
            })
        );
        if (v !== undefined) p.set(v);
        return p;
    }

    /**
     * @deprecated
     */
    inValueFloat(name, v)
    {
        return this.inFloat(name, v);
    }

    /**
     * @deprecated
     */
    inValue(name, v)
    {
        return this.inFloat(name, v);
    }

    /**
     * create a number value input port
     * @function inFloat
     * @memberof Op
     * @instance
     * @param {String} name
     * @param {Number} v
     * @return {Port} created port
     */
    inFloat(name, v)
    {
        const p = this.addInPort(new Port(this, name, Port.TYPE_VALUE));

        p.setInitialValue(v);

        return p;
    }

    /**
     * @deprecated
     */
    inValueBool(name, v)
    {
        return this.inBool(name, v);
    }

    /**
     * create a boolean input port, displayed as a checkbox
     * @function inBool
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {Boolean|number} v
     * @return {Port} created port
     */
    inBool(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_NUMBER, {
                "display": "bool"
            })
        );

        if (v === true)v = 1;
        if (v === false)v = 0;
        p.setInitialValue(v);

        return p;
    }

    /**
     * @param {string} name
     * @param {number} type
     */
    inMultiPort(name, type)
    {
        const p = new MultiPort(
            this,
            name,
            type,
            Port.DIR_IN,
            {
                "addPort": true,
                "hidePort": true
            }
        );
        p.ignoreValueSerialize = true;

        this.addInPort(p);
        p.initPorts();

        return p;
    }

    outMultiPort(name, type, uiAttribsPort = {})
    {
        const p = new MultiPort(
            this,
            name,
            type,
            CONSTANTS.PORT.PORT_DIR_OUT,
            {
                "display": "multiport",
                "hidePort": true
            },
            uiAttribsPort
        );
        p.ignoreValueSerialize = true;

        this.addOutPort(p);
        p.initPorts();

        return p;
    }

    /**
     * @param {string} name
     * @param {string} v
     */
    inValueString(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_VALUE, {
                "type": "string"
            })
        );
        p.value = "";

        p.setInitialValue(v);
        return p;
    }

    /**
     * create a String value input port
     * @function inString
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {String} v default value
     * @return {Port} created port
     */
    inString(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_STRING, {
                "type": "string"
            })
        );
        v = v || "";
        // p.value = v;

        p.setInitialValue(v);
        return p;
    }

    // /**
    //  * create a String value input port displayed as TextArea
    //  * @function inValueText
    //  * @instance
    //  * @memberof Op
    //  * @param {String} name
    //  * @param {String} v default value
    //  * @return {Port} created port
    //  */
    // inValueText(name, v)
    // {
    //     const p = this.addInPort(
    //         new Port(this, name, Port.TYPE_VALUE, {
    //             "type": "string",
    //             "display": "text"
    //         })
    //     );
    //     p.value = "";

    //     p.setInitialValue(v);

    //     /*
    //      * if (v !== undefined)
    //      * {
    //      *     p.set(v);
    //      *     p.defaultValue = v;
    //      * }
    //      */
    //     return p;
    // }

    /**
     * @param {string} name
     * @param {string} v
     */
    inTextarea(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_STRING, {
                "type": "string",
                "display": "text"
            })
        );
        p.value = "";
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    /**
     * create a String value input port displayed as editor
     * @function inStringEditor
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {String} v default value
     * @param {String} syntax language
     * @param {Boolean} hideFormatButton
     * @return {Port} created port
     */
    inStringEditor(name, v, syntax, hideFormatButton = true)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_STRING, {
                "type": "string",
                "display": "editor",
                "editShortcut": true,
                "editorSyntax": syntax,
                "hideFormatButton": hideFormatButton
            }));

        p.value = "";
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    /**
     * @deprecated
     */
    inValueEditor(name, v, syntax, hideFormatButton = true)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_NUMBER, {
                "type": "string",
                "display": "editor",
                "editorSyntax": syntax,
                "hideFormatButton": hideFormatButton
            })
        );
        p.value = "";
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    /**
     * @deprecated
     */
    inValueSelect(name, values, v, noindex)
    {
        return this.inDropDown(name, values, v, noindex);
    }

    /**
     * create a string select box
     * @function inDropDown
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {Array} values
     * @param {String} v default value
     * @return {Port} created port
     */
    inDropDown(name, values, v, noindex)
    {
        let p = null;
        if (!noindex)
        {
            const indexPort = new Port(this, name + " index", Port.TYPE_NUMBER, {
                "increment": "integer",
                "hideParam": true
            });
            const n = this.addInPort(indexPort);

            if (values) for (let i = 0; i < values.length; i++) values[i] = String(values[i]);

            const valuePort = new ValueSelectPort(
                this,
                name,
                Port.TYPE_NUMBER,
                {
                    "display": "dropdown",
                    "hidePort": true,
                    "type": "string",
                    "values": values
                },
                n

            );

            valuePort.indexPort = indexPort;

            valuePort.on("change", (val, thePort) =>
            {
                if (!thePort.indexPort.isLinked() && thePort.uiAttribs.values)
                {
                    const idx = thePort.uiAttribs.values.indexOf(val);
                    if (idx > -1) thePort.indexPort.set(idx);
                }
            });

            indexPort.onLinkChanged = () =>
            {
                valuePort.setUiAttribs({ "greyout": indexPort.isLinked() });
            };

            p = this.addInPort(valuePort);

            if (v !== undefined)
            {
                p.set(v);
                const index = values.findIndex((item) => { return item == v; });
                n.setValue(index);
                p.defaultValue = v;
                n.defaultValue = index;
            }
        }
        else
        {
            const valuePort = new Port(this, name, Port.TYPE_VALUE, {
                "display": "dropdown",
                "hidePort": true,
                "type": "string",
                values
            });

            p = this.addInPort(valuePort);
        }

        return p;
    }

    /**
     * create a string switch box
     * @function inSwitch
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {Array} values
     * @param {String} v default value
     * @return {Port} created port
     */
    inSwitch(name, values, v, noindex)
    {
        let p = null;
        if (!noindex)
        {
            if (!v)v = values[0];
            const indexPort = new Port(this, name + " index", Port.TYPE_VALUE, {
                "increment": "integer",
                "values": values,
                "hideParam": true
            });
            const n = this.addInPort(indexPort);

            if (values) for (let i = 0; i < values.length; i++) values[i] = String(values[i]);

            const switchPort = new SwitchPort(
                this,
                name,
                Port.TYPE_STRING,
                {
                    "display": "switch",
                    "hidePort": true,
                    "type": "string",
                    "values": values
                },
                n
            );

            switchPort.indexPort = indexPort;

            switchPort.on("change", (val, thePort) =>
            {
                if (!thePort.indexPort.isLinked() && thePort.uiAttribs.values)
                {
                    const idx = thePort.uiAttribs.values.indexOf(val);
                    if (idx > -1) thePort.indexPort.set(idx);
                }
            });

            indexPort.onLinkChanged = function ()
            {
                switchPort.setUiAttribs({ "greyout": indexPort.isLinked() });
            };
            p = this.addInPort(switchPort);

            if (v !== undefined)
            {
                p.set(v);
                const index = values.findIndex((item) => { return item == v; });
                n.setValue(index);
                p.defaultValue = v;
                n.defaultValue = index;
            }
        }
        else
        {
            const switchPort = new Port(this, name, Port.TYPE_STRING, {
                "display": "switch",
                "hidePort": true,
                "type": "string",
                "values": values
            });
            p = this.addInPort(switchPort);
        }

        return p;
    }

    /**
     * @deprecated
     */
    inValueInt(name, v)
    {
        return this.inInt(name, v);
    }

    /**
     * create a integer input port
     * @function inInt
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {number} v default value
     * @return {Port} created port
     */
    inInt(name, v)
    {
        // old
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_VALUE, {
                "increment": "integer" })
        );
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    /**
     * create a file/URL input port
     * @function inURL
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {String} filter
     * @param {String} v
     * @return {Port} created port
     */
    inFile(name, filter, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_VALUE, {
                "display": "file",
                "type": "string",
                "filter": filter
            })
        );
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    /**
     * @deprecated
     */
    inUrl(name, filter, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_STRING, {
                "display": "file",
                "type": "string",
                "filter": filter
            })
        );
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    /**
     * create a texture input port
     * @function inTexture
     * @instance
     * @memberof Op
     * @param {String} name
     * @return {Port} created port
     */
    inTexture(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_OBJECT, {
                "display": "texture",
                "objType": "texture",
                "preview": true
            })
        );
        p.ignoreValueSerialize = true;
        if (v !== undefined) p.set(v);
        return p;
    }

    /**
     * create a object input port
     * @function inObject
     * @instance
     * @memberof Op
     * @param {String} name
     * @return {Port} created port
     */
    inObject(name, v, objType)
    {
        const p = this.addInPort(new Port(this, name, Port.TYPE_OBJECT, { "objType": objType }));
        p.ignoreValueSerialize = true;

        if (v !== undefined) p.set(v);
        return p;
    }

    /**
     * @param {string} name
     * @param {string} v
     */
    inGradient(name, v)
    {
        const p = this.addInPort(
            new Port(this, name, Port.TYPE_VALUE, {
                "display": "gradient"
                // "hidePort": true
            })
        );
        if (v !== undefined) p.set(v);
        return p;
    }

    getPortVisibleIndex(p)
    {
        let ports = this.portsIn;
        if (p.direction == CONSTANTS.PORT_DIR_OUT)ports = this.portsOut;

        let index = 0;
        for (let i = 0; i < ports.length; i++)
        {
            if (ports[i].uiAttribs.hidePort) continue;
            index++;
            if (ports[i] == p) return index;
        }
    }

    /**
     * create a array input port
     * @param {String} name
     * @param {Array|Number} v
     * @param {number} stride
     * @return {Port} created port
     */
    inArray(name, v, stride)
    {
        if (!stride && CABLES.isNumeric(v))stride = v;

        const p = this.addInPort(new Port(this, name, Port.TYPE_ARRAY, { "stride": stride }));

        if (v !== undefined && (Array.isArray(v) || v == null)) p.set(v);

        return p;
    }

    /**
     * @deprecated
     */
    inValueSlider(name, v, min, max)
    {
        return this.inFloatSlider(name, v, min, max);
    }

    /**
     * create a value slider input port
     * @function inFloatSlider
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {number} v
     * @param {number} min
     * @param {number} max
     * @return {Port} created port
     */
    inFloatSlider(name, v, min, max)
    {
        const uiattribs = { "display": "range" };

        if (min != undefined && max != undefined)
        {
            uiattribs.min = min;
            uiattribs.max = max;
        }

        const p = this.addInPort(new Port(this, name, Port.TYPE_VALUE, uiattribs));
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    /**
     * @deprecated
     */
    outFunction(name, v)
    {
        return this.outTrigger(name, v);
    }

    /**
     * create output trigger port
     * @function outTrigger
     * @instance
     * @memberof Op
     * @param {String} name
     * @return {Port} created port
     */
    outTrigger(name, v)
    {
        // old
        const p = this.addOutPort(new Port(this, name, Port.TYPE_FUNCTION));
        if (v !== undefined) p.set(v);
        return p;
    }

    /**
     * @deprecated
     */
    outValue(name, v)
    {
        return this.outNumber(name, v);
    }

    /**
     * create output value port
     * @function outNumber
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {number} v default value
     * @return {Port} created port
     */
    outNumber(name, v)
    {
        const p = this.addOutPort(new Port(this, name, Port.TYPE_VALUE));
        if (v !== undefined) p.set(v);
        return p;
    }

    /**
     * @deprecated
     */
    outValueBool(name, v)
    {
        return this.outBool(name, v);
    }

    /**
     * deprecated create output boolean port
     * @deprecated
     * @function outBool
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {boolean} v default value
     * @return {Port} created port
     */
    outBool(name, v)
    {
        // old: use outBoolNum
        const p = this.addOutPort(
            new Port(this, name, Port.TYPE_VALUE, {
                "display": "bool"
            })
        );
        if (v !== undefined) p.set(v);
        else p.set(0);
        return p;
    }

    /**
     * create output boolean port,value will be converted to 0 or 1
     * @function outBoolNum
     * @instance
     * @memberof Op
     * @param {String} name
     * @return {Port} created port
     */
    outBoolNum(name, v)
    {
        const p = this.addOutPort(
            new Port(this, name, Port.TYPE_VALUE, {
                "display": "boolnum"
            })
        );

        p.set = function (b)
        {
            this.setValue(b ? 1 : 0);
        }.bind(p);

        if (v !== undefined) p.set(v);
        else p.set(0);
        return p;
    }

    /**
     * @deprecated
     */
    outValueString(name, v)
    {
        const p = this.addOutPort(
            new Port(this, name, Port.TYPE_VALUE, {
                "type": "string"
            })
        );
        if (v !== undefined) p.set(v);
        return p;
    }

    /**
     * create output string port
     * @function outString
     * @instance
     * @memberof Op
     * @param {String} v
     * @return {Port} created port
     */
    outString(name, v)
    {
        const p = this.addOutPort(
            new Port(this, name, Port.TYPE_STRING, {
                "type": "string"
            })
        );
        if (v !== undefined) p.set(v);
        else p.set("");
        return p;
    }

    /**
     * create output object port
     * @function outObject
     * @instance
     * @memberof Op
     * @param {String} name
     * @return {Port} created port
     */
    outObject(name, v, objType)
    {
        const p = this.addOutPort(new Port(this, name, Port.TYPE_OBJECT, { "objType": objType || null }));
        p.set(v || null);
        p.ignoreValueSerialize = true;
        return p;
    }

    /**
     * create output array port
     * @function outArray
     * @instance
     * @memberof Op
     * @param {String} name
     * @return {Port} created port
     */
    outArray(name, v, stride)
    {
        if (!stride && CABLES.isNumeric(v))stride = v;
        const p = this.addOutPort(new Port(this, name, Port.TYPE_ARRAY, { "stride": stride }));
        if (v !== undefined && (Array.isArray(v) || v == null)) p.set(v);

        p.ignoreValueSerialize = true;
        return p;
    }

    /**
     * create output texture port
     * @function outTexture
     * @instance
     * @memberof Op
     * @param {String} name
     * @return {Port} created port
     */
    outTexture(name, v)
    {
        const p = this.addOutPort(
            new Port(this, name, Port.TYPE_OBJECT, {
                "preview": true,
                "objType": "texture",
                "display": "texture"
            })
        );
        if (v !== undefined) p.setRef(v || CGL.Texture.getEmptyTexture(this.patch.cgl));

        p.ignoreValueSerialize = true;
        return p;
    }

    /**
     * @deprecated
     */
    inDynamic(name, filter, options, v)
    {
        const p = new Port(this, name, Port.TYPE_DYNAMIC, options);

        p.shouldLink = (p1, p2) =>
        {
            if (filter && CABLES.isArray(filter))
            {
                for (let i = 0; i < filter.length; i++)
                {
                    if (p1 == this && p2.type === filter[i]) return true;
                    if (p2 == this && p1.type === filter[i]) return true;
                }
                return false; // types do not match
            }
            return true; // no filter set
        };

        this.addInPort(p);
        if (v !== undefined)
        {
            p.set(v);
            p.defaultValue = v;
        }
        return p;
    }

    removeLinks()
    {
        for (let i = 0; i < this.portsIn.length; i++) this.portsIn[i].removeLinks();
        for (let i = 0; i < this.portsOut.length; i++) this.portsOut[i].removeLinks();
    }

    getSerialized()
    {
        const opObj = {};

        if (this.opId) opObj.opId = this.opId;
        if (this.patch.storeObjNames) opObj.objName = this.objName;

        opObj.id = this.id;
        opObj.uiAttribs = JSON.parse(JSON.stringify(this.uiAttribs)) || {};

        if (this.storage && Object.keys(this.storage).length > 0) opObj.storage = JSON.parse(JSON.stringify(this.storage));
        if (this.uiAttribs.hasOwnProperty("working") && this.uiAttribs.working == true) delete this.uiAttribs.working;
        if (opObj.uiAttribs.hasOwnProperty("uierrors")) delete opObj.uiAttribs.uierrors;

        if (opObj.uiAttribs.title === "") delete opObj.uiAttribs.title;
        if (opObj.uiAttribs.color === null) delete opObj.uiAttribs.color;
        if (opObj.uiAttribs.comment === null) delete opObj.uiAttribs.comment;

        if (opObj.uiAttribs.title == this.#shortOpName ||
            (this.uiAttribs.title || "").toLowerCase() == this.#shortOpName.toLowerCase()) delete opObj.uiAttribs.title;

        opObj.portsIn = [];
        opObj.portsOut = [];

        for (let i = 0; i < this.portsIn.length; i++)
        {
            const s = this.portsIn[i].getSerialized();
            if (s) opObj.portsIn.push(s);
        }

        for (let i = 0; i < this.portsOut.length; i++)
        {
            const s = this.portsOut[i].getSerialized();
            if (s) opObj.portsOut.push(s);
        }

        if (opObj.portsIn.length == 0) delete opObj.portsIn;
        if (opObj.portsOut.length == 0) delete opObj.portsOut;
        cleanJson(opObj);

        return opObj;
    }

    getFirstOutPortByType(type)
    {
        for (const ipo in this.portsOut) if (this.portsOut[ipo].type == type) return this.portsOut[ipo];
    }

    getFirstInPortByType(type)
    {
        for (const ipo in this.portsIn) if (this.portsIn[ipo].type == type) return this.portsIn[ipo];
    }

    /**
     * return port by the name portName
     * @function getPort
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {boolean} lowerCase
     * @return {Port}
     */
    getPort(name, lowerCase)
    {
        return this.getPortByName(name, lowerCase);
    }

    /**
     * @param {string} name
     * @param {boolean} [lowerCase]
     * @returns {Port}
     */
    getPortByName(name, lowerCase = false)
    {
        if (lowerCase)
        {
            for (let ipi = 0; ipi < this.portsIn.length; ipi++)
                if (this.portsIn[ipi].getName().toLowerCase() == name || this.portsIn[ipi].id.toLowerCase() == name)
                    return this.portsIn[ipi];

            for (let ipo = 0; ipo < this.portsOut.length; ipo++)
                if (this.portsOut[ipo].getName().toLowerCase() == name || this.portsOut[ipo].id.toLowerCase() == name)
                    return this.portsOut[ipo];
        }
        else
        {
            for (let ipi = 0; ipi < this.portsIn.length; ipi++)
                if (this.portsIn[ipi].getName() == name || this.portsIn[ipi].id == name)
                    return this.portsIn[ipi];

            for (let ipo = 0; ipo < this.portsOut.length; ipo++)
                if (this.portsOut[ipo].getName() == name || this.portsOut[ipo].id == name)
                    return this.portsOut[ipo];
        }
    }

    /**
     * return port by the name id
     * @function getPortById
     * @instance
     * @memberof Op
     * @param {String} id
     * @return {Port}
     */
    getPortById(id)
    {
        for (let ipi = 0; ipi < this.portsIn.length; ipi++) if (this.portsIn[ipi].id == id) return this.portsIn[ipi];
        for (let ipo = 0; ipo < this.portsOut.length; ipo++) if (this.portsOut[ipo].id == id) return this.portsOut[ipo];
    }

    updateAnims()
    {
        if (this.hasAnimPort)
            for (let i = 0; i < this.portsIn.length; i++) this.portsIn[i].updateAnim();
    }

    log()
    {
        this._log.log(...arguments);
    }

    /**
     * @deprecated
     */
    error()
    {
        this._log.error(...arguments);
    }

    logError()
    {
        this._log.error(...arguments);
    }

    /**
     * @deprecated
     */
    warn()
    {
        this._log.warn(...arguments);
    }

    logWarn()
    {
        this._log.warn(...arguments);
    }

    /**
     * @deprecated
     */
    verbose()
    {
        this._log.verbose(...arguments);
    }

    logVerbose()
    {
        this._log.verbose(...arguments);
    }

    profile()
    {
        for (let ipi = 0; ipi < this.portsIn.length; ipi++)
        {
            this.portsIn[ipi]._onTriggered = this.portsIn[ipi]._onTriggeredProfiling;
            this.portsIn[ipi].set = this.portsIn[ipi]._onSetProfiling;
        }
    }

    // findParent(objName)
    // {
    //     for (let ipi = 0; ipi < this.portsIn.length; ipi++)
    //     {
    //         if (this.portsIn[ipi].isLinked())
    //         {
    //             if (this.portsIn[ipi].links[0].portOut.parent.objName == objName)
    //                 return this.portsIn[ipi].links[0].portOut.parent;

    //             let found = null;
    //             found = this.portsIn[ipi].links[0].portOut.parent.findParent(objName);
    //             if (found) return found;
    //         }
    //     }
    //     return null;
    // }

    // todo: check instancing stuff?
    cleanUp()
    {
        if (this._instances)
        {
            for (let i = 0; i < this._instances.length; i++)
                if (this._instances[i].onDelete) this._instances[i].onDelete();

            this._instances.length = 0;
        }

        for (let i = 0; i < this.portsIn.length; i++)
            this.portsIn[i].setAnimated(false);

        if (this.onAnimFrame) this.patch.removeOnAnimFrame(this);
    }

    // todo: check instancing stuff?
    instanced(triggerPort)
    {
        return false;

        /*
         * this._log.log("instanced", this.patch.instancing.numCycles());
         * if (this.patch.instancing.numCycles() === 0) return false;
         */

        /*
         * let i = 0;
         * let ipi = 0;
         * if (!this._instances || this._instances.length != this.patch.instancing.numCycles())
         * {
         *     if (!this._instances) this._instances = [];
         *     this._.log("creating instances of ", this.objName, this.patch.instancing.numCycles(), this._instances.length);
         *     this._instances.length = this.patch.instancing.numCycles();
         */

        /*
         *     for (i = 0; i < this._instances.length; i++)
         *     {
         *         this._instances[i] = this.patch.createOp(this.objName, true);
         *         this._instances[i].instanced ()
         *         {
         *             return false;
         *         };
         *         this._instances[i].uiAttr(this.uiAttribs);
         */

        /*
         *         for (let ipo = 0; ipo < this.portsOut.length; ipo++)
         *         {
         *             if (this.portsOut[ipo].type == Port.TYPE_FUNCTION)
         *             {
         *                 this._instances[i].getPortByName(this.portsOut[ipo].name).trigger = this.portsOut[ipo].trigger.bind(this.portsOut[ipo]);
         *             }
         *         }
         *     }
         */

        /*
         *     for (ipi = 0; ipi < this.portsIn.length; ipi++)
         *     {
         *         this.portsIn[ipi].onChange = null;
         *         this.portsIn[ipi].onValueChanged = null;
         *     }
         * }
         */

        /*
         * const theTriggerPort = null;
         * for (ipi = 0; ipi < this.portsIn.length; ipi++)
         * {
         *     if (
         *         this.portsIn[ipi].type == Port.TYPE_VALUE ||
         *         this.portsIn[ipi].type == Port.TYPE_ARRAY
         *     )
         *     {
         *         this._instances[this.patch.instancing.index()].portsIn[ipi].set(this.portsIn[ipi].get());
         *     }
         *     if (this.portsIn[ipi].type == Port.TYPE_FUNCTION)
         *     {
         *         // if(this._instances[ this.patch.instancing.index() ].portsIn[ipi].name==triggerPort.name)
         *         // theTriggerPort=this._instances[ this.patch.instancing.index() ].portsIn[ipi];
         *     }
         * }
         */

        // if (theTriggerPort) theTriggerPort.onTriggered();

        /*
         * for (ipi = 0; ipi < this.portsOut.length; ipi++)
         * {
         *     if (this.portsOut[ipi].type == Port.TYPE_VALUE)
         *     {
         *         this.portsOut[ipi].set(this._instances[this.patch.instancing.index()].portsOut[ipi].get());
         *     }
         * }
         */

        // return true;
    }

    // todo: check instancing stuff?
    initInstancable()
    {
        //         if(this.isInstanced)
        //         {
        //             this._log.log('cancel instancing');
        //             return;
        //         }
        //         this._instances=[];
        //         for(var ipi=0;ipi<this.portsIn.length;ipi++)
        //         {
        //             if(this.portsIn[ipi].type==Port.TYPE_VALUE)
        //             {
        //
        //             }
        //             if(this.portsIn[ipi].type==Port.TYPE_FUNCTION)
        //             {
        //                 // var piIndex=ipi;
        //                 this.portsIn[ipi].onTriggered=function(piIndex)
        //                 {
        //
        //                     var i=0;
        // // this._log.log('trigger',this._instances.length);
        //
        //                 }.bind(this,ipi );
        //
        //             }
        // };
        // this._instances=null;
    }

    // setValues(obj)
    // {
    //     for (const i in obj)
    //     {
    //         const port = this.getPortByName(i);
    //         if (port) port.set(obj[i]);
    //         else this._log.warn("op.setValues: port not found:", i);
    //     }
    // }

    /**
     * return true if op has this error message id
     * @function hasUiError
     * @param {String} id
     * @returns {Boolean} - has id
     */
    hasUiError(id)
    {
        return this.uiErrors.hasOwnProperty(id) && this.uiErrors[id];
    }

    /**
     * show op error message - set message to null to remove error message
     * @function setUiError
     * @instance
     * @memberof Op
     * @param {string} id error id
     * @param {string} txt text message
     * @param {number} level level
     */
    setUiError(id, txt, level = 2, options = {})
    {
        // overwritten in ui: core_extend_op
    }

    // todo: remove
    // setError(id, txt)
    // {
    //     this._log.warn("old error message op.error() - use op.setUiError()");
    // }

    /**
     * enable/disable op
     * @function
     * @instance
     * @memberof Op
     * @param {boolean} b
     */
    setEnabled(b)
    {
        this.enabled = b;
        this.emitEvent("onEnabledChange", b);
    }

    /**
     * organize ports into a group
     * @function
     * @instance
     * @memberof Op
     * @param {String} name
     * @param {Array} ports
     */
    setPortGroup(name, ports)
    {
        for (let i = 0; i < ports.length; i++)
        {
            if (ports[i])
                if (ports[i].setUiAttribs) ports[i].setUiAttribs({ "group": name });
                else this._log.error("setPortGroup: invalid port!");
        }
    }

    /**
     * visually indicate ports that they are coordinate inputs
     * @function
     * @instance
     * @memberof Op
     * @param {Port} px
     * @param {Port} py
     * @param {Port} pz
     */
    setUiAxisPorts(px, py, pz)
    {
        if (px) px.setUiAttribs({ "axis": "X" });
        if (py) py.setUiAttribs({ "axis": "Y" });
        if (pz) pz.setUiAttribs({ "axis": "Z" });
    }

    /**
     * remove port from op
     * @function removePort
     * @instance
     * @memberof Op
     * @param {Port} port to remove
     */
    removePort(port)
    {
        for (let ipi = 0; ipi < this.portsIn.length; ipi++)
        {
            if (this.portsIn[ipi] == port)
            {
                this.portsIn.splice(ipi, 1);
                this.emitEvent("onUiAttribsChange", {});
                this.emitEvent("onPortRemoved", {});
                return;
            }
        }
        for (let ipi = 0; ipi < this.portsOut.length; ipi++)
        {
            if (this.portsOut[ipi] == port)
            {
                this.portsOut.splice(ipi, 1);
                this.emitEvent("onUiAttribsChange", {});
                this.emitEvent("onPortRemoved", {});
                return;
            }
        }
    }

    _checkLinksNeededToWork() {}

    /**
     * show a warning of this op is not a child of parentOpName
     * @function
     * @instance
     * @memberof Op
     * @param {String} parentOpName
     */
    toWorkNeedsParent(parentOpName)
    {
        this.linkTimeRules.needsParentOp = parentOpName;
    }

    // /**
    //  * show a warning of this op is a child of parentOpName
    //  * @function
    //  * @instance
    //  * @memberof Op
    //  * @param {String} parentOpName
    //  */
    toWorkShouldNotBeChild(parentOpName, type)
    {
        if (!this.patch.isEditorMode()) return;
        this.linkTimeRules.forbiddenParent = parentOpName;
        if (type != undefined) this.linkTimeRules.forbiddenParentType = type;
    }

    toWorkPortsNeedsString()
    {
        if (!this.patch.isEditorMode()) return;
        for (let i = 0; i < arguments.length; i++)
            if (this.linkTimeRules.needsStringToWork.indexOf(arguments[i]) == -1) this.linkTimeRules.needsStringToWork.push(arguments[i]);
    }

    /**
     * show a small X to indicate op is not working when given ports are not linked
     * @function
     * @instance
     * @memberof Op
     * @param {Port} port1
     * @param {Port} port2
     * @param {Port} port3
     */
    toWorkPortsNeedToBeLinked()
    {
        if (!this.patch.isEditorMode()) return;
        for (let i = 0; i < arguments.length; i++)
            if (this.linkTimeRules.needsLinkedToWork.indexOf(arguments[i]) == -1) this.linkTimeRules.needsLinkedToWork.push(arguments[i]);
    }

    toWorkPortsNeedToBeLinkedReset()
    {
        if (!this.patch.isEditorMode()) return;
        this.linkTimeRules.needsLinkedToWork.length = 0;
        if (this.checkLinkTimeWarnings) this.checkLinkTimeWarnings();
    }

    initVarPorts()
    {
        for (let i = 0; i < this.portsIn.length; i++)
        {
            if (this.portsIn[i].getVariableName()) this.portsIn[i].setVariable(this.portsIn[i].getVariableName());
        }
    }

    /**
     * refresh op parameters, if current op is selected
     * @function
     * @instance
     * @memberof Op
     */
    refreshParams()
    {
        if (this.patch && this.patch.isEditorMode() && this.isCurrentUiOp())
            gui.opParams.show(this);
    }

    /**
     * Returns true if op is selected and parameter are shown in the editor, can only return true if in editor/ui
     * @function isCurrentUiOp
     * @instance
     * @memberof Op
     * @returns {Boolean} - is current ui op
     */
    isCurrentUiOp()
    {
        if (this.patch.isEditorMode()) return gui.patchView.isCurrentOp(this);
    }
}

;// CONCATENATED MODULE: ./src/core/loadingstatus.js




/**
 * LoadingStatus class, manages asynchronous loading jobs
 *
 * @namespace external:CABLES#LoadingStatus
 * @hideconstructor
 * @class
 * @param patch
 */

class LoadingStatus extends Events
{

    /**
     * @param {Patch} patch
     */
    constructor(patch)
    {
        super();
        this._log = new Logger("LoadingStatus");
        this._loadingAssets = {};
        this._cbFinished = [];
        this._assetTasks = [];
        this._percent = 0;
        this._count = 0;
        this._countFinished = 0;
        this._order = 0;
        this._startTime = 0;
        this._patch = patch;
        this._wasFinishedPrinted = false;
        this._loadingAssetTaskCb = false;
    }

    setOnFinishedLoading(cb)
    {
        this._cbFinished.push(cb);
    }

    getNumAssets()
    {
        return this._countFinished;
    }

    getProgress()
    {
        return this._percent;
    }

    checkStatus()
    {
        this._countFinished = 0;
        this._count = 0;

        for (const i in this._loadingAssets)
        {
            this._count++;
            if (!this._loadingAssets[i].finished)
            {
                this._countFinished++;
            }
        }

        this._percent = (this._count - this._countFinished) / this._count;

        if (this._countFinished === 0)
        {
            for (let j = 0; j < this._cbFinished.length; j++)
            {
                if (this._cbFinished[j])
                {
                    const cb = this._cbFinished[j];
                    setTimeout(() => { cb(this._patch); this.emitEvent("finishedAll"); }, 100);
                }
            }

            if (!this._wasFinishedPrinted)
            {
                this._wasFinishedPrinted = true;
                this.print();
            }
            this.emitEvent("finishedAll");
        }
    }

    getList()
    {
        let arr = [];
        for (const i in this._loadingAssets)
        {
            arr.push(this._loadingAssets[i]);
        }

        return arr;
    }

    getListJobs()
    {
        let arr = [];
        for (const i in this._loadingAssets)
        {
            if (!this._loadingAssets[i].finished)arr.push(this._loadingAssets[i].name);
        }

        return arr;
    }

    print()
    {
        if (this._patch.config.silent) return;

        const rows = [];

        for (const i in this._loadingAssets)
        {
            rows.push([
                this._loadingAssets[i].order,
                this._loadingAssets[i].type,
                this._loadingAssets[i].name,
                (this._loadingAssets[i].timeEnd - this._loadingAssets[i].timeStart) / 1000 + "s",
            ]);
        }

        this._log.groupCollapsed("finished loading " + this._order + " assets in " + (Date.now() - this._startTime) / 1000 + "s");
        this._log.table(rows);
        this._log.groupEnd();
    }

    finished(id)
    {
        const l = this._loadingAssets[id];
        if (l)
        {
            if (l.finished) this._log.warn("loading job was already finished", l);

            if (l.op) l.op.setUiAttribs({ "loading": false });
            l.finished = true;
            l.timeEnd = Date.now();
        }

        this.checkStatus();
        this.emitEvent("finishedTask");
        return null;
    }

    _startAssetTasks()
    {
        for (let i = 0; i < this._assetTasks.length; i++) this._assetTasks[i]();
        this._assetTasks.length = 0;
    }

    /**
     * delay an asset loading task, mainly to wait for ui to be finished loading and showing, and only then start loading assets
     * @function addAssetLoadingTask
     * @instance
     * @memberof LoadingStatus
     * @param {function} cb callback
     */
    addAssetLoadingTask(cb)
    {
        if (this._patch.isEditorMode() && !CABLES.UI.loaded)
        {
            this._assetTasks.push(cb);

            if (!this._loadingAssetTaskCb)window.gui.addEventListener("uiloaded", this._startAssetTasks.bind(this));
            this._loadingAssetTaskCb = true;
        }
        else
        {
            cb();
        }
        this.emitEvent("addAssetTask");
    }

    existByName(name)
    {
        for (let i in this._loadingAssets)
        {
            if (this._loadingAssets[i].name == name && !this._loadingAssets[i].finished)
                return true;
        }
    }

    start(type, name, op)
    {
        if (this._startTime == 0) this._startTime = Date.now();
        const id = generateUUID();

        name = name || "unknown";
        if (name.length > 100)name = name.substring(0, 100);

        if (op)op.setUiAttribs({ "loading": true });

        this._loadingAssets[id] = {
            "id": id,
            "op": op,
            "type": type,
            "name": name,
            "finished": false,
            "timeStart": Date.now(),
            "order": this._order,
        };
        this._order++;

        this.emitEvent("startTask");

        return id;
    }
}

;// CONCATENATED MODULE: ./src/core/timer.js


/**
 * @namespace CABLES
 */

const internalNow = function ()
{
    return window.performance.now();
};

/*
 * current time in milliseconds
 * @memberof CABLES
 * @function now
 * @static
 *
 */
const now = function ()
{
    return internalNow();
};

/**
 * Measuring time
 * @namespace external:CABLES#Timer
 * @hideconstructor
 * @class
 */
class Timer extends Events
{
    constructor()
    {
        super();

        /**
         * @private
         */
        this._timeStart = internalNow();
        this._timeOffset = 0;
        this._currentTime = 0;
        this._lastTime = 0;
        this._paused = true;
        this._delay = 0;
        this.overwriteTime = -1;
    }

    _internalNow()
    {
        if (this._ts) return this._ts;
        return internalNow();
    }

    _getTime()
    {
        this._lastTime = (this._internalNow() - this._timeStart) / 1000;
        return this._lastTime + this._timeOffset;
    }

    setDelay(d)
    {
        this._delay = d;
        this.emitEvent("timeChange");
    }

    /**
     * @function
     * @memberof Timer
     * @instance
     * @description returns true if timer is playing
     * @return {Boolean} value
     */
    isPlaying()
    {
        return !this._paused;
    }

    /**
     * @function
     * @memberof Timer
     * @instance
     * @param ts
     * @description update timer
     * @return {Number} time
     */
    update(ts)
    {
        if (ts) this._ts = ts;
        if (this._paused) return;
        this._currentTime = this._getTime();

        return this._currentTime;
    }

    /**
     * @function
     * @memberof Timer
     * @instance
     * @return {Number} time in milliseconds
     */
    getMillis()
    {
        return this.get() * 1000;
    }

    /**
     * @function
     * @memberof Timer
     * @instance
     * @return {Number} value time in seconds
     */
    get()
    {
        return this.getTime();
    }

    getTime()
    {
        if (this.overwriteTime >= 0) return this.overwriteTime - this._delay;
        return this._currentTime - this._delay;
    }

    /**
     * toggle between play/pause state
     * @function
     * @memberof Timer
     * @instance
     */
    togglePlay()
    {
        if (this._paused) this.play();
        else this.pause();
    }

    /**
     * set current time
     * @function
     * @memberof Timer
     * @instance
     * @param {Number} t
     */
    setTime(t)
    {
        if (isNaN(t) || t < 0) t = 0;
        this._timeStart = this._internalNow();
        this._timeOffset = t;
        this._currentTime = t;
        this.emitEvent("timeChange");
    }

    setOffset(val)
    {
        if (this._currentTime + val < 0)
        {
            this._timeStart = this._internalNow();
            this._timeOffset = 0;
            this._currentTime = 0;
        }
        else
        {
            this._timeOffset += val;
            this._currentTime = this._lastTime + this._timeOffset;
        }
        this.emitEvent("timeChange");
    }

    /**
     * (re)starts the timer
     * @function
     * @memberof Timer
     * @instance
     */
    play()
    {
        this._timeStart = this._internalNow();
        this._paused = false;
        this.emitEvent("playPause");
    }

    /**
     * pauses the timer
     * @function
     * @memberof Timer
     * @instance
     */
    pause()
    {
        this._timeOffset = this._currentTime;
        this._paused = true;
        this.emitEvent("playPause");
    }
}



;// CONCATENATED MODULE: ./src/core/core_profiler.js



class Profiler
{

    /**
     * @param {Patch} patch
     */
    constructor(patch)
    {
        this.startFrame = patch.getFrameNum();
        this.items = {};
        this.currentId = null;
        this.currentStart = 0;
        this._patch = patch;
    }

    getItems()
    {
        return this.items;
    }

    clear()
    {
        if (this.paused) return;
        this.items = {};
    }

    togglePause()
    {
        this.paused = !this.paused;
        if (!this.paused)
        {
            this.items = {};
            this.currentStart = performance.now();
        }
    }

    add(type, object)
    {
        if (this.paused) return;

        if (this.currentId !== null)
        {
            if (!object || object.id != this.currentId)
            {
                if (this.items[this.currentId])
                {
                    this.items[this.currentId].timeUsed += performance.now() - this.currentStart;

                    if (!this.items[this.currentId].peakTime || now() - this.items[this.currentId].peakTime > 5000)
                    {
                        this.items[this.currentId].peak = 0;
                        this.items[this.currentId].peakTime = now();
                    }
                    this.items[this.currentId].peak = Math.max(this.items[this.currentId].peak, performance.now() - this.currentStart);
                }
            }
        }

        if (object !== null)
        {
            if (!this.items[object.id])
            {
                this.items[object.id] = {
                    "numTriggers": 0,
                    "timeUsed": 0,
                };
            }

            if (this.items[object.id].lastFrame != this._patch.getFrameNum()) this.items[object.id].numTriggers = 0;

            this.items[object.id].lastFrame = this._patch.getFrameNum();
            this.items[object.id].numTriggers++;
            this.items[object.id].opid = object.op.id;
            this.items[object.id].title = object.op.name + "." + object.name;
            this.items[object.id].subPatch = object.op.uiAttribs.subPatch;

            this.currentId = object.id;
            this.currentStart = performance.now();
        }
        else
        {
            this.currentId = null;
        }
    }

    print()
    {
        console.log("--------");
        for (const i in this.items)
        {
            console.log(this.items[i].title + ": " + this.items[i].numTriggers + " / " + this.items[i].timeUsed);
        }
    }
}

;// CONCATENATED MODULE: ./src/core/core_variable.js


class PatchVariable extends Events
{

    /**
     * @param {String} name
     * @param {String|Number} val
     * @param {number} type
     */
    constructor(name, val, type)
    {
        super();
        this._name = name;
        this.type = type;
        this.setValue(val);
    }

    /**
     * keeping this for backwards compatibility in older
     * exports before using eventtarget
     *
     * @param cb
     */
    addListener(cb)
    {
        this.on("change", cb, "var");
    }

    /**
     * @function Variable.getValue
     * @memberof PatchVariable
     * @returns {String|Number|Boolean}
     */
    getValue()
    {
        return this._v;
    }

    /**
     * @function getName
     * @memberof PatchVariable
     * @instance
     * @returns {String|Number|Boolean}
     * @function
     */
    getName()
    {
        return this._name;
    }

    /**
     * @function setValue
     * @memberof PatchVariable
     * @instance
     * @param v
     * @returns {any}
     * @function
     */
    setValue(v)
    {
        this._v = v;
        this.emitEvent("change", v, this);
    }
}

;// CONCATENATED MODULE: ./src/core/cgl/constants.js
const SHADER = {
    // default attributes
    "SHADERVAR_VERTEX_POSITION": "vPosition",
    "SHADERVAR_VERTEX_NUMBER": "attrVertIndex",
    "SHADERVAR_VERTEX_NORMAL": "attrVertNormal",
    "SHADERVAR_VERTEX_TEXCOORD": "attrTexCoord",
    "SHADERVAR_INSTANCE_MMATRIX": "instMat",
    "SHADERVAR_VERTEX_COLOR": "attrVertColor",

    "SHADERVAR_INSTANCE_INDEX": "instanceIndex",

    // default uniforms
    "SHADERVAR_UNI_PROJMAT": "projMatrix",
    "SHADERVAR_UNI_VIEWMAT": "viewMatrix",
    "SHADERVAR_UNI_MODELMAT": "modelMatrix",
    "SHADERVAR_UNI_NORMALMAT": "normalMatrix",
    "SHADERVAR_UNI_INVVIEWMAT": "inverseViewMatrix",
    "SHADERVAR_UNI_INVPROJMAT": "invProjMatrix",
    "SHADERVAR_UNI_MATERIALID": "materialId",
    "SHADERVAR_UNI_OBJECTID": "objectId",

    "SHADERVAR_UNI_VIEWPOS": "camPos",
};

const BLEND_MODES = {
    "BLEND_NONE": 0,
    "BLEND_NORMAL": 1,
    "BLEND_ADD": 2,
    "BLEND_SUB": 3,
    "BLEND_MUL": 4,
};

const RAD2DEG = 180.0 / Math.PI;
const DEG2RAD = Math.PI / 180.0;

const constants_CONSTANTS = {
    "MATH": {
        "DEG2RAD": DEG2RAD,
        "RAD2DEG": RAD2DEG,
    },
    "SHADER": SHADER,
    "BLEND_MODES": BLEND_MODES,
};



;// CONCATENATED MODULE: ./src/core/cg/cg_uniform.js




class CgUniform
{

    /**
     * Description
     * @param {CgShader} __shader
     * @param {string} __type
     * @param {string} __name
     * @param {Number|Port} _value
     * @param {Port} _port2
     * @param {Port} _port3
     * @param {Port} _port4
     */
    constructor(__shader, __type, __name, _value, _port2, _port3, _port4, _structUniformName, _structName, _propertyName)
    {
        this._log = new Logger("cg_uniform");
        this._type = __type;
        this._name = __name;
        this._shader = __shader;
        this._value = 0.00001;
        this._oldValue = null;
        this._port = null;

        this._structName = _structName;
        this._structUniformName = _structUniformName;
        this._propertyName = _propertyName;

        this._shader._addUniform(this);
        this.needsUpdate = true;
        this.shaderType = null;
        this.comment = null;

        if (__type == "f")
        {
            this.set = this.setValue = this.setValueF.bind(this);
            this.updateValue = this.updateValueF.bind(this);
        }
        else if (__type == "f[]")
        {
            this.set = this.setValue = this.setValueArrayF.bind(this);
            this.updateValue = this.updateValueArrayF.bind(this);
        }
        else if (__type == "2f[]")
        {
            this.set = this.setValue = this.setValueArray2F.bind(this);
            this.updateValue = this.updateValueArray2F.bind(this);
        }
        else if (__type == "3f[]")
        {
            this.set = this.setValue = this.setValueArray3F.bind(this);
            this.updateValue = this.updateValueArray3F.bind(this);
        }
        else if (__type == "4f[]")
        {
            this.set = this.setValue = this.setValueArray4F.bind(this);
            this.updateValue = this.updateValueArray4F.bind(this);
        }
        else if (__type == "i")
        {
            this.set = this.setValue = this.setValueI.bind(this);
            this.updateValue = this.updateValueI.bind(this);
        }
        else if (__type == "2i")
        {
            this.set = this.setValue = this.setValue2I.bind(this);
            this.updateValue = this.updateValue2I.bind(this);
        }
        else if (__type == "3i")
        {
            this.set = this.setValue = this.setValue3I.bind(this);
            this.updateValue = this.updateValue3I.bind(this);
        }
        else if (__type == "4i")
        {
            this.set = this.setValue = this.setValue4I.bind(this);
            this.updateValue = this.updateValue4I.bind(this);
        }
        else if (__type == "b")
        {
            this.set = this.setValue = this.setValueBool.bind(this);
            this.updateValue = this.updateValueBool.bind(this);
        }
        else if (__type == "4f")
        {
            this.set = this.setValue = this.setValue4F.bind(this);
            this.updateValue = this.updateValue4F.bind(this);
        }
        else if (__type == "3f")
        {
            this.set = this.setValue = this.setValue3F.bind(this);
            this.updateValue = this.updateValue3F.bind(this);
        }
        else if (__type == "2f")
        {
            this.set = this.setValue = this.setValue2F.bind(this);
            this.updateValue = this.updateValue2F.bind(this);
        }
        else if (__type == "t")
        {
            this.set = this.setValue = this.setValueT.bind(this);
            this.updateValue = this.updateValueT.bind(this);
        }
        else if (__type == "sampler")
        {
            if (this.setValueAny)
            {
                this.set = this.setValue = this.setValueAny.bind(this);
                this.updateValue = this.updateValueAny.bind(this);
            }
        }
        else if (__type == "tc")
        {
            this.set = this.setValue = this.setValueT.bind(this);
            this.updateValue = this.updateValueT.bind(this);
        }
        else if (__type == "t[]")
        {
            this.set = this.setValue = this.setValueArrayT.bind(this);
            this.updateValue = this.updateValueArrayT.bind(this);
        }
        else if (__type == "m4" || __type == "m4[]")
        {
            this.set = this.setValue = this.setValueM4.bind(this);
            this.updateValue = this.updateValueM4.bind(this);
        }
        else
        {
            // console.error("unknown");
            this._log.error("Unknown uniform type " + __type);
        }

        if (typeof _value == "object" && _value instanceof Port)
        {
            this._port = _value;
            this._value = this._port.get();

            if (_port2 && _port3 && _port4)
            {
                if (!(_port2 instanceof Port) || !(_port3 instanceof Port) || !(_port4 instanceof Port))
                {
                    this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ", this._name);
                }

                this._value = [0, 0, 0, 0];
                this._port2 = _port2;
                this._port3 = _port3;
                this._port4 = _port4;

                this._port.on("change", this.updateFromPort4f.bind(this));
                this._port2.on("change", this.updateFromPort4f.bind(this));
                this._port3.on("change", this.updateFromPort4f.bind(this));
                this._port4.on("change", this.updateFromPort4f.bind(this));

                // this._port.onChange = this._port2.onChange = this._port3.onChange = this._port4.onChange = this.updateFromPort4f.bind(this);
                this.updateFromPort4f();
            }
            else if (_port2 && _port3)
            {
                if (!(_port2 instanceof Port) || !(_port3 instanceof Port))
                {
                    this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ", this._name);
                }

                this._value = [0, 0, 0];
                this._port2 = _port2;
                this._port3 = _port3;
                // this._port.onChange = this._port2.onChange = this._port3.onChange = this.updateFromPort3f.bind(this);
                this._port.on("change", this.updateFromPort3f.bind(this));
                this._port2.on("change", this.updateFromPort3f.bind(this));
                this._port3.on("change", this.updateFromPort3f.bind(this));

                this.updateFromPort3f();
            }
            else if (_port2)
            {
                if (!(_port2 instanceof Port))
                {
                    this._log.error("[cgl_uniform] mixed port/value parameter for vec4 ", this._name);
                }

                this._value = [0, 0];
                this._port2 = _port2;
                // this._port.onChange = this._port2.onChange = this.updateFromPort2f.bind(this);
                this._port.on("change", this.updateFromPort2f.bind(this));
                this._port2.on("change", this.updateFromPort2f.bind(this));

                this.updateFromPort2f();
            }
            else
            {
                // this._port.on = this.updateFromPort.bind(this);
                this._port.on("change", this.updateFromPort.bind(this));
            }
        }
        else this._value = _value;

        if (this._value == undefined)
        {
            this._value = 0;
        }

        this.setValue(this._value);

        this.needsUpdate = true;
    }

    getType()
    {
        return this._type;
    }

    get type()
    {
        return this._type;
    }

    get name()
    {
        return this._name;
    }

    getName()
    {
        return this._name;
    }

    getValue()
    {
        return this._value;
    }

    getShaderType()
    {
        return this.shaderType;
    }

    isStructMember()
    {
        return !!this._structName;
    }

    updateFromPort4f()
    {
        this._value[0] = this._port.get();
        this._value[1] = this._port2.get();
        this._value[2] = this._port3.get();
        this._value[3] = this._port4.get();
        this.setValue(this._value);
    }

    updateFromPort3f()
    {
        this._value[0] = this._port.get();
        this._value[1] = this._port2.get();
        this._value[2] = this._port3.get();
        this.setValue(this._value);
    }

    updateFromPort2f()
    {
        this._value[0] = this._port.get();
        this._value[1] = this._port2.get();
        this.setValue(this._value);
    }

    updateFromPort()
    {
        this.setValue(this._port.get());
    }
}

;// CONCATENATED MODULE: ./src/core/cgl/cgl_shader_uniform.js




/**
 * Shader uniforms
 *
 * types:
 * <pre>
 * f    - float
 * 2f   - vec2
 * 3f   - vec3
 * 4f   - vec4
 * i    - integer
 * t    - texture
 * m4   - mat4, 4x4 float matrix
 * f[]  - array of floats
 * 2f[] - array of float vec2
 * 3f[] - array of float vec3
 * 4f[] - array of float vec4
 * </pre>
 *
 * @namespace external:CGL
 * @class
 * @param {CgShader} shader
 * @param {String} [type=f]
 * @param {String} name
 * @param {Number|Port} value  can be a Number,Matrix or Port
 * @example
 * // bind float uniform called myfloat and initialize with value 1.0
 * const unir=new CGL.Uniform(shader,'f','myfloat',1.0);
 * unir.setValue(1.0);
 *
 * // bind float uniform called myfloat and automatically set it to input port value
 * const myPort=op.inFloat("input");
 * const pv=new CGL.Uniform(shader,'f','myfloat',myPort);
 *
 */

// export const Uniform(__shader, __type, __name, _value, _port2, _port3, _port4, _structUniformName, _structName, _propertyName)

class cgl_shader_uniform_Uniform extends CgUniform
{
    constructor(__shader, __type, __name, _value, _port2, _port3, _port4, _structUniformName, _structName, _propertyName)
    {
        super(__shader, __type, __name, _value, _port2, _port3, _port4, _structUniformName, _structName, _propertyName);
        this._loc = -1;
        this._cgl = __shader._cgl;
    }

    get name()
    {
        return this._name;
    }

    copy(newShader)
    {
        const uni = new cgl_shader_uniform_Uniform(newShader, this._type, this._name, this._value, this._port2, this._port3, this._port4, this._structUniformName, this._structName, this._propertyName);
        uni.shaderType = this.shaderType;
        return uni;
    }

    /**
     * returns type as glsl type string. e.g. 'f' returns 'float'
     * @function getGlslTypeString
     * @memberof Uniform
     * @instance
     * @return {string} type as string
     */
    getGlslTypeString()
    {
        return cgl_shader_uniform_Uniform.glslTypeString(this._type);
    }

    _isValidLoc()
    {
        return this._loc != -1;// && this._loc != null;
    }

    resetLoc()
    {
        this._loc = -1;
        this.needsUpdate = true;
    }

    bindTextures() {}

    getLoc()
    {
        return this._loc;
    }

    updateFromPort4f()
    {
        this._value[0] = this._port.get();
        this._value[1] = this._port2.get();
        this._value[2] = this._port3.get();
        this._value[3] = this._port4.get();
        this.setValue(this._value);
    }

    updateFromPort3f()
    {
        this._value[0] = this._port.get();
        this._value[1] = this._port2.get();
        this._value[2] = this._port3.get();
        this.setValue(this._value);
    }

    updateFromPort2f()
    {
        this._value[0] = this._port.get();
        this._value[1] = this._port2.get();
        this.setValue(this._value);
    }

    updateFromPort()
    {
        this.setValue(this._port.get());
    }

    updateValueF()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;

        this._shader.getCgl().gl.uniform1f(this._loc, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    setValueF(v)
    {
        if (v != this._value)
        {
            this.needsUpdate = true;
            this._value = v;
        }
    }

    updateValueI()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;

        this._shader.getCgl().gl.uniform1i(this._loc, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    updateValue2I()
    {
        if (!this._value) return;

        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }

        this._shader.getCgl().gl.uniform2i(this._loc, this._value[0], this._value[1]);

        this.needsUpdate = false;
        this._cgl.profileData.profileUniformCount++;
    }

    updateValue3I()
    {
        if (!this._value) return;
        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }

        this._shader.getCgl().gl.uniform3i(this._loc, this._value[0], this._value[1], this._value[2]);
        this.needsUpdate = false;
        this._cgl.profileData.profileUniformCount++;
    }

    updateValue4I()
    {
        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }
        this._shader.getCgl().gl.uniform4i(this._loc, this._value[0], this._value[1], this._value[2], this._value[3]);
        this._cgl.profileData.profileUniformCount++;
    }

    setValueI(v)
    {
        if (v != this._value)
        {
            this.needsUpdate = true;
            this._value = v;
        }
    }

    setValue2I(v)
    {
        if (!v) return;
        if (!this._oldValue)
        {
            this._oldValue = [v[0] - 1, 1];
            this.needsUpdate = true;
        }
        else if (v[0] != this._oldValue[0] || v[1] != this._oldValue[1])
        {
            this._oldValue[0] = v[0];
            this._oldValue[1] = v[1];
            this.needsUpdate = true;
        }

        this._value = v;
    }

    setValue3I(v)
    {
        if (!v) return;
        if (!this._oldValue)
        {
            this._oldValue = [v[0] - 1, 1, 2];
            this.needsUpdate = true;
        }
        else if (v[0] != this._oldValue[0] || v[1] != this._oldValue[1] || v[2] != this._oldValue[2])
        {
            this._oldValue[0] = v[0];
            this._oldValue[1] = v[1];
            this._oldValue[2] = v[2];
            this.needsUpdate = true;
        }

        this._value = v;
    }

    setValue4I(v)
    {
        this.needsUpdate = true;
        this._value = v || vec4.create();
    }

    updateValueBool()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;
        this._shader.getCgl().gl.uniform1i(this._loc, this._value ? 1 : 0);

        this._cgl.profileData.profileUniformCount++;
    }

    setValueBool(v)
    {
        if (v != this._value)
        {
            this.needsUpdate = true;
            this._value = v;
        }
    }

    setValueArray4F(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValueArray4F()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;

        if (!this._value) return;
        this._shader.getCgl().gl.uniform4fv(this._loc, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    setValueArray3F(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValueArray3F()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;

        if (!this._value) return;
        this._shader.getCgl().gl.uniform3fv(this._loc, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    setValueArray2F(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValueArray2F()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;

        if (!this._value) return;
        this._shader.getCgl().gl.uniform2fv(this._loc, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    setValueArrayF(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValueArrayF()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;

        if (!this._value) return;
        this._shader.getCgl().gl.uniform1fv(this._loc, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    setValueArrayT(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValue3F()
    {
        if (!this._value) return;
        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }

        this._shader.getCgl().gl.uniform3f(this._loc, this._value[0], this._value[1], this._value[2]);
        this.needsUpdate = false;
        this._cgl.profileData.profileUniformCount++;
    }

    setValue3F(v)
    {
        if (!v) return;
        if (!this._oldValue)
        {
            this._oldValue = [v[0] - 1, 1, 2];
            this.needsUpdate = true;
        }
        else if (v[0] != this._oldValue[0] || v[1] != this._oldValue[1] || v[2] != this._oldValue[2])
        {
            this._oldValue[0] = v[0];
            this._oldValue[1] = v[1];
            this._oldValue[2] = v[2];
            this.needsUpdate = true;
        }

        this._value = v;
    }

    updateValue2F()
    {
        if (!this._value) return;

        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }

        this._shader.getCgl().gl.uniform2f(this._loc, this._value[0], this._value[1]);
        this.needsUpdate = false;
        this._cgl.profileData.profileUniformCount++;
    }

    setValue2F(v)
    {
        if (!v) return;
        if (!this._oldValue)
        {
            this._oldValue = [v[0] - 1, 1];
            this.needsUpdate = true;
        }
        else if (v[0] != this._oldValue[0] || v[1] != this._oldValue[1])
        {
            this._oldValue[0] = v[0];
            this._oldValue[1] = v[1];
            this.needsUpdate = true;
        }
        this._value = v;
    }

    updateValue4F()
    {
        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }

        if (!this._value)
        {
            this._log.warn("no value for uniform", this._name, this);
            this._value = [0, 0, 0, 0];
        }

        this.needsUpdate = false;
        this._shader.getCgl().gl.uniform4f(this._loc, this._value[0], this._value[1], this._value[2], this._value[3]);
        this._cgl.profileData.profileUniformCount++;
    }

    setValue4F(v)
    {
        if (typeof this.value == "number") this.value = vec4.create(); // this should not be needed, but somehow it crashes with some shadermods

        if (!v) return;
        if (!this._oldValue)
        {
            this._oldValue = [v[0] - 1, 1, 2, 3];
            this.needsUpdate = true;
        }
        else if (v[0] != this._oldValue[0] || v[1] != this._oldValue[1] || v[2] != this._oldValue[2] || v[3] != this._oldValue[3])
        {
            this._oldValue[0] = v[0];
            this._oldValue[1] = v[1];
            this._oldValue[2] = v[2];
            this.needsUpdate = true;
        }

        this._value = v;
    }

    updateValueM4()
    {
        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }
        if (!this._value || this._value.length % 16 != 0) return console.log("this.name", this._name, this._value);

        this._shader.getCgl().gl.uniformMatrix4fv(this._loc, false, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    setValueM4(v)
    {
        this.needsUpdate = true;
        this._value = v || mat4.create();
    }

    updateValueArrayT()
    {
        if (!this._isValidLoc()) this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
        else this.needsUpdate = false;

        if (!this._value) return;
        this._shader.getCgl().gl.uniform1iv(this._loc, this._value);
        this._cgl.profileData.profileUniformCount++;
    }

    updateValueT()
    {
        if (!this._isValidLoc())
        {
            this._loc = this._shader.getCgl().gl.getUniformLocation(this._shader.getProgram(), this._name);
            this._cgl.profileData.profileShaderGetUniform++;
            this._cgl.profileData.profileShaderGetUniformName = this._name;
        }

        this._cgl.profileData.profileUniformCount++;
        this._shader.getCgl().gl.uniform1i(this._loc, this._value);
        this.needsUpdate = false;
    }

    setValueT(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }
}

cgl_shader_uniform_Uniform.glslTypeString = (t) =>
{
    if (t == "f") return "float";
    if (t == "b") return "bool";
    if (t == "i") return "int";
    if (t == "2i") return "ivec2";
    if (t == "2f") return "vec2";
    if (t == "3f") return "vec3";
    if (t == "4f") return "vec4";
    if (t == "m4") return "mat4";

    if (t == "t") return "sampler2D";
    if (t == "tc") return "samplerCube";

    if (t == "3f[]") return null; // ignore this for now...
    if (t == "m4[]") return null; // ignore this for now...
    if (t == "f[]") return null; // ignore this for now...

    console.warn("[CGL UNIFORM] unknown glsl type string ", t);
};

/**
 * @function setValue
 * @memberof Uniform
 * @instance
 * @param {Number|Array|Matrix|Texture} value
 */

;// CONCATENATED MODULE: ./src/core/cg/cg_texture.js
const DEFAULT_TEXTURE_SIZE = 8;

/**
 * @typedef {Object} CglTextureOptions
 * @property {number} [width]
 * @property {number} [height]
 * @property {string} [pixelformat]
 */
class CgTexture
{

    /**
     * @param {CglTextureOptions} options={}
     */
    constructor(options = {})
    {
        this.id = CABLES.uuid();
        this.width = 0;
        this.height = 0;
        this.name = "unknown";

        options = options || {};
        this.pixelFormat = options.pixelFormat || CgTexture.PFORMATSTR_RGBA8UB;

        this.name = options.name || "unknown";

        if (!options.width) options.width = DEFAULT_TEXTURE_SIZE;
        if (!options.height) options.height = DEFAULT_TEXTURE_SIZE;
    }
}

CgTexture.getDefaultTextureData = (name, size, options = {}) =>
{
    if (name == "empty")
    {
        return new Uint8Array(size * size * 4).fill(0);
    }
    else
    if (name == "color")
    {
        const data = new Uint8Array(size * size * 4);
        let r = options.r || 1;
        let g = options.g || 1;
        let b = options.b || 1;

        for (let x = 0; x < size * size; x++)
        {
            data[x * 4 + 0] = r;
            data[x * 4 + 1] = g;
            data[x * 4 + 2] = b;
            data[x * 4 + 3] = 255;
        }
        return data;
    }
    else
    if (name == "randomUInt")
    {
        const data = new Uint8Array(size * size * 4);

        for (let x = 0; x < size * size; x++)
        {
            data[x * 4 + 0] = Math.random() * 255;
            data[x * 4 + 1] = Math.random() * 255;
            data[x * 4 + 2] = Math.random() * 255;
            data[x * 4 + 3] = 255;
        }
        return data;
    }
    else
    if (name == "random" || name == "randomFloat")
    {
        const data = new Float32Array(size * size * 4);

        for (let x = 0; x < size * size; x++)
        {
            data[x * 4 + 0] = (Math.random() - 0.5) * 2.0;
            data[x * 4 + 1] = (Math.random() - 0.5) * 2.0;
            data[x * 4 + 2] = (Math.random() - 0.5) * 2.0;
            data[x * 4 + 3] = 1;
        }
        return data;
    }
    else
    if (name == "stripes")
    {
        const arr = [];

        let r = options.r;
        let g = options.g;
        let b = options.b;

        if (r === undefined)r = 1;
        if (g === undefined)g = 1;
        if (b === undefined)b = 1;

        for (let y = 0; y < size; y++)
        {
            for (let x = 0; x < size; x++)
            {
                if ((x + y) % 64 < 32)
                {
                    arr.push((200 + (y / size) * 25 + (x / size) * 25) * r);
                    arr.push((200 + (y / size) * 25 + (x / size) * 25) * g);
                    arr.push((200 + (y / size) * 25 + (x / size) * 25) * b);
                }
                else
                {
                    arr.push((40 + (y / size) * 25 + (x / size) * 25) * r);
                    arr.push((40 + (y / size) * 25 + (x / size) * 25) * g);
                    arr.push((40 + (y / size) * 25 + (x / size) * 25) * b);
                }
                arr.push(255);
            }
        }

        return new Uint8Array(arr);
    }
    else
    {
        console.warn("unknown default texture", name);
        return CgTexture.getDefaultTextureData("stripes", size, { "r": 1, "g": 0, "b": 0 });
    }
};

CgTexture.FILTER_NEAREST = 0;
CgTexture.FILTER_LINEAR = 1;
CgTexture.FILTER_MIPMAP = 2;

CgTexture.WRAP_REPEAT = 0;
CgTexture.WRAP_MIRRORED_REPEAT = 1;
CgTexture.WRAP_CLAMP_TO_EDGE = 2;

CgTexture.TYPE_DEFAULT = 0;
CgTexture.TYPE_DEPTH = 1;
CgTexture.TYPE_FLOAT = 2;

CgTexture.PFORMATSTR_RGB565 = "RGB 5/6/5bit ubyte";

CgTexture.PFORMATSTR_R8UB = "R 8bit ubyte";
CgTexture.PFORMATSTR_RG8UB = "RG 8bit ubyte";
CgTexture.PFORMATSTR_RGB8UB = "RGB 8bit ubyte";
CgTexture.PFORMATSTR_RGBA8UB = "RGBA 8bit ubyte";

CgTexture.PFORMATSTR_SRGBA8 = "SRGBA 8bit ubyte";

CgTexture.PFORMATSTR_R11FG11FB10F = "RGB 11/11/10bit float";

CgTexture.PFORMATSTR_R16F = "R 16bit float";
CgTexture.PFORMATSTR_RG16F = "RG 16bit float";
CgTexture.PFORMATSTR_RGB16F = "RGB 16bit float";
CgTexture.PFORMATSTR_RGBA16F = "RGBA 16bit float";

CgTexture.PFORMATSTR_R32F = "R 32bit float";
CgTexture.PFORMATSTR_RG32F = "RG 32bit float";
CgTexture.PFORMATSTR_RGB32F = "RGB 32bit float";
CgTexture.PFORMATSTR_RGBA32F = "RGBA 32bit float";

CgTexture.PFORMATSTR_DEPTH = "DEPTH";

CgTexture.PIXELFORMATS = [

    CgTexture.PFORMATSTR_RGB565,

    CgTexture.PFORMATSTR_R8UB,
    CgTexture.PFORMATSTR_RG8UB,
    CgTexture.PFORMATSTR_RGB8UB,
    CgTexture.PFORMATSTR_RGBA8UB,

    CgTexture.PFORMATSTR_SRGBA8,

    CgTexture.PFORMATSTR_R11FG11FB10F,
    CgTexture.PFORMATSTR_R16F,
    CgTexture.PFORMATSTR_RG16F,
    CgTexture.PFORMATSTR_RGBA16F,

    CgTexture.PFORMATSTR_R32F,
    CgTexture.PFORMATSTR_RGBA32F

];

;// CONCATENATED MODULE: ./src/core/cgl/cgl_texture.js





const cgl_texture_DEFAULT_TEXTURE_SIZE = 8;

const log = new Logger("cgl_texture");

/**
 * A Texture
 * @namespace external:CGL
 * @class
 * @param {CglContext} __cgl cgl
 * @param {Object} options
 * @hideconstructor
 * @example
 * // generate a 256x256 pixel texture of random colors
 * const size=256;
 * const data = new Uint8Array(size*size*4);
 *
 * for(var x=0;x<size*size*4;x++) data[ x*4+3]=255;
 *
 * const tex=new CGL.Texture(cgl);
 * tex.initFromData(data,size,size,CGL.Texture.FILTER_NEAREST,CGL.Texture.WRAP_REPEAT);
 */
class Texture extends CgTexture
{
    constructor(__cgl, options = {})
    {
        super(options);
        if (!__cgl) throw new Error("no cgl");

        this._cgl = __cgl;
        this._log = new Logger("tex");
        this.tex = this._cgl.gl.createTexture();
        this.loading = false;
        this.flip = true;
        this.flipped = false;
        this.shadowMap = false;
        this.deleted = false;
        this.image = null;
        this.anisotropic = 0;
        this.filter = Texture.FILTER_NEAREST;
        this.wrap = Texture.WRAP_CLAMP_TO_EDGE;
        this.texTarget = this._cgl.gl.TEXTURE_2D;
        if (options && options.type) this.texTarget = options.type;
        this.textureType = Texture.TYPE_DEFAULT;
        this.unpackAlpha = true;
        this._fromData = true;

        this._glDataType = -1;
        this._glInternalFormat = -1;
        this._glDataFormat = -1;

        if (options)
        {
            if (options.isDepthTexture) this.textureType = Texture.TYPE_DEPTH;
            if (options.isFloatingPointTexture === true) this.textureType = Texture.TYPE_FLOAT;

            if ("textureType" in options) this.textureType = options.textureType;
            if ("filter" in options) this.filter = options.filter;
            if ("wrap" in options) this.wrap = options.wrap;
            if ("unpackAlpha" in options) this.unpackAlpha = options.unpackAlpha;
            if ("flip" in options) this.flip = options.flip;
            if ("shadowMap" in options) this.shadowMap = options.shadowMap;
            if ("anisotropic" in options) this.anisotropic = options.anisotropic;
        }
        else
        {
            options = {};
        }

        if (!options.pixelFormat && options.isFloatingPointTexture) this.pixelFormat = Texture.PFORMATSTR_RGBA32F;

        if (this.textureType == Texture.TYPE_DEPTH) this.pixelFormat = Texture.PFORMATSTR_DEPTH;

        this._cgl.profileData.profileTextureNew++;

        this.setFormat(Texture.setUpGlPixelFormat(this._cgl, this.pixelFormat));
        this._cgl.profileData.addHeavyEvent("texture created", this.name, options.width + "x" + options.height);

        this.setSize(options.width, options.height);
        this.getInfoOneLine();
    }

    isFloatingPoint()
    {
        return Texture.isPixelFormatFloat(this.pixelFormat);
    }

    /**
     * returns true if otherTexture has same options (width/height/filter/wrap etc)
     * @function compareSettings
     * @memberof Texture
     * @instance
     * @param {Texture} tex otherTexture
     * @returns {Boolean}
     */
    compareSettings(tex)
    {
    // if (!tex) { this._log.warn("compare: no tex"); return false; }
    // if (tex.width != this.width) this._log.warn("tex.width not equal", tex.width, this.width);
    // if (tex.height != this.height) this._log.warn("tex.height not equal", tex.height, this.height);
    // if (tex.filter != this.filter) this._log.warn("tex.filter not equal");
    // if (tex.wrap != this.wrap) this._log.warn("tex.wrap not equal");
    // if (tex.textureType != this.textureType) this._log.warn("tex.textureType not equal");
    // if (tex.unpackAlpha != this.unpackAlpha) this._log.warn("tex.unpackAlpha not equal");
    // if (tex.anisotropic != this.anisotropic) this._log.warn("tex.anisotropic not equal");
    // if (tex.shadowMap != this.shadowMap) this._log.warn("tex.shadowMap not equal");
    // if (tex.texTarget != this.texTarget) this._log.warn("tex.texTarget not equal");
    // if (tex.flip != this.flip) this._log.warn("tex.flip not equal");

        if (!tex) return false;
        return (
            tex.width == this.width &&
            tex.height == this.height &&
            tex.filter == this.filter &&
            tex.wrap == this.wrap &&
            tex.textureType == this.textureType &&
            tex.unpackAlpha == this.unpackAlpha &&
            tex.anisotropic == this.anisotropic &&
            tex.shadowMap == this.shadowMap &&
            tex.texTarget == this.texTarget &&
            tex.flip == this.flip
        );
    }

    /**
     * returns a new texture with the same settings (does not copy texture itself)
     * @function clone
     * @memberof Texture
     * @instance
     * @returns {Texture}
     */
    clone()
    {
        const newTex = new Texture(this._cgl, {
            "name": this.name,
            "filter": this.filter,
            "anisotropic": this.anisotropic,
            "wrap": this.wrap,
            "textureType": this.textureType,
            "pixelFormat": this.pixelFormat,
            "unpackAlpha": this.unpackAlpha,
            "flip": this.flip,
            "width": this.width,
            "height": this.height,
        });

        this._cgl.profileData.addHeavyEvent("texture created", this.name, this.width + "x" + this.height);

        if (!this.compareSettings(newTex))
        {
            this._log.error("Cloned texture settings do not compare!");
            this._log.error(this);
            this._log.error(newTex);
        }

        return newTex;
    }

    setFormat(o)
    {
        this.pixelFormat = o.pixelFormat;
        this._glDataFormat = o.glDataFormat;
        this._glInternalFormat = o.glInternalFormat;
        this._glDataType = o.glDataType;
    }

    /**
     * set pixel size of texture
     * @function setSize
     * @memberof Texture
     * @instance
     * @param {Number} w width
     * @param {Number} h height
     */
    setSize(w, h)
    {
        if (this._cgl.aborted) return;
        if (w != w || w <= 0 || !w) w = cgl_texture_DEFAULT_TEXTURE_SIZE;
        if (h != h || h <= 0 || !h) h = cgl_texture_DEFAULT_TEXTURE_SIZE;

        if (w > this._cgl.maxTexSize || h > this._cgl.maxTexSize) this._log.error("texture size too big! " + w + "x" + h + " / max: " + this._cgl.maxTexSize);

        w = Math.min(w, this._cgl.maxTexSize);
        h = Math.min(h, this._cgl.maxTexSize);

        w = Math.floor(w);
        h = Math.floor(h);
        if (this.width == w && this.height == h) return;

        w = this._cgl.checkTextureSize(w);
        h = this._cgl.checkTextureSize(h);

        this.width = w;
        this.height = h;
        this.deleted = false;

        this.setFormat(Texture.setUpGlPixelFormat(this._cgl, this.pixelFormat));

        this.shortInfoString = this.getInfoOneLine();// w + "x" + h + "";

        this._cgl.gl.bindTexture(this.texTarget, this.tex);
        this._cgl.profileData.profileTextureResize++;

        const uarr = null;

        this._cgl.gl.texImage2D(this.texTarget, 0, this._glInternalFormat, w, h, 0, this._glDataFormat, this._glDataType, uarr);

        this._setFilter();

        this.updateMipMap();

        this._cgl.gl.bindTexture(this.texTarget, null);
    }

    /**
     * @function initFromData
     * @memberof Texture
     * @instance
     * @description create texturem from rgb data
     * @param {Array<Number>} data rgb color array [r,g,b,a,r,g,b,a,...]
     * @param {Number} w width
     * @param {Number} h height
     * @param {Number} filter
     * @param {Number} wrap
     */
    initFromData(data, w, h, filter, wrap)
    {
        this.filter = filter;
        this.wrap = wrap;
        if (filter == undefined) this.filter = Texture.FILTER_LINEAR;
        if (wrap == undefined) this.wrap = Texture.WRAP_CLAMP_TO_EDGE;
        this.width = w;
        this.height = h;
        this._fromData = true;
        this.deleted = false;

        if (this.height > this._cgl.maxTexSize || this.width > this._cgl.maxTexSize)
        {
            const t = CGL.Texture.getTempTexture(this._cgl);
            this.width = t.width;
            this.height = t.height;
            this.tex = t.tex;
            this._log.warn("[cgl_texture] texture size too big!", this.width, this.height, this._cgl.maxTexSize);
            return;
        }

        if (this.flip) this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL, this.flip);

        this._cgl.gl.bindTexture(this.texTarget, this.tex);

        this.setFormat(Texture.setUpGlPixelFormat(this._cgl, this.pixelFormat));

        this._cgl.gl.texImage2D(this.texTarget, 0, this._glInternalFormat, w, h, 0, this._glDataFormat, this._glDataType, data);

        this._setFilter();
        this.updateMipMap();

        if (this.flip) this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL, false);
        this._cgl.gl.bindTexture(this.texTarget, null);
    }

    updateMipMap()
    {
        if ((this._cgl.glVersion == 2 || this.isPowerOfTwo()) && this.filter == Texture.FILTER_MIPMAP)
        {
            this._cgl.gl.generateMipmap(this.texTarget);
            this._cgl.profileData.profileGenMipMap++;
        }
    }

    /**
     * set texture data from an image/canvas object
     * @function initTexture
     * @memberof Texture
     * @instance
     * @param {Object} img image
     * @param {Number} filter
     */
    initTexture(img, filter = null)
    {
        this._cgl.printError("before initTexture");
        this._cgl.checkFrameStarted("texture inittexture");
        this._fromData = false;

        this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this.unpackAlpha);
        if (img.width || img.videoWidth) this.width = img.videoWidth || img.width;
        if (img.height || img.videoHeight) this.height = img.videoHeight || img.height;

        if (filter !== null) this.filter = filter; // todo: can we remove this filter param?

        if (img.height > this._cgl.maxTexSize || img.width > this._cgl.maxTexSize)
        {
            const t = CGL.Texture.getTempTexture(this._cgl);
            this.width = t.width;
            this.height = t.height;
            this.tex = t.tex;
            this._log.warn("[cgl_texture] texture size too big!", img.width, img.height, this._cgl.maxTexSize);
            return;
        }

        this._cgl.gl.bindTexture(this.texTarget, this.tex);

        this.deleted = false;
        this.flipped = !this.flip;
        if (this.flipped) this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL, this.flipped);

        this.setFormat(Texture.setUpGlPixelFormat(this._cgl, this.pixelFormat));

        this._cgl.gl.texImage2D(this.texTarget, 0, this._glInternalFormat, this._glDataFormat, this._glDataType, img);

        this._setFilter();
        this.updateMipMap();

        this._cgl.gl.bindTexture(this.texTarget, null);
        this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, false);
        if (this.flipped) this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_FLIP_Y_WEBGL, false);

        this.getInfoOneLine();
        this._cgl.printError("initTexture");
    }

    /**
     * delete texture. use this when texture is no longer needed
     * @function delete
     * @memberof Texture
     * @instance
     */
    dispose()
    {
        this.delete();
    }

    delete()
    {
        if (this.loading)
        {
            // cant delete texture when still loading
            // setTimeout(this.delete.bind(this), 50);
            return;
        }

        this.deleted = true;
        this.width = 0;
        this.height = 0;
        this._cgl.profileData.profileTextureDelete++;
        this._cgl.gl.deleteTexture(this.tex);
        this.image = null;

        this.tex = null;
    }

    /**
     * @function isPowerOfTwo
     * @memberof Texture
     * @instance
     * @description return true if texture width and height are both power of two
     * @return {Boolean}
     */
    isPowerOfTwo()
    {
        return Texture.isPowerOfTwo(this.width) && Texture.isPowerOfTwo(this.height);
    }

    printInfo()
    {
        log.log(this.getInfo());
    }

    getInfoReadable()
    {
        const info = this.getInfo();
        let html = "";

        info.name = info.name.substr(0, info.name.indexOf("?rnd="));

        for (const i in info)
        {
            html += "* " + i + ":  **" + info[i] + "**\n";
        }

        return html;
    }

    getInfoOneLine()
    {
        let txt = "" + this.width + "x" + this.height;
        txt += " ";
        // if (this.textureType === CGL.Texture.TYPE_FLOAT) txt += " 32bit"; else txt += " 8bit";
        // if (this.textureType === CGL.Texture.TYPE_FLOAT) txt += " 32bit"; else txt += " 8bit";
        txt += this.pixelFormat;

        if (this.filter === Texture.FILTER_NEAREST) txt += " nearest";
        if (this.filter === Texture.FILTER_LINEAR) txt += " linear";
        if (this.filter === Texture.FILTER_MIPMAP) txt += " mipmap";

        if (this.wrap === Texture.WRAP_CLAMP_TO_EDGE) txt += " clamp";
        if (this.wrap === Texture.WRAP_REPEAT) txt += " repeat";
        if (this.wrap === Texture.WRAP_MIRRORED_REPEAT) txt += " repeatmir";

        this.shortInfoString = txt;

        return txt;
    }

    getInfoOneLineShort()
    {
        let txt = "" + this.width + "x" + this.height;
        // if (this.textureType === CGL.Texture.TYPE_FLOAT) txt += " 32bit"; else txt += " 8bit";
        txt += " ";
        txt += this.pixelFormat;

        this.shortInfoString = txt;

        return txt;
    }

    getInfo()
    {
        return Texture.getTexInfo(this);
    }

    _setFilter()
    {
        this._cgl.printError("before _setFilter");

        if (!this._fromData)
        {
            this._cgl.gl.pixelStorei(this._cgl.gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this.unpackAlpha);
        }

        if (this.shadowMap)
        {
            this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D, this._cgl.gl.TEXTURE_COMPARE_MODE, this._cgl.gl.COMPARE_REF_TO_TEXTURE);
            this._cgl.gl.texParameteri(this._cgl.gl.TEXTURE_2D, this._cgl.gl.TEXTURE_COMPARE_FUNC, this._cgl.gl.LEQUAL);
        }

        if (this.textureType == Texture.TYPE_FLOAT && this.filter == Texture.FILTER_MIPMAP)
        {
            this.filter = Texture.FILTER_LINEAR;
            this._log.stack("texture: HDR and mipmap filtering at the same time is not possible");
        }

        if (this._cgl.glVersion == 1 && !this.isPowerOfTwo())
        {
            this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MAG_FILTER, this._cgl.gl.NEAREST);
            this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MIN_FILTER, this._cgl.gl.NEAREST);

            this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_S, this._cgl.gl.CLAMP_TO_EDGE);
            this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_T, this._cgl.gl.CLAMP_TO_EDGE);

            this.filter = Texture.FILTER_NEAREST;
            this.wrap = Texture.WRAP_CLAMP_TO_EDGE;
        }
        else
        {
            if (this.wrap == Texture.WRAP_CLAMP_TO_EDGE)
            {
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_S, this._cgl.gl.CLAMP_TO_EDGE);
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_T, this._cgl.gl.CLAMP_TO_EDGE);
            }
            else if (this.wrap == Texture.WRAP_REPEAT)
            {
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_S, this._cgl.gl.REPEAT);
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_T, this._cgl.gl.REPEAT);
            }
            else if (this.wrap == Texture.WRAP_MIRRORED_REPEAT)
            {
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_S, this._cgl.gl.MIRRORED_REPEAT);
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_WRAP_T, this._cgl.gl.MIRRORED_REPEAT);
            }

            if (this.filter == Texture.FILTER_NEAREST)
            {
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MAG_FILTER, this._cgl.gl.NEAREST);
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MIN_FILTER, this._cgl.gl.NEAREST);
            }
            else if (this.filter == Texture.FILTER_LINEAR)
            {
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MIN_FILTER, this._cgl.gl.LINEAR);
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MAG_FILTER, this._cgl.gl.LINEAR);
            }
            else if (this.filter == Texture.FILTER_MIPMAP)
            {
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MAG_FILTER, this._cgl.gl.LINEAR);
                this._cgl.gl.texParameteri(this.texTarget, this._cgl.gl.TEXTURE_MIN_FILTER, this._cgl.gl.LINEAR_MIPMAP_LINEAR);
            }
            else
            {
                this._log.log("unknown texture filter!", this.filter);
                throw new Error("unknown texture filter!" + this.filter);
            }

            if (this.anisotropic)
            {
                const ext = this._cgl.enableExtension("EXT_texture_filter_anisotropic");

                if (this._cgl.maxAnisotropic)
                {
                    const aniso = Math.min(this._cgl.maxAnisotropic, this.anisotropic);
                    this._cgl.gl.texParameterf(this._cgl.gl.TEXTURE_2D, ext.TEXTURE_MAX_ANISOTROPY_EXT, aniso);
                }
            }
        }
        this.getInfoOneLine();
        this._cgl.printError("_setFilter");
    }
}

/**
 * @function load
 * @static
 * @memberof Texture
 * @description load an image from an url
 * @param {CGState} cgl
 * @param {String} url
 * @param {Function} finishedCallback
 * @param {Object} settings
 * @return {Texture}
 */
Texture.load = function (cgl, url, finishedCallback, settings)
{
    if (!url) return finishedCallback({ "error": true });
    let loadingId = null;
    if (!cgl.patch.loading.existByName(url)) loadingId = cgl.patch.loading.start("cgl.texture", url);

    const texture = new Texture(cgl);
    texture.name = url;

    texture.image = new Image();
    texture.image.crossOrigin = "anonymous";
    texture.loading = true;

    if (settings && settings.hasOwnProperty("filter")) texture.filter = settings.filter;
    if (settings && settings.hasOwnProperty("flip")) texture.flip = settings.flip;
    if (settings && settings.hasOwnProperty("wrap")) texture.wrap = settings.wrap;
    if (settings && settings.hasOwnProperty("anisotropic")) texture.anisotropic = settings.anisotropic;
    if (settings && settings.hasOwnProperty("unpackAlpha")) texture.unpackAlpha = settings.unpackAlpha;
    if (settings && settings.hasOwnProperty("pixelFormat")) texture.pixelFormat = settings.pixelFormat;

    texture.image.onabort = texture.image.onerror = (e) =>
    {
        console.warn("[cgl.texture.load] error loading texture", url, e);
        texture.loading = false;
        if (loadingId) cgl.patch.loading.finished(loadingId);
        const error = { "error": true };
        if (finishedCallback) finishedCallback(error, texture);
    };

    texture.image.onload = function (e)
    {
        cgl.addNextFrameOnceCallback(() =>
        {
            texture.initTexture(texture.image);
            if (loadingId) cgl.patch.loading.finished(loadingId);
            texture.loading = false;

            if (finishedCallback) finishedCallback(null, texture);
        });
    };
    texture.image.src = url;

    return texture;
};

/**
 * @static
 * @function getTempTexture
 * @memberof Texture
 * @description returns the default temporary texture (grey diagonal stipes)
 * @param {CGState} cgl
 * @return {Texture}
 */
Texture.getTempTexture = function (cgl)
{
    if (!cgl) console.error("[getTempTexture] no cgl!");
    if (!cgl.tempTexture) cgl.tempTexture = Texture.getTemporaryTexture(cgl, 256, Texture.FILTER_LINEAR, Texture.REPEAT);
    return cgl.tempTexture;
};

/**
 * @static
 * @function getErrorTexture
 * @memberof Texture
 * @description returns the default temporary texture (grey diagonal stipes)
 * @param {CGState} cgl
 * @return {Texture}
 */
Texture.getErrorTexture = function (cgl)
{
    if (!cgl) console.error("[getTempTexture] no cgl!");
    if (!cgl.errorTexture) cgl.errorTexture = Texture.getTemporaryTexture(cgl, 256, Texture.FILTER_LINEAR, Texture.REPEAT, 1, 0.2, 0.2);
    return cgl.errorTexture;
};

/**
 * @function getEmptyTexture
 * @memberof Texture
 * @instance
 * @param cgl
 * @param fp
 * @description returns a reference to a small empty (transparent) texture
 * @return {Texture}
 */
Texture.getEmptyTexture = function (cgl, fp)
{
    if (fp) return Texture.getEmptyTextureFloat(cgl);
    if (!cgl) console.error("[getEmptyTexture] no cgl!");
    if (cgl.tempTextureEmpty) return cgl.tempTextureEmpty;

    let size = 8;

    cgl.tempTextureEmpty = new Texture(cgl, { "name": "emptyTexture" });
    const data = Texture.getDefaultTextureData("empty", size);

    cgl.tempTextureEmpty.initFromData(data, size, size, Texture.FILTER_NEAREST, Texture.WRAP_REPEAT);

    return cgl.tempTextureEmpty;
};

/**
 * @function getEmptyTextureFloat
 * @memberof Texture
 * @instance
 * @param cgl
 * @description returns a reference to a small empty (transparent) 32bit texture
 * @return {Texture}
 */
Texture.getEmptyTextureFloat = function (cgl)
{
    if (!cgl) console.error("[getEmptyTextureFloat] no cgl!");
    if (cgl.tempTextureEmptyFloat) return cgl.tempTextureEmptyFloat;

    cgl.tempTextureEmptyFloat = new Texture(cgl, { "name": "emptyTexture", "isFloatingPointTexture": true });
    const data = new Float32Array(8 * 8 * 4).fill(1);
    for (let i = 0; i < 8 * 8 * 4; i += 4) data[i + 3] = 0;

    cgl.tempTextureEmptyFloat.initFromData(data, 8, 8, Texture.FILTER_NEAREST, Texture.WRAP_REPEAT);

    return cgl.tempTextureEmptyFloat;
};

/**
 * @function getRandomTexture
 * @memberof Texture
 * @static
 * @param cgl
 * @description returns a reference to a random texture
 * @return {Texture}
 */
Texture.getRandomTexture = function (cgl)
{
    if (!cgl) console.error("[getRandomTexture] no cgl!");
    if (cgl.randomTexture) return cgl.randomTexture;

    const size = 256;
    const data = Texture.getDefaultTextureData("randomUInt", size);

    cgl.randomTexture = new Texture(cgl);
    cgl.randomTexture.initFromData(data, size, size, Texture.FILTER_NEAREST, Texture.WRAP_REPEAT);

    return cgl.randomTexture;
};

/**
 * @function getRandomFloatTexture
 * @memberof Texture
 * @static
 * @param cgl
 * @description returns a reference to a texture containing random numbers between -1 and 1
 * @return {Texture}
 */
Texture.getRandomFloatTexture = function (cgl)
{
    if (!cgl) console.error("[getRandomTexture] no cgl!");
    if (cgl.getRandomFloatTexture) return cgl.getRandomFloatTexture;

    const size = 256;
    const data = Texture.getDefaultTextureData("randomFloat", size);

    cgl.getRandomFloatTexture = new Texture(cgl, { "isFloatingPointTexture": true });
    cgl.getRandomFloatTexture.initFromData(data, size, size, Texture.FILTER_NEAREST, Texture.WRAP_REPEAT);

    return cgl.getRandomFloatTexture;
};

/**
 * @function getBlackTexture
 * @memberof Texture
 * @static
 * @param cgl
 * @description returns a reference to a black texture
 * @return {Texture}
 */
Texture.getBlackTexture = function (cgl)
{
    if (!cgl) this._log.error("[getBlackTexture] no cgl!");
    if (cgl.blackTexture) return cgl.blackTexture;

    const size = 8;
    const data = Texture.getDefaultTextureData("color", size, { "r": 0, "g": 0, "b": 0 });

    cgl.blackTexture = new Texture(cgl);
    cgl.blackTexture.initFromData(data, size, size, Texture.FILTER_NEAREST, Texture.WRAP_REPEAT);

    return cgl.blackTexture;
};

/**
 * @function getEmptyCubemapTexture
 * @memberof Texture
 * @static
 * @param cgl
 * @description returns an empty cubemap texture with rgba = [0, 0, 0, 0]
 * @return {Texture}
 */
Texture.getEmptyCubemapTexture = function (cgl)
{
    const faces = [
        cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_X,
        cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_X,
        cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_Y,
        cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_Y,
        cgl.gl.TEXTURE_CUBE_MAP_POSITIVE_Z,
        cgl.gl.TEXTURE_CUBE_MAP_NEGATIVE_Z
    ];

    const tex = cgl.gl.createTexture();
    const target = cgl.gl.TEXTURE_CUBE_MAP;
    const filter = Texture.FILTER_NEAREST;
    const wrap = Texture.WRAP_CLAMP_TO_EDGE;
    const width = 8;
    const height = 8;

    cgl.profileData.profileTextureNew++;

    cgl.gl.bindTexture(target, tex);
    cgl.profileData.profileTextureResize++;

    for (let i = 0; i < 6; i += 1)
    {
        const data = new Uint8Array(8 * 8 * 4);

        cgl.gl.texImage2D(faces[i], 0, cgl.gl.RGBA, 8, 8, 0, cgl.gl.RGBA, cgl.gl.UNSIGNED_BYTE, data);
        cgl.gl.texParameteri(target, cgl.gl.TEXTURE_MAG_FILTER, cgl.gl.NEAREST);
        cgl.gl.texParameteri(target, cgl.gl.TEXTURE_MIN_FILTER, cgl.gl.NEAREST);

        cgl.gl.texParameteri(target, cgl.gl.TEXTURE_WRAP_S, cgl.gl.CLAMP_TO_EDGE);
        cgl.gl.texParameteri(target, cgl.gl.TEXTURE_WRAP_T, cgl.gl.CLAMP_TO_EDGE);
    }

    cgl.gl.bindTexture(target, null);

    return {
        "id": CABLES.uuid(),
        "tex": tex,
        "cubemap": tex,
        "width": width,
        "height": height,
        "filter": filter,
        "wrap": wrap,
        "unpackAlpha": true,
        "flip": true,
        "_fromData": true,
        "name": "emptyCubemapTexture",
        "anisotropic": 0,
    };
};

Texture.getTempGradientTexture = function (cgl) // deprecated...
{
    if (!cgl) console.error("[getTempGradientTexture] no cgl!");
    return Texture.getTempTexture(cgl);
};

Texture.getTemporaryTexture = function (cgl, size, filter, wrap, r, g, b)
{
    const data = Texture.getDefaultTextureData("stripes", 256, { "r": r, "g": g, "b": b });
    const temptex = new Texture(cgl);
    temptex.initFromData(data, size, size, filter, wrap);
    return temptex;
};

/**
 * @static
 * @function createFromImage
 * @memberof Texture
 * @description create texturem from image data (e.g. image or canvas)
 * @param {CGState} cgl
 * @param {Object} img image
 * @param {Object} options
 */
Texture.createFromImage = function (cgl, img, options)
{
    options = options || {};
    const texture = new Texture(cgl, options);
    texture.flip = false;
    texture.image = img;
    texture.width = img.videoWidth || img.width || 8;
    texture.height = img.videoHeight || img.height || 8;
    if (options.hasOwnProperty("wrap"))texture.wrap = options.wrap;

    texture.initTexture(img, options.filter);

    return texture;
};

// deprecated!
Texture.fromImage = function (cgl, img, filter, wrap)
{
    console.error("deprecated texture from image...");

    const texture = new Texture(cgl);
    texture.flip = false;
    if (filter) texture.filter = filter;
    if (wrap) texture.wrap = wrap;
    texture.image = img;
    texture.initTexture(img);
    return texture;
};

/**
 * @static
 * @function isPowerOfTwo
 * @memberof Texture
 * @description returns true if x is power of two
 * @param {Number} x
 * @return {Boolean}
 */
Texture.isPowerOfTwo = function (x)
{
    return x == 1 || x == 2 || x == 4 || x == 8 || x == 16 || x == 32 || x == 64 || x == 128 || x == 256 || x == 512 || x == 1024 || x == 2048 || x == 4096 || x == 8192 || x == 16384;
};

Texture.getTexInfo = function (tex)
{
    const obj = {};

    obj.name = tex.name;
    obj["power of two"] = tex.isPowerOfTwo();
    obj.size = tex.width + " x " + tex.height;

    let targetString = tex.texTarget;
    if (tex.texTarget == tex._cgl.gl.TEXTURE_2D) targetString = "TEXTURE_2D";
    obj.target = targetString;

    obj.unpackAlpha = tex.unpackAlpha;

    if (tex.cubemap)obj.cubemap = true;

    if (tex.textureType == Texture.TYPE_FLOAT) obj.textureType = "TYPE_FLOAT";
    if (tex.textureType == Texture.TYPE_HALF_FLOAT) obj.textureType = "TYPE_HALF_FLOAT";
    else if (tex.textureType == Texture.TYPE_DEPTH) obj.textureType = "TYPE_DEPTH";
    else if (tex.textureType == Texture.TYPE_DEFAULT) obj.textureType = "TYPE_DEFAULT";
    else obj.textureType = "UNKNOWN " + this.textureType;

    if (tex.wrap == Texture.WRAP_CLAMP_TO_EDGE) obj.wrap = "CLAMP_TO_EDGE";
    else if (tex.wrap == Texture.WRAP_REPEAT) obj.wrap = "WRAP_REPEAT";
    else if (tex.wrap == Texture.WRAP_MIRRORED_REPEAT) obj.wrap = "WRAP_MIRRORED_REPEAT";
    else obj.wrap = "UNKNOWN";

    if (tex.filter == Texture.FILTER_NEAREST) obj.filter = "FILTER_NEAREST";
    else if (tex.filter == Texture.FILTER_LINEAR) obj.filter = "FILTER_LINEAR";
    else if (tex.filter == Texture.FILTER_MIPMAP) obj.filter = "FILTER_MIPMAP";
    else obj.filter = "UNKNOWN";

    obj.pixelFormat = tex.pixelFormat || "unknown";

    return obj;
};

Texture.setUpGlPixelFormat = function (cgl, pixelFormatStr)
{
    const o = {};

    if (!pixelFormatStr)
    {
        cgl._log.error("no pixelformatstr!");
        cgl._log.log(new Error());
        pixelFormatStr = Texture.PFORMATSTR_RGBA8UB;
    }

    o.pixelFormatBase = pixelFormatStr;
    o.pixelFormat = pixelFormatStr;
    o.glDataType = cgl.gl.UNSIGNED_BYTE;
    o.glInternalFormat = cgl.gl.RGBA8;
    o.glDataFormat = cgl.gl.RGBA;

    let floatDatatype = cgl.gl.FLOAT;

    if (cgl.glUseHalfFloatTex)
    {
        if (pixelFormatStr == Texture.PFORMATSTR_RGBA32F) pixelFormatStr = Texture.PFORMATSTR_RGBA16F;
        if (pixelFormatStr == Texture.PFORMATSTR_RG32F) pixelFormatStr = Texture.PFORMATSTR_RG16F;
        if (pixelFormatStr == Texture.PFORMATSTR_R32F) pixelFormatStr = Texture.PFORMATSTR_R16F;
    }

    if (pixelFormatStr.includes("16bit"))
    {
        if (cgl.glVersion == 2)
        {
            // cgl.enableExtension("OES_texture_half_float");
            const hasExt = cgl.enableExtension("EXT_color_buffer_half_float");

            if (!hasExt)
            {
                console.warn("no 16bit extension, fallback to 32bit", pixelFormatStr);
                // fallback to 32 bit?
                if (pixelFormatStr == Texture.PFORMATSTR_RGBA16F) pixelFormatStr = Texture.PFORMATSTR_RGBA32F;
                if (pixelFormatStr == Texture.PFORMATSTR_RGB16F) pixelFormatStr = Texture.PFORMATSTR_RGB32F;
                if (pixelFormatStr == Texture.PFORMATSTR_RG16F) pixelFormatStr = Texture.PFORMATSTR_RG32F;
                if (pixelFormatStr == Texture.PFORMATSTR_R16F) pixelFormatStr = Texture.PFORMATSTR_R32F;
            }
            else
            {
                floatDatatype = cgl.gl.HALF_FLOAT;
            }
        }
    }

    if (cgl.glVersion == 1)
    {
        o.glInternalFormat = cgl.gl.RGBA;

        if (pixelFormatStr == Texture.PFORMATSTR_RGBA16F || pixelFormatStr == Texture.PFORMATSTR_RG16F || pixelFormatStr == Texture.PFORMATSTR_R16F)
        {
            const ext = cgl.enableExtension("OES_texture_half_float");
            if (!ext) throw new Error("no half float texture extension");

            floatDatatype = ext.HALF_FLOAT_OES;
        }
    }

    if (pixelFormatStr == Texture.PFORMATSTR_RGBA8UB)
    {
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_RGB565)
    {
        o.glInternalFormat = cgl.gl.RGB565;
        o.glDataFormat = cgl.gl.RGB;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_R8UB)
    {
        o.glInternalFormat = cgl.gl.R8;
        o.glDataFormat = cgl.gl.RED;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_RG8UB)
    {
        o.glInternalFormat = cgl.gl.RG8;
        o.glDataFormat = cgl.gl.RG;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_RGB8UB)
    {
        o.glInternalFormat = cgl.gl.RGB8;
        o.glDataFormat = cgl.gl.RGB;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_SRGBA8)
    {
        o.glInternalFormat = cgl.gl.SRGB8_ALPHA8;
    }

    else if (pixelFormatStr == Texture.PFORMATSTR_R32F)
    {
        o.glInternalFormat = cgl.gl.R32F;
        o.glDataFormat = cgl.gl.RED;
        o.glDataType = floatDatatype;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_R16F)
    {
        o.glInternalFormat = cgl.gl.R16F;
        o.glDataType = floatDatatype;
        o.glDataFormat = cgl.gl.RED;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_RG16F)
    {
        o.glInternalFormat = cgl.gl.RG16F;
        o.glDataType = floatDatatype;
        o.glDataFormat = cgl.gl.RG;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_RGBA16F)
    {
        if (cgl.glVersion == 1) o.glInternalFormat = cgl.gl.RGBA;
        else o.glInternalFormat = cgl.gl.RGBA16F;
        o.glDataType = floatDatatype;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_R11FG11FB10F)
    {
        o.glInternalFormat = cgl.gl.R11F_G11F_B10F;
        o.glDataType = floatDatatype;
        o.glDataFormat = cgl.gl.RGB;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_RGBA32F)
    {
        if (cgl.glVersion == 1) o.glInternalFormat = cgl.gl.RGBA;
        else o.glInternalFormat = cgl.gl.RGBA32F;
        o.glDataType = floatDatatype;
    }
    else if (pixelFormatStr == Texture.PFORMATSTR_DEPTH)
    {
        if (cgl.glVersion == 1)
        {
            o.glInternalFormat = cgl.gl.DEPTH_COMPONENT;
            o.glDataType = cgl.gl.UNSIGNED_SHORT;
            o.glDataFormat = cgl.gl.DEPTH_COMPONENT;
        }
        else
        {
            o.glInternalFormat = cgl.gl.DEPTH_COMPONENT32F;
            o.glDataType = cgl.gl.FLOAT;
            o.glDataFormat = cgl.gl.DEPTH_COMPONENT;
        }
    }
    else
    {
        log.log("unknown pixelformat ", pixelFormatStr);
    }

    /// //////

    if (pixelFormatStr.includes("32bit") || pixelFormatStr == Texture.PFORMATSTR_R11FG11FB10F)
    {
        if (cgl.glVersion == 2) cgl.enableExtension("EXT_color_buffer_float");
        if (cgl.glVersion == 2) cgl.enableExtension("EXT_float_blend");

        cgl.enableExtension("OES_texture_float_linear"); // yes, i am sure, this is a webgl 1 and 2 ext
    }

    o.numColorChannels = Texture.getPixelFormatNumChannels(pixelFormatStr);

    if (!o.glDataType || !o.glInternalFormat || !o.glDataFormat) log.log("pixelformat wrong ?!", pixelFormatStr, o.glDataType, o.glInternalFormat, o.glDataFormat, this);

    return o;
};

Texture.getPixelFormatNumChannels =
    (pxlFrmtStr) =>
    {
        if (pxlFrmtStr.startsWith("RGBA")) return 4;
        if (pxlFrmtStr.startsWith("RGB")) return 3;
        if (pxlFrmtStr.startsWith("RG")) return 2;
        return 1;
    };

Texture.isPixelFormatFloat =
    (pxlFrmtStr) =>
    {
        return (pxlFrmtStr || "").includes("float");
    };

Texture.isPixelFormatHalfFloat =
    (pxlFrmtStr) =>
    {
        return (pxlFrmtStr || "").includes("float") && (pxlFrmtStr || "").includes("16bit");
    };

;// CONCATENATED MODULE: ./src/core/cgl/cgl_textureeffect.js




class TextureEffect
{
    constructor(cgl, options)
    {
        this._cgl = cgl;
        this._log = new Logger("cgl_TextureEffect");

        if (!cgl.TextureEffectMesh) this.createMesh();

        this._textureSource = null;
        this._options = options;
        this.name = options.name || "unknown";

        this.imgCompVer = 0;
        this.aspectRatio = 1;
        this._textureTarget = null; // new CGL.Texture(this._cgl,opts);
        this._frameBuf = this._cgl.gl.createFramebuffer();
        this._frameBuf2 = this._cgl.gl.createFramebuffer();
        this._renderbuffer = this._cgl.gl.createRenderbuffer();
        this._renderbuffer2 = this._cgl.gl.createRenderbuffer();
        this.switched = false;
        this.depth = false;
    }

    dispose()
    {
        if (this._renderbuffer) this._cgl.gl.deleteRenderbuffer(this._renderbuffer);
        if (this._frameBuf) this._cgl.gl.deleteFramebuffer(this._frameBuf);
        if (this._renderbuffer2) this._cgl.gl.deleteRenderbuffer(this._renderbuffer2);
        if (this._frameBuf2) this._cgl.gl.deleteFramebuffer(this._frameBuf2);
    }

    getWidth()
    {
        return this._textureSource.width;
    }

    getHeight()
    {
        return this._textureSource.height;
    }

    setSourceTexture(tex)
    {
        if (tex === null)
        {
            this._textureSource = new Texture(this._cgl);
            this._textureSource.setSize(16, 16);
        }
        else
        {
            this._textureSource = tex;
        }

        if (!this._textureSource.compareSettings(this._textureTarget))
        {
            if (this._textureTarget) this._textureTarget.delete();

            this._textureTarget = this._textureSource.clone();

            this._cgl.profileData.profileEffectBuffercreate++;

            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuf);

            this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER, this._renderbuffer);

            // if(tex.textureType==CGL.Texture.TYPE_FLOAT) this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.RGBA32F, this._textureSource.width,this._textureSource.height);
            // else this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.RGBA8, this._textureSource.width,this._textureSource.height);

            if (this.depth) this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER, this._cgl.gl.DEPTH_COMPONENT16, this._textureSource.width, this._textureSource.height);
            this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0, this._cgl.gl.TEXTURE_2D, this._textureTarget.tex, 0);
            if (this.depth) this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.DEPTH_ATTACHMENT, this._cgl.gl.RENDERBUFFER, this._renderbuffer);

            // this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0, this._cgl.gl.TEXTURE_2D, this._textureTarget.tex, 0);

            this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D, null);
            this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER, null);
            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, null);

            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuf2);

            this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER, this._renderbuffer2);

            // if(tex.textureType==CGL.Texture.TYPE_FLOAT) this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.RGBA32F, this._textureSource.width,this._textureSource.height);
            // else this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,this._cgl.gl.RGBA8, this._textureSource.width,this._textureSource.height);

            if (this.depth) this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER, this._cgl.gl.DEPTH_COMPONENT16, this._textureSource.width, this._textureSource.height);
            this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0, this._cgl.gl.TEXTURE_2D, this._textureSource.tex, 0);

            if (this.depth) this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.DEPTH_ATTACHMENT, this._cgl.gl.RENDERBUFFER, this._renderbuffer2);

            // this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0, this._cgl.gl.TEXTURE_2D, this._textureSource.tex, 0);

            this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D, null);
            this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER, null);
            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, null);
        }

        this.aspectRatio = this._textureSource.width / this._textureSource.height;
    }

    continueEffect()
    {
        this._cgl.pushDepthTest(false);
        this._cgl.pushModelMatrix();
        this._cgl.pushPMatrix();
        // todo why two pushs?

        this._cgl.pushViewPort(0, 0, this.getCurrentTargetTexture().width, this.getCurrentTargetTexture().height);

        mat4.perspective(this._cgl.pMatrix, 45, this.getCurrentTargetTexture().width / this.getCurrentTargetTexture().height, 0.1, 1100.0); // todo: why?

        this._cgl.pushPMatrix();
        mat4.identity(this._cgl.pMatrix);

        this._cgl.pushViewMatrix();
        mat4.identity(this._cgl.vMatrix);

        this._cgl.pushModelMatrix();
        mat4.identity(this._cgl.mMatrix);
    }

    startEffect(bgTex)
    {
        if (!this._textureTarget)
        {
            this._log.warn("effect has no target");
            return;
        }

        this.switched = false;

        this.continueEffect();

        if (bgTex)
        {
            this._bgTex = bgTex;
        }
        this._countEffects = 0;
    }

    endEffect()
    {
        this._cgl.popDepthTest();
        this._cgl.popModelMatrix();

        this._cgl.popPMatrix();
        this._cgl.popModelMatrix();
        this._cgl.popViewMatrix();

        this._cgl.popPMatrix();
        this._cgl.popViewPort();
    }

    bind()
    {
        if (this._textureSource === null)
        {
            this._log.warn("no base texture set!");
            return;
        }

        if (!this.switched)
        {
            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuf);
            this._cgl.pushGlFrameBuffer(this._frameBuf);
        }
        else
        {
            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuf2);
            this._cgl.pushGlFrameBuffer(this._frameBuf2);
        }
    }

    finish()
    {
        if (this._textureSource === null)
        {
            this._log.warn("no base texture set!");
            return;
        }

        this._cgl.TextureEffectMesh.render(this._cgl.getShader());

        this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.popGlFrameBuffer());

        this._cgl.profileData.profileTextureEffect++;

        if (this._textureTarget.filter == Texture.FILTER_MIPMAP)
        {
            if (!this.switched)
            {
                this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D, this._textureTarget.tex);
                this._textureTarget.updateMipMap();
            }
            else
            {
                this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D, this._textureSource.tex);
                this._textureSource.updateMipMap();
            }

            this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D, null);
        }

        this.switched = !this.switched;
        this._countEffects++;
    }

    getCurrentTargetTexture()
    {
        if (this.switched) return this._textureSource;
        return this._textureTarget;
    }

    getCurrentSourceTexture()
    {
        if (this._countEffects == 0 && this._bgTex) return this._bgTex;

        if (this.switched) return this._textureTarget;
        return this._textureSource;
    }

    delete()
    {
        if (this._textureTarget) this._textureTarget.delete();
        if (this._textureSource) this._textureSource.delete();
        this._cgl.gl.deleteRenderbuffer(this._renderbuffer);
        this._cgl.gl.deleteFramebuffer(this._frameBuf);
    }

    createMesh()
    {
        this._cgl.TextureEffectMesh = CABLES.CGL.MESHES.getSimpleRect(this._cgl, "texEffectRect");
    }

    // ---------------------------------------------------------------------------------
}

TextureEffect.checkOpNotInTextureEffect = function (op)
{
    if (!op.patch.cgl) return true;
    if (op.uiAttribs.error && !op.patch.cgl.currentTextureEffect)
    {
        op.setUiError("textureeffect", null);
        return true;
    }
    if (!op.patch.cgl.currentTextureEffect) return true;

    if (op.patch.cgl.currentTextureEffect && !op.uiAttribs.error)
    {
        op.setUiError("textureeffect", "This op can not be a child of a ImageCompose/texture effect! imagecompose should only have textureeffect childs.", 0);
        return false;
    }

    if (op.patch.cgl.currentTextureEffect) return false;
    return true;
};

TextureEffect.checkOpInEffect = function (op, minver)
{
    minver = minver || 0;

    if (op.patch.cgl.currentTextureEffect)
    {
        if (op.uiAttribs.uierrors && op.patch.cgl.currentTextureEffect.imgCompVer >= minver)
        {
            op.setUiError("texeffect", null);
            return true;
        }

        if (minver && op.patch.cgl.currentTextureEffect.imgCompVer < minver)
        {
            op.setUiError("texeffect", "This op must be a child of an ImageCompose op with version >=" + minver + " <span class=\"button-small\" onclick=\"gui.patchView.downGradeOp('" + op.id + "','" + op.name + "')\">Downgrade</span> to previous version", 1);
        }
    }

    if (op.patch.cgl.currentTextureEffect) return true;

    if (!op.patch.cgl.currentTextureEffect && (!op.uiAttribs.uierrors || op.uiAttribs.uierrors.length == 0))
    {
        op.setUiError("texeffect", "This op must be a child of an ImageCompose op! More infos <a href=\"https://cables.gl/docs/image_composition/image_composition.html\" target=\"_blank\">here</a>. ", 1);
        return false;
    }

    if (!op.patch.cgl.currentTextureEffect) return false;
    return true;
};

TextureEffect.getBlendCode = function (ver)
{
    let src = "".endl()
        + "vec3 _blend(vec3 base,vec3 blend)".endl()
        + "{".endl()
        + "   vec3 colNew=blend;".endl()
        + "   #ifdef BM_MULTIPLY".endl()
        + "       colNew=base*blend;".endl()
        + "   #endif".endl()
        + "   #ifdef BM_MULTIPLY_INV".endl()
        + "       colNew=base* vec3(1.0)-blend;".endl()
        + "   #endif".endl()
        + "   #ifdef BM_AVERAGE".endl()
        + "       colNew=((base + blend) / 2.0);".endl()
        + "   #endif".endl()
        + "   #ifdef BM_ADD".endl()
        + "       colNew=min(base + blend, vec3(1.0));".endl()
        + "   #endif".endl()
        + "   #ifdef BM_SUBTRACT_ONE".endl()
        + "       colNew=max(base + blend - vec3(1.0), vec3(0.0));".endl()
        + "   #endif".endl()

        + "   #ifdef BM_SUBTRACT".endl()
        + "       colNew=base - blend;".endl()
        + "   #endif".endl()

        + "   #ifdef BM_DIFFERENCE".endl()
        + "       colNew=abs(base - blend);".endl()
        + "   #endif".endl()
        + "   #ifdef BM_NEGATION".endl()
        + "       colNew=(vec3(1.0) - abs(vec3(1.0) - base - blend));".endl()
        + "   #endif".endl()
        + "   #ifdef BM_EXCLUSION".endl()
        + "       colNew=(base + blend - 2.0 * base * blend);".endl()
        + "   #endif".endl()
        + "   #ifdef BM_LIGHTEN".endl()
        + "       colNew=max(blend, base);".endl()
        + "   #endif".endl()
        + "   #ifdef BM_DARKEN".endl()
        + "       colNew=min(blend, base);".endl()
        + "   #endif".endl()
        + "   #ifdef BM_OVERLAY".endl()
        + "      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))"
            // .endl()+'       #define BlendOverlay(base, blend)       Blend(base, blend, BlendOverlayf)'
            //    .endl()+'      colNew=Blend(base, blend, BlendOverlayf);'
            .endl()
        + "      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()
        + "   #endif".endl()
        + "   #ifdef BM_SCREEN".endl()
        + "      #define BlendScreenf(base, blend)       (1.0 - ((1.0 - base) * (1.0 - blend)))"
            // .endl()+'       #define BlendScreen(base, blend)        Blend(base, blend, BlendScreenf)'
            // .endl()+'      colNew=Blend(base, blend, BlendScreenf);'
            .endl()
        + "      colNew=vec3(BlendScreenf(base.r, blend.r),BlendScreenf(base.g, blend.g),BlendScreenf(base.b, blend.b));".endl()
        + "   #endif".endl()
        + "   #ifdef BM_SOFTLIGHT".endl()
        + "      #define BlendSoftLightf(base, blend)    ((blend < 0.5) ? (2.0 * base * blend + base * base * (1.0 - 2.0 * blend)) : (sqrt(base) * (2.0 * blend - 1.0) + 2.0 * base * (1.0 - blend)))"
            // .endl()+'       #define BlendSoftLight(base, blend)     Blend(base, blend, BlendSoftLightf)'
            //    .endl()+'      colNew=Blend(base, blend, BlendSoftLightf);'
            .endl()
        + "      colNew=vec3(BlendSoftLightf(base.r, blend.r),BlendSoftLightf(base.g, blend.g),BlendSoftLightf(base.b, blend.b));".endl()
        + "   #endif".endl()
        + "   #ifdef BM_HARDLIGHT".endl()
        + "      #define BlendOverlayf(base, blend)  (base < 0.5 ? (2.0 * base * blend) : (1.0 - 2.0 * (1.0 - base) * (1.0 - blend)))"
            // .endl()+'       #define BlendOverlay(base, blend)       Blend(base, blend, BlendOverlayf)'
            // .endl()+'      colNew=Blend(blend, base, BlendOverlayf);'
            .endl()
        + "      colNew=vec3(BlendOverlayf(base.r, blend.r),BlendOverlayf(base.g, blend.g),BlendOverlayf(base.b, blend.b));".endl()
        + "   #endif".endl()
        + "   #ifdef BM_COLORDODGE".endl()
        + "      #define BlendColorDodgef(base, blend)   ((blend == 1.0) ? blend : min(base / (1.0 - blend), 1.0))"
            // .endl()+'      colNew=Blend(base, blend, BlendColorDodgef);'
            .endl()
        + "      colNew=vec3(BlendColorDodgef(base.r, blend.r),BlendColorDodgef(base.g, blend.g),BlendColorDodgef(base.b, blend.b));".endl()
        + "   #endif".endl()
        + "   #ifdef BM_COLORBURN".endl()
        + "      #define BlendColorBurnf(base, blend)    ((blend == 0.0) ? blend : max((1.0 - ((1.0 - base) / blend)), 0.0))"
            // .endl()+'      colNew=Blend(base, blend, BlendColorBurnf);'
            .endl()
        + "      colNew=vec3(BlendColorBurnf(base.r, blend.r),BlendColorBurnf(base.g, blend.g),BlendColorBurnf(base.b, blend.b));".endl()
        + "   #endif".endl()

        + "   return colNew;".endl()
        + "}".endl();

    if (!ver)
        src += "vec4 cgl_blend(vec4 oldColor,vec4 newColor,float amount)".endl()
                + "{".endl()
                    + "vec4 col=vec4( _blend(oldColor.rgb,newColor.rgb) ,1.0);".endl()
                    + "col=vec4( mix( col.rgb, oldColor.rgb ,1.0-oldColor.a*amount),1.0);".endl()
                    + "return col;".endl()
                + "}".endl();

    if (ver >= 3)
        src += "vec4 cgl_blendPixel(vec4 base,vec4 col,float amount)".endl() +
                "{".endl() +

                "#ifdef BM_MATH_ADD".endl() +
                "   return vec4(base.rgb+col.rgb*amount,1.0);".endl() +
                "#endif".endl() +

                "#ifdef BM_MATH_SUB".endl() +
                "   return vec4(base.rgb-col.rgb*amount,1.0);".endl() +
                "#endif".endl() +

                "#ifdef BM_MATH_MUL".endl() +
                "   return vec4(base.rgb*col.rgb*amount,1.0);".endl() +
                "#endif".endl() +

                "#ifdef BM_MATH_DIV".endl() +
                "   return vec4(base.rgb/col.rgb*amount,1.0);".endl() +
                "#endif".endl() +

                    "#ifndef BM_MATH".endl() +
                        "vec3 colNew=_blend(base.rgb,col.rgb);".endl() +

                        "float newA=clamp(base.a+(col.a*amount),0.,1.);".endl() +

                        "#ifdef BM_ALPHAMASKED".endl() +
                            "newA=base.a;".endl() +
                        "#endif".endl() +

                        "return vec4(".endl() +
                            "mix(colNew,base.rgb,1.0-(amount*col.a)),".endl() +
                            "newA);".endl() +

                    "#endif".endl() +
    "}".endl();

    return src;
};

TextureEffect.onChangeBlendSelect = function (shader, blendName, maskAlpha = false)
{
    blendName = String(blendName);
    shader.toggleDefine("BM_NORMAL", blendName == "normal");
    shader.toggleDefine("BM_MULTIPLY", blendName == "multiply");
    shader.toggleDefine("BM_MULTIPLY_INV", blendName == "multiply invert");
    shader.toggleDefine("BM_AVERAGE", blendName == "average");
    shader.toggleDefine("BM_ADD", blendName == "add");
    shader.toggleDefine("BM_SUBTRACT_ONE", blendName == "subtract one");
    shader.toggleDefine("BM_SUBTRACT", blendName == "subtract");
    shader.toggleDefine("BM_DIFFERENCE", blendName == "difference");
    shader.toggleDefine("BM_NEGATION", blendName == "negation");
    shader.toggleDefine("BM_EXCLUSION", blendName == "exclusion");
    shader.toggleDefine("BM_LIGHTEN", blendName == "lighten");
    shader.toggleDefine("BM_DARKEN", blendName == "darken");
    shader.toggleDefine("BM_OVERLAY", blendName == "overlay");
    shader.toggleDefine("BM_SCREEN", blendName == "screen");
    shader.toggleDefine("BM_SOFTLIGHT", blendName == "softlight");
    shader.toggleDefine("BM_HARDLIGHT", blendName == "hardlight");
    shader.toggleDefine("BM_COLORDODGE", blendName == "color dodge");
    shader.toggleDefine("BM_COLORBURN", blendName == "color burn");

    shader.toggleDefine("BM_MATH_ADD", blendName == "Math Add");
    shader.toggleDefine("BM_MATH_SUB", blendName == "Math Subtract");
    shader.toggleDefine("BM_MATH_MUL", blendName == "Math Multiply");
    shader.toggleDefine("BM_MATH_DIV", blendName == "Math Divide");

    shader.toggleDefine("BM_MATH", blendName.indexOf("Math ") == 0);

    shader.toggleDefine("BM_ALPHAMASKED", maskAlpha);
};

TextureEffect.AddBlendSelect = function (op, name, defaultMode)
{
    const p = op.inValueSelect(name || "Blend Mode", [
        "normal", "lighten", "darken", "multiply", "multiply invert", "average", "add", "subtract", "difference", "negation", "exclusion", "overlay", "screen", "color dodge", "color burn", "softlight", "hardlight", "subtract one",
        "Math Add",
        "Math Subtract",
        "Math Multiply",
        "Math Divide",

    ], defaultMode || "normal");
    return p;
};

TextureEffect.AddBlendAlphaMask = function (op, name, defaultMode)
{
    const p = op.inSwitch(name || "Alpha Mask", ["Off", "On"], defaultMode || "Off");
    return p;
};

TextureEffect.setupBlending = function (op, shader, blendPort, amountPort, alphaMaskPort)
{
    const onChange = () =>
    {
        let maskAlpha = false;
        if (alphaMaskPort) maskAlpha = alphaMaskPort.get() == "On";
        TextureEffect.onChangeBlendSelect(shader, blendPort.get(), maskAlpha);

        let str = blendPort.get();
        if (str == "normal") str = null;
        else if (str == "multiply") str = "mul";
        else if (str == "multiply invert") str = "mulinv";
        else if (str == "lighten") str = "light";
        else if (str == "darken") str = "darken";
        else if (str == "average") str = "avg";
        else if (str == "subtract one") str = "sub one";
        else if (str == "subtract") str = "sub";
        else if (str == "difference") str = "diff";
        else if (str == "negation") str = "neg";
        else if (str == "exclusion") str = "exc";
        else if (str == "overlay") str = "ovl";
        else if (str == "color dodge") str = "dodge";
        else if (str == "color burn") str = "burn";
        else if (str == "softlight") str = "soft";
        else if (str == "hardlight") str = "hard";
        else if (str == "Math Add") str = "+";
        else if (str == "Math Subtract") str = "-";
        else if (str == "Math Multiply") str = "*";
        else if (str == "Math Divide") str = "/";

        op.setUiAttrib({ "extendTitle": str });
    };
    op.setPortGroup("Blending", [blendPort, amountPort, alphaMaskPort]);

    let maskAlpha = false;

    blendPort.onChange = onChange;
    if (alphaMaskPort)
    {
        alphaMaskPort.onChange = onChange;
        maskAlpha = alphaMaskPort.get() == "On";
    }

    TextureEffect.onChangeBlendSelect(shader, blendPort.get(), maskAlpha);
};

;// CONCATENATED MODULE: ./src/core/cgl/cgl_shader_lib.js



/** @type {Object} */
const ShaderLibMods = {
    "CGL.BLENDMODES": function ()
    {
        this.name = "blendmodes";
        this.srcHeadFrag = TextureEffect.getBlendCode();
    },

    "CGL.BLENDMODES3": function ()
    {
        this.name = "blendmodes3";
        this.srcHeadFrag = TextureEffect.getBlendCode(3);
    },

    "CGL.LUMINANCE": function ()
    {
        this.name = "luminance";
        this.srcHeadFrag = "".endl()
            + "float cgl_luminance(vec3 c)".endl()
            + "{".endl()
            + "    return dot(vec3(0.2126,0.7152,0.0722),c);".endl()
            + "}".endl();
    },

    // quite good random numbers, but somehow don't work in ANGLE
    "CGL.RANDOM_OLD": function ()
    {
        this.name = "randomNumber";
        this.srcHeadFrag = "".endl()
            + "float cgl_random(vec2 co)".endl()
            + "{".endl()
            + "    return fract(sin(dot(co.xy ,vec2(12.9898,4.1414))) * 432758.5453);".endl()
            + "}".endl()
            + "vec3 cgl_random3(vec2 co)".endl()
            + "{".endl()
            + "    return vec3( cgl_random(co),cgl_random(co+0.5711),cgl_random(co+1.5711));".endl()
            + "}";
    },

    // low quality generative ranodm numbers
    "CGL.RANDOM_LOW": function ()
    {
        this.name = "randomNumber";
        this.srcHeadFrag = "".endl()
            + "float cgl_random(vec2 co)".endl()
            + "{".endl()
            + "    return fract(sin(dot(co.xy ,vec2(12.9898,4.1414))) * 358.5453);".endl()
            + "}".endl()
            + "vec3 cgl_random3(vec2 co)".endl()
            + "{".endl()
            + "    return vec3( cgl_random(co),cgl_random(co+0.5711),cgl_random(co+1.5711));".endl()
            + "}";
    },

    "CGL.RANDOM_TEX": function ()
    {
        this.name = "randomNumbertex";

        this.srcHeadFrag = "".endl()
            + "UNI sampler2D CGLRNDTEX;".endl()
            + "float cgl_random(vec2 co)".endl()
            + "{".endl()
            + "    return texture(CGLRNDTEX,co*5711.0).r;".endl()
            + "}".endl()
            + "vec3 cgl_random3(vec2 co)".endl()
            + "{".endl()
            + "    return texture(CGLRNDTEX,co*5711.0).rgb;".endl()
            + "}";

        this.initUniforms = function (shader)
        {
            return [new cgl_shader_uniform_Uniform(shader, "t", "CGLRNDTEX", 7)];
        };

        this.onBind = function (cgl, shader)
        {
            CABLES.CGL.Texture.getRandomTexture(cgl);
            cgl.setTexture(7, CABLES.CGL.Texture.getRandomTexture(cgl).tex);
        };
    }

};

;// CONCATENATED MODULE: ./src/core/cg/cg_mesh.js
class CgMesh
{
    _name = "unknown";

    constructor()
    {
    }

}

;// CONCATENATED MODULE: ./src/core/cgl/cgl_mesh.js









const MESH = {};
MESH.lastMesh = null;

/**
 * @typedef {Object} CglMeshAttributeOptions
 * @property {Number} [instanced]
 * @property {Function} [cb]
 * @property {Function} [type]
 */

/**
 * @type Object
 * @typedef CglMeshOptions
 * @property {Number} [glPrimitive]
 * @property {String} [opId]
 */

/**
 * webgl renderable 3d object
 * @class
 * @namespace external:CGL
 * @hideconstructor
 * @example
 * const cgl=this._cgl
 * const mesh=new CGL.Mesh(cgl, geometry);
 *
 * function render()
 * {
 *   mesh.render(cgl.getShader());
 * }
 *
 */
class Mesh extends CgMesh
{

    /** @type {CglContext} */
    #cgl = null;

    /** @type {Geometry} */
    #geom = null;

    /** @type {WebGLBuffer} */
    #bufVerticesIndizes = null;

    /**
     * @param {CglContext} _cgl cgl
     * @param {Geometry} __geom geometry
     * @param {CglMeshOptions} _options
     */
    constructor(_cgl, __geom, _options = {})
    {
        super();
        this.#cgl = _cgl;

        let options = _options || {};
        if (CABLES.isNumeric(options))options = { "glPrimitive": _options }; // old constructor fallback...
        this._log = new Logger("cgl_mesh");
        this._bufVertexAttrib = null;
        this.#bufVerticesIndizes = this.#cgl.gl.createBuffer();
        this._indexType = this.#cgl.gl.UNSIGNED_SHORT;
        this._attributes = [];
        this._attribLocs = {};

        this._lastShader = null;
        this._numInstances = 0;
        this._glPrimitive = options.glPrimitive;

        this.opId = options.opId || "";
        this._preWireframeGeom = null;
        this.addVertexNumbers = false;

        this.feedBackAttributes = [];
        this.setGeom(__geom);

        this._feedBacks = [];
        this._feedBacksChanged = false;
        this._transformFeedBackLoc = -1;
        this._lastAttrUpdate = 0;

        this.memFreed = false;

        this.#cgl.profileData.addHeavyEvent("mesh constructed", this._name);

        this._queryExt = null;
    }

    get numInstances()
    {
        return this._numInstances;
    }

    set numInstances(v)
    {
        this.setNumInstances(v);
    }

    freeMem()
    {
        this.memFreed = true;

        for (let i = 0; i < this._attributes.length; i++)
            this._attributes[i].floatArray = null;
    }

    /**
     * @function updateVertices
     * @memberof Mesh
     * @instance
     * @description update vertices only from a geometry
     * @param {Geometry} geom
     */
    updateVertices(geom)
    {
        this.setAttribute(constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_POSITION, geom.vertices, 3);
        this._numVerts = geom.vertices.length / 3;
    }

    /**
     * @param {String} attrName
     * @param {String} name
     * @param {Number} stride
     * @param {Number} offset
      */
    setAttributePointer(attrName, name, stride, offset)
    {
        for (let i = 0; i < this._attributes.length; i++)
        {
            if (this._attributes[i].name == attrName)
            {
                if (!this._attributes[i].pointer) this._attributes[i].pointer = [];

                this._attributes[i].pointer.push(
                    {
                        "loc": -1,
                        "name": name,
                        "stride": stride,
                        "offset": offset,
                        "instanced": attrName == constants_CONSTANTS.SHADER.SHADERVAR_INSTANCE_MMATRIX,
                    }
                );
            }
        }
    }

    /**
     * @param {String} name
     * @returns {AttributeObject}
     */
    getAttribute(name)
    {
        for (let i = 0; i < this._attributes.length; i++) if (this._attributes[i].name == name) return this._attributes[i];
    }

    setAttributeRange(attr, array, start, end)
    {
        if (!attr) return;
        if (!start && !end) return;

        if (!attr.name)
            this._log.stack("no attrname?!");

        const gl = this.#cgl.gl;

        gl.bindBuffer(gl.ARRAY_BUFFER, attr.buffer);
        this.#cgl.profileData.profileMeshAttributes += (end - start) || 0;

        this.#cgl.profileData.profileSingleMeshAttribute[this._name] = this.#cgl.profileData.profileSingleMeshAttribute[this._name] || 0;
        this.#cgl.profileData.profileSingleMeshAttribute[this._name] += (end - start) || 0;

        if (attr.numItems < array.length / attr.itemSize)
        {
            this._resizeAttr(array, attr);
        }

        if (end > array.length && !this.warned)
        {
            this.warned = true;
            this._log.warn(this.#cgl.canvas.id + " " + attr.name + " buffersubdata out of bounds ?", array.length, end, start, attr);
            return;
        }

        // if (glVersion == 1) gl.bufferSubData(gl.ARRAY_BUFFER, 0, array); // probably slow/ maybe create and array with only changed size ??
        // else
        gl.bufferSubData(gl.ARRAY_BUFFER, start * 4, array, start, (end - start));
    }

    _resizeAttr(array, attr)
    {
        const gl = this.#cgl.gl;

        if (attr.buffer)
            gl.deleteBuffer(attr.buffer);

        attr.buffer = gl.createBuffer();
        gl.bindBuffer(gl.ARRAY_BUFFER, attr.buffer);
        this._bufferArray(array, attr);
        attr.numItems = array.length / attr.itemSize;// numItems;
    }

    _bufferArray(array, attr)
    {
        let floatArray = attr.floatArray || null;
        if (!array) return;

        if (this.#cgl.debugOneFrame)
        {
        console.log("_bufferArray", array.length, attr.name); // eslint-disable-line
        }

        if (!(array instanceof Float32Array))
        {
            if (attr && floatArray && floatArray.length == array.length)
            {
                floatArray.set(array);
            }
            else
            {
                floatArray = new Float32Array(array);

                if (this.#cgl.debugOneFrame)
                {
                console.log("_bufferArray create new float32array", array.length, attr.name); // eslint-disable-line
                }

                if (array.length > 10000)
                {
                    this.#cgl.profileData.profileNonTypedAttrib++;
                    this.#cgl.profileData.profileNonTypedAttribNames = "(" + this._name + ":" + attr.name + ")";
                }
            }
        }
        else floatArray = array;

        attr.arrayLength = floatArray.length;
        attr.floatArray = null;// floatArray;

        this.#cgl.gl.bufferData(this.#cgl.gl.ARRAY_BUFFER, floatArray, this.#cgl.gl.DYNAMIC_DRAW);
    }

    /**
     * @function setAttribute
     * @description update attribute
     * @memberof Mesh
     * @instance
     * @param {String} name
     * @param {Array} array
     * @param {Number} itemSize
     * @param {Object} options
     */
    addAttribute(name, array, itemSize, options)
    {
        this.setAttribute(name, array, itemSize, options);
    }

    /**
     * @param {String} name
     * @param {Array} array
     * @param {Number} itemSize Integer
     * @param {CglMeshAttributeOptions} options
     */
    setAttribute(name, array, itemSize, options = {})
    {
        if (!array)
        {
            this._log.error("mesh addAttribute - no array given! " + name);
            throw new Error();
        }
        let cb = null;
        let instanced = false;
        let i = 0;
        const numItems = array.length / itemSize;

        this.#cgl.profileData.profileMeshAttributes += numItems || 0;

        if (typeof options == "function")
        {
            cb = options;
        }

        if (typeof options == "object")
        {
            if (options.cb) cb = options.cb;
            if (options.instanced) instanced = options.instanced;
        }

        if (name == constants_CONSTANTS.SHADER.SHADERVAR_INSTANCE_MMATRIX) instanced = true;

        for (i = 0; i < this._attributes.length; i++)
        {
            const attr = this._attributes[i];
            if (attr.name == name)
            {
                if (attr.numItems === numItems)
                {
                }
                else
                {
                    this._resizeAttr(array, attr);
                }

                this.#cgl.gl.bindBuffer(this.#cgl.gl.ARRAY_BUFFER, attr.buffer);
                this._bufferArray(array, attr);

                return attr;
            }
        }

        // create new buffer...

        const buffer = this.#cgl.gl.createBuffer();

        this.#cgl.gl.bindBuffer(this.#cgl.gl.ARRAY_BUFFER, buffer);
        // this._cgl.gl.bufferData(this._cgl.gl.ARRAY_BUFFER, floatArray, this._cgl.gl.DYNAMIC_DRAW);

        let type = this.#cgl.gl.FLOAT;
        if (options && options.type) type = options.type;
        const attr = {
            "buffer": buffer,
            "name": name,
            "cb": cb,
            "itemSize": itemSize,
            "numItems": numItems,
            "startItem": 0,
            "instanced": instanced,
            "type": type
        };

        this._bufferArray(array, attr);

        if (name == constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_POSITION) this._bufVertexAttrib = attr;
        this._attributes.push(attr);
        this._attribLocs = {};

        return attr;
    }

    getAttributes()
    {
        return this._attributes;
    }

    /**
     * @function updateTexCoords
     * @description update texture coordinates only from a geometry
     * @memberof Mesh
     * @instance
     * @param {Geometry} geom
     */
    updateTexCoords(geom)
    {
        if (geom.texCoords && geom.texCoords.length > 0)
        {
            this.setAttribute(constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_TEXCOORD, geom.texCoords, 2);
        }
        else
        {
            const tcBuff = new Float32Array(Math.round((geom.vertices.length / 3) * 2));
            this.setAttribute(constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_TEXCOORD, tcBuff, 2);
        }
    }

    /**
     * @function updateNormals
     * @description update normals only from a geometry
     * @memberof Mesh
     * @instance
     * @param {Geometry} geom
     */
    updateNormals(geom)
    {
        if (geom.vertexNormals && geom.vertexNormals.length > 0)
        {
            this.setAttribute(constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_NORMAL, geom.vertexNormals, 3);
        }
        else
        {
            const tcBuff = new Float32Array(Math.round((geom.vertices.length)));
            this.setAttribute(constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_NORMAL, tcBuff, 3);
        }
    }

    /**
     * @param {Array} arr
     */
    _setVertexNumbers(arr)
    {
        if (!this._verticesNumbers || this._verticesNumbers.length != this._numVerts || arr)
        {
            if (arr) this._verticesNumbers = arr;
            else
            {
                this._verticesNumbers = new Float32Array(this._numVerts);
                for (let i = 0; i < this._numVerts; i++) this._verticesNumbers[i] = i;
            }

            this.setAttribute(constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_NUMBER, this._verticesNumbers, 1, (attr, geom, shader) =>
            {
                if (!shader.uniformNumVertices) shader.uniformNumVertices = new cgl_shader_uniform_Uniform(shader, "f", "numVertices", this._numVerts);
                shader.uniformNumVertices.setValue(this._numVerts);
            });
        }
    }

    /**
     * @function setVertexIndices
     * @description update vertex indices / faces
     * @memberof Mesh
     * @instance
     * @param {array} vertIndices
     */
    setVertexIndices(vertIndices)
    {
        if (!this.#bufVerticesIndizes)
        {
            this._log.warn("no bufVerticesIndizes: " + this._name);
            return;
        }
        if (vertIndices.length > 0)
        {
            if (vertIndices instanceof Float32Array) this._log.warn("vertIndices float32Array: " + this._name);

            for (let i = 0; i < vertIndices.length; i++)
            {
                if (vertIndices[i] >= this._numVerts)
                {
                    this._log.warn("invalid index in " + this._name, i, vertIndices[i]);
                    return;
                }
            }

            this.#cgl.gl.bindBuffer(this.#cgl.gl.ELEMENT_ARRAY_BUFFER, this.#bufVerticesIndizes);

            /*
             * todo cache this ?
             * if(!this.vertIndicesTyped || this.vertIndicesTyped.length!=this._geom.verticesIndices.length)
             */

            if (vertIndices.length > 65535)
            {
                this.vertIndicesTyped = new Uint32Array(vertIndices);
                this._indexType = this.#cgl.gl.UNSIGNED_INT;
            }
            else
            if (vertIndices instanceof Uint32Array)
            {
                this.vertIndicesTyped = vertIndices;
                this._indexType = this.#cgl.gl.UNSIGNED_INT;
            }
            else
            if (!(vertIndices instanceof Uint16Array))
            {
                this.vertIndicesTyped = new Uint16Array(vertIndices);
                this._indexType = this.#cgl.gl.UNSIGNED_SHORT;
            }
            else this.vertIndicesTyped = vertIndices;

            this.#cgl.gl.bufferData(this.#cgl.gl.ELEMENT_ARRAY_BUFFER, this.vertIndicesTyped, this.#cgl.gl.DYNAMIC_DRAW);
            this.#bufVerticesIndizes.itemSize = 1;
            this.#bufVerticesIndizes.numItems = vertIndices.length;
        }
        else this.#bufVerticesIndizes.numItems = 0;
    }

    /**
     * @function setGeom
     * @memberof Mesh
     * @instance
     * @description set geometry for mesh
     * @param {Geometry} geom
     * @param {boolean} removeRef
     */
    setGeom(geom, removeRef = false)
    {
        this.#geom = geom;
        if (geom.glPrimitive != null) this._glPrimitive = geom.glPrimitive;
        if (this.#geom && this.#geom.name) this._name = "mesh " + this.#geom.name;

        MESH.lastMesh = null;
        this.#cgl.profileData.profileMeshSetGeom++;

        this._disposeAttributes();

        this.updateVertices(this.#geom);
        this.setVertexIndices(this.#geom.verticesIndices);

        if (this.addVertexNumbers) this._setVertexNumbers();

        const geomAttribs = this.#geom.getAttributes();

        const attribAssoc = {
            "texCoords": constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_TEXCOORD,
            "vertexNormals": constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_NORMAL,
            "vertexColors": constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_COLOR,
            "tangents": "attrTangent",
            "biTangents": "attrBiTangent",
        };

        for (const index in geomAttribs)
            if (geomAttribs[index].data && geomAttribs[index].data.length)
                this.setAttribute(attribAssoc[index] || index, geomAttribs[index].data, geomAttribs[index].itemSize);

        if (removeRef)
        {
            this.#geom = null;
        }
    }

    _preBind(shader)
    {
        for (let i = 0; i < this._attributes.length; i++)
            if (this._attributes[i].cb)
                this._attributes[i].cb(this._attributes[i], this.#geom, shader);
    }

    _checkAttrLengths()
    {
        if (this.memFreed) return;
        // check length
        for (let i = 0; i < this._attributes.length; i++)
        {
            if (this._attributes[i].arrayLength / this._attributes[i].itemSize < this._attributes[0].arrayLength / this._attributes[0].itemSize)
            {
                let name = "unknown";
                if (this.#geom)name = this.#geom.name;

            /*
             * this._log.warn(
             *     name + ": " + this._attributes[i].name +
             *     " wrong attr length. is:", this._attributes[i].arrayLength / this._attributes[i].itemSize,
             *     " should be:", this._attributes[0].arrayLength / this._attributes[0].itemSize,
             * );
             */
            }
        }
    }

    _bind(shader)
    {
        if (!shader) return;
        if (!shader.isValid()) return;

        let attrLocs = [];
        if (this._attribLocs[shader.id]) attrLocs = this._attribLocs[shader.id];
        else this._attribLocs[shader.id] = attrLocs;

        this._lastShader = shader;
        if (shader.lastCompile > this._lastAttrUpdate || attrLocs.length != this._attributes.length)
        {
            this._lastAttrUpdate = shader.lastCompile;
            for (let i = 0; i < this._attributes.length; i++) attrLocs[i] = -1;
        }

        for (let i = 0; i < this._attributes.length; i++)
        {
            const attribute = this._attributes[i];
            if (attrLocs[i] == -1)
            {
                if (attribute._attrLocationLastShaderTime != shader.lastCompile)
                {
                    attribute._attrLocationLastShaderTime = shader.lastCompile;
                    attrLocs[i] = this.#cgl.glGetAttribLocation(shader.getProgram(), attribute.name);
                    // this._log.log('attribloc',attribute.name,attrLocs[i]);
                    this.#cgl.profileData.profileAttrLoc++;
                }
            }

            if (attrLocs[i] != -1)
            {
                this.#cgl.gl.enableVertexAttribArray(attrLocs[i]);
                this.#cgl.gl.bindBuffer(this.#cgl.gl.ARRAY_BUFFER, attribute.buffer);

                if (attribute.instanced)
                {
                // todo: easier way to fill mat4 attribs...
                    if (attribute.itemSize <= 4)
                    {
                        if (!attribute.itemSize || attribute.itemSize == 0) this._log.warn("instanced attrib itemsize error", this.#geom.name, attribute);

                        this.#cgl.gl.vertexAttribPointer(attrLocs[i], attribute.itemSize, attribute.type, false, attribute.itemSize * 4, 0);
                        this.#cgl.gl.vertexAttribDivisor(attrLocs[i], 1);
                    }
                    else if (attribute.itemSize == 16)
                    {
                        const stride = 16 * 4;

                        this.#cgl.gl.vertexAttribPointer(attrLocs[i], 4, attribute.type, false, stride, 0);
                        this.#cgl.gl.enableVertexAttribArray(attrLocs[i] + 1);
                        this.#cgl.gl.vertexAttribPointer(attrLocs[i] + 1, 4, attribute.type, false, stride, 4 * 4 * 1);
                        this.#cgl.gl.enableVertexAttribArray(attrLocs[i] + 2);
                        this.#cgl.gl.vertexAttribPointer(attrLocs[i] + 2, 4, attribute.type, false, stride, 4 * 4 * 2);
                        this.#cgl.gl.enableVertexAttribArray(attrLocs[i] + 3);
                        this.#cgl.gl.vertexAttribPointer(attrLocs[i] + 3, 4, attribute.type, false, stride, 4 * 4 * 3);

                        this.#cgl.gl.vertexAttribDivisor(attrLocs[i], 1);
                        this.#cgl.gl.vertexAttribDivisor(attrLocs[i] + 1, 1);
                        this.#cgl.gl.vertexAttribDivisor(attrLocs[i] + 2, 1);
                        this.#cgl.gl.vertexAttribDivisor(attrLocs[i] + 3, 1);
                    }
                    else
                    {
                        this._log.warn("unknown instance attrib size", attribute.name);
                    }
                }
                else
                {
                    if (!attribute.itemSize || attribute.itemSize == 0) this._log.warn("attrib itemsize error", this._name, attribute);
                    this.#cgl.gl.vertexAttribPointer(attrLocs[i], attribute.itemSize, attribute.type, false, attribute.itemSize * 4, 0);

                    if (attribute.pointer)
                    {
                        for (let ip = 0; ip < attribute.pointer.length; ip++)
                        {
                            const pointer = attribute.pointer[ip];

                            if (pointer.loc == -1)
                                pointer.loc = this.#cgl.glGetAttribLocation(shader.getProgram(), pointer.name);

                            this.#cgl.profileData.profileAttrLoc++;

                            this.#cgl.gl.enableVertexAttribArray(pointer.loc);
                            this.#cgl.gl.vertexAttribPointer(pointer.loc, attribute.itemSize, attribute.type, false, pointer.stride, pointer.offset);
                        }
                    }
                    if (this.bindFeedback) this.bindFeedback(attribute);
                }
            }
        }

        if (this.#bufVerticesIndizes && this.#bufVerticesIndizes.numItems !== 0) this.#cgl.gl.bindBuffer(this.#cgl.gl.ELEMENT_ARRAY_BUFFER, this.#bufVerticesIndizes);
    }

    unBind()
    {
        const shader = this._lastShader;
        this._lastShader = null;
        if (!shader) return;

        let attrLocs = [];
        if (this._attribLocs[shader.id]) attrLocs = this._attribLocs[shader.id];
        else this._attribLocs[shader.id] = attrLocs;

        MESH.lastMesh = null;

        for (let i = 0; i < this._attributes.length; i++)
        {
            if (this._attributes[i].instanced)
            {
            // todo: easier way to fill mat4 attribs...
                if (this._attributes[i].itemSize <= 4)
                {
                    if (attrLocs[i] != -1) this.#cgl.gl.vertexAttribDivisor(attrLocs[i], 0);
                    if (attrLocs[i] >= 0) this.#cgl.gl.disableVertexAttribArray(attrLocs[i]);
                }
                else
                {
                    this.#cgl.gl.vertexAttribDivisor(attrLocs[i], 0);
                    this.#cgl.gl.vertexAttribDivisor(attrLocs[i] + 1, 0);
                    this.#cgl.gl.vertexAttribDivisor(attrLocs[i] + 2, 0);
                    this.#cgl.gl.vertexAttribDivisor(attrLocs[i] + 3, 0);
                    this.#cgl.gl.disableVertexAttribArray(attrLocs[i] + 1);
                    this.#cgl.gl.disableVertexAttribArray(attrLocs[i] + 2);
                    this.#cgl.gl.disableVertexAttribArray(attrLocs[i] + 3);
                }
            }

            if (attrLocs[i] != -1) this.#cgl.gl.disableVertexAttribArray(attrLocs[i]);

        }
    }

    meshChanged()
    {
        return this.#cgl.lastMesh && this.#cgl.lastMesh != this;
    }

    printDebug(shader)
    {
        console.log("--attributes");
        for (let i = 0; i < this._attributes.length; i++)
        {
            console.log("attribute " + i + " " + this._attributes[i].name);
        }
    }

    /**
     * @param {Number} num
     */
    setNumVertices(num)
    {
        // this._bufVerticesIndizes.numItems = num;
        this._bufVertexAttrib.numItems = num;
    }

    /**
     * @returns {Number}
     */
    getNumVertices()
    {
        // return this._bufVerticesIndizes.numItems;
        return this._bufVertexAttrib.numItems;
    }

    /**
     * @param {Number} num
     */
    setNumIndices(num)
    {
        this.#bufVerticesIndizes.numItems = num;
    }

    /**
     * @returns {Number}
     */
    getNumIndices()
    {
        return this.#bufVerticesIndizes.numItems;
    }

    /**
     * @function render
     * @memberof Mesh
     * @instance
     * @description draw mesh to screen
     * @param {CgShader} shader
     */
    render(shader)
    {
        // TODO: enable/disablevertex only if the mesh has changed... think drawing 10000x the same mesh

        if (this.#cgl.aborted) return;
        shader = shader || this.#cgl.getShader();

        if (!shader)
        {
            return console.log("shadern not valid");
        }

        if (!shader.isValid())
        {
            shader = this.#cgl.getErrorShader();
        }

        this._checkAttrLengths();

        if (this.#geom)
        {
            if (this._preWireframeGeom && !shader.wireframe && !this.#geom.isIndexed())
            {
                this.setGeom(this._preWireframeGeom);
                this._preWireframeGeom = null;
            }

            if (shader.wireframe)
            {
                let changed = false;

                if (this.#geom.isIndexed())
                {
                    if (!this._preWireframeGeom)
                    {
                        this._preWireframeGeom = this.#geom;
                        this.#geom = this.#geom.copy();
                    }

                    this.#geom.unIndex();
                    changed = true;
                }

                if (!this.#geom.getAttribute("attrBarycentric"))
                {
                    if (!this._preWireframeGeom)
                    {
                        this._preWireframeGeom = this.#geom;
                        this.#geom = this.#geom.copy();
                    }
                    changed = true;

                    this.#geom.calcBarycentric();
                }
                if (changed) this.setGeom(this.#geom);
            }
        }

        let needsBind = false;
        if (MESH.lastMesh != this)
        {
            if (MESH.lastMesh) MESH.lastMesh.unBind();
            needsBind = true;
        }

        if (needsBind) this._preBind(shader);

        if (!shader.bind()) return;

        this._bind(shader);
        if (this.addVertexNumbers) this._setVertexNumbers();

        MESH.lastMesh = this;

        let prim = this.#cgl.gl.TRIANGLES;
        if (this._glPrimitive !== undefined) prim = this._glPrimitive;
        if (shader.glPrimitive !== null) prim = shader.glPrimitive;

        let elementDiv = 1;
        let doQuery = this.#cgl.profileData.doProfileGlQuery;
        let queryStarted = false;
        if (doQuery)
        {
            let id = this._name + " - " + shader.getName() + " #" + shader.id;
            if (this._numInstances) id += " instanced " + this._numInstances + "x";

            let queryProfilerData = this.#cgl.profileData.glQueryData[id];

            if (!queryProfilerData) queryProfilerData = { "id": id, "num": 0 };

            if (shader.opId)queryProfilerData.shaderOp = shader.opId;
            if (this.opId)queryProfilerData.meshOp = this.opId;

            this.#cgl.profileData.glQueryData[id] = queryProfilerData;

            if (!this._queryExt && this._queryExt !== false) this._queryExt = this.#cgl.enableExtension("EXT_disjoint_timer_query_webgl2") || false;
            if (this._queryExt)
            {
                if (queryProfilerData._drawQuery)
                {
                    const available = this.#cgl.gl.getQueryParameter(queryProfilerData._drawQuery, this.#cgl.gl.QUERY_RESULT_AVAILABLE);
                    if (available)
                    {
                        const elapsedNanos = this.#cgl.gl.getQueryParameter(queryProfilerData._drawQuery, this.#cgl.gl.QUERY_RESULT);
                        const currentTimeGPU = elapsedNanos / 1000000;

                        queryProfilerData._times = queryProfilerData._times || 0;
                        queryProfilerData._times += currentTimeGPU;
                        queryProfilerData._numcount++;
                        queryProfilerData.when = performance.now();
                        queryProfilerData._drawQuery = null;
                        queryProfilerData.queryStarted = false;
                    }
                }

                if (!queryProfilerData.queryStarted)
                {
                    queryProfilerData._drawQuery = this.#cgl.gl.createQuery();
                    this.#cgl.gl.beginQuery(this._queryExt.TIME_ELAPSED_EXT, queryProfilerData._drawQuery);
                    queryStarted = queryProfilerData.queryStarted = true;
                }
            }
        }

        if (this.hasFeedbacks && this.hasFeedbacks()) this.drawFeedbacks(shader, prim);
        else if (!this.#bufVerticesIndizes || this.#bufVerticesIndizes.numItems === 0)
        {

            /*
             * for (let i = 0; i < this._attributes.length; i++)
             * {
             *     if (this._attributes[i].arrayLength / this._attributes[i].itemSize != this._bufVertexAttrib.floatArray.length / 3)
             *     {
             *         this._log.warn("attrib buffer length wrong! ", this._attributes[i].name, this._attributes[i].arrayLength / this._attributes[i].itemSize, this._bufVertexAttrib.floatArray.length / 3, this._attributes[i].itemSize);
             *         // this._log.log(this);
             *         // debugger;
             *         return;
             *     }
             * }
             */

            if (prim == this.#cgl.gl.TRIANGLES)elementDiv = 3;

            if (this._numInstances === 0) this.#cgl.gl.drawArrays(prim, this._bufVertexAttrib.startItem, this._bufVertexAttrib.numItems - this._bufVertexAttrib.startItem);
            else this.#cgl.gl.drawArraysInstanced(prim, this._bufVertexAttrib.startItem, this._bufVertexAttrib.numItems, this._numInstances);
        }
        else
        {
            if (prim == this.#cgl.gl.TRIANGLES)elementDiv = 3;
            if (this._numInstances === 0)
            {
                this.#cgl.gl.drawElements(prim, this.#bufVerticesIndizes.numItems, this._indexType, 0);
            }
            else
            {
                this.#cgl.gl.drawElementsInstanced(prim, this.#bufVerticesIndizes.numItems, this._indexType, 0, this._numInstances);
            }
        }

        if (this.#cgl.debugOneFrame && this.#cgl.gl.getError() != this.#cgl.gl.NO_ERROR)
        {
            this._log.error("mesh draw gl error");
            this._log.error("mesh", this);
            this._log.error("shader", shader);

            const attribNames = [];
            for (let i = 0; i < this.#cgl.gl.getProgramParameter(shader.getProgram(), this.#cgl.gl.ACTIVE_ATTRIBUTES); i++)
            {
                const name = this.#cgl.gl.getActiveAttrib(shader.getProgram(), i).name;
                this._log.error("attrib ", name);
            }
        }

        this.#cgl.profileData.profileMeshNumElements += (this._bufVertexAttrib.numItems / elementDiv) * (this._numInstances || 1);
        this.#cgl.profileData.profileMeshDraw++;

        if (doQuery && queryStarted)
        {
            this.#cgl.gl.endQuery(this._queryExt.TIME_ELAPSED_EXT);
        }

        this.#cgl.printError("mesh render " + this._name);

        this.unBind();
    }

    setNumInstances(n)
    {
        n = Math.max(0, n);
        if (this._numInstances != n)
        {
            this._numInstances = n;
            const indexArr = new Float32Array(n);
            for (let i = 0; i < n; i++) indexArr[i] = i;
            this.setAttribute(constants_CONSTANTS.SHADER.SHADERVAR_INSTANCE_INDEX, indexArr, 1, { "instanced": true });
        }
    }

    _disposeAttributes()
    {
        if (!this._attributes) return;

        for (let i = 0; i < this._attributes.length; i++)
        {
            if (this._attributes[i].buffer)
            {
                this.#cgl.gl.deleteBuffer(this._attributes[i].buffer);
                this._attributes[i].buffer = null;
            }
        }
        this._attributes.length = 0;
    }

    dispose()
    {
        if (this._bufVertexAttrib && this._bufVertexAttrib.buffer) this.#cgl.gl.deleteBuffer(this._bufVertexAttrib.buffer);
        if (this.#bufVerticesIndizes) this.#cgl.gl.deleteBuffer(this.#bufVerticesIndizes);
        this.#bufVerticesIndizes = null;

        this._disposeAttributes();
    }
}



;// CONCATENATED MODULE: ./src/core/cg/cg_shader.js




/**
 * @typedef ShaderModule
 * @property {String} title
 * @property {Number} id
 * @property {Number} numId
 * @property {String} group
 * @property {String} prefix
 * @property {Number} priority
 * @property {String} srcBodyFrag
 * @property {String} srcBodyVert
 */

class CgShader extends Events
{
    id = simpleId();
    _isValid = true;

    // this._defines.push([name, value]);

    /** @type {Array<Array<String>>} */
    _defines = [];

    /** @type {Array<String>} */
    _moduleNames = [];

    _moduleNumId = 0;
    _needsRecompile = true;
    _compileReason = "initial";

    /** @type {Array<ShaderModule>} */
    _modules = [];

    _compileCount = 0;

    logError = true;

    constructor()
    {
        super();
    }

    /**
     * @param {string} reason
     */
    setWhyCompile(reason)
    {
        this._compileReason = reason;
        this._needsRecompile = true;
    }

    getWhyCompile()
    {
        return this._compileReason;
    }

    needsRecompile()
    {
        return this._needsRecompile;
    }

    /**
     * easily enable/disable a define without a value
     * @param {String} name
     * @param {Port} enabled value or port
     */
    toggleDefine(name, enabled)
    {
        if (enabled && typeof (enabled) == "object" && enabled.addEventListener) // port
        {
            if (enabled.changeListener)enabled.off(enabled.changeListener);

            enabled.onToggleDefine = (v) =>
            {
                this.toggleDefine(name, v);
            };

            enabled.changeListener = enabled.on("change", enabled.onToggleDefine);
            enabled = enabled.get();
        }

        if (enabled) this.define(name);
        else this.removeDefine(name);
    }

    /**
     * add a define to a shader, e.g.  #define DO_THIS_THAT 1
     * @param {String} name
     * @param {any} value (can be empty)
     */
    define(name, value = "")
    {
        if (value === null || value === undefined) value = "";

        if (typeof (value) == "object") // port
        {
            value.removeEventListener("change", value.onDefineChange);
            value.onDefineChange = (v) =>
            {
                this.define(name, v);
            };
            value.on("change", value.onDefineChange);

            value = value.get();
        }

        for (let i = 0; i < this._defines.length; i++)
        {
            if (this._defines[i][0] == name && this._defines[i][1] == value) return;
            if (this._defines[i][0] == name)
            {
                this._defines[i][1] = value;
                this.setWhyCompile("define " + name + " " + value);
                return;
            }
        }
        this.setWhyCompile("define " + name + " " + value);

        this._defines.push([name, value]);
    }

    getDefines()
    {
        return this._defines;
    }

    /**
     * @param {string} name
     */
    getDefine(name)
    {
        for (let i = 0; i < this._defines.length; i++)
            if (this._defines[i][0] == name) return this._defines[i][1];
        return null;
    }

    /**
     * return true if shader has define
     * @function hasDefine
     * @memberof Shader
     * @instance
     * @param {String} name
     * @return {Boolean}
     */
    hasDefine(name)
    {
        for (let i = 0; i < this._defines.length; i++)
            if (this._defines[i][0] == name) return true;
    }

    /**
     * remove a define from a shader
     * @param {string} name
     */
    removeDefine(name)
    {
        for (let i = 0; i < this._defines.length; i++)
        {
            if (this._defines[i][0] == name)
            {
                this._defines.splice(i, 1);

                this.setWhyCompile("define removed:" + name);

                return;
            }
        }
    }

    /**
     * @param {any} modId
     */
    hasModule(modId)
    {
        for (let i = 0; i < this._modules.length; i++)
            if (this._modules[i].id == modId) return true;

        return false;
    }

    /**
     *
     * @param {Array<String>} names
     */
    setModules(names)
    {
        this._moduleNames = names;
    }

    /**
     * remove a module from shader
     * @param {ShaderModule} mod the module to be removed
     */
    removeModule(mod)
    {
        for (let i = 0; i < this._modules.length; i++)
        {
            if (mod && mod.id)
            {
                if (this._modules[i].id == mod.id || !this._modules[i])
                {
                    let found = true;
                    while (found)
                    {
                        found = false;
                        for (let j = 0; j < this._uniforms.length; j++)
                        {
                            if (this._uniforms[j].getName().startsWith(mod.prefix))
                            {
                                this._uniforms.splice(j, 1);
                                found = true;
                                continue;
                            }
                        }
                    }

                    this.setWhyCompile("remove module " + mod.title);
                    this._modules.splice(i, 1);
                    break;
                }
            }
        }
    }

    getNumModules()
    {
        return this._modules.length;
    }

    getCurrentModules() { return this._modules; }

    /**
     * add a module
     * @param {ShaderModule} mod the module to be added
     * @param {ShaderModule} [sibling] sibling module, new module will share the same group
     */
    addModule(mod, sibling)
    {
        if (this.hasModule(mod.id)) return;
        if (!mod.id) mod.id = CABLES.simpleId();
        if (!mod.numId) mod.numId = this._moduleNumId;
        if (!mod.num)mod.num = this._modules.length;
        if (sibling && !sibling.group) sibling.group = simpleId();

        if (!mod.group)
            if (sibling) mod.group = sibling.group;
            else mod.group = simpleId();

        mod.prefix = "mod" + mod.group + "_";
        this._modules.push(mod);

        this.setWhyCompile("add module " + mod.title);
        this._moduleNumId++;

        return mod;
    }

    isValid()
    {
        return this._isValid;
    }

    // getAttributeSrc(mod, srcHeadVert, srcVert)
    // {
    //     if (mod.attributes)
    //         for (let k = 0; k < mod.attributes.length; k++)
    //         {
    //             const r = this._getAttrSrc(mod.attributes[k], false);
    //             if (r.srcHeadVert)srcHeadVert += r.srcHeadVert;
    //             if (r.srcVert)srcVert += r.srcVert;
    //         }

    //     return { "srcHeadVert": srcHeadVert, "srcVert": srcVert };
    // }

    // replaceModuleSrc()
    // {
    //     let srcHeadVert = "";

    //     for (let j = 0; j < this._modules.length; j++)
    //     {
    //         const mod = this._modules[j];
    //         if (mod.name == this._moduleNames[i])
    //         {
    //             srcHeadVert += "\n//---- MOD: group:" + mod.group + ": idx:" + j + " - prfx:" + mod.prefix + " - " + mod.title + " ------\n";

    //             srcVert += "\n\n//---- MOD: " + mod.title + " / " + mod.priority + " ------\n";

    //             if (mod.getAttributeSrc)
    //             {
    //                 const r = getAttributeSrc(mod, srcHeadVert, srcVert);
    //                 if (r.srcHeadVert)srcHeadVert += r.srcHeadVert;
    //                 if (r.srcVert)srcVert += r.srcVert;
    //             }

    //             srcHeadVert += mod.srcHeadVert || "";
    //             srcVert += mod.srcBodyVert || "";

    //             srcHeadVert += "\n//---- end mod ------\n";

    //             srcVert += "\n//---- end mod ------\n";

    //             srcVert = srcVert.replace(/{{mod}}/g, mod.prefix);
    //             srcHeadVert = srcHeadVert.replace(/{{mod}}/g, mod.prefix);

    //             srcVert = srcVert.replace(/MOD_/g, mod.prefix);
    //             srcHeadVert = srcHeadVert.replace(/MOD_/g, mod.prefix);
    //         }
    //     }

    //     vs = vs.replace("{{" + this._moduleNames[i] + "}}", srcVert);
    // }
}



;// CONCATENATED MODULE: ./src/core/cgl/cgl_shader_default_glsl.vert
/* harmony default export */ const cgl_shader_default_glsl = ("{{MODULES_HEAD}}\nIN vec3 vPosition; //!@\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent,attrBiTangent;\n\nIN float attrVertIndex;\n\nOUT vec2 texCoord;\nOUT vec3 norm;\nUNI mat4 projMatrix;\nUNI mat4 viewMatrix;\nUNI mat4 modelMatrix;\n\nvoid main()\n{\n    texCoord=attrTexCoord;\n    norm=attrVertNormal;\n    vec4 pos=vec4(vPosition,  1.0);\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n    mat4 mMatrix=modelMatrix;\n    gl_PointSize=10.0;\n\n    {{MODULE_VERTEX_POSITION}}\n\n    mat4 modelViewMatrix=viewMatrix*mMatrix;\n    {{MODULE_VERTEX_MODELVIEW}}\n\n    gl_Position = projMatrix * modelViewMatrix * pos;\n}\n");
;// CONCATENATED MODULE: ./src/core/cgl/cgl_shader.js












// ---------------------------------------------------------------------------

/*

proposal default shader variable names:

attrVertex - currently: vPosition
attrVertexIndex - currently: attrVertIndex
attrTexCoord
attrInstMat - currently: instMat
attrVertColor
attrTangent
attrBiTangent

uProjMatrix - currently: projMatrix
uModelMatrix - currently: modelMatrix
uNormalMatrix - currently: normalMatrix
uCamPosition - currently: camPos

*/

// ---------------------------------------------------------------------------

let materialIdCounter = 0;

function getDefaultVertexShader()
{
    return cgl_shader_default_glsl;
}

function getDefaultFragmentShader(r, g, b)
{
    if (r == undefined)
    {
        r = 0.5;
        g = 0.5;
        b = 0.5;
    }
    return ""
        .endl() + "IN vec2 texCoord;"
        .endl() + "{{MODULES_HEAD}}"
        .endl() + "void main()"
        .endl() + "{"
        .endl() + "    vec4 col=vec4(" + r + "," + g + "," + b + ",1.0);"
        .endl() + "    {{MODULE_COLOR}}"
        .endl() + "    outColor = col;"
        .endl() + "}";
}

/**
 * @class
 * @namespace external:CGL
 * @hideconstructor
 * @param _cgl
 * @param _name
 * @param _op
 * @example
 * var shader=new CGL.Shader(cgl,'MinimalMaterial');
 * shader.setSource(attachments.shader_vert,attachments.shader_frag);
 */
class CglShader extends CgShader
{
    constructor(_cgl, _name, _op)
    {
        super();
        if (!_cgl) throw new Error("shader constructed without cgl " + _name);

        this._log = new Logger("cgl_shader");
        this._cgl = _cgl;

        if (!_name) this._log.stack("no shader name given");
        this._name = _name || "unknown";

        if (_op) this.opId = _op.id;
        this.glslVersion = 0;
        if (_cgl.glVersion > 1) this.glslVersion = 300;

        this._materialId = ++materialIdCounter;

        this._program = null;
        this._uniforms = [];
        this._drawBuffers = [true];
        this.error = null;

        this.ignoreMissingUniforms = false;
        this._projMatrixUniform = null;
        this._mvMatrixUniform = null;
        this._mMatrixUniform = null;
        this._vMatrixUniform = null;
        this._camPosUniform = null;
        this._normalMatrixUniform = null;
        this._inverseViewMatrixUniform = null;
        this._fromUserInteraction = false;

        this._attrVertexPos = -1;
        this.precision = _cgl.patch.config.glslPrecision || "highp";

        this._pMatrixState = -1;
        this._vMatrixState = -1;

        this._countMissingUniforms = 0;
        this._modGroupCount = 0; // not needed anymore...
        this._feedBackNames = [];
        this._attributes = [];

        this.glPrimitive = null;
        this.offScreenPass = false;
        this._extensions = [];
        this.srcVert = getDefaultVertexShader();
        this.srcFrag = getDefaultFragmentShader();
        this.lastCompile = 0;

        this._libs = [];
        this._structNames = [];
        this._structUniformNames = [];
        this._textureStackUni = [];
        this._textureStackTex = [];
        this._textureStackType = [];
        this._textureStackTexCgl = [];

        this._tempNormalMatrix = mat4.create();
        this._tempCamPosMatrix = mat4.create();
        this._tempInverseViewMatrix = mat4.create();
        this._tempInverseProjMatrix = mat4.create();

        this.setModules(["MODULE_VERTEX_POSITION", "MODULE_COLOR", "MODULE_NORMAL", "MODULE_BEGIN_FRAG", "MODULE_VERTEX_MODELVIEW"]);
    }

    isValid()
    {
        return this._isValid;
    }

    getCgl()
    {
        return this._cgl;
    }

    getName()
    {
        return this._name;
    }

    /**
     * @param {string} name
     */
    enableExtension(name)
    {
        this.setWhyCompile("enable extension " + name);

        this._extensions.push(name);
    }

    getAttrVertexPos()
    {
        return this._attrVertexPos;
    }

    hasTextureUniforms()
    {
        for (let i = 0; i < this._uniforms.length; i++)
            if (this._uniforms[i].getType() == "t") return true;
        return false;
    }

    /**
     * copy all uniform values from another shader
     * @function copyUniforms
     * @memberof Shader
     * @instance
     * @param origShader uniform values will be copied from this shader
     */
    copyUniformValues(origShader)
    {
        // this._log.log(origShader._uniforms);
        for (let i = 0; i < origShader._uniforms.length; i++)
        {
            if (!this._uniforms[i])
            {
                this._log.log("unknown uniform?!");
                continue;
            }

            // this._log.log(origShader._uniforms[i].getName());
            // this.getUniform(origShader._uniforms[i].)
            // this._uniforms[i].set(origShader._uniforms[i].getValue());

            // if (origShader._uniforms[i].getName().includes("pathPoints"))
            //     this._log.log("copyUniformValues", origShader._uniforms[i].getName(), origShader._uniforms[i].getValue());

            this.getUniform(origShader._uniforms[i].getName()).set(origShader._uniforms[i].getValue());
        }

        this.popTextures();
        for (let i = 0; i < origShader._textureStackUni.length; i++)
        {
            this._textureStackUni[i] = origShader._textureStackUni[i];
            this._textureStackTex[i] = origShader._textureStackTex[i];
            this._textureStackType[i] = origShader._textureStackType[i];
            this._textureStackTexCgl[i] = origShader._textureStackTexCgl[i];
        }

        // this._textureStackUni = [];
        // this._textureStackTex = [];
        // this._textureStackType = [];
        // this._textureStackTexCgl = [];
    }

    /**
     * copy current shader
     * @function copy
     * @memberof Shader
     * @instance
     * @returns newShader
     */
    copy()
    {
        const shader = new CglShader(this._cgl, this._name + " copy");
        shader.setSource(this.srcVert, this.srcFrag);

        shader._modules = JSON.parse(JSON.stringify(this._modules));
        shader._defines = JSON.parse(JSON.stringify(this._defines));

        shader._modGroupCount = this._modGroupCount;
        shader._moduleNames = this._moduleNames;
        shader.glPrimitive = this.glPrimitive;
        shader.offScreenPass = this.offScreenPass;
        shader._extensions = this._extensions;
        shader.wireframe = this.wireframe;
        shader._attributes = this._attributes;

        for (let i = 0; i < this._uniforms.length; i++)
        {
            const u = this._uniforms[i].copy(shader);
            u.resetLoc();
        }

        shader.setWhyCompile("copy");
        return shader;
    }

    /**
     * set shader source code
     * @function setSource
     * @memberof Shader
     * @instance
     * @param {String} srcVert
     * @param {String} srcFrag
     * @param {Boolean} fromUserInteraction
     */
    setSource(srcVert, srcFrag, fromUserInteraction = false)
    {
        this._fromUserInteraction = fromUserInteraction;
        this.srcVert = srcVert;
        this.srcFrag = srcFrag;
        this.setWhyCompile("Source changed");
        this._isValid = true;
    }

    _addLibs(src)
    {
        for (const id in ShaderLibMods)
        {
            if (src.includes(id))
            {
                const lib = new ShaderLibMods[id]();
                src = src.replace("{{" + id + "}}", lib.srcHeadFrag);
                this._libs.push(lib);
                if (lib.initUniforms)lib.initUniforms(this);
            }
        }

        return src;
    }

    createStructUniforms()
    {
        // * create structs
        let structStrFrag = "";
        let structStrVert = ""; // TODO: not used yet

        this._structNames = [];
        // * reset the arrays holding the value each recompile so we don't skip structs
        // * key value mapping so the same struct can be added twice (two times the same modifier)
        this._injectedStringsFrag = {};
        this._injectedStringsVert = {};

        this._structUniformNamesIndicesFrag = [];
        this._structUniformNamesIndicesVert = [];

        for (let i = 0; i < this._uniforms.length; i++)
        {
            // * only add uniforms to struct that are a member of a struct
            if (this._uniforms[i].isStructMember())
            {
                const injectionString = "{{INJECTION_POINT_STRUCT_" + this._uniforms[i]._structName + "}}";

                // * check if struct is not already part of shader
                if (!this._structNames.includes(this._uniforms[i]._structName))
                {
                    // * create struct definition with placeholder string to inject
                    const structDefinition = "struct "
                        + this._uniforms[i]._structName + " {".endl()
                        + injectionString
                        + "};".endl().endl();

                    if (this._uniforms[i].getShaderType() === "both" || this._uniforms[i].getShaderType() === "frag")
                        structStrFrag = structStrFrag.concat(structDefinition);

                    if (this._uniforms[i].getShaderType() === "both" || this._uniforms[i].getShaderType() === "vert")
                        structStrVert = structStrVert.concat(structDefinition);

                    this._structNames.push(this._uniforms[i]._structName);
                    this._injectedStringsFrag[this._uniforms[i]._structName] = [];
                    this._injectedStringsVert[this._uniforms[i]._structName] = [];
                }

                // * create member & comment
                let comment = "";
                if (this._uniforms[i].comment) comment = " // " + this._uniforms[i].comment;

                let stringToInsert = "";
                if (this._uniforms[i].getGlslTypeString() == undefined)stringToInsert += "//";
                stringToInsert += "  " + this._uniforms[i].getGlslTypeString()
                        + " " + this._uniforms[i]._propertyName + ";"
                        + comment;

                if (this._uniforms[i].getShaderType() === "both")
                {
                    // * inject member before {injectionString}
                    if (
                        !this._injectedStringsFrag[this._uniforms[i]._structName].includes(stringToInsert)
                    && !this._injectedStringsVert[this._uniforms[i]._structName].includes(stringToInsert))
                    {
                        const insertionIndexFrag = structStrFrag.lastIndexOf(injectionString);
                        const insertionIndexVert = structStrVert.lastIndexOf(injectionString);

                        structStrFrag =
                            structStrFrag.slice(0, insertionIndexFrag)
                            + stringToInsert + structStrFrag.slice(insertionIndexFrag - 1);

                        structStrVert =
                            structStrVert.slice(0, insertionIndexVert)
                            + stringToInsert + structStrVert.slice(insertionIndexVert - 1);

                        this._injectedStringsFrag[this._uniforms[i]._structName].push(stringToInsert);
                        this._injectedStringsVert[this._uniforms[i]._structName].push(stringToInsert);
                    }

                    if (!this._structUniformNamesIndicesFrag.includes(i)) this._structUniformNamesIndicesFrag.push(i);
                    if (!this._structUniformNamesIndicesVert.includes(i)) this._structUniformNamesIndicesVert.push(i);
                }
                else if (this._uniforms[i].getShaderType() === "frag")
                {
                    // * inject member before {injectionString}
                    if (!this._injectedStringsFrag[this._uniforms[i]._structName].includes(stringToInsert)) //
                    {
                        const insertionIndexFrag = structStrFrag.lastIndexOf(injectionString);

                        structStrFrag =
                            structStrFrag.slice(0, insertionIndexFrag)
                            + stringToInsert + structStrFrag.slice(insertionIndexFrag - 1);

                        this._injectedStringsFrag[this._uniforms[i]._structName].push(stringToInsert);
                    }

                    if (!this._structUniformNamesIndicesFrag.includes(i)) this._structUniformNamesIndicesFrag.push(i);
                }
                else if (this._uniforms[i].getShaderType() === "vert")
                {
                    // * inject member before {injectionString}
                    if (!this._injectedStringsVert[this._uniforms[i]._structName].includes(stringToInsert))
                    {
                        const insertionIndexVert = structStrVert.lastIndexOf(injectionString);

                        structStrVert =
                            structStrVert.slice(0, insertionIndexVert)
                            + stringToInsert + structStrVert.slice(insertionIndexVert - 1);

                        this._injectedStringsVert[this._uniforms[i]._structName].push(stringToInsert);
                    }

                    if (!this._structUniformNamesIndicesVert.includes(i)) this._structUniformNamesIndicesVert.push(i);
                }
            }
        }

        // * dedupe injected uni declarations
        this._uniDeclarationsFrag = [];
        this._uniDeclarationsVert = [];

        // * remove struct injection points and add uniform in fragment
        for (let i = 0; i < this._structUniformNamesIndicesFrag.length; i += 1)
        {
            const index = this._structUniformNamesIndicesFrag[i];
            const uniDeclarationString = "UNI " + this._uniforms[index]._structName + " " + this._uniforms[index]._structUniformName + ";".endl();

            if (!this._uniDeclarationsFrag.includes(uniDeclarationString))
            {
                const injectionString = "{{INJECTION_POINT_STRUCT_" + this._uniforms[index]._structName + "}}";

                structStrFrag = structStrFrag.replace(injectionString, "");
                structStrFrag += uniDeclarationString;

                this._uniDeclarationsFrag.push(uniDeclarationString);
            }
        }

        // * remove struct injection points and add uniform in vertex
        for (let i = 0; i < this._structUniformNamesIndicesVert.length; i += 1)
        {
            const index = this._structUniformNamesIndicesVert[i];
            const uniDeclarationString = "UNI " + this._uniforms[index]._structName + " " + this._uniforms[index]._structUniformName + ";".endl();

            if (!this._uniDeclarationsVert.includes(uniDeclarationString))
            {
                const injectionString = "{{INJECTION_POINT_STRUCT_" + this._uniforms[index]._structName + "}}";

                structStrVert = structStrVert.replace(injectionString, "");
                structStrVert += uniDeclarationString;
                this._uniDeclarationsVert.push(uniDeclarationString);
            }
        }

        return [structStrVert, structStrFrag];
    }

    _getAttrSrc(attr, firstLevel)
    {
        const r = {};
        if (attr.name && attr.type)
        {
            r.srcHeadVert = "";
            if (!firstLevel) r.srcHeadVert += "#ifndef ATTRIB_" + attr.name.endl();
            r.srcHeadVert += "#define ATTRIB_" + attr.name.endl();
            r.srcHeadVert += "IN " + attr.type + " " + attr.name + ";".endl();
            if (!firstLevel) r.srcHeadVert += "#endif".endl();

            if (attr.nameFrag)
            {
                r.srcHeadVert += "";
                if (!firstLevel) r.srcHeadVert += "#ifndef ATTRIB_" + attr.nameFrag.endl();
                r.srcHeadVert += "#define ATTRIB_" + attr.nameFrag.endl();
                r.srcHeadVert += "OUT " + attr.type + " " + attr.nameFrag + ";".endl();
                if (!firstLevel) r.srcHeadVert += "#endif".endl();

                r.srcVert = "".endl() + attr.nameFrag + "=" + attr.name + ";";

                r.srcHeadFrag = "";
                if (!firstLevel) r.srcHeadFrag += "#ifndef ATTRIB_" + attr.nameFrag.endl();
                r.srcHeadFrag += "#define ATTRIB_" + attr.nameFrag.endl();
                r.srcHeadFrag += "IN " + attr.type + " " + attr.nameFrag + ";".endl();
                if (!firstLevel) r.srcHeadFrag += "#endif".endl();
            }
        }
        return r;
    }

    compile()
    {
        if (this._cgl.aborted) return;
        const startTime = performance.now();

        this._cgl.profileData.profileShaderCompiles++;
        this._cgl.profileData.profileShaderCompileName = this._name + " [" + this._compileReason + "]";

        let extensionString = "";
        if (this._extensions)
            for (let i = 0; i < this._extensions.length; i++)
                extensionString += "#extension " + this._extensions[i] + " : enable".endl();

        let definesStr = "";
        if (this._defines.length) definesStr = "\n// cgl generated".endl();
        for (let i = 0; i < this._defines.length; i++)
            definesStr += "#define " + this._defines[i][0] + " " + this._defines[i][1] + "".endl();

        const structStrings = this.createStructUniforms();
        this._cgl.profileData.addHeavyEvent("shader compile", this._name + " [" + this._compileReason + "]");
        this._compileReason = "";

        if (this._uniforms)
        {
            // * we create an array of the uniform names to check our indices & an array to save them
            const uniNames = this._uniforms.map((uni) => { return uni._name; });
            const indicesToRemove = [];

            // * we go through our uniforms and check if the same name is contained somewhere further in the array
            // * if so, we add the current index to be removed later
            for (let i = 0; i < this._uniforms.length; i++)
            {
                const uni = this._uniforms[i];
                const nextIndex = uniNames.indexOf(uni._name, i + 1);
                if (nextIndex > -1) indicesToRemove.push(i);
            }

            // * after that, we go through the uniforms backwards (so we keep the order) and remove the indices
            // * also, we reset the locations of all the other valid uniforms
            for (let j = this._uniforms.length - 1; j >= 0; j -= 1)
            {
                if (indicesToRemove.includes(j)) this._uniforms.splice(j, 1);
                else this._uniforms[j].resetLoc();
            }
        }

        this._cgl.printError("uniform resets");

        this._compileCount++;
        if (this.hasTextureUniforms()) definesStr += "#define HAS_TEXTURES".endl();

        let vs = "";
        let fs = "";

        if (!this.srcFrag)
        {
            this._log.warn("[cgl shader] has no fragment source!", this._name, this);
            this.srcVert = getDefaultVertexShader();
            this.srcFrag = getDefaultFragmentShader();
        }

        vs = "#version 300 es"
            .endl() + "// "
            .endl() + "// vertex shader " + this._name
            .endl() + "// "
            .endl() + "precision " + this.precision + " float;"
            .endl() + "precision " + this.precision + " sampler2D;"
            .endl() + ""
            .endl() + "#define WEBGL2"
            .endl() + "#define texture2D texture"
            .endl() + "#define UNI uniform"
            .endl() + "#define IN in"
            .endl() + "#define OUT out"
            .endl();

        fs = "#version 300 es"
            .endl() + "// "
            .endl() + "// fragment shader " + this._name
            .endl() + "// "
            .endl() + "precision " + this.precision + " float;"
            .endl() + "precision " + this.precision + " sampler2D;"
            .endl() + ""
            .endl() + "#define WEBGL2"
            .endl() + "#define texture2D texture"
            .endl() + "#define IN in"
            .endl() + "#define OUT out"
            .endl() + "#define UNI uniform"
            .endl() + "{{DRAWBUFFER}}"

            .endl();

        let uniformsStrVert = "\n// cgl generated".endl();
        let uniformsStrFrag = "\n// cgl generated".endl();

        fs += "\n// active mods: --------------- ";
        vs += "\n// active mods: --------------- ";

        let foundModsFrag = false;
        let foundModsVert = false;
        for (let i = 0; i < this._moduleNames.length; i++)
        {
            for (let j = 0; j < this._modules.length; j++)
            {
                if (this._modules[j].name == this._moduleNames[i])
                {
                    if (this._modules[j].srcBodyFrag || this._modules[j].srcHeadFrag)
                    {
                        foundModsFrag = true;
                        fs += "\n// " + i + "." + j + ". " + this._modules[j].title + " (" + this._modules[j].name + ")";
                    }
                    if (this._modules[j].srcBodyVert || this._modules[j].srcHeadVert)
                    {
                        vs += "\n// " + i + "." + j + ". " + this._modules[j].title + " (" + this._modules[j].name + ")";
                        foundModsVert = true;
                    }
                }
            }
        }
        if (!foundModsVert)fs += "\n// no mods used...";
        if (!foundModsFrag)fs += "\n// no mods used...";
        fs += "\n";
        vs += "\n";

        for (let i = 0; i < this._uniforms.length; i++)
        {
            if (this._uniforms[i].shaderType && !this._uniforms[i].isStructMember())
            {
                let uniStr = "";
                if (!this._uniforms[i].getGlslTypeString())uniStr += "// ";
                uniStr += "UNI " + this._uniforms[i].getGlslTypeString() + " " + this._uniforms[i].getName();
                let comment = "";
                if (this._uniforms[i].comment) comment = " // " + this._uniforms[i].comment;

                if (this._uniforms[i].shaderType == "vert" || this._uniforms[i].shaderType == "both")
                    if (!this.srcVert.includes(uniStr) && !this.srcVert.includes("uniform " + this._uniforms[i].getGlslTypeString() + " " + this._uniforms[i].getName()))
                        uniformsStrVert += uniStr + ";" + comment.endl();

                if (this._uniforms[i].shaderType == "frag" || this._uniforms[i].shaderType == "both")
                    if (!this.srcFrag.includes(uniStr) && !this.srcFrag.includes("uniform " + this._uniforms[i].getGlslTypeString() + " " + this._uniforms[i].getName()))
                        uniformsStrFrag += uniStr + ";" + comment.endl();
            }
        }

        let countUniFrag = 0;
        let countUniVert = 0;
        for (let i = 0; i < this._uniforms.length; i++)
        {
            if (this._uniforms[i].shaderType && !this._uniforms[i].isStructMember())
            {
                if (this._uniforms[i].shaderType == "vert" || this._uniforms[i].shaderType == "both") countUniVert++;
                if (this._uniforms[i].shaderType == "frag" || this._uniforms[i].shaderType == "both") countUniFrag++;
            }
        }
        if (countUniFrag >= this._cgl.maxUniformsFrag) this._log.warn("[cgl_shader] num uniforms frag: " + countUniFrag + " / " + this._cgl.maxUniformsFrag);
        if (countUniVert >= this._cgl.maxUniformsVert) this._log.warn("[cgl_shader] num uniforms vert: " + countUniVert + " / " + this._cgl.maxUniformsVert);

        if (!fs.includes("precision")) fs = "precision " + this.precision + " float;".endl() + fs;
        if (!vs.includes("precision")) vs = "precision " + this.precision + " float;".endl() + vs;
        if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
        {
            fs += "#define MOBILE".endl();
            vs += "#define MOBILE".endl();
        }
        vs = extensionString + vs + definesStr + structStrings[0] + uniformsStrVert + "\n// -- \n" + this.srcVert;
        fs = extensionString + fs + definesStr + structStrings[1] + uniformsStrFrag + "\n// -- \n" + this.srcFrag;

        let srcHeadVert = "";
        let srcHeadFrag = "";

        this._modules.sort(function (a, b)
        {
            return a.priority || 0 - b.priority || 0;
        });

        let addedAttribs = false;

        for (let i = 0; i < this._moduleNames.length; i++)
        {
            let srcVert = "";
            let srcFrag = "";

            if (!addedAttribs)
            {
                addedAttribs = true;

                for (let k = 0; k < this._attributes.length; k++)
                {
                    const r = this._getAttrSrc(this._attributes[k], true);
                    if (r.srcHeadVert)srcHeadVert += r.srcHeadVert;
                    if (r.srcVert)srcVert += r.srcVert;
                    if (r.srcHeadFrag)srcHeadFrag += r.srcHeadFrag;
                }
            }

            for (let j = 0; j < this._modules.length; j++)
            {
                const mod = this._modules[j];
                if (mod.name == this._moduleNames[i])
                {
                    srcHeadVert += "\n//---- MOD: group:" + mod.group + ": idx:" + j + " - prfx:" + mod.prefix + " - " + mod.title + " ------\n";
                    srcHeadFrag += "\n//---- MOD: group:" + mod.group + ": idx:" + j + " - prfx:" + mod.prefix + " - " + mod.title + " ------\n";

                    srcVert += "\n\n//---- MOD: " + mod.title + " / " + mod.priority + " ------\n";
                    srcFrag += "\n\n//---- MOD: " + mod.title + " / " + mod.priority + " ------\n";

                    if (mod.attributes)
                        for (let k = 0; k < mod.attributes.length; k++)
                        {
                            const r = this._getAttrSrc(mod.attributes[k], false);
                            if (r.srcHeadVert)srcHeadVert += r.srcHeadVert;
                            if (r.srcVert)srcVert += r.srcVert;
                            if (r.srcHeadFrag)srcHeadFrag += r.srcHeadFrag;
                        }

                    srcHeadVert += mod.srcHeadVert || "";
                    srcHeadFrag += mod.srcHeadFrag || "";
                    srcVert += mod.srcBodyVert || "";
                    srcFrag += mod.srcBodyFrag || "";

                    srcHeadVert += "\n//---- end mod ------\n";
                    srcHeadFrag += "\n//---- end mod ------\n";

                    srcVert += "\n//---- end mod ------\n";
                    srcFrag += "\n//---- end mod ------\n";

                    srcVert = srcVert.replace(/{{mod}}/g, mod.prefix);
                    srcFrag = srcFrag.replace(/{{mod}}/g, mod.prefix);
                    srcHeadVert = srcHeadVert.replace(/{{mod}}/g, mod.prefix);
                    srcHeadFrag = srcHeadFrag.replace(/{{mod}}/g, mod.prefix);

                    srcVert = srcVert.replace(/MOD_/g, mod.prefix);
                    srcFrag = srcFrag.replace(/MOD_/g, mod.prefix);
                    srcHeadVert = srcHeadVert.replace(/MOD_/g, mod.prefix);
                    srcHeadFrag = srcHeadFrag.replace(/MOD_/g, mod.prefix);
                }
            }

            vs = vs.replace("{{" + this._moduleNames[i] + "}}", srcVert);
            fs = fs.replace("{{" + this._moduleNames[i] + "}}", srcFrag);
        }

        vs = vs.replace("{{MODULES_HEAD}}", srcHeadVert);
        fs = fs.replace("{{MODULES_HEAD}}", srcHeadFrag);

        vs = this._addLibs(vs);
        fs = this._addLibs(fs);

        // SETUP draw buffers / multi texture render targets

        let drawBufferStr = "";
        for (let i = 0; i < 16; i++)
            if (fs.includes("outColor" + i)) this._drawBuffers[i] = true;

        if (this._drawBuffers.length == 1)
        {
            drawBufferStr = "out vec4 outColor;".endl();
            drawBufferStr += "#define gl_FragColor outColor".endl();
        }
        else
        {
            drawBufferStr += "#define MULTI_COLORTARGETS".endl();
            drawBufferStr += "vec4 outColor;".endl();

            let count = 0;
            for (let i = 0; i < this._drawBuffers.length; i++)
            {
                if (count == 0) drawBufferStr += "#define gl_FragColor outColor" + i + "".endl();
                drawBufferStr += "layout(location = " + i + ") out vec4 outColor" + i + ";".endl();
                count++;
            }
        }

        fs = fs.replace("{{DRAWBUFFER}}", drawBufferStr);
        // //////

        if (!this._program)
        {
            this._program = this._createProgram(vs, fs);
        }
        else
        {
            // this.vshader=createShader(vs, gl.VERTEX_SHADER, this.vshader );
            // this.fshader=createShader(fs, gl.FRAGMENT_SHADER, this.fshader );
            // linkProgram(program);
            this._program = this._createProgram(vs, fs);

            this._projMatrixUniform = null;

            for (let i = 0; i < this._uniforms.length; i++) this._uniforms[i].resetLoc();
        }

        this.finalShaderFrag = fs;
        this.finalShaderVert = vs;

        MESH.lastMesh = null;
        MESH.lastShader = null;

        this._countMissingUniforms = 0;
        this._needsRecompile = false;
        this.lastCompile = now();

        this._cgl.profileData.shaderCompileTime += performance.now() - startTime;
    }

    bind()
    {
        if (!this._isValid || this._cgl.aborted) return;

        MESH.lastShader = this;

        if (!this._program || this.needsRecompile()) this.compile();
        if (!this._isValid) return;

        if (!this._projMatrixUniform && !this.ignoreMissingUniforms)
        {
            this._countMissingUniforms++;
            // if (this._countMissingUniforms == 10)this._log.log("stopping getlocation of missing uniforms...", this._name);
            if (this._countMissingUniforms < 10)
            {
                this._projMatrixUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_PROJMAT);
                this._attrVertexPos = this._cgl.glGetAttribLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_VERTEX_POSITION);
                this._mvMatrixUniform = this._cgl.gl.getUniformLocation(this._program, "mvMatrix");
                this._vMatrixUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_VIEWMAT);
                this._mMatrixUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_MODELMAT);
                this._camPosUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_VIEWPOS);
                this._normalMatrixUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_NORMALMAT);
                this._inverseViewMatrixUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_INVVIEWMAT);
                this._inverseProjMatrixUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_INVPROJMAT);
                this._materialIdUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_MATERIALID);
                this._objectIdUniform = this._cgl.gl.getUniformLocation(this._program, constants_CONSTANTS.SHADER.SHADERVAR_UNI_OBJECTID);

                for (let i = 0; i < this._uniforms.length; i++) this._uniforms[i].needsUpdate = true;
            }
        }

        if (this._cgl.currentProgram != this._program)
        {
            this._cgl.profileData.profileShaderBinds++;
            this._cgl.gl.useProgram(this._program);
            this._cgl.currentProgram = this._program;
        }

        for (let i = 0; i < this._uniforms.length; i++)
            if (this._uniforms[i].needsUpdate) this._uniforms[i].updateValue();

        if (this._pMatrixState != this._cgl.getProjectionMatrixStateCount())
        {
            this._pMatrixState = this._cgl.getProjectionMatrixStateCount();
            this._cgl.gl.uniformMatrix4fv(this._projMatrixUniform, false, this._cgl.pMatrix);
            this._cgl.profileData.profileMVPMatrixCount++;
        }

        if (this._objectIdUniform)
            this._cgl.gl.uniform1f(this._objectIdUniform, ++this._cgl.tempData.objectIdCounter);

        if (this._materialIdUniform)
            this._cgl.gl.uniform1f(this._materialIdUniform, this._materialId);

        if (this._vMatrixUniform)
        {
            if (this._vMatrixState != this._cgl.getViewMatrixStateCount())
            {
                this._cgl.gl.uniformMatrix4fv(this._vMatrixUniform, false, this._cgl.vMatrix);
                this._cgl.profileData.profileMVPMatrixCount++;
                this._vMatrixState = this._cgl.getViewMatrixStateCount();

                if (this._inverseViewMatrixUniform)
                {
                    mat4.invert(this._tempInverseViewMatrix, this._cgl.vMatrix);
                    this._cgl.gl.uniformMatrix4fv(this._inverseViewMatrixUniform, false, this._tempInverseViewMatrix);
                    this._cgl.profileData.profileMVPMatrixCount++;
                }
                if (this._inverseProjMatrixUniform)
                {
                    mat4.invert(this._tempInverseProjMatrix, this._cgl.pMatrix);
                    this._cgl.gl.uniformMatrix4fv(this._inverseProjMatrixUniform, false, this._tempInverseProjMatrix);
                    this._cgl.profileData.profileMVPMatrixCount++;
                }
            }
            this._cgl.gl.uniformMatrix4fv(this._mMatrixUniform, false, this._cgl.mMatrix);
            this._cgl.profileData.profileMVPMatrixCount++;

            if (this._camPosUniform)
            {
                mat4.invert(this._tempCamPosMatrix, this._cgl.vMatrix);
                this._cgl.gl.uniform3f(this._camPosUniform, this._tempCamPosMatrix[12], this._tempCamPosMatrix[13], this._tempCamPosMatrix[14]);
                this._cgl.profileData.profileMVPMatrixCount++;
            }
        }
        else
        {
            // mvmatrix deprecated....
            const tempmv = mat4.create();

            mat4.mul(tempmv, this._cgl.vMatrix, this._cgl.mMatrix);
            this._cgl.gl.uniformMatrix4fv(this._mvMatrixUniform, false, tempmv);
            this._cgl.profileData.profileMVPMatrixCount++;
        }

        if (this._normalMatrixUniform)
        {
            // mat4.mul(this._tempNormalMatrix, this._cgl.vMatrix, this._cgl.mMatrix);
            mat4.invert(this._tempNormalMatrix, this._cgl.mMatrix);
            mat4.transpose(this._tempNormalMatrix, this._tempNormalMatrix);

            this._cgl.gl.uniformMatrix4fv(this._normalMatrixUniform, false, this._tempNormalMatrix);
            this._cgl.profileData.profileMVPMatrixCount++;
        }

        for (let i = 0; i < this._libs.length; i++)
        {
            if (this._libs[i].onBind) this._libs[i].onBind.bind(this._libs[i])(this._cgl, this);
        }

        this._bindTextures();

        return this._isValid;
    }

    unBind()
    {
    }

    dispose()
    {
        if (this._program) this._cgl.gl.deleteProgram(this._program);
        this._program = null;
    }

    setDrawBuffers(arr)
    {
        this._log.warn("useless drawbuffers...?!");
        // if (this._drawBuffers.length !== arr.length)
        // {
        //     this._drawBuffers = arr;
        //     this._needsRecompile = true;
        //     this.setWhyCompile("setDrawBuffers");
        //     return;
        // }
        // for (let i = 0; i < arr.length; i++)
        // {
        //     if (arr[i] !== this._drawBuffers[i])
        //     {
        //         this._drawBuffers = arr;
        //         this._needsRecompile = true;
        //         this.setWhyCompile("setDrawBuffers");
        //         return;
        //     }
        // }
    }

    getUniforms()
    {
        return this._uniforms;
    }

    getUniform(name)
    {
        for (let i = 0; i < this._uniforms.length; i++)
            if (this._uniforms[i].getName() == name)
                return this._uniforms[i];
        return null;
    }

    removeAllUniforms()
    {
        this._uniforms = [];
        // for (let i = 0; i < this._uniforms.length; i++)
        //     this.removeUniform(this._uniforms[i].name);
    }

    removeUniform(name)
    {
        for (let i = 0; i < this._uniforms.length; i++)
        {
            if (this._uniforms[i].getName() == name)
            {
                this._uniforms.splice(i, 1);
            }
        }
        this.setWhyCompile("remove uniform " + name);
    }

    _addUniform(uni)
    {
        this._uniforms.push(uni);
        this.setWhyCompile("add uniform " + name);
    }

    /**
     * add a uniform to the fragment shader
     * @param {String} type ['f','t', etc]
     * @param {String} name
     * @param {any} valueOrPort value or port
     * @param p2
     * @param p3
     * @param p4
     * @memberof Shader
     * @instance
     * @function addUniformFrag
     * @returns {CGL.Uniform}
     */
    addUniformFrag(type, name, valueOrPort, p2, p3, p4)
    {
        const uni = new CGL.Uniform(this, type, name, valueOrPort, p2, p3, p4);
        uni.shaderType = "frag";
        return uni;
    }

    /**
     * add a uniform to the vertex shader
     * @param {String} type ['f','t', etc]
     * @param {String} name
     * @param {any} valueOrPort value or port
     * @param p2
     * @param p3
     * @param p4
     * @memberof Shader
     * @instance
     * @function addUniformVert
     * @returns {CGL.Uniform}
     */
    addUniformVert(type, name, valueOrPort, p2, p3, p4)
    {
        const uni = new CGL.Uniform(this, type, name, valueOrPort, p2, p3, p4);
        uni.shaderType = "vert";
        return uni;
    }

    /**
     * add a uniform to both shaders
     * @param {String} type ['f','t', etc]
     * @param {String} name
     * @param {any} valueOrPort value or port
     * @param p2
     * @param p3
     * @param p4
     * @memberof Shader
     * @instance
     * @function addUniformBoth
     * @returns {CGL.Uniform}
     */
    addUniformBoth(type, name, valueOrPort, p2, p3, p4)
    {
        const uni = new CGL.Uniform(this, type, name, valueOrPort, p2, p3, p4);
        uni.shaderType = "both";
        return uni;
    }

    /**
     * add a struct & its uniforms to the fragment shader
     * @param {String} structName name of the struct, i.e.: LightStruct
     * @param {String} uniformName name of the struct uniform in the shader, i.e.: lightUni
     * @param {Array} members array of objects containing the struct members. see example for structure

     * @memberof Shader
     * @instance
     * @function addUniformStructFrag
     * @returns {Object}
     * @example
     * const shader = new CGL.Shader(cgl, 'MinimalMaterial');
     * shader.setSource(attachments.shader_vert, attachments.shader_frag);
     * shader.addUniformStructFrag("Light", "uniformLight", [
     * { "type": "3f", "name": "position", "v1": null },
     * { "type": "4f", "name": "color", "v1": inR, v2: inG, v3: inB, v4: inAlpha }
     * ]);
     */
    addUniformStructFrag(structName, uniformName, members)
    {
        const uniforms = {};

        if (!members) return uniforms;

        for (let i = 0; i < members.length; i += 1)
        {
            const member = members[i];
            if (!this.hasUniform(uniformName + "." + member.name))
            {
                const uni = new CGL.Uniform(this, member.type, uniformName + "." + member.name, member.v1, member.v2, member.v3, member.v4, uniformName, structName, member.name);
                uni.shaderType = "frag";
                uniforms[uniformName + "." + member.name] = uni;
            }
        }

        return uniforms;
    }

    /**
     * add a struct & its uniforms to the vertex shader
     * @param {String} structName name of the struct, i.e.: LightStruct
     * @param {String} uniformName name of the struct uniform in the shader, i.e.: lightUni
     * @param {Array} members array of objects containing the struct members. see example for structure

     * @memberof Shader
     * @instance
     * @function addUniformStructVert
     * @returns {CGL.Uniform}
     * @example
     * const shader = new CGL.Shader(cgl, 'MinimalMaterial');
     * shader.setSource(attachments.shader_vert, attachments.shader_frag);
     * shader.addUniformStructVert("Light", "uniformLight", [
     * { "type": "3f", "name": "position", "v1": null },
     * { "type": "4f", "name": "color", "v1": inR, v2: inG, v3: inB, v4: inAlpha }
     * ]);
     */
    addUniformStructVert(structName, uniformName, members)
    {
        const uniforms = {};

        if (!members) return uniforms;

        for (let i = 0; i < members.length; i += 1)
        {
            const member = members[i];
            if (!this.hasUniform(uniformName + "." + member.name))
            {
                const uni = new CGL.Uniform(this, member.type, uniformName + "." + member.name, member.v1, member.v2, member.v3, member.v4, uniformName, structName, member.name);
                uni.shaderType = "vert";
                uniforms[uniformName + "." + member.name] = uni;
            }
        }

        return uniforms;
    }

    /**
     * add a struct & its uniforms to the both shaders. PLEASE NOTE: it is not possible to add the same struct to both shaders when it contains ANY integer members.
     * @param {String} structName name of the struct, i.e.: LightStruct
     * @param {String} uniformName name of the struct uniform in the shader, i.e.: lightUni
     * @param {Array} members array of objects containing the struct members. see example for structure

     * @memberof Shader
     * @instance
     * @function addUniformStructBoth
     * @returns {Object}
     * @example
     * const shader = new CGL.Shader(cgl, 'MinimalMaterial');
     * shader.setSource(attachments.shader_vert, attachments.shader_frag);
     * shader.addUniformStructBoth("Light", "uniformLight", [
     * { "type": "3f", "name": "position", "v1": null },
     * { "type": "4f", "name": "color", "v1": inR, v2: inG, v3: inB, v4: inAlpha }
     * ]);
     */
    addUniformStructBoth(structName, uniformName, members)
    {
        const uniforms = {};

        if (!members) return uniforms;

        for (let i = 0; i < members.length; i += 1)
        {
            const member = members[i];
            if ((member.type === "2i" || member.type === "i" || member.type === "3i"))
                this._log.error("Adding an integer struct member to both shaders can potentially error. Please use different structs for each shader. Error occured in struct:", structName, " with member:", member.name, " of type:", member.type, ".");
            if (!this.hasUniform(uniformName + "." + member.name))
            {
                const uni = new CGL.Uniform(this, member.type, uniformName + "." + member.name, member.v1, member.v2, member.v3, member.v4, uniformName, structName, member.name);
                uni.shaderType = "both";
                uniforms[uniformName + "." + member.name] = uni;
            }
        }

        return uniforms;
    }

    /**
     * @param {String} name
     */
    hasUniform(name)
    {
        for (let i = 0; i < this._uniforms.length; i++)
        {
            if (this._uniforms[i].getName() == name) return true;
        }
        return false;
    }

    /**
     * @param {String} vstr
     * @param {String} fstr
     */
    _createProgram(vstr, fstr)
    {
        this._cgl.printError("before _createprogram");

        const program = this._cgl.gl.createProgram();

        this.vshader = CglShader.createShader(this._cgl, vstr, this._cgl.gl.VERTEX_SHADER, this);
        this.fshader = CglShader.createShader(this._cgl, fstr, this._cgl.gl.FRAGMENT_SHADER, this);

        if (this.vshader && this.fshader)
        {
            this._cgl.gl.attachShader(program, this.vshader);
            this._cgl.gl.attachShader(program, this.fshader);

            this._linkProgram(program, vstr, fstr);
        }
        else
        {
            this._isValid = false;
            this._cgl.printError("shader _createProgram");
            this._log.error("could not link shaderprogram");
            return null;
        }

        this._cgl.printError("shader _createProgram");
        return program;
    }

    hasErrors()
    {
        return this._hasErrors;
    }

    _linkProgram(program, vstr, fstr)
    {
        this._cgl.printError("before _linkprogram");

        if (this._feedBackNames.length > 0)
        {
            this._cgl.gl.transformFeedbackVaryings(program, this._feedBackNames, this._cgl.gl.SEPARATE_ATTRIBS);
            // INTERLEAVED_ATTRIBS
            // SEPARATE_ATTRIBS
        }

        this._cgl.gl.linkProgram(program);
        this._cgl.printError("gl.linkprogram");
        this._isValid = true;
        this._hasErrors = false;

        if (this._cgl.patch.config.glValidateShader !== false)
        {
            this._cgl.gl.validateProgram(program);

            if (!this._cgl.gl.getProgramParameter(program, this._cgl.gl.VALIDATE_STATUS))
            {
                // validation failed
                this._log.log("shaderprogram validation failed...");

                this._cgl.gl.getProgramInfoLog(program);
            }

            if (!this._cgl.gl.getProgramParameter(program, this._cgl.gl.LINK_STATUS))
            {
                this._hasErrors = true;

                const infoLogFrag = this._cgl.gl.getShaderInfoLog(this.fshader);
                const infoLogVert = this._cgl.gl.getShaderInfoLog(this.vshader);

                if (this.logError)
                    this._log.error(this._name + " shader linking fail...");
                else
                    this._log.warn(this._name + " shader linking fail...");

                if (infoLogFrag) this._log.warn(this._cgl.gl.getShaderInfoLog(this.fshader));
                if (infoLogVert) this._log.warn(this._cgl.gl.getShaderInfoLog(this.vshader));

                this._cgl.gl.getProgramInfoLog(program);
                if (!CABLES.UI) this._log.log(this);
                this._isValid = false;

                this._cgl.printError("shader link err");
            }
        }
    }

    getProgram()
    {
        return this._program;
    }

    setFeedbackNames(names)
    {
        this.setWhyCompile("setFeedbackNames");
        this._feedBackNames = names;
    }

    /**
      * adds attribute definition to shader header without colliding with other shader modules...
     * when attrFrag is defined, vertex shader will output this attribute to the fragment shader
     * @function
     * @memberof Shader
     * @instance
     * @param {Object} attr {type:x,name:x,[nameFrag:x]}
     * @return {Object}
     */
    addAttribute(attr)
    {
        for (let i = 0; i < this._attributes.length; i++)
        {
            if (this._attributes[i].name == attr.name && this._attributes[i].nameFrag == attr.nameFrag) return;
        }
        this._attributes.push(attr);

        this.setWhyCompile("addAttribute");
    }

    bindTextures()
    {
        this._bindTextures();
    }

    _bindTextures()
    {
        if (this._textureStackTex.length > this._cgl.maxTextureUnits)
        {
            this._log.warn("[shader._bindTextures] too many textures bound", this._textureStackTex.length + "/" + this._cgl.maxTextureUnits);
        }

        // for (let i = this._textureStackTex.length + 1; i < this._cgl.maxTextureUnits; i++) this._cgl.setTexture(i, null);

        for (let i = 0; i < this._textureStackTex.length; i++)
        {
            // this._log.log(this._textureStackTex.length, i);
            if (!this._textureStackTex[i] && !this._textureStackTexCgl[i])
            {
                this._log.warn("no texture for pushtexture", this._name);
            }
            else
            {
                let t = this._textureStackTex[i];
                if (this._textureStackTexCgl[i])
                {
                    t = this._textureStackTexCgl[i].tex || CGL.Texture.getEmptyTexture(this._cgl).tex;
                }

                let bindOk = true;

                if (!this._textureStackUni[i])
                {
                    // throw(new Error('no uniform given to texturestack'));
                    this._log.warn("no uniform for pushtexture", this._name);
                    bindOk = this._cgl.setTexture(i, t, this._textureStackType[i]);
                }
                else
                {
                    this._textureStackUni[i].setValue(i);
                    bindOk = this._cgl.setTexture(i, t, this._textureStackType[i]);

                    // this._log.log(bindOk, i, t, this._textureStackType[i]);
                }
                if (!bindOk) this._log.warn("tex bind failed", this.getName(), this._textureStackUni[i]);
            }
        }
    }

    setUniformTexture(uni, tex)
    {
        tex = tex || CGL.Texture.getTempTexture(this._cgl);
        for (let i = 0; i < this._textureStackUni.length; i++)
            if (this._textureStackUni[i] == uni)
            {
                const old = this._textureStackTex[i] || this._textureStackTexCgl[i];
                if (tex.hasOwnProperty("tex"))
                {
                    this._textureStackTexCgl[i] = tex;
                    this._textureStackTex[i] = null;
                }
                else
                {
                    this._textureStackTexCgl[i] = null;
                    this._textureStackTex[i] = tex;
                }

                // this._textureStackTex[i] = tex;
                // this._cgl.setTexture(i, tex, this._textureStackType[i]);
                return old;
            }
        return null;
    }

    /**
     * push a texture on the stack. those textures will be bound when binding the shader. texture slots are automatically set
     * @param {Uniform} uniform texture uniform
     * @param {Texture} t texture
     * @param {number} type texture type, can be ignored when TEXTURE_2D
     * @function pushTexture
     * @memberof Shader
     * @instance
     */
    pushTexture(uniform, t, type)
    {
        if (!uniform)
        {
            // this._log.log("pushtexture: no uniform given to texturestack", "shader:"+this._name,uniform,t,type);
            return;
        }
        if (!t)
        {
            // if(uniform)this._log.warn("pushtexture: no tex","shader:"+this._name," uniform:"+uniform.name);
            return;
        }
        if (!t.hasOwnProperty("tex") && !(t instanceof WebGLTexture))
        {
            this._log.warn(new Error("invalid texture").stack);

            this._log.warn("[cgl_shader] invalid texture...", t);
            return;
        }

        this._textureStackUni.push(uniform);

        if (t.hasOwnProperty("tex"))
        {
            this._textureStackTexCgl.push(t);
            this._textureStackTex.push(null);
        }
        else
        {
            this._textureStackTexCgl.push(null);
            this._textureStackTex.push(t);
        }

        this._textureStackType.push(type);
    }

    /**
     * pop last texture
     * @function popTexture
     * @memberof Shader
     * @instance
     */
    popTexture()
    {
        this._textureStackUni.pop();
        this._textureStackTex.pop();
        this._textureStackTexCgl.pop();
        this._textureStackType.pop();
    }

    /**
     * pop all textures
     * @function popTextures
     * @memberof Shader
     * @instance
     */
    popTextures()
    {
        this._textureStackTex.length =
        this._textureStackTexCgl.length =
        this._textureStackType.length =
        this._textureStackUni.length = 0;
    }

    getMaterialId()
    {
        return this._materialId;
    }

    getInfo()
    {
        const info = {};
        info.name = this._name;
        // info.modules = JSON.parse(JSON.stringify(this._modules));
        // info.defines = JSON.parse(JSON.stringify(this._defines));
        info.defines = this.getDefines();
        info.hasErrors = this.hasErrors();

        return info;
    }

    getDefaultFragmentShader(r, g, b, a)
    {
        return getDefaultFragmentShader(r, g, b, a);
    }

    getDefaultVertexShader()
    {
        return getDefaultVertexShader();
    }
}

// --------------------------

CglShader.getDefaultVertexShader = getDefaultVertexShader;
CglShader.getDefaultFragmentShader = getDefaultFragmentShader;

CglShader.getErrorFragmentShader = function ()
{
    return ""
        .endl() + "void main()"
        .endl() + "{"
        .endl() + "   float g=mod((gl_FragCoord.y+gl_FragCoord.x),50.0)/50.0;"
        .endl() + "   g= step(0.1,g);"
        .endl() + "   outColor = vec4( g+0.5, 0.0, 0.0, 1.0);"
        .endl() + "}";
};

/**
 * @param {CglContext} cgl
 * @param {String} str
 * @param {number} type
 * @param {CglShader} cglShader
 * @returns {CglShader}
 */
CglShader.createShader = function (cgl, str, type, cglShader)
{
    if (cgl.aborted) return;

    const shader = cgl.gl.createShader(type);
    cgl.gl.shaderSource(shader, str);
    cgl.gl.compileShader(shader);

    if (!cgl.gl.getShaderParameter(shader, cgl.gl.COMPILE_STATUS))
    {
        cglShader.error = { "str": str, "infoLog": cgl.gl.getShaderInfoLog(shader) };

        if (CABLES.UI) gui.emitEvent("ShaderError", cglShader);

        if (!cglShader.error.infoLog)
        {
            cglShader._log.warn("empty shader info log", this._name);
            return;
        }

        cglShader.setSource(CglShader.getDefaultVertexShader(), CglShader.getErrorFragmentShader());

        // CABLES.UI.showShaderError(shader);

    }
    return shader;
};



;// CONCATENATED MODULE: ./src/core/cgl/cgl_profiledata.js
class ProfileData
{
    constructor(cgl)
    {
        this._cgl = cgl;
        this._lastTime = 0;
        this.pause = false;
        this.profileUniformCount = 0;
        this.profileShaderBinds = 0;
        this.profileUniformCount = 0;
        this.profileShaderCompiles = 0;
        this.profileVideosPlaying = 0;
        this.profileMVPMatrixCount = 0;
        this.profileEffectBuffercreate = 0;
        this.profileShaderGetUniform = 0;
        this.profileFrameBuffercreate = 0;
        this.profileMeshSetGeom = 0;
        this.profileTextureNew = 0;
        this.profileGenMipMap = 0;
        this.profileOnAnimFrameOps = 0;

        this.profileFencedPixelRead = 0;
        this.profileMainloopMs = 0;
        this.profileMeshDraw = 0;
        this.profileTextureEffect = 0;
        this.profileTexPreviews = 0;
        this.shaderCompileTime = 0;
        this.profileMeshNumElements = 0;
        this.profileMeshAttributes = 0;
        this.profileSingleMeshAttribute = [];
        this.heavyEvents = [];

        this.doProfileGlQuery = false;
        this.glQueryData = {};
    }

    clear()
    {
        this.profileSingleMeshAttribute = {};
        this.profileMeshAttributes = 0;
        this.profileUniformCount = 0;
        this.profileShaderGetUniform = 0;
        this.profileShaderCompiles = 0;
        this.profileShaderBinds = 0;
        this.profileTextureResize = 0;
        this.profileFrameBuffercreate = 0;
        this.profileEffectBuffercreate = 0;
        this.profileTextureDelete = 0;
        this.profileMeshSetGeom = 0;
        this.profileVideosPlaying = 0;
        this.profileMVPMatrixCount = 0;
        this.profileNonTypedAttrib = 0;
        this.profileNonTypedAttribNames = "";
        this.profileTextureNew = 0;
        this.profileGenMipMap = 0;
        this.profileFramebuffer = 0;
        this.profileMeshDraw = 0;
        this.profileTextureEffect = 0;
        this.profileTexPreviews = 0;
        this.profileMeshNumElements = 0;
        this.profileFencedPixelRead = 0;
    }

    clearGlQuery()
    {
        for (let i in this.glQueryData)
        {
            if (!this.glQueryData[i].lastClear || performance.now() - this.glQueryData[i].lastClear > 1000)
            {
                this.glQueryData[i].time = this.glQueryData[i]._times / this.glQueryData[i]._numcount;
                this.glQueryData[i].num = this.glQueryData[i]._numcount;

                this.glQueryData[i]._times = 0;
                this.glQueryData[i]._numcount = 0;
                this.glQueryData[i].lastClear = performance.now();
            }
        }
    }

    addHeavyEvent(event, name, info)
    {
        const e = { "event": event, "name": name, "info": info, "date": performance.now() };
        this.heavyEvents.push(e);
        this._cgl.emitEvent("heavyEvent", e);
    }
}



;// CONCATENATED MODULE: ./src/core/cg/cg_canvas.js


class CgCanvas
{
    constructor(options)
    {
        this._log = new Logger("CgCanvas");
        if (!options)
        {
            this._log.error("CgCanvas no options");
        }
        else
        {
            this._canvasEle = options.canvasEle;
        }

        if (!options.cg) this._log.error("CgCanvas options has no cg");
        if (!options.canvasEle) this._log.error("CgCanvas options has no canvasEle");

        this._cg = options.cg;
        this.pixelDensity = 1;
        this.canvasWidth = this.canvasEle.clientWidth;
        this.canvasHeight = this.canvasEle.clientHeight;

        this._oldWidthRp = -1;
        this._oldHeightRp = -1;

        this.setSize(this.canvasWidth, this.canvasHeight);
    }

    get canvasEle() { return this._canvasEle; }

    setWhyCompile(why)
    {
        this._compileReason = why;
    }

    /**
     * @param {Number} w
     * @param {Number} h
     * @param {any} ignorestyle
     * @returns {any}
     */
    setSize(w, h, ignorestyle = false)
    {
        if (this._oldWidthRp != w * this.pixelDensity || this._oldHeightRp != h * this.pixelDensity)
        {
            this._oldWidthRp = this.canvasEle.width = w * this.pixelDensity;
            this._oldHeightRp = this.canvasEle.height = h * this.pixelDensity;

            if (!ignorestyle)
            {
                this.canvasEle.style.width = w + "px";
                this.canvasEle.style.height = h + "px";
            }

            this.updateSize();

            this._cg.emitEvent("resize");
        }
    }

    updateSize()
    {
        this.canvasEle.width = this.canvasWidth = this.canvasEle.clientWidth * this.pixelDensity;
        this.canvasEle.height = this.canvasHeight = this.canvasEle.clientHeight * this.pixelDensity;
    }

    dispose()
    {
        if (this._canvasEle) this._canvasEle.remove();
        this._canvasEle = null;
    }
}



;// CONCATENATED MODULE: ./src/core/cg/cg_matrixstack.js
class MatrixStack
{
    constructor()
    {
        this._arr = [mat4.create()];
        this._index = 0;
        this.stateCounter = 0;
    }

    /**
     * @param {mat4} m
     */
    push(m)
    {
        this._index++;
        this.stateCounter++;

        if (this._index == this._arr.length)
        {
            const copy = mat4.create();
            this._arr.push(copy);
        }

        mat4.copy(this._arr[this._index], m || this._arr[this._index - 1]);

        return this._arr[this._index];
    }

    pop()
    {
        this.stateCounter++;

        this._index--;
        if (this._index < 0) this._index = 0;

        return this._arr[this._index];
    }

    length()
    {
        return this._index;
    }
}



;// CONCATENATED MODULE: ./src/core/cg/cg_state.js





class CgContext extends Events
{

    static API_WEBGL = 0;
    static API_WEBGPU = 1;

    /**
     * Description
     * @param {Patch} _patch
     */
    constructor(_patch)
    {
        super();
        this.tempData = this.frameStore = this.frameStore || {};
        // this.canvas = null;
        this.fpsCounter = new CABLES.CG.FpsCounter();
        this._identView = vec3.create();
        this._ident = vec3.create();
        vec3.set(this._identView, 0, 0, -2);
        vec3.set(this._ident, 0, 0, 0);
        this._onetimeCallbacks = [];
        this.maxTexSize = 2048;
        this._viewPort = [0, 0, 1, 1];
        this._viewPortStack = [];
        this.patch = _patch;
        this.autoReSize = true;

        this.DEPTH_COMPARE_FUNC_NEVER = 0;
        this.DEPTH_COMPARE_FUNC_LESS = 1;
        this.DEPTH_COMPARE_FUNC_EQUAL = 2;
        this.DEPTH_COMPARE_FUNC_LESSEQUAL = 3;
        this.DEPTH_COMPARE_FUNC_GREATER = 4;
        this.DEPTH_COMPARE_FUNC_NOTEQUAL = 5;
        this.DEPTH_COMPARE_FUNC_GREATEREQUAL = 6;
        this.DEPTH_COMPARE_FUNC_ALWAYS = 7;

        /**
         * Current projection matrix
         * @memberof Context
         * @instance
         * @type {mat4}
         */
        this.pMatrix = mat4.create();

        /**
         * Current model matrix
         * @memberof Context
         * @instance
         * @type {mat4}
         */
        this.mMatrix = mat4.create();

        /**
         * Current view matrix
         * @memberof Context
         * @instance
         * @type {mat4}
         */
        this.vMatrix = mat4.create();
        this._textureslots = [];

        this._pMatrixStack = new MatrixStack();
        this._mMatrixStack = new MatrixStack();
        this._vMatrixStack = new MatrixStack();

        this.canvasScale = 1;

        mat4.identity(this.mMatrix);
        mat4.identity(this.vMatrix);

        window.matchMedia("screen and (min-resolution: 2dppx)")
            .addEventListener("change", (e) =>
            {
                this.emitEvent("resize");
            });
    }

    get canvasWidth()
    {
        return this.cgCanvas.canvasWidth;
    }

    get canvasHeight()
    {
        return this.cgCanvas.canvasHeight;
    }

    set pixelDensity(p)
    {
        if (this.cgCanvas.pixelDensity != p)
        {
            this.cgCanvas.pixelDensity = p;
            this.cgCanvas.updateSize();
            this.emitEvent("resize");
        }
    }

    get pixelDensity()
    {
        return this.cgCanvas.pixelDensity;
    }

    getGApiName()
    {
        return ["WebGL", "WebGPU"][this.gApi];
    }

    get canvas()
    {
        return this.cgCanvas.canvasEle;
    }

    get viewPort()
    {
        // TODO: add stack...
        return [0, 0, this.canvasWidth, this.canvasHeight];
    }

    /**
     * @param {HTMLElement} canvEle
     */
    setCanvas(canvEle)
    {
        if (this.cgCanvas && canvEle == this.cgCanvas.canvasEle) return;
        if (typeof canvEle === "string") canvEle = document.getElementById(canvEle);

        this.cgCanvas = new CgCanvas({ "canvasEle": canvEle, "cg": this });

        canvEle.parentElement.classList.add("cablesContainer");
        if (this._setCanvas) this._setCanvas(canvEle);

        this.updateSize();
    }

    updateSize()
    {
        this.cgCanvas.updateSize();
    }

    /**
     * @param {number} w
     * @param {number} h
     * @param {boolean} ignorestyle
     */
    setSize(w, h, ignorestyle = false)
    {
        this.cgCanvas.setSize(w, h, ignorestyle);
    }

    _resizeToWindowSize()
    {
        if (this.autoReSize)
        {
            this.setSize(window.innerWidth, window.innerHeight);
            this.updateSize();
        }
    }

    _resizeToParentSize()
    {
        if (this.autoReSize)
        {
            const p = this.canvas.parentElement;
            if (!p)
            {
                this._log.error("cables: can not resize to container element");
                return;
            }

            this.setSize(p.clientWidth, p.clientHeight);
            this.updateSize();
        }
    }

    setAutoResize(parent)
    {
        window.removeEventListener("resize", this._resizeToWindowSize.bind(this));
        window.removeEventListener("resize", this._resizeToParentSize.bind(this));

        if (parent == "window")
        {
            window.addEventListener("resize", this._resizeToWindowSize.bind(this));
            window.addEventListener("orientationchange", this._resizeToWindowSize.bind(this));
            this._resizeToWindowSize();
        }
        if (parent == "parent")
        {
            window.addEventListener("resize", this._resizeToParentSize.bind(this));
            this._resizeToParentSize();
        }
    }

    /**
     * push a matrix to the projection matrix stack
     * @function pushPMatrix
     * @memberof Context
     * @instance
     */
    pushPMatrix()
    {
        this.pMatrix = this._pMatrixStack.push(this.pMatrix);
    }

    /**
      * pop projection matrix stack
      * @function popPMatrix
      * @memberof Context
      * @instance
      * @returns {mat4} current projectionmatrix
      */
    popPMatrix()
    {
        this.pMatrix = this._pMatrixStack.pop();
        return this.pMatrix;
    }

    getProjectionMatrixStateCount()
    {
        return this._pMatrixStack.stateCounter;
    }

    /**
      * push a matrix to the model matrix stack
      * @function pushModelMatrix
      * @memberof Context
      * @instance
      * @example
      * // see source code of translate op:
      * cgl.pushModelMatrix();
      * mat4.translate(cgl.mMatrix,cgl.mMatrix, vec);
      * trigger.trigger();
      * cgl.popModelMatrix();
      */
    pushModelMatrix()
    {
        this.mMatrix = this._mMatrixStack.push(this.mMatrix);
    }

    /**
      * pop model matrix stack
      * @function popModelMatrix
      * @memberof Context
      * @instance
      * @returns {mat4} current modelmatrix
      */
    popModelMatrix()
    {
        // todo: DEPRECATE
        // if (this._mMatrixStack.length === 0) throw "Invalid modelview popMatrix!";
        this.mMatrix = this._mMatrixStack.pop();
        return this.mMatrix;
    }

    /**
      * get model matrix
      * @function modelMatrix
      * @memberof Context
      * @instance
      * @returns {mat4} current modelmatrix
      */
    modelMatrix()
    {
        return this.mMatrix;
    }

    /**
     * push a matrix to the view matrix stack
     * @function pushviewMatrix
     * @memberof Context
     * @instance
     */
    pushViewMatrix()
    {
        this.vMatrix = this._vMatrixStack.push(this.vMatrix);
    }

    /**
      * pop view matrix stack
      * @function popViewMatrix
      * @memberof Context
      * @instance
      * @returns {mat4} current viewmatrix
      * @function
      */
    popViewMatrix()
    {
        this.vMatrix = this._vMatrixStack.pop();
    }

    getViewMatrixStateCount()
    {
        return this._vMatrixStack.stateCounter;
    }

    /**
     * @param {vec3} identTranslate
     * @param {vec3} identTranslateView
     */
    _startMatrixStacks(identTranslate, identTranslateView)
    {
        identTranslate = identTranslate || this._ident;
        identTranslateView = identTranslateView || this._identView;

        mat4.perspective(this.pMatrix, 45, this.canvasWidth / this.canvasHeight, 0.1, 1000.0);

        mat4.identity(this.mMatrix);
        mat4.identity(this.vMatrix);
        mat4.translate(this.mMatrix, this.mMatrix, identTranslate);
        mat4.translate(this.vMatrix, this.vMatrix, identTranslateView);

        this.pushPMatrix();
        this.pushModelMatrix();
        this.pushViewMatrix();
    }

    _endMatrixStacks()
    {
        this.popViewMatrix();
        this.popModelMatrix();
        this.popPMatrix();
    }

    dispose()
    {
        this.aborted = true;
        if (this.cgCanvas) this.cgCanvas.dispose();
        if (this._dispose) this._dispose();
    }

    shouldDrawHelpers()
    {
        return false;
    }

    /**
     * execute the callback next frame, once
     * @function addNextFrameOnceCallback
     * @memberof Context
     * @instance
     * @param {function} cb
     */
    addNextFrameOnceCallback(cb)
    {
        if (cb && this._onetimeCallbacks.indexOf(cb) == -1) this._onetimeCallbacks.push(cb);
    }

    _execOneTimeCallbacks()
    {
        if (this._onetimeCallbacks.length > 0)
        {
            for (let i = 0; i < this._onetimeCallbacks.length; i++) this._onetimeCallbacks[i]();
            this._onetimeCallbacks.length = 0;
        }
    }

    checkTextureSize(x)
    {
        x = x || 1;
        x = Math.floor(x);
        x = Math.min(x, this.maxTexSize);
        x = Math.max(x, 1);
        return x;
    }

    // shnould be overwritten...
    screenShot(cb, doScreenshotClearAlpha, mimeType, quality)
    {
        console.log("no screenshot function implemented");
    }

    saveScreenshot(filename, cb, pw, ph, noclearalpha)
    {
        this.patch.renderOneFrame();

        let w = this.canvas.clientWidth * this.pixelDensity;
        let h = this.canvas.clientHeight * this.pixelDensity;

        if (pw)
        {
            this.canvas.width = pw;
            w = pw;
        }
        if (ph)
        {
            this.canvas.height = ph;
            h = ph;
        }

        function padLeft(nr, n, str)
        {
            return Array(n - String(nr).length + 1).join(str || "0") + nr;
        }

        const d = new Date();
        const dateStr = "".concat(String(d.getFullYear()) + String(d.getMonth() + 1) + String(d.getDate()), "_").concat(padLeft(d.getHours(), 2)).concat(padLeft(d.getMinutes(), 2)).concat(padLeft(d.getSeconds(), 2));

        if (!filename) filename = "cables_" + dateStr + ".png";
        else filename += ".png";

        this.screenShot(function (blob)
        {
            this.canvas.width = w;
            this.canvas.height = h;

            if (blob)
            {
                const anchor = document.createElement("a");

                anchor.download = filename;
                anchor.href = URL.createObjectURL(blob);

                setTimeout(function ()
                {
                    anchor.click();
                    if (cb) cb(blob);
                }, 100);
            }
            else
            {
                this._log.log("screenshot: no blob");
            }
        }.bind(this));
    }

}

;// CONCATENATED MODULE: ./src/core/cgl/cgl_state.js











const BLENDS = {
    "BLEND_NONE": 0,
    "BLEND_NORMAL": 1,
    "BLEND_ADD": 2,
    "BLEND_SUB": 3,
    "BLEND_MUL": 4,
};

/**
 * cables gl context/state manager
 * @class
 * @namespace external:CGL
 * @hideconstructor
 */
// const Context(_patch)
class CglContext extends CgContext
{
    constructor(_patch)
    {
        super(_patch);

        this.gApi = CgContext.API_WEBGL;
        this.aborted = false;

        this.pushMvMatrix = this.pushModelMatrix; // deprecated and wrong... still used??
        this.popMvMatrix = this.popmMatrix = this.popModelMatrix;// deprecated and wrong... still used??

        this.profileData = new ProfileData(this);
        this._log = new Logger("cgl_context", { "onError": _patch.config.onError });

        this.glVersion = 0;
        this.glUseHalfFloatTex = false;
        this.clearCanvasTransparent = true;
        this.clearCanvasDepth = true;
        this.debugOneFrame = false;
        this.checkGlErrors = false; // true is slow // false should be default...
        this.maxTextureUnits = 0;
        this.maxVaryingVectors = 0;
        this.currentProgram = null;
        this._hadStackError = false;
        this.glSlowRenderer = false;
        this._isSafariCrap = false;

        this.temporaryTexture = null;
        this.gl = null;

        this._cursor = "auto";
        this._currentCursor = "";

        this._viewPortStack = [];
        this._glFrameBufferStack = [];
        this._frameBufferStack = [];
        this._shaderStack = [];
        this._stackDepthTest = [];
        this.mainloopOp = null;
        this._stackBlendMode = [];
        this._stackBlendModePremul = [];
        this._stackBlend = [];
        this._stackDepthFunc = [];
        this._stackCullFaceFacing = [];
        this._stackCullFace = [];
        this._stackDepthWrite = [];
        this._stackDepthTest = [];
        this._stackStencil = [];

        this._simpleShader = new CglShader(this, "simpleshader");
        this._simpleShader.setModules(["MODULE_VERTEX_POSITION", "MODULE_COLOR", "MODULE_BEGIN_FRAG", "MODULE_VERTEX_MODELVIEW"]);
        this._simpleShader.setSource(CglShader.getDefaultVertexShader(), CglShader.getDefaultFragmentShader());

        this._currentShader = this._simpleShader;

        this._oldCanvasWidth = -1;
        this._oldCanvasHeight = -1;
        this._enabledExtensions = {};

        this.errorShader = null;
    }

    // set pixelDensity(p)
    // {
    //     this._pixelDensity = p;
    // }

    // get pixelDensity()
    // {
    //     return this._pixelDensity;
    // }

    get viewPort()
    {
        if (this._viewPortStack.length > 3)
        {
            const l = this._viewPortStack.length;

            return [
                this._viewPortStack[l - 4],
                this._viewPortStack[l - 3],
                this._viewPortStack[l - 2],
                this._viewPortStack[l - 1]
            ];
        }
        else
        {
            // workaround pre viewport stack times / or+and initial value...

            return this._viewPort;
        }
    }

    get mvMatrix() // deprecate
    {
        return this.mMatrix;
    }

    set mvMatrix(m) // deprecate
    {
        this.mMatrix = m;
    }

    _setCanvas(canv)
    {
        if (!canv) this._log.stack("_setCanvas undef");

        if (!this.patch.config.canvas) this.patch.config.canvas = {};
        if (!this.patch.config.canvas.hasOwnProperty("preserveDrawingBuffer")) this.patch.config.canvas.preserveDrawingBuffer = false;
        if (!this.patch.config.canvas.hasOwnProperty("premultipliedAlpha")) this.patch.config.canvas.premultipliedAlpha = false;
        if (!this.patch.config.canvas.hasOwnProperty("alpha")) this.patch.config.canvas.alpha = false;

        this.patch.config.canvas.stencil = true;

        if (this.patch.config.hasOwnProperty("clearCanvasColor")) this.clearCanvasTransparent = this.patch.config.clearCanvasColor;
        if (this.patch.config.hasOwnProperty("clearCanvasDepth")) this.clearCanvasDepth = this.patch.config.clearCanvasDepth;

        // safari stuff..........
        if (/^((?!chrome|android).)*safari/i.test(navigator.userAgent) && (navigator.userAgent.match(/iPhone/i)))
        {
            this._isSafariCrap = true;
            this.glUseHalfFloatTex = true;
        }

        if (!this.patch.config.canvas.forceWebGl1) this.gl = canv.getContext("webgl2", this.patch.config.canvas);

        if (!this.gl || this.gl.isContextLost())
        {
            this.aborted = true;
            this._log.error("NO_WEBGL", "sorry, could not initialize WebGL. Please check if your Browser supports WebGL or try to restart your browser.");
            return;
        }

        if (this.gl.getParameter(this.gl.VERSION) != "WebGL 1.0")
        {
            this.glVersion = 2;
        }
        else
        {
            this.gl = canv.getContext("webgl", this.patch.config.canvas) || canv.getContext("experimental-webgl", this.patch.config.canvas);
            this.glVersion = 1;

            // safari
            // if (/^((?!chrome|android).)*safari/i.test(navigator.userAgent) && (navigator.userAgent.match(/iPhone/i)))
            // {
            //     this.glUseHalfFloatTex = true;
            // }

            // ios
            if (/iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream)
            {
                if (!this.patch.config.canvas.hasOwnProperty("powerPreference")) this.patch.config.canvas.powerPreference = "high-performance";
            }

            this.enableExtension("OES_standard_derivatives");
            // this.enableExtension("GL_OES_standard_derivatives");
            const instancingExt = this.enableExtension("ANGLE_instanced_arrays") || this.gl;
            if (instancingExt.vertexAttribDivisorANGLE)
            {
                this.gl.vertexAttribDivisor = instancingExt.vertexAttribDivisorANGLE.bind(instancingExt);
                this.gl.drawElementsInstanced = instancingExt.drawElementsInstancedANGLE.bind(instancingExt);
            }
        }

        const dbgRenderInfo = this.enableExtension("WEBGL_debug_renderer_info");
        if (dbgRenderInfo)
        {
            this.glRenderer = this.gl.getParameter(dbgRenderInfo.UNMASKED_RENDERER_WEBGL);
            if (this.glRenderer === "Google SwiftShader") this.glSlowRenderer = true;
        }

        this.canvas.addEventListener("webglcontextlost", (event) =>
        {
            if (this.aborted) return this._log.warn("[cgl_state] aborted context lost... can be ignored...");
            this._log.error("canvas lost...", event);
            this.emitEvent("webglcontextlost");
            this.aborted = true;
        });

        this.maxAnisotropic = 0;
        if (this.enableExtension("EXT_texture_filter_anisotropic"))
            this.maxAnisotropic = this.gl.getParameter(this.enableExtension("EXT_texture_filter_anisotropic").MAX_TEXTURE_MAX_ANISOTROPY_EXT);

        this.maxVaryingVectors = this.gl.getParameter(this.gl.MAX_VARYING_VECTORS);
        this.maxTextureUnits = this.gl.getParameter(this.gl.MAX_TEXTURE_IMAGE_UNITS);
        this.maxTexSize = this.gl.getParameter(this.gl.MAX_TEXTURE_SIZE);
        this.maxUniformsFrag = this.gl.getParameter(this.gl.MAX_FRAGMENT_UNIFORM_VECTORS);
        this.maxUniformsVert = this.gl.getParameter(this.gl.MAX_VERTEX_UNIFORM_VECTORS);
        this.maxSamples = 0;
        if (this.gl.MAX_SAMPLES) this.maxSamples = this.gl.getParameter(this.gl.MAX_SAMPLES);

        if (this.glVersion == 1)
        {
            this.enableExtension("OES_standard_derivatives");
            const instancingExt = this.enableExtension("ANGLE_instanced_arrays") || this.gl;

            if (instancingExt.vertexAttribDivisorANGLE)
            {
                this.gl.vertexAttribDivisor = instancingExt.vertexAttribDivisorANGLE.bind(instancingExt);
                this.gl.drawElementsInstanced = instancingExt.drawElementsInstancedANGLE.bind(instancingExt);
            }
        }

        this.DEPTH_FUNCS = [
            this.gl.NEVER,
            this.gl.ALWAYS,
            this.gl.LESS,
            this.gl.LEQUAL,
            this.gl.GREATER,
            this.gl.GEQUAL,
            this.gl.EQUAL,
            this.gl.NOTEQUAL
        ];
        this.CULL_MODES = [
            null,
            this.gl.BACK,
            this.gl.FRONT,
            this.gl.FRONT_AND_BACK
        ];
    }

    getInfo()
    {
        return {
            "glVersion": this.glVersion,
            "glRenderer": this.glRenderer,
            "glUseHalfFloatTex": this.glUseHalfFloatTex,
            "maxVaryingVectors": this.maxVaryingVectors,
            "maxTextureUnits": this.maxTextureUnits,
            "maxTexSize": this.maxTexSize,
            "maxUniformsFrag": this.maxUniformsFrag,
            "maxUniformsVert": this.maxUniformsVert,
            "maxSamples": this.maxSamples
        };
    }

    /**
     * @function popViewPort
     * @memberof Context
     * @instance
     * @description pop viewPort stack
     */
    popViewPort()
    {
        this._viewPortStack.pop();
        this._viewPortStack.pop();
        this._viewPortStack.pop();
        this._viewPortStack.pop();

        if (this._viewPortStack.length == 0)
            this.setViewPort(0, 0, this.canvasWidth, this.canvasHeight);
        else
            this.setViewPort(this._viewPortStack[this._viewPort.length - 4], this._viewPortStack[this._viewPort.length - 3], this._viewPortStack[this._viewPort.length - 2], this._viewPortStack[this._viewPort.length - 1]);
    }

    /**
     * @function pushViewPort
     * @memberof Context
     * @instance
     * @description push a new viewport onto stack
     * @param {Number} x
     * @param {Number} y
     * @param {Number} w
     * @param {Number} h
     */

    pushViewPort(x, y, w, h)
    {
        this._viewPortStack.push(x, y, w, h);
        this.setViewPort(x, y, w, h);
    }

    // old
    getViewPort()
    {
        return this._viewPort;
    }

    // old
    resetViewPort()
    {
        this.gl.viewport(this._viewPort[0], this._viewPort[1], this._viewPort[2], this._viewPort[3]);
    }

    // old
    setViewPort(x, y, w, h)
    {
        this._viewPort[0] = Math.round(x);
        this._viewPort[1] = Math.round(y);
        this._viewPort[2] = Math.round(w);
        this._viewPort[3] = Math.round(h);
        this.gl.viewport(this._viewPort[0], this._viewPort[1], this._viewPort[2], this._viewPort[3]);
    }

    /**
     * @param {function} cb
     * @param {boolean} doScreenshotClearAlpha
     * @param {string} mimeType
     * @param {number} quality
     */
    screenShot(cb, doScreenshotClearAlpha, mimeType, quality)
    {
        if (doScreenshotClearAlpha)
        {
            this.gl.clearColor(1, 1, 1, 1);
            this.gl.colorMask(false, false, false, true);
            this.gl.clear(this.gl.COLOR_BUFFER_BIT);
            this.gl.colorMask(true, true, true, true);
        }

        if (this.canvas && this.canvas.toBlob)
        {
            this.canvas.toBlob((blob) =>
            {
                if (cb) cb(blob);
                else this._log.log("no screenshot callback...");
            }, mimeType, quality);
        }
    }

    endFrame()
    {
        if (this.patch.isEditorMode()) CABLES.GL_MARKER.drawMarkerLayer(this);

        this.setPreviousShader();

        if (this._vMatrixStack.length() > 0) this.logStackError("view matrix stack length !=0 at end of rendering...");
        if (this._mMatrixStack.length() > 0) this.logStackError("mvmatrix stack length !=0 at end of rendering...");
        if (this._pMatrixStack.length() > 0) this.logStackError("pmatrix stack length !=0 at end of rendering...");
        if (this._glFrameBufferStack.length > 0) this.logStackError("glFrameBuffer stack length !=0 at end of rendering...");
        if (this._stackDepthTest.length > 0) this.logStackError("depthtest stack length !=0 at end of rendering...");
        if (this._stackDepthWrite.length > 0) this.logStackError("depthwrite stack length !=0 at end of rendering...");
        if (this._stackDepthFunc.length > 0) this.logStackError("depthfunc stack length !=0 at end of rendering...");
        if (this._stackBlend.length > 0) this.logStackError("blend stack length !=0 at end of rendering...");
        if (this._stackBlendMode.length > 0) this.logStackError("blendMode stack length !=0 at end of rendering...");
        if (this._shaderStack.length > 0) this.logStackError("this._shaderStack length !=0 at end of rendering...");
        if (this._stackCullFace.length > 0) this.logStackError("this._stackCullFace length !=0 at end of rendering...");
        if (this._stackCullFaceFacing.length > 0) this.logStackError("this._stackCullFaceFacing length !=0 at end of rendering...");
        if (this._viewPortStack.length > 0) this.logStackError("viewport stack length !=0 at end of rendering...");

        this._frameStarted = false;

        if (this._oldCanvasWidth != this.canvasWidth || this._oldCanvasHeight != this.canvasHeight)
        {
            this._oldCanvasWidth = this.canvasWidth;
            this._oldCanvasHeight = this.canvasHeight;
            this.emitEvent("resize");
        }

        if (this._cursor != this._currentCursor)
        {
            this._currentCursor = this.canvas.style.cursor = this._cursor;
        }

        this.emitEvent("endframe");

        this.fpsCounter.endFrame();
    }

    logStackError(str)
    {
        if (!this._hadStackError)
        {
            this._hadStackError = true;
            this._log.warn("[" + this.canvas.id + "]: ", str);
        }
    }

    // shader stack
    getShader()
    {
        if (this._currentShader) if (!this.tempData || ((this.tempData.renderOffscreen === true) == this._currentShader.offScreenPass) === true) return this._currentShader;

        for (let i = this._shaderStack.length - 1; i >= 0; i--) if (this._shaderStack[i]) if (this.tempData.renderOffscreen == this._shaderStack[i].offScreenPass) return this._shaderStack[i];
    }

    getDefaultShader()
    {
        return this._simpleShader;
    }

    /**
     * @deprecated
     * @param {Shader} s
     */
    setShader(s)
    {
        this.pushShader(s);
    }

    /**
     * push a shader to the shader stack
     * @function pushShader
     * @memberof Context
     * @instance
     * @param {Shader} shader
     * @function
     */
    pushShader(shader)
    {
        if (this.tempData.forceShaderMods)
        {
            for (let i = 0; i < this.tempData.forceShaderMods.length; i++)
            {
                // if (!currentShader.forcedMod && currentShader != this.tempData.forceShaderMods[i])
                // {
                //     currentShader.forcedMod = this.tempData.forceShaderMods[i];
                shader = this.tempData.forceShaderMods[i].bind(shader, false);
                // }
                // return currentShader;
                // if (this.tempData.forceShaderMods[i].currentShader() && shader != this.tempData.forceShaderMods[i].currentShader().shader)
            }
        }

        this._shaderStack.push(shader);
        this._currentShader = shader;
    }

    popShader()
    {
        this.setPreviousShader();
    }

    /**
     * pop current used shader from shader stack
     * @function popShader
     * @memberof Context
     * @instance
     * @function
     */
    setPreviousShader()
    {
        if (this.tempData.forceShaderMods)
        {
            for (let i = 0; i < this.tempData.forceShaderMods.length; i++)
            {
                // const a =
                this.tempData.forceShaderMods[i].unbind(false);
                // if (a) return;
                // this.popShader();
            }
        }

        if (this._shaderStack.length === 0) throw new Error("Invalid shader stack pop!");
        this._shaderStack.pop();
        this._currentShader = this._shaderStack[this._shaderStack.length - 1];
    }

    /**
     * push a framebuffer to the framebuffer stack
     * @function pushGlFrameBuffer
     * @memberof Context
     * @instance
     * @param {Object} fb framebuffer
     * @function
     */
    pushGlFrameBuffer(fb)
    {
        this._glFrameBufferStack.push(fb);
    }

    /**
     * pop framebuffer stack
     * @function popGlFrameBuffer
     * @memberof Context
     * @instance
     * @returns {Object} current framebuffer or null
     */
    popGlFrameBuffer()
    {
        if (this._glFrameBufferStack.length == 0) return null;
        this._glFrameBufferStack.pop();
        return this._glFrameBufferStack[this._glFrameBufferStack.length - 1];
    }

    /**
     * get current framebuffer
     * @function getCurrentFrameBuffer
     * @memberof Context
     * @instance
     * @returns {Object} current framebuffer or null
     */
    getCurrentGlFrameBuffer()
    {
        if (this._glFrameBufferStack.length === 0) return null;
        return this._glFrameBufferStack[this._glFrameBufferStack.length - 1];
    }

    /**
     * push a framebuffer to the framebuffer stack
     * @function pushGlFrameBuffer
     * @memberof Context
     * @instance
     * @param {Framebuffer2} fb framebuffer
     */
    pushFrameBuffer(fb)
    {
        this._frameBufferStack.push(fb);
    }

    /**
     * pop framebuffer stack
     * @function popFrameBuffer
     * @memberof Context
     * @instance
     * @returns {Framebuffer2} current framebuffer or null
     */
    popFrameBuffer()
    {
        if (this._frameBufferStack.length == 0) return null;
        this._frameBufferStack.pop();
        return this._frameBufferStack[this._frameBufferStack.length - 1];
    }

    /**
     * get current framebuffer
     * @function getCurrentFrameBuffer
     * @memberof Context
     * @instance
     * @returns {Framebuffer2} current framebuffer or null
     */
    getCurrentFrameBuffer()
    {
        if (this._frameBufferStack.length === 0) return null;
        return this._frameBufferStack[this._frameBufferStack.length - 1];
    }

    renderStart(cgl, identTranslate, identTranslateView)
    {
        this.fpsCounter.startFrame();
        this.pushDepthTest(true);
        this.pushDepthWrite(true);
        this.pushDepthFunc(cgl.gl.LEQUAL);
        this.pushCullFaceFacing(cgl.gl.BACK);
        this.pushCullFace(false);

        // if (this.clearCanvasTransparent)
        // {
        //     cgl.gl.clearColor(0, 0, 0, 0);
        //     cgl.gl.clear(cgl.gl.COLOR_BUFFER_BIT);
        // }
        // if (this.clearCanvasDepth) cgl.gl.clear(cgl.gl.DEPTH_BUFFER_BIT);

        cgl.setViewPort(0, 0, cgl.canvasWidth, cgl.canvasHeight);

        this._startMatrixStacks(identTranslate, identTranslateView);

        cgl.pushBlendMode(constants_CONSTANTS.BLEND_MODES.BLEND_NORMAL, false);

        for (let i = 0; i < this._textureslots.length; i++) this._textureslots[i] = null;

        this.pushShader(this._simpleShader);

        this._frameStarted = true;

        this._execOneTimeCallbacks();

        for (let i = 0; i < this._textureslots.length; i++)
        {
            this.gl.activeTexture(this.gl.TEXTURE0 + i);
            this.gl.bindTexture(this.gl.TEXTURE_2D, null);
            this._textureslots[i] = null;
        }

        this.emitEvent("beginFrame");
    }

    renderEnd(cgl)
    {
        this._endMatrixStacks();

        this.popDepthTest();
        this.popDepthWrite();
        this.popDepthFunc();
        this.popCullFaceFacing();
        this.popCullFace();
        this.popBlend();
        this.popBlendMode();

        cgl.endFrame();

        this.emitEvent("endFrame");
    }

    getTexture(slot)
    {
        return this._textureslots[slot];
    }

    hasFrameStarted()
    {
        return this._frameStarted;
    }

    /**
     * log warning to console if the rendering of one frame has not been started / handy to check for async problems
     * @function checkFrameStarted
     * @memberof Context
     * @param string
     * @instance
     */
    checkFrameStarted(string)
    {
        if (!this._frameStarted)
        {
            this._log.warn("frame not started " + string);
            this.patch.printTriggerStack();
        }
    }

    setTexture(slot, t, type)
    {
        this.checkFrameStarted("cgl setTexture");

        if (t === null) t = CGL.Texture.getEmptyTexture(this).tex;

        if (this._textureslots[slot] != t)
        {
            this.gl.activeTexture(this.gl.TEXTURE0 + slot);
            this.gl.bindTexture(type || this.gl.TEXTURE_2D, t);
            this._textureslots[slot] = t;
        }

        return true;
    }

    fullScreen()
    {
        if (this.canvas.requestFullscreen) this.canvas.requestFullscreen();
        else if (this.canvas.mozRequestFullScreen) this.canvas.mozRequestFullScreen();
        else if (this.canvas.webkitRequestFullscreen) this.canvas.webkitRequestFullscreen();
        else if (this.canvas.msRequestFullscreen) this.canvas.msRequestFullscreen();
    }

    printError(str)
    {
        if (!this.checkGlErrors) return;
        let found = false;
        let error = this.gl.getError();

        if (error != this.gl.NO_ERROR)
        {
            let errStr = "";
            if (error == this.gl.OUT_OF_MEMORY) errStr = "OUT_OF_MEMORY";
            if (error == this.gl.INVALID_ENUM) errStr = "INVALID_ENUM";
            if (error == this.gl.INVALID_OPERATION) errStr = "INVALID_OPERATION";
            if (error == this.gl.INVALID_FRAMEBUFFER_OPERATION) errStr = "INVALID_FRAMEBUFFER_OPERATION";
            if (error == this.gl.INVALID_VALUE) errStr = "INVALID_VALUE";
            if (error == this.gl.CONTEXT_LOST_WEBGL)
            {
                this.aborted = true;
                errStr = "CONTEXT_LOST_WEBGL";
            }
            if (error == this.gl.NO_ERROR) errStr = "NO_ERROR";

            found = true;

            this._log.warn("gl error [" + this.canvas.id + "]: ", str, error, errStr);

            if (this.canvas.id.includes("glGuiCanvas"))
                if (!this._loggedGlError)
                {
                    this.patch.printTriggerStack();
                    this._log.stack("glerror");
                    this._loggedGlError = true;
                }
        }
        error = this.gl.getError();

        return found;
    }

    _dispose()
    {
        this._simpleShader.dispose();
        this.gl = null;
    }

    // state depthtest

    /**
     * push depth testing enabled state
     * @function pushDepthTest
     * @param {Boolean} enabled
     * @memberof Context
     * @instance
     */

    pushDepthTest(enabled)
    {
        this._stackDepthTest.push(enabled);
        if (!enabled) this.gl.disable(this.gl.DEPTH_TEST);
        else this.gl.enable(this.gl.DEPTH_TEST);
    }

    /**
     * current state of depth testing
     * @function stateCullFace
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateDepthTest()
    {
        return this._stackDepthTest[this._stackDepthTest.length - 1];
    }

    /**
     * pop depth testing state
     * @function popCullFace
     * @memberof Context
     * @instance
     */
    popDepthTest()
    {
        this._stackDepthTest.pop();

        if (!this._stackDepthTest[this._stackDepthTest.length - 1]) this.gl.disable(this.gl.DEPTH_TEST);
        else this.gl.enable(this.gl.DEPTH_TEST);
    }

    // --------------------------------------
    // state depthwrite

    /**
     * push depth write enabled state
     * @function pushDepthTest
     * @param {Boolean} enabled
     * @memberof Context
     * @instance
     */
    pushDepthWrite(enabled)
    {
        enabled = enabled || false;
        this._stackDepthWrite.push(enabled);
        this.gl.depthMask(enabled);
    }

    /**
     * current state of depth writing
     * @function stateDepthWrite
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateDepthWrite()
    {
        return this._stackDepthWrite[this._stackDepthWrite.length - 1];
    }

    /**
     * pop depth writing state
     * @function popDepthWrite
     * @memberof Context
     * @instance
     */
    popDepthWrite()
    {
        this._stackDepthWrite.pop();
        this.gl.depthMask(this._stackDepthWrite[this._stackDepthWrite.length - 1] || false);
    }

    // --------------------------------------
    // state CullFace

    /**
     * push face culling face enabled state
     * @function pushCullFace
     * @param {Boolean} enabled
     * @memberof Context
     * @instance
     */
    pushCullFace(enabled)
    {
        this._stackCullFace.push(enabled);

        if (enabled) this.gl.enable(this.gl.CULL_FACE);
        else this.gl.disable(this.gl.CULL_FACE);
    }

    /**
     * current state of face culling
     * @function stateCullFace
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateCullFace()
    {
        return this._stackCullFace[this._stackCullFace.length - 1];
    }

    /**
     * pop face culling enabled state
     * @function popCullFace
     * @memberof Context
     * @instance
     */
    popCullFace()
    {
        this._stackCullFace.pop();

        if (this._stackCullFace[this._stackCullFace.length - 1]) this.gl.enable(this.gl.CULL_FACE);
        else this.gl.disable(this.gl.CULL_FACE);
    }

    // --------------------------------------
    // state CullFace Facing

    /**
     * push face culling face side
     * @function pushCullFaceFacing
     * @param {Number} cgl.gl.FRONT_AND_BACK, cgl.gl.BACK or cgl.gl.FRONT
     * @memberof Context
     * @instance
     */

    pushCullFaceFacing(b)
    {
        this._stackCullFaceFacing.push(b);
        this.gl.cullFace(this._stackCullFaceFacing[this._stackCullFaceFacing.length - 1]);
    }

    /**
     * current state of face culling side
     * @function stateCullFaceFacing
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateCullFaceFacing()
    {
        return this._stackCullFaceFacing[this._stackCullFaceFacing.length - 1];
    }

    /**
     * pop face culling face side
     * @function popCullFaceFacing
     * @memberof Context
     * @instance
     */
    popCullFaceFacing()
    {
        this._stackCullFaceFacing.pop();
        if (this._stackCullFaceFacing.length > 0) this.gl.cullFace(this._stackCullFaceFacing[this._stackCullFaceFacing.length - 1]);
    }

    // --------------------------------------
    // state depthfunc

    /**
     * enable / disable depth testing
     * like `gl.depthFunc(boolean);`
     * @function pushDepthFunc
     * @memberof Context
     * @instance
     * @param {Boolean} f depthtesting
     */
    pushDepthFunc(f)
    {
        this._stackDepthFunc.push(f);
        this.gl.depthFunc(f);
    }

    /**
     * current state of blend
     * @function stateDepthFunc
     * @memberof Context
     * @instance
     * @returns {Boolean} depth testing enabled/disabled
     */
    stateDepthFunc()
    {
        if (this._stackDepthFunc.length > 0) return this._stackDepthFunc[this._stackDepthFunc.length - 1];
        return false;
    }

    /**
     * pop depth testing and set the previous state
     * @function popDepthFunc
     * @memberof Context
     * @instance
     */
    popDepthFunc()
    {
        this._stackDepthFunc.pop();
        if (this._stackDepthFunc.length > 0) this.gl.depthFunc(this._stackDepthFunc[this._stackDepthFunc.length - 1]);
    }

    // --------------------------------------
    // state blending

    /**
     * enable / disable blend
     * like gl.enable(gl.BLEND); / gl.disable(gl.BLEND);
     * @function pushBlend
     * @memberof Context
     * @instance
     * @param {boolean} b blending
     */
    pushBlend(b)
    {
        this._stackBlend.push(b);
        if (!b) this.gl.disable(this.gl.BLEND);
        else this.gl.enable(this.gl.BLEND);
    }

    /**
     * pop blend state and set the previous state
     * @function popBlend
     * @memberof Context
     * @instance
     */
    popBlend()
    {
        this._stackBlend.pop();

        if (!this._stackBlend[this._stackBlend.length - 1]) this.gl.disable(this.gl.BLEND);
        else this.gl.enable(this.gl.BLEND);
    }

    /**
     * current state of blend
     * @function stateBlend
     * @returns {boolean} blending enabled/disabled
     * @memberof Context
     * @instance
     */
    stateBlend()
    {
        return this._stackBlend[this._stackBlend.length - 1];
    }

    /**
     * push and switch to predefined blendmode (CONSTANTS.BLEND_MODES.BLEND_NONE,CONSTANTS.BLEND_MODES.BLEND_NORMAL,CONSTANTS.BLEND_MODES.BLEND_ADD,CONSTANTS.BLEND_MODES.BLEND_SUB,CONSTANTS.BLEND_MODES.BLEND_MUL)
     * @function pushBlendMode
     * @memberof Context
     * @instance
     * @param {Number} blendMode
     * @param {Boolean} premul premultiplied mode
     */
    pushBlendMode(blendMode, premul)
    {
        this._stackBlendMode.push(blendMode);
        this._stackBlendModePremul.push(premul);

        const n = this._stackBlendMode.length - 1;

        this.pushBlend(this._stackBlendMode[n] !== constants_CONSTANTS.BLEND_MODES.BLEND_NONE);
        this._setBlendMode(this._stackBlendMode[n], this._stackBlendModePremul[n]);
    }

    /**
     * pop predefined blendmode / switch back to previous blendmode
     * @function popBlendMode
     * @memberof Context
     * @instance
     */
    popBlendMode()
    {
        this._stackBlendMode.pop();
        this._stackBlendModePremul.pop();

        const n = this._stackBlendMode.length - 1;

        this.popBlend(this._stackBlendMode[n] !== constants_CONSTANTS.BLEND_MODES.BLEND_NONE);

        if (n >= 0) this._setBlendMode(this._stackBlendMode[n], this._stackBlendModePremul[n]);
    }

    // --------------------------------------
    // state stencil

    /**
     * enable / disable stencil testing

    * @function pushStencil
    * @memberof Context
    * @instance
    * @param {Boolean} b enable
    */
    pushStencil(b)
    {
        this._stackStencil.push(b);
        if (!b) this.gl.disable(this.gl.STENCIL_TEST);
        else this.gl.enable(this.gl.STENCIL_TEST);
    }

    /**
     * pop stencil test state and set the previous state
     * @function popStencil
     * @memberof Context
     * @instance
     */
    popStencil()
    {
        this._stackStencil.pop();

        if (!this._stackStencil[this._stackStencil.length - 1]) this.gl.disable(this.gl.STENCIL_TEST);
        else this.gl.enable(this.gl.STENCIL_TEST);
    }

    // --------------------------------------

    glGetAttribLocation(prog, name)
    {
        const l = this.gl.getAttribLocation(prog, name);
        // if (l == -1)
        // {
        //     this._log.warn("get attr loc -1 ", name);
        // }
        return l;
    }

    /**
     * should an op now draw helpermeshes
     * @function shouldDrawHelpers
     * @memberof Context
     * @param op
     * @instance
     */
    shouldDrawHelpers(op)
    {
        if (this.tempData.shadowPass) return false;
        if (!op.patch.isEditorMode()) return false;

        // const fb = this.getCurrentFrameBuffer();
        // if (fb && fb.getWidth)
        // {
        //     const fbshould = this.canvasWidth / this.canvasHeight == fb.getWidth() / fb.getHeight();
        //     if (!fbshould) return false;
        // }

        return gui.shouldDrawOverlay;// || (CABLES.UI.renderHelperCurrent && op.isCurrentUiOp());
    }

    _setBlendMode(blendMode, premul)
    {
        const gl = this.gl;

        if (blendMode == constants_CONSTANTS.BLEND_MODES.BLEND_NONE)
        {
            // this.gl.disable(this.gl.BLEND);
        }
        else if (blendMode == constants_CONSTANTS.BLEND_MODES.BLEND_ADD)
        {
            if (premul)
            {
                gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);
                gl.blendFuncSeparate(gl.ONE, gl.ONE, gl.ONE, gl.ONE);
            }
            else
            {
                gl.blendEquation(gl.FUNC_ADD);
                gl.blendFunc(gl.SRC_ALPHA, gl.ONE);
            }
        }
        else if (blendMode == constants_CONSTANTS.BLEND_MODES.BLEND_SUB)
        {
            if (premul)
            {
                gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);
                gl.blendFuncSeparate(gl.ZERO, gl.ZERO, gl.ONE_MINUS_SRC_COLOR, gl.ONE_MINUS_SRC_ALPHA);
            }
            else
            {
                gl.blendEquation(gl.FUNC_ADD);
                gl.blendFunc(gl.ZERO, gl.ONE_MINUS_SRC_COLOR);
            }
        }
        else if (blendMode == constants_CONSTANTS.BLEND_MODES.BLEND_MUL)
        {
            if (premul)
            {
                gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);
                gl.blendFuncSeparate(gl.ZERO, gl.SRC_COLOR, gl.ZERO, gl.SRC_ALPHA);
            }
            else
            {
                gl.blendEquation(gl.FUNC_ADD);
                gl.blendFunc(gl.ZERO, gl.SRC_COLOR);
            }
        }
        else if (blendMode == constants_CONSTANTS.BLEND_MODES.BLEND_NORMAL)
        {
            if (premul)
            {
                gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);
                gl.blendFuncSeparate(gl.ONE, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
            }
            else
            {
                gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);
                gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);
            }
        }
        else
        {
            this._log.log("setblendmode: unknown blendmode");
        }
    }

    /**
     * @param {Geometry} options
     * @param {CglMeshOptions} options
     */
    createMesh(geom, options)
    {
        if (CABLES.isNumeric(options))options = { "glPrimitive": options }; // old constructor fallback...
        return new Mesh(this, geom, options);
    }

    /**
     * set cursor
     * @function setCursor
     * @memberof Context
     * @instance
     * @param {String} str css cursor string
     */
    setCursor(str)
    {
        this._cursor = str;
    }

    /**
     * enable a webgl extension
     * @function enableExtension
     * @memberof Context
     * @instance
     * @param {String} name extension name
     * @returns {Object} extension object or null
     */
    enableExtension(name)
    {
        if (!this.gl) return null;

        if (this._enabledExtensions.hasOwnProperty(name))
            return this._enabledExtensions[name];

        const o = this.gl.getExtension(name);
        this._enabledExtensions[name] = o;

        if (!o) this._log.warn("[cgl_state] extension not available " + name);

        return o;
    }

    getErrorShader()
    {
        if (this.errorShader) return this.errorShader;

        this.errorShader = new CglShader(this, "errormaterial");
        this.errorShader.setSource(CglShader.getDefaultVertexShader(), CglShader.getErrorFragmentShader());
        return this.errorShader;
    }

}

;// CONCATENATED MODULE: ./src/core/core_patch.js











/**
 * @typedef PatchConfig
 * @property {String} [prefixAssetPath=''] prefix for path to assets
 * @property {String} [assetPath=''] path to assets
 * @property {String} [jsPath=''] path to javascript files
 * @property {String} [glCanvasId='glcanvas'] dom element id of canvas element
 * @property {Function} [onError=null] called when an error occurs
 * @property {Function} [onFinishedLoading=null] called when patch finished loading all assets
 * @property {Function} [onFirstFrameRendered=null] called when patch rendered it's first frame
 * @property {Boolean} [glCanvasResizeToWindow=false] resize canvas automatically to window size
 * @property {Boolean} [glCanvasResizeToParent] resize canvas automatically to parent element
 * @property {Boolean} [doRequestAnimation=true] do requestAnimationFrame set to false if you want to trigger exec() from outside (only do if you know what you are doing)
 * @property {Boolean} [clearCanvasColor=true] clear canvas in transparent color every frame
 * @property {Boolean} [clearCanvasDepth=true] clear depth every frame
 * @property {Boolean} [glValidateShader=true] enable/disable validation of shaders *
 * @property {Boolean} [silent=false]
 * @property {Number} [fpsLimit=0] 0 for maximum possible frames per second
 * @property {String} [glslPrecision='mediump'] default precision for glsl shader
 * @property {String} [prefixJsPath]
 * @property {Function} [onPatchLoaded]
 * @property {Object} [canvas]
 * @property {String} [patchFile]
 * @property {String} [subPatch] internal use
  */

/**
 * Patch class, contains all operators,values,links etc. manages loading and running of the whole patch
 *
 * see {@link PatchConfig}
 *
 * @example
 * CABLES.patch=new CABLES.Patch(
 * {
 *     patch:pStr,
 *     glCanvasId:'glcanvas',
 *     glCanvasResizeToWindow:true,
 *     canvas:{powerPreference:"high-performance"},
 *     prefixAssetPath:'/assets/',
 *     prefixJsPath:'/js/',
 *     onError:function(e){console.log(e);}
 *     glslPrecision:'highp'
 * });
 */
class Patch extends Events
{
    static EVENT_OP_DELETED = "onOpDelete";
    static EVENT_OP_ADDED = "onOpAdd";
    static EVENT_PAUSE = "pause";
    static EVENT_RESUME = "resume";
    static EVENT_PATCHLOADEND = "patchLoadEnd";
    static EVENT_VARIABLES_CHANGED = "variablesChanged";

    #renderOneFrame = false;

    /** @param {PatchConfig} cfg */
    constructor(cfg)
    {
        super();

        this._log = new Logger("core_patch", { "onError": cfg.onError });

        /** @type {Array<Op>} */
        this.ops = [];
        this.settings = {};

        /** @type {PatchConfig} */
        this.config = cfg ||
        {
            "glCanvasResizeToWindow": false,
            "prefixAssetPath": "",
            "prefixJsPath": "",
            "silent": true,
            "onError": null,
            "onFinishedLoading": null,
            "onFirstFrameRendered": null,
            "onPatchLoaded": null,
            "fpsLimit": 0,

        };

        this.timer = new Timer();
        this.freeTimer = new Timer();
        this.animFrameOps = [];
        this.animFrameCallbacks = [];
        this.gui = false;
        CABLES.logSilent = this.silent = true;
        this.profiler = null;
        this.aborted = false;
        this._crashedOps = [];

        this._animReq = null;
        this._opIdCache = {};
        this._triggerStack = [];
        this.storeObjNames = false; // remove after may release

        /** @type {LoadingStatus} */
        this.loading = new LoadingStatus(this);

        this._volumeListeners = [];
        this._paused = false;
        this._frameNum = 0;
        this.onOneFrameRendered = null;
        this.namedTriggers = {};

        this._origData = null;
        this._frameNext = 0;
        this._frameInterval = 0;
        this._lastFrameTime = 0;
        this._frameWasdelayed = true;
        this.tempData = this.frameStore = {};
        this.reqAnimTimeStamp = 0;

        // /** @deprecated */
        // this.onDelete = null;

        this.cgCanvas = null;

        if (!(function () { return !this; }())) console.log("not in strict mode: core patch");

        if (this.config.hasOwnProperty("silent")) this.silent = CABLES.logSilent = this.config.silent;
        if (!this.config.hasOwnProperty("doRequestAnimation")) this.config.doRequestAnimation = true;

        if (!this.config.prefixAssetPath) this.config.prefixAssetPath = "";
        if (!this.config.prefixJsPath) this.config.prefixJsPath = "";
        if (!this.config.masterVolume) this.config.masterVolume = 1.0;

        this._variables = {};
        this.vars = {};
        if (cfg && cfg.vars) this.vars = cfg.vars; // vars is old!

        this.cgl = new CglContext(this);
        this.cgp = null;

        this._subpatchOpCache = {};

        this.cgl.setCanvas(this.config.glCanvasId || this.config.glCanvas || "glcanvas");
        if (this.config.glCanvasResizeToWindow === true) this.cgl.setAutoResize("window");
        if (this.config.glCanvasResizeToParent === true) this.cgl.setAutoResize("parent");
        this.loading.setOnFinishedLoading(this.config.onFinishedLoading);

        if (this.cgl.aborted) this.aborted = true;
        if (this.cgl.silent) this.silent = true;

        if (!CABLES.OPS)
        {
            this.aborted = true;
            throw new Error("no CABLES.OPS found");
        }
        this.freeTimer.play();
        this.exec();

        if (!this.aborted)
        {
            if (this.config.patch)
            {
                this.deSerialize(this.config.patch);
            }
            else if (this.config.patchFile)
            {
                ajax(
                    this.config.patchFile,
                    (err, _data) =>
                    {
                        try
                        {
                            const data = JSON.parse(_data);
                            if (err)
                            {
                                const txt = "";
                                this._log.error("err", err);
                                this._log.error("data", data);
                                this._log.error("data", data.msg);
                                return;
                            }
                            this.deSerialize(data);
                        }
                        catch (e)
                        {
                            this._log.error("could not load/parse patch ", e);
                        }
                    }
                );
            }
            this.timer.play();
        }

        console.log("made with https://cables.gl"); // eslint-disable-line

    }

    isPlaying()
    {
        return !this._paused;
    }

    /** @deprecated */
    renderOneFrame()
    {
        this._paused = true;
        this._renderOneFrame = true;
        this.exec();
        this._renderOneFrame = false;
    }

    /**
     * returns true if patch is opened in editor/gui mode
     * @function isEditorMode
     * @memberof Patch
     * @instance
     * @return {Boolean} editor mode
     */
    isEditorMode()
    {
        return this.config.editorMode === true;
    }

    /**
     * pauses patch execution
     * @function pause
     * @memberof Patch
     * @instance
     */
    pause()
    {
        cancelAnimationFrame(this._animReq);
        this.emitEvent(Patch.EVENT_PAUSE);
        this._animReq = null;
        this._paused = true;
        this.freeTimer.pause();
    }

    /**
     * resumes patch execution
     * @function resume
     * @memberof Patch
     * @instance
     */
    resume()
    {
        if (this._paused)
        {
            cancelAnimationFrame(this._animReq);
            this._paused = false;
            this.freeTimer.play();
            this.emitEvent(Patch.EVENT_RESUME);
            this.exec();
        }
    }

    /**
     * set volume [0-1]
     * @function setVolume
     * @param {Number} v volume
     * @memberof Patch
     * @instance
     */
    setVolume(v)
    {
        this.config.masterVolume = v;
        for (let i = 0; i < this._volumeListeners.length; i++) this._volumeListeners[i].onMasterVolumeChanged(v);
    }

    /**
     * get asset path
     * @function getAssetPath
     * @memberof Patch
     * @param patchId
     * @instance
     */
    getAssetPath(patchId = null)
    {
        if (this.config.hasOwnProperty("assetPath"))
        {
            return this.config.assetPath;
        }
        else if (this.isEditorMode())
        {
            let id = patchId || gui.project()._id;
            return "/assets/" + id + "/";
        }
        else if (document.location.href.indexOf("cables.gl") > 0 || document.location.href.indexOf("cables.local") > 0)
        {
            const parts = document.location.pathname.split("/");
            let id = patchId || parts[parts.length - 1];
            return "/assets/" + id + "/";
        }
        else
        {
            return "assets/";
        }
    }

    /**
     * get js path
     * @function getJsPath
     * @memberof Patch
     * @instance
     */
    getJsPath()
    {
        if (this.config.hasOwnProperty("jsPath"))
        {
            return this.config.jsPath;
        }
        else
        {
            return "js/";
        }
    }

    /**
     * get url/filepath for a filename
     * this uses prefixAssetpath in exported patches
     * @function getFilePath
     * @memberof Patch
     * @instance
     * @param {String} filename
     * @return {String} url
     */
    getFilePath(filename)
    {
        if (!filename) return filename;
        filename = String(filename);
        if (filename.indexOf("https:") === 0 || filename.indexOf("http:") === 0) return filename;
        if (filename.indexOf("data:") === 0) return filename;
        if (filename.indexOf("file:") === 0) return filename;
        filename = filename.replace("//", "/");
        if (filename.startsWith(this.config.prefixAssetPath)) filename = filename.replace(this.config.prefixAssetPath, "");
        return this.config.prefixAssetPath + filename + (this.config.suffixAssetPath || ""); //
    }

    clear()
    {
        this.emitEvent("patchClearStart");
        this.cgl.TextureEffectMesh = null;
        this.animFrameOps.length = 0;
        this.timer = new Timer();
        while (this.ops.length > 0) this.deleteOp(this.ops[0].id);

        this._opIdCache = {};
        this.emitEvent("patchClearEnd");
    }

    /**
     * @param {string} identifier
     * @param {string} id
     * @param {string} [opName]
     */
    createOp(identifier, id, opName = null)
    {

        /**
         * @type {Op}
         */
        let op = null;
        let objName = "";

        try
        {
            if (!identifier)
            {
                console.error("createop identifier false", identifier);
                console.log((new Error()).stack);
                return;
            }
            if (identifier.indexOf("Ops.") === -1)
            {

                /*
                 * this should be a uuid, not a namespace
                 * creating ops by id should be the default way from now on!
                 */
                const opId = identifier;

                if (CABLES.OPS[opId])
                {
                    objName = CABLES.OPS[opId].objName;
                    op = new CABLES.OPS[opId].f(this, objName, id, opId);
                    op.opId = opId;
                }
                else
                {
                    if (opName)
                    {
                        identifier = opName;
                        this._log.warn("could not find op by id: " + opId);
                    }
                    else
                    {
                        throw new Error("could not find op by id: " + opId, { "cause": "opId:" + opId });
                    }
                }
            }

            if (!op)
            {
                // fallback: create by objname!
                objName = identifier;
                const parts = identifier.split(".");
                const opObj = Patch.getOpClass(objName);

                if (!opObj)
                {
                    this.emitEvent("criticalError", { "title": "unknown op" + objName, "text": "unknown op: " + objName });

                    this._log.error("unknown op: " + objName);
                    throw new Error("unknown op: " + objName);
                }
                else
                {
                    if (parts.length == 2) op = new window[parts[0]][parts[1]](this, objName, id);
                    else if (parts.length == 3) op = new window[parts[0]][parts[1]][parts[2]](this, objName, id);
                    else if (parts.length == 4) op = new window[parts[0]][parts[1]][parts[2]][parts[3]](this, objName, id);
                    else if (parts.length == 5) op = new window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]](this, objName, id);
                    else if (parts.length == 6) op = new window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]](this, objName, id);
                    else if (parts.length == 7) op = new window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]](this, objName, id);
                    else if (parts.length == 8) op = new window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]][parts[7]](this, objName, id);
                    else if (parts.length == 9) op = new window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]][parts[7]][parts[8]](this, objName, id);
                    else if (parts.length == 10) op = new window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]][parts[7]][parts[8]][parts[9]](this, objName, id);
                    else console.log("parts.length", parts.length);
                }

                if (op)
                {
                    op.opId = null;
                    for (const i in CABLES.OPS)
                    {
                        if (CABLES.OPS[i].objName == objName) op.opId = i;
                    }
                }
            }
        }
        catch (e)
        {
            this._crashedOps.push(objName);

            this._log.error("[instancing error] " + objName, e);

            if (!this.isEditorMode())
            {
                this._log.error("INSTANCE_ERR", "Instancing Error: " + objName, e);
                // throw new Error("instancing error 1" + objName);
            }
        }

        if (op)
        {
            op._objName = objName;
            op.patch = this;
        }
        else
        {
            this._log.log("no op was created!?", identifier, id);
        }
        return op;
    }

    /**
     * create a new op in patch
     * @function addOp
     * @memberof Patch
     * @instance
     * @param {string} opIdentifier uuid or name, e.g. Ops.Math.Sum
     * @param {OpUiAttribs} uiAttribs Attributes
     * @param {string} id
     * @param {boolean} [fromDeserialize]
     * @param {string} [opName] e.g. Ops.Math.Sum
     * @example
     * // add invisible op
     * patch.addOp('Ops.Math.Sum', { showUiAttribs: false });
     */
    addOp(opIdentifier, uiAttribs, id, fromDeserialize = false, opName = null)
    {
        const op = this.createOp(opIdentifier, id, opName);

        if (op)
        {
            uiAttribs = uiAttribs || {};
            if (uiAttribs.hasOwnProperty("errors")) delete uiAttribs.errors;
            if (uiAttribs.hasOwnProperty("error")) delete uiAttribs.error;
            uiAttribs.subPatch = uiAttribs.subPatch || 0;

            op.setUiAttribs(uiAttribs);
            if (op.onCreate) op.onCreate();

            if (op.hasOwnProperty("onAnimFrame")) this.addOnAnimFrame(op);
            if (op.hasOwnProperty("onMasterVolumeChanged")) this._volumeListeners.push(op);

            if (this._opIdCache[op.id])
            {
                this._log.warn("opid with id " + op.id + " already exists in patch!");
                this.deleteOp(op.id); // strange with subpatch ops: why is this needed, somehow ops get added twice ???.....
                // return;
            }

            this.ops.push(op);
            this._opIdCache[op.id] = op;

            if (this._subPatchCacheAdd) this._subPatchCacheAdd(uiAttribs.subPatch, op);
            this.emitEvent(Patch.EVENT_OP_ADDED, op, fromDeserialize);

            if (op.init) op.init();

            op.emitEvent("init", fromDeserialize);
        }
        else
        {
            this._log.error("addop: op could not be created: ", opIdentifier);
        }

        return op;
    }

    addOnAnimFrame(op)
    {
        for (let i = 0; i < this.animFrameOps.length; i++) if (this.animFrameOps[i] == op) { return; }

        this.animFrameOps.push(op);
    }

    removeOnAnimFrame(op)
    {
        for (let i = 0; i < this.animFrameOps.length; i++)
        {
            if (this.animFrameOps[i] == op)
            {
                this.animFrameOps.splice(i, 1);
                return;
            }
        }
    }

    addOnAnimFrameCallback(cb)
    {
        this.animFrameCallbacks.push(cb);
    }

    removeOnAnimCallback(cb)
    {
        for (let i = 0; i < this.animFrameCallbacks.length; i++)
        {
            if (this.animFrameCallbacks[i] == cb)
            {
                this.animFrameCallbacks.splice(i, 1);
                return;
            }
        }
    }

    deleteOp(opid, tryRelink, reloadingOp)
    {
        let found = false;
        for (const i in this.ops)
        {
            if (this.ops[i].id == opid)
            {
                const op = this.ops[i];
                let reLinkP1 = null;
                let reLinkP2 = null;

                if (op)
                {
                    found = true;
                    if (tryRelink)
                    {
                        if (op.portsIn.length > 0 && op.portsIn[0].isLinked() && (op.portsOut.length > 0 && op.portsOut[0].isLinked()))
                        {
                            if (op.portsIn[0].getType() == op.portsOut[0].getType() && op.portsIn[0].links[0])
                            {
                                reLinkP1 = op.portsIn[0].links[0].getOtherPort(op.portsIn[0]);
                                reLinkP2 = op.portsOut[0].links[0].getOtherPort(op.portsOut[0]);
                            }
                        }
                    }

                    const opToDelete = this.ops[i];
                    opToDelete.removeLinks();

                    this.ops.splice(i, 1);
                    opToDelete.emitEvent("delete", opToDelete);
                    this.emitEvent(Patch.EVENT_OP_DELETED, opToDelete, reloadingOp);

                    if (this.clearSubPatchCache) this.clearSubPatchCache(opToDelete.uiAttribs.subPatch);

                    if (opToDelete.onDelete) opToDelete.onDelete(reloadingOp);
                    opToDelete.cleanUp();

                    if (reLinkP1 !== null && reLinkP2 !== null)
                    {
                        this.link(reLinkP1.op, reLinkP1.getName(), reLinkP2.op, reLinkP2.getName());
                    }

                    delete this._opIdCache[opid];
                    break;
                }
            }
        }

        if (!found) this._log.warn("core patch deleteop: not found...", opid);
    }

    getFrameNum()
    {
        return this._frameNum;
    }

    emitOnAnimFrameEvent(time, delta)
    {
        time = time || this.timer.getTime();

        for (let i = 0; i < this.animFrameCallbacks.length; ++i)
            if (this.animFrameCallbacks[i])
                this.animFrameCallbacks[i](time, this._frameNum, delta);

        for (let i = 0; i < this.animFrameOps.length; ++i)
            if (this.animFrameOps[i].onAnimFrame)
                this.animFrameOps[i].onAnimFrame(time, this._frameNum, delta);
    }

    renderFrame(timestamp)
    {
        this.timer.update(this.reqAnimTimeStamp);
        this.freeTimer.update(this.reqAnimTimeStamp);
        const time = this.timer.getTime();
        const startTime = performance.now();
        this.cgl.frameStartTime = this.timer.getTime();

        const delta = timestamp - this.reqAnimTimeStamp || timestamp;

        this.emitOnAnimFrameEvent(null, delta);

        this.cgl.profileData.profileFrameDelta = delta;
        this.reqAnimTimeStamp = timestamp;
        this.cgl.profileData.profileOnAnimFrameOps = performance.now() - startTime;

        this.emitEvent("onRenderFrame", time);

        this._frameNum++;
        if (this._frameNum == 1)
        {
            if (this.config.onFirstFrameRendered) this.config.onFirstFrameRendered();
        }
    }

    exec(timestamp)
    {
        if (!this.#renderOneFrame && (this._paused || this.aborted)) return;
        this.emitEvent("reqAnimFrame");
        cancelAnimationFrame(this._animReq);

        this.config.fpsLimit = this.config.fpsLimit || 0;
        if (this.config.fpsLimit)
        {
            this._frameInterval = 1000 / this.config.fpsLimit;
        }

        const now = CABLES.now();
        const frameDelta = now - this._frameNext;

        if (this.isEditorMode())
        {
            if (!this.#renderOneFrame)
            {
                if (now - this._lastFrameTime >= 500 && this._lastFrameTime !== 0 && !this._frameWasdelayed)
                {
                    this._lastFrameTime = 0;
                    setTimeout(this.exec.bind(this), 500);
                    this.emitEvent("renderDelayStart");
                    this._frameWasdelayed = true;
                    return;
                }
            }
        }

        if (this.#renderOneFrame || this.config.fpsLimit === 0 || frameDelta > this._frameInterval || this._frameWasdelayed)
        {
            this.renderFrame(timestamp);

            if (this._frameInterval) this._frameNext = now - (frameDelta % this._frameInterval);
        }

        if (this._frameWasdelayed)
        {
            this.emitEvent("renderDelayEnd");
            this._frameWasdelayed = false;
        }

        if (this.#renderOneFrame)
        {
            if (this.onOneFrameRendered) this.onOneFrameRendered(); // todo remove everywhere and use propper event...
            this.emitEvent("renderedOneFrame");
            this._renderOneFrame = false;
        }

        if (this.config.doRequestAnimation) this._animReq = this.cgl.canvas.ownerDocument.defaultView.requestAnimationFrame(this.exec.bind(this));
    }

    /**
     * link two ops/ports
     * @function link
     * @memberof Patch
     * @instance
     * @param {Op} op1
     * @param {String} port1Name
     * @param {Op} op2
     * @param {String} port2Name
     * @param {boolean} lowerCase
     * @param {boolean} fromDeserialize
     */
    link(op1, port1Name, op2, port2Name, lowerCase = false, fromDeserialize = false)
    {
        if (!op1) return this._log.warn("link: op1 is null ");
        if (!op2) return this._log.warn("link: op2 is null");

        const port1 = op1.getPort(port1Name, lowerCase);
        const port2 = op2.getPort(port2Name, lowerCase);

        if (!port1) return this._log.warn("port1 not found! " + port1Name + " (" + op1.objName + ")");
        if (!port2) return this._log.warn("port2 not found! " + port2Name + " of " + op2.name + "(" + op2.objName + ")", op2);

        if (!port1.shouldLink(port1, port2) || !port2.shouldLink(port1, port2)) return false;

        if (Link.canLink(port1, port2))
        {
            const link = new Link(this);
            link.link(port1, port2);

            this.emitEvent("onLink", port1, port2, link, fromDeserialize);
            return link;
        }
    }

    /**
     * @param {Object} options
     * @returns {Object|String}
     */
    serialize(options)
    {
        const obj = {};

        options = options || {};
        obj.ops = [];
        obj.settings = this.settings;
        for (const i in this.ops)
        {
            const op = this.ops[i];
            if (op && op.getSerialized)obj.ops.push(op.getSerialized());
        }

        cleanJson(obj);

        if (options.asObject) return obj;
        return JSON.stringify(obj);
    }

    getOpsByRefId(refId) // needed for instancing ops ?
    {
        const perf = gui.uiProfiler.start("[corepatchetend] getOpsByRefId");
        const refOps = [];
        const ops = gui.corePatch().ops;
        for (let i = 0; i < ops.length; i++)
            if (ops[i].storage && ops[i].storage.ref == refId) refOps.push(ops[i]);
        perf.finish();
        return refOps;
    }

    /**
     * @param {String} opid
     * @returns {Op}
     */
    getOpById(opid)
    {
        return this._opIdCache[opid];
    }

    /**
     * @param {String} name
     */
    getOpsByObjName(name)
    {
        const arr = [];
        for (const i in this.ops)
            if (this.ops[i].objName == name) arr.push(this.ops[i]);
        return arr;
    }

    /**
     * @param {String} opid
     */
    getOpsByOpId(opid)
    {
        const arr = [];
        for (const i in this.ops)
            if (this.ops[i].opId == opid) arr.push(this.ops[i]);
        return arr;
    }

    /**
     * @param {String} which
     */
    loadLib(which)
    {
        ajaxSync(
            "/ui/libs/" + which + ".js",
            (err, res) =>
            {
                const se = document.createElement("script");
                se.type = "text/javascript";
                se.text = res;
                document.getElementsByTagName("head")[0].appendChild(se);
            },
            "GET",
        );
    }

    getSubPatchOpsByName(patchId, objName)
    {
        const arr = [];
        for (const i in this.ops)
            if (this.ops[i].uiAttribs && this.ops[i].uiAttribs.subPatch == patchId && this.ops[i].objName == objName)
                arr.push(this.ops[i]);

        return arr;
    }

    getSubPatchOp(patchId, objName)
    {
        return this.getFirstSubPatchOpByName(patchId, objName);
    }

    getFirstSubPatchOpByName(patchId, objName)
    {
        for (const i in this.ops)
            if (this.ops[i].uiAttribs && this.ops[i].uiAttribs.subPatch == patchId && this.ops[i].objName == objName)
                return this.ops[i];

        return false;
    }

    _addLink(opinid, opoutid, inName, outName)
    {
        return this.link(this.getOpById(opinid), inName, this.getOpById(opoutid), outName, false, true);
    }

    deSerialize(obj, options)
    {
        options = options || { "genIds": false, "createRef": false };
        if (this.aborted) return;
        const newOps = [];
        const loadingId = this.loading.start("core", "deserialize");

        this.namespace = obj.namespace || "";
        this.name = obj.name || "";

        if (typeof obj === "string") obj = JSON.parse(obj);

        this.settings = obj.settings;

        this.emitEvent("patchLoadStart");

        obj.ops = obj.ops || [];

        if (window.logStartup)logStartup("add " + obj.ops.length + " ops... ");

        const addedOps = [];

        // add ops...
        for (let iop = 0; iop < obj.ops.length; iop++)
        {
            const start = CABLES.now();
            const opData = obj.ops[iop];
            let op = null;

            try
            {
                if (opData.opId) op = this.addOp(opData.opId, opData.uiAttribs, opData.id, true, opData.objName);
                else op = this.addOp(opData.objName, opData.uiAttribs, opData.id, true);
            }
            catch (e)
            {
                this._log.error("[instancing error] op data:", opData, e);
                // throw new Error("could not create op by id: <b>" + (opData.objName || opData.opId) + "</b> (" + opData.id + ")");
            }

            if (op)
            {
                addedOps.push(op);
                if (options.genIds) op.id = shortId();
                op.portsInData = opData.portsIn;
                op._origData = JSON.parse(JSON.stringify(opData));
                op.storage = opData.storage;
                // if (opData.hasOwnProperty("disabled"))op.setEnabled(!opData.disabled);

                for (const ipi in opData.portsIn)
                {
                    const objPort = opData.portsIn[ipi];
                    if (objPort && objPort.hasOwnProperty("name"))
                    {
                        const port = op.getPort(objPort.name);

                        if (port && (port.uiAttribs.display == "bool" || port.uiAttribs.type == "bool") && !isNaN(objPort.value)) objPort.value = objPort.value == true ? 1 : 0;
                        if (port && objPort.value !== undefined && port.type != Port.TYPE_TEXTURE) port.set(objPort.value);

                        if (port)
                        {
                            port.deSerializeSettings(objPort);
                        }
                        else
                        {

                            /*
                             * if (port.uiAttribs.hasOwnProperty("title"))
                             * {
                             *     op.preservedPortTitles = op.preservedPortTitles || {};
                             *     op.preservedPortTitles[port.name] = port.uiAttribs.title;
                             * }
                             */
                            op.preservedPortValues = op.preservedPortValues || {};
                            op.preservedPortValues[objPort.name] = objPort.value;
                        }
                    }
                }

                for (const ipo in opData.portsOut)
                {
                    const objPort = opData.portsOut[ipo];
                    if (objPort && objPort.hasOwnProperty("name"))
                    {
                        const port2 = op.getPort(objPort.name);

                        if (port2)
                        {
                            port2.deSerializeSettings(objPort);

                            if (port2.uiAttribs.hasOwnProperty("title"))
                            {
                                op.preservedPortTitles = op.preservedPortTitles || {};
                                op.preservedPortTitles[port2.name] = port2.uiAttribs.title;
                            }

                            if (port2.type != Port.TYPE_TEXTURE && objPort.hasOwnProperty("value"))
                                port2.set(obj.ops[iop].portsOut[ipo].value);

                            if (objPort.expose) port2.setUiAttribs({ "expose": true });
                        }
                    }
                }
                newOps.push(op);
            }

            const timeused = Math.round(100 * (CABLES.now() - start)) / 100;
            if (!this.silent && timeused > 5) console.log("long op init ", obj.ops[iop].objName, timeused);
        }
        if (window.logStartup)logStartup("add ops done");

        for (const i in this.ops)
        {
            if (this.ops[i].onLoadedValueSet)
            {
                this.ops[i].onLoadedValueSet(this.ops[i]._origData);
                this.ops[i].onLoadedValueSet = null;
                this.ops[i]._origData = null;
            }
            this.ops[i].emitEvent("loadedValueSet");
        }

        if (window.logStartup)logStartup("creating links");

        if (options.opsCreated)options.opsCreated(addedOps);
        // create links...
        if (obj.ops)
        {
            for (let iop = 0; iop < obj.ops.length; iop++)
            {
                if (obj.ops[iop].portsIn)
                {
                    for (let ipi2 = 0; ipi2 < obj.ops[iop].portsIn.length; ipi2++)
                    {
                        if (obj.ops[iop].portsIn[ipi2] && obj.ops[iop].portsIn[ipi2].links)
                        {
                            for (let ili = 0; ili < obj.ops[iop].portsIn[ipi2].links.length; ili++)
                            {
                                const l = this._addLink(
                                    obj.ops[iop].portsIn[ipi2].links[ili].objIn,
                                    obj.ops[iop].portsIn[ipi2].links[ili].objOut,
                                    obj.ops[iop].portsIn[ipi2].links[ili].portIn,
                                    obj.ops[iop].portsIn[ipi2].links[ili].portOut);

                                /*
                                 * const took = performance.now - startTime;
                                 * if (took > 100)console.log(obj().ops[iop].portsIn[ipi2].links[ili].objIn, obj.ops[iop].portsIn[ipi2].links[ili].objOut, took);
                                 */
                            }
                        }
                    }
                }
                if (obj.ops[iop].portsOut)
                    for (let ipi2 = 0; ipi2 < obj.ops[iop].portsOut.length; ipi2++)
                        if (obj.ops[iop].portsOut[ipi2] && obj.ops[iop].portsOut[ipi2].links)
                        {
                            for (let ili = 0; ili < obj.ops[iop].portsOut[ipi2].links.length; ili++)
                            {
                                if (obj.ops[iop].portsOut[ipi2].links[ili])
                                {
                                    if (obj.ops[iop].portsOut[ipi2].links[ili].subOpRef)
                                    {
                                        // lost link
                                        const outOp = this.getOpById(obj.ops[iop].portsOut[ipi2].links[ili].objOut);
                                        let dstOp = null;
                                        let theSubPatch = 0;

                                        for (let i = 0; i < this.ops.length; i++)
                                        {
                                            if (
                                                this.ops[i].storage &&
                                                this.ops[i].storage.ref == obj.ops[iop].portsOut[ipi2].links[ili].subOpRef &&
                                                outOp.uiAttribs.subPatch == this.ops[i].uiAttribs.subPatch
                                            )
                                            {
                                                theSubPatch = this.ops[i].patchId.get();
                                                break;
                                            }
                                        }

                                        for (let i = 0; i < this.ops.length; i++)
                                        {
                                            if (
                                                this.ops[i].storage &&
                                                this.ops[i].storage.ref == obj.ops[iop].portsOut[ipi2].links[ili].refOp &&
                                                this.ops[i].uiAttribs.subPatch == theSubPatch)
                                            {
                                                dstOp = this.ops[i];
                                                break;
                                            }
                                        }

                                        if (!dstOp) this._log.warn("could not find op for lost link");
                                        else
                                        {
                                            const l = this._addLink(
                                                dstOp.id,
                                                obj.ops[iop].portsOut[ipi2].links[ili].objOut,

                                                obj.ops[iop].portsOut[ipi2].links[ili].portIn,
                                                obj.ops[iop].portsOut[ipi2].links[ili].portOut);
                                        }
                                    }
                                    else
                                    {
                                        const l = this._addLink(obj.ops[iop].portsOut[ipi2].links[ili].objIn, obj.ops[iop].portsOut[ipi2].links[ili].objOut, obj.ops[iop].portsOut[ipi2].links[ili].portIn, obj.ops[iop].portsOut[ipi2].links[ili].portOut);

                                        if (!l)
                                        {
                                            const op1 = this.getOpById(obj.ops[iop].portsOut[ipi2].links[ili].objIn);
                                            const op2 = this.getOpById(obj.ops[iop].portsOut[ipi2].links[ili].objOut);

                                            if (!op1)console.log("could not find link op1");
                                            if (!op2)console.log("could not find link op2");

                                            const p1Name = obj.ops[iop].portsOut[ipi2].links[ili].portIn;

                                            if (op1 && !op1.getPort(p1Name))
                                            {
                                                // console.log("PRESERVE port 1 not found", p1Name);

                                                op1.preservedPortLinks[p1Name] = op1.preservedPortLinks[p1Name] || [];
                                                op1.preservedPortLinks[p1Name].push(obj.ops[iop].portsOut[ipi2].links[ili]);
                                            }

                                            const p2Name = obj.ops[iop].portsOut[ipi2].links[ili].portOut;
                                            if (op2 && !op2.getPort(p2Name))
                                            {
                                                // console.log("PRESERVE port 2 not found", obj.ops[iop].portsOut[ipi2].links[ili].portOut);
                                                op2.preservedPortLinks[p1Name] = op2.preservedPortLinks[p1Name] || [];
                                                op2.preservedPortLinks[p1Name].push(obj.ops[iop].portsOut[ipi2].links[ili]);
                                            }
                                        }
                                    }
                                }
                            }
                        }
            }
        }

        if (window.logStartup)logStartup("calling ops onloaded");

        for (const i in this.ops)
        {
            if (this.ops[i].onLoaded)
            {
                // TODO: deprecate!!!
                this.ops[i].onLoaded();
                this.ops[i].onLoaded = null;
            }
        }

        if (window.logStartup)logStartup("initializing ops...");
        for (const i in this.ops)
        {
            if (this.ops[i].init)
            {
                try
                {
                    this.ops[i].init();
                    this.ops[i].init = null;
                }
                catch (e)
                {
                    console.error("op.init crash", e);
                }
            }
        }

        if (window.logStartup)logStartup("initializing vars...");

        if (this.config.variables)
            for (const varName in this.config.variables)
                this.setVarValue(varName, this.config.variables[varName]);

        if (window.logStartup)logStartup("initializing var ports");

        for (const i in this.ops)
        {
            this.ops[i].initVarPorts();
            delete this.ops[i].uiAttribs.pasted;
        }

        setTimeout(() => { this.loading.finished(loadingId); }, 100);

        if (this.config.onPatchLoaded) this.config.onPatchLoaded(this);

        this.emitEvent(Patch.EVENT_PATCHLOADEND, newOps, obj, options.genIds);
    }

    profile(enable)
    {
        this.profiler = new Profiler(this);
        for (const i in this.ops)
        {
            this.ops[i].profile(enable);
        }
    }

    // ----------------------

    /**
     * set variable value
     * @function setVariable
     * @memberof Patch
     * @instance
     * @param {String} name of variable
     * @param {Number|String|Boolean} val value
     */
    setVariable(name, val)
    {
        if (this._variables[name] !== undefined)
        {
            this._variables[name].setValue(val);
        }
        else
        {
            this._log.warn("variable " + name + " not found!");
        }
    }

    _sortVars()
    {
        if (!this.isEditorMode()) return;
        const ordered = {};
        Object.keys(this._variables).sort(
            (a, b) =>
            { return a.localeCompare(b, "en", { "sensitivity": "base" }); }
        ).forEach((key) =>
        {
            ordered[key] = this._variables[key];
        });
        this._variables = ordered;
    }

    /**
     * has variable
     * @function hasVariable
     * @memberof Patch
     * @instance
     * @param {String} name of variable
     */
    hasVar(name)
    {
        return this._variables[name] !== undefined;
    }

    // used internally
    setVarValue(name, val, type)
    {
        if (this.hasVar(name))
        {
            this._variables[name].setValue(val);
        }
        else
        {
            this._variables[name] = new PatchVariable(name, val, type);
            this._sortVars();
            this.emitEvent(Patch.EVENT_VARIABLES_CHANGED);
        }
        return this._variables[name];
    }

    // old?
    getVarValue(name, val)
    {
        if (this._variables.hasOwnProperty(name)) return this._variables[name].getValue();
    }

    /**
     * @function getVar
     * @memberof Patch
     * @instance
     * @param {String} name
     * @return {PatchVariable} variable
     */
    getVar(name)
    {
        if (this._variables.hasOwnProperty(name)) return this._variables[name];
    }

    deleteVar(name)
    {
        for (let i = 0; i < this.ops.length; i++)
            for (let j = 0; j < this.ops[i].portsIn.length; j++)
                if (this.ops[i].portsIn[j].getVariableName() == name)
                    this.ops[i].portsIn[j].setVariable(null);

        delete this._variables[name];
        this.emitEvent("variableDeleted", name);
        this.emitEvent("variablesChanged");
    }

    /**
     * @param {number} t
     * @returns {Array<PatchVariable>}
     */
    getVars(t)
    {
        if (t === undefined) return this._variables;

        const vars = [];
        if (t == Port.TYPE_STRING) t = "string";
        if (t == Port.TYPE_VALUE) t = "number";
        if (t == Port.TYPE_ARRAY) t = "array";
        if (t == Port.TYPE_OBJECT) t = "object";

        for (const i in this._variables)
        {
            if (!this._variables[i].type || this._variables[i].type == t) vars.push(this._variables[i]);
        }
        return vars;
    }

    /**
     * @function preRenderOps
     * @memberof Patch
     * @instance
     * @description invoke pre rendering of ops
     * @function
     */
    preRenderOps()
    {
        this._log.log("prerendering...");

        for (let i = 0; i < this.ops.length; i++)
        {
            if (this.ops[i].preRender)
            {
                this.ops[i].preRender();
                this._log.log("prerender " + this.ops[i].objName);
            }
        }
    }

    /**
     * @function dispose
     * @memberof Patch
     * @instance
     * @description stop, dispose and cleanup patch
     */
    dispose()
    {
        this.pause();
        this.clear();
        this.cgl.dispose();
    }

    pushTriggerStack(p)
    {
        this._triggerStack.push(p);
    }

    popTriggerStack()
    {
        this._triggerStack.pop();
    }

    printTriggerStack()
    {
        if (this._triggerStack.length == 0)
        {
            // console.log("stack length", this._triggerStack.length); // eslint-disable-line
            return;
        }
        console.groupCollapsed( // eslint-disable-line
            "trigger port stack " + this._triggerStack[this._triggerStack.length - 1].op.objName + "." + this._triggerStack[this._triggerStack.length - 1].name,
        );

        const rows = [];
        for (let i = 0; i < this._triggerStack.length; i++)
        {
            rows.push(i + ". " + this._triggerStack[i].op.objName + " " + this._triggerStack[i].name);
        }

        console.table(rows); // eslint-disable-line
        console.groupEnd(); // eslint-disable-line
    }

    /**
     * returns document object of the patch could be != global document object when opening canvas ina popout window
     * @function getDocument
     * @memberof Patch
     * @instance
     * @return {Object} document
     */
    getDocument()
    {
        return this.cgl.canvas.ownerDocument;
    }
}

Patch.getOpClass = function (objName)
{
    const parts = objName.split(".");
    let opObj = null;

    try
    {
        if (parts.length == 2) opObj = window[parts[0]][parts[1]];
        else if (parts.length == 3) opObj = window[parts[0]][parts[1]][parts[2]];
        else if (parts.length == 4) opObj = window[parts[0]][parts[1]][parts[2]][parts[3]];
        else if (parts.length == 5) opObj = window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]];
        else if (parts.length == 6) opObj = window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]];
        else if (parts.length == 7) opObj = window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]];
        else if (parts.length == 8) opObj = window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]][parts[7]];
        else if (parts.length == 9) opObj = window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]][parts[7]][parts[8]];
        else if (parts.length == 10) opObj = window[parts[0]][parts[1]][parts[2]][parts[3]][parts[4]][parts[5]][parts[6]][parts[7]][parts[8]][parts[9]];
        return opObj;
    }
    catch (e)
    {
        return null;
    }
};

Patch.replaceOpIds = function (json, options)
{
    const opids = {};
    for (const i in json.ops)
    {
        opids[json.ops[i].id] = json.ops[i];
    }

    for (const j in json.ops)
    {
        for (const k in json.ops[j].portsOut)
        {
            const links = json.ops[j].portsOut[k].links;
            if (links)
            {
                let l = links.length;

                while (l--)
                {
                    if (links[l] && (!opids[links[l].objIn] || !opids[links[l].objOut]))
                    {
                        if (!options.doNotUnlinkLostLinks)
                        {
                            links.splice(l, 1);
                        }
                        else
                        {
                            if (options.fixLostLinks)
                            {
                                const op = gui.corePatch().getOpById(links[l].objIn);
                                if (!op) console.log("op not found!");
                                else
                                {
                                    const outerOp = gui.patchView.getSubPatchOuterOp(op.uiAttribs.subPatch);
                                    if (outerOp)
                                    {
                                        op.storage = op.storage || {};
                                        op.storage.ref = op.storage.ref || shortId();
                                        links[l].refOp = op.storage.ref;
                                        links[l].subOpRef = outerOp.storage.ref;
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    }

    for (const i in json.ops)
    {
        const op = json.ops[i];
        const oldId = op.id;
        let newId = shortId();

        if (options.prefixHash) newId = prefixedHash(options.prefixHash + oldId);

        else if (options.prefixId) newId = options.prefixId + oldId;
        else if (options.refAsId) // when saving json
        {
            if (op.storage && op.storage.ref)
            {
                newId = op.storage.ref;
                delete op.storage.ref;
            }
            else
            {
                op.storage = op.storage || {};
                op.storage.ref = newId = shortId();
            }
        }

        const newID = op.id = newId;

        if (options.oldIdAsRef) // when loading json
        {
            op.storage = op.storage || {};
            op.storage.ref = oldId;
        }

        for (const j in json.ops)
        {
            if (json.ops[j].portsIn)
                for (const k in json.ops[j].portsIn)
                {
                    if (json.ops[j].portsIn[k].links)
                    {
                        let l = json.ops[j].portsIn[k].links.length;

                        while (l--) if (json.ops[j].portsIn[k].links[l] === null) json.ops[j].portsIn[k].links.splice(l, 1);

                        for (l in json.ops[j].portsIn[k].links)
                        {
                            if (json.ops[j].portsIn[k].links[l].objIn === oldId) json.ops[j].portsIn[k].links[l].objIn = newID;
                            if (json.ops[j].portsIn[k].links[l].objOut === oldId) json.ops[j].portsIn[k].links[l].objOut = newID;
                        }
                    }
                }

            if (json.ops[j].portsOut)
                for (const k in json.ops[j].portsOut)
                {
                    if (json.ops[j].portsOut[k].links)
                    {
                        let l = json.ops[j].portsOut[k].links.length;

                        while (l--) if (json.ops[j].portsOut[k].links[l] === null) json.ops[j].portsOut[k].links.splice(l, 1);

                        for (l in json.ops[j].portsOut[k].links)
                        {
                            if (json.ops[j].portsOut[k].links[l].objIn === oldId) json.ops[j].portsOut[k].links[l].objIn = newID;
                            if (json.ops[j].portsOut[k].links[l].objOut === oldId) json.ops[j].portsOut[k].links[l].objOut = newID;
                        }
                    }
                }
        }
    }

    // set correct subpatch
    const subpatchIds = [];
    const fixedSubPatches = [];

    for (let i = 0; i < json.ops.length; i++)
    {
        // if (CABLES.Op.isSubPatchOpName(json.ops[i].objName))
        if (json.ops[i].storage && json.ops[i].storage.subPatchVer)
        {
            for (const k in json.ops[i].portsIn)
            {
                if (json.ops[i].portsIn[k].name === "patchId")
                {
                    let newId = shortId();

                    if (options.prefixHash) newId = prefixedHash(options.prefixHash + json.ops[i].portsIn[k].value);

                    const oldSubPatchId = json.ops[i].portsIn[k].value;
                    const newSubPatchId = json.ops[i].portsIn[k].value = newId;

                    subpatchIds.push(newSubPatchId);

                    for (let j = 0; j < json.ops.length; j++)
                    {
                        // op has no uiAttribs in export, we don't care about subpatches in export though
                        if (json.ops[j].uiAttribs)
                        {
                            if (json.ops[j].uiAttribs.subPatch === oldSubPatchId)
                            {
                                json.ops[j].uiAttribs.subPatch = newSubPatchId;
                                fixedSubPatches.push(json.ops[j].id);
                            }
                        }
                    }
                }
            }
        }
    }

    for (const kk in json.ops)
    {
        let found = false;
        for (let j = 0; j < fixedSubPatches.length; j++)
        {
            if (json.ops[kk].id === fixedSubPatches[j])
            {
                found = true;
                break;
            }
        }
        // op has no uiAttribs in export, we don't care about subpatches in export though
        if (!found && json.ops[kk].uiAttribs && options.parentSubPatchId != null)
            json.ops[kk].uiAttribs.subPatch = options.parentSubPatchId;
    }

    return json;
};

/**
 * remove an eventlistener
 * @instance
 * @function addEventListener
 * @param {String} name of event
 * @param {function} callback
 */

/**
 * remove an eventlistener
 * @instance
 * @function removeEventListener
 * @param {String} name of event
 * @param {function} callback
 */

/**
 * op added to patch event
 * @event onOpAdd
 *
 * @memberof Patch
 * @type {Object}
 * @property {Op} op new op
 */

/**
 * op deleted from patch
 * @event onOpDelete
 * @memberof Patch
 * @type {Object}
 * @property {Op} op that will be deleted
 */

/**
 * link event - two ports will be linked
 * @event onLink
 * @memberof Patch
 * @type {Object}
 * @property {Port} port1
 * @property {Port} port2
 */

/**
 * unlink event - a link was deleted
 * @event onUnLink
 * @memberof Patch
 * @type {Object}
 */

/**
 * variables has been changed / a variable has been added to the patch
 * @event variablesChanged
 * @memberof Patch
 * @type {Object}
 * @property {Port} port1
 * @property {Port} port2
 */

;// CONCATENATED MODULE: ./src/core/embedding.js



const EMBED = {};

/**
 * add patch into html element (will create canvas and set size to fill containerElement)
 * @name CABLES.EMBED#addPatch
 * @param {object|string} _element containerElement dom element or id of element
 * @param {Object} options patch options
 * @function
 */
EMBED.addPatch = function (_element, options)
{
    let el = _element;
    let id = generateUUID();
    if (typeof _element == "string")
    {
        id = _element;
        el = document.getElementById(id);

        if (!el)
        {
            console.error(id + " Polyshape Container Element not found!");
            return;
        }
    }

    const canvEl = document.createElement("canvas");
    canvEl.id = "glcanvas_" + id;
    canvEl.width = el.clientWidth;
    canvEl.height = el.clientHeight;

    window.addEventListener(
        "resize",
        function ()
        {
            this.setAttribute("width", el.clientWidth);
            this.height = el.clientHeight;
        }.bind(canvEl),
    );

    el.appendChild(canvEl);

    options = options || {};
    options.glCanvasId = canvEl.id;

    if (!options.onError)
    {
        options.onError = function (err)
        {
            console.error(err);
        };
    }

    CABLES.patch = new Patch(options);
    return canvEl;
};



;// CONCATENATED MODULE: ./src/core/webaudio.js
/** @namespace WEBAUDIO */




const WEBAUDIO = {};

WEBAUDIO.toneJsInitialized = false;

/*
 * External JSDoc definitions
 */

/**
 * Part of the Web Audio API, the AudioBuffer interface represents a short audio asset residing in memory.
 * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/AudioBuffer}
 */

/**
 * Part of the Web Audio API, the AudioNode interface is a generic interface for representing an audio processing module.
 * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/AudioNode}
 */

/**
 * The AudioContext interface represents an audio-processing graph built from audio modules linked together
 * @see {@link https://developer.mozilla.org/en-US/docs/Web/API/AudioContext}
 */

/**
 * Checks if a global audio context has been created and creates
 * it if necessary. This audio context can be used for native Web Audio as well as Tone.js ops.
 * Associates the audio context with Tone.js if it is being used
 * @param {Types.Op} op - The operator which needs the Audio Context
 */
WEBAUDIO.createAudioContext = function (op)
{
    window.AudioContext = window.AudioContext || window.webkitAudioContext;
    if (window.AudioContext)
    {
        if (!window.audioContext)
        {
            window.audioContext = new AudioContext();
        }
        // check if tone.js lib is being used
        if (window.Tone && !WEBAUDIO.toneJsInitialized)
        {
            // set current audio context in tone.js
            Tone.setContext(window.audioContext);
            WEBAUDIO.toneJsInitialized = true;
        }
    }
    else
    {
        if (op.patch.config.onError)op.logError("NO_WEBAUDIO", "Web Audio is not supported in this browser.");
        return;
    }
    return window.audioContext;
};

/**
 * Returns the audio context.
 * Before `createAudioContext` must have been called at least once.
 * It most cases you should use `createAudioContext`, which just returns the audio context
 * when it has been created already.
 */
WEBAUDIO.getAudioContext = function ()
{
    return window.audioContext;
};

/**
 * Creates an audio in port for the op with name `portName`
 * When disconnected it will disconnect the previous connected audio node
 * from the op's audio node.
 * @param {Types.Op} op - The operator to create the audio port in
 * @param {string} portName - The name of the port
 * @param {AudioNode} audioNode - The audionode incoming connections should connect to
 * @param {number} [inputChannelIndex=0] - If the audio node has multiple inputs, this is the index of the input channel to connect to
 * @returns {Types.Port|undefined} - The newly created audio in port or `undefined` if there was an error
 */
WEBAUDIO.createAudioInPort = function (op, portName, audioNode, inputChannelIndex)
{
    if (!op || !portName || !audioNode)
    {
        const msg = "ERROR: createAudioInPort needs three parameters, op, portName and audioNode";
        op.log(msg);
        throw new Error(msg);
        // return;
    }
    if (!inputChannelIndex)
    {
        inputChannelIndex = 0;
    }
    op.webAudio = op.webAudio || {};
    op.webAudio.audioInPorts = op.webAudio.audioInPorts || [];
    const port = op.inObject(portName);
    port.webAudio = {};
    port.webAudio.previousAudioInNode = null;
    port.webAudio.audioNode = audioNode;

    op.webAudio.audioInPorts[portName] = port;

    port.onChange = function ()
    {
        const audioInNode = port.get();
        // when port disconnected, disconnect audio nodes
        if (!audioInNode)
        {
            if (port.webAudio.previousAudioInNode)
            {
                try
                {
                    if (port.webAudio.previousAudioInNode.disconnect) port.webAudio.previousAudioInNode.disconnect(port.webAudio.audioNode, 0, inputChannelIndex);
                    op.setUiError("audioCtx", null);
                }
                catch (e)
                {
                    try
                    {
                        port.webAudio.previousAudioInNode.disconnect(port.webAudio.audioNode);
                    }
                    catch (er)
                    {
                        op.log(
                            "Disconnecting audio node with in/out port index, as well as without in/out-port-index did not work ",
                            e,
                        );
                        if (e.printStackTrace)
                        {
                            e.printStackTrace();
                        }
                        throw e;
                    }
                }
            }
        }
        else
        {
            try
            {
                if (audioInNode.connect)
                {
                    audioInNode.connect(port.webAudio.audioNode, 0, inputChannelIndex);
                    op.setUiError("audioCtx", null);
                }
                else op.setUiError("audioCtx", "The passed input is not an audio context. Please make sure you connect an audio context to the input.", 2);
            }
            catch (e)
            {
                op.log("Error: Failed to connect web audio node!", e);
                op.log("port.webAudio.audioNode", port.webAudio.audioNode);
                op.log("audioInNode: ", audioInNode);
                op.log("inputChannelIndex:", inputChannelIndex);
                op.log("audioInNode.connect: ", audioInNode.connect);
                throw e;
            }
        }
        port.webAudio.previousAudioInNode = audioInNode;
    };
    // TODO: Maybe add subtype to audio-node-object?
    return port;
};

/**
 * Sometimes it is necessary to replace a node of a port, if so all
 * connections to this node must be disconnected and connections to the new
 * node must be made.
 * Can be used for both Audio ports as well as AudioParam ports
 * if used with an AudioParam pass e.g. `synth.frequency` as newNode
 * @param {Types.Port} port - The port where the audio node needs to be replaced
 * @param oldNode
 * @param newNode
 */
WEBAUDIO.replaceNodeInPort = function (port, oldNode, newNode)
{
    const connectedNode = port.webAudio.previousAudioInNode;
    // check if connected
    if (connectedNode && connectedNode.disconnect)
    {
        try
        {
            connectedNode.disconnect(oldNode);
        }
        catch (e)
        {
            if (e.printStackTrace)
            {
                e.printStackTrace();
            }
            throw new Error("replaceNodeInPort: Could not disconnect old audio node. " + e.name + " " + e.message);
        }
        port.webAudio.audioNode = newNode;
        try
        {
            connectedNode.connect(newNode);
        }
        catch (e)
        {
            if (e.printStackTrace)
            {
                e.printStackTrace();
            }
            throw new Error("replaceNodeInPort: Could not connect to new node. " + e.name + " " + e.message);
        }
    }
};

/**
 * Creates an audio out port which takes care of (dis-)connecting on its own
 * @param {Types.Op} op - The op to create an audio out port for
 * @param {string} portName - The name of the port to be created
 * @param {AudioNode} audioNode - The audio node to link to the port
 * @returns {(CABLES.Port|undefined)} - The newly created audio out port or `undefined` if there was an error
 */
WEBAUDIO.createAudioOutPort = function (op, portName, audioNode)
{
    if (!op || !portName || !audioNode)
    {
        const msg = "ERROR: createAudioOutPort needs three parameters, op, portName and audioNode";
        op.log(msg);
        throw new Error(msg);
    }

    const port = op.outObject(portName);
    // TODO: Maybe add subtype to audio-node-object?
    port.set(audioNode);
    return port;
};

/**
 * Creates an audio param in port for the op with name portName.
 * The port accepts other audio nodes as signals as well as values (numbers)
 * When the port is disconnected it will disconnect the previous connected audio node
 * from the op's audio node and restore the number value set before.
 * @param {Types.Op} op - The operator to create an audio param input port for
 * @param {string} portName - The name of the port to create
 * @param audioNode
 * @param options
 * @param defaultValue
 * @returns {(CABLES.Port|undefined)} - The newly created port, which takes care of (dis-)connecting on its own, or `undefined` if there was an error
 */
WEBAUDIO.createAudioParamInPort = function (op, portName, audioNode, options, defaultValue)
{
    if (!op || !portName || !audioNode)
    {
        op.log("ERROR: createAudioParamInPort needs three parameters, op, portName and audioNode");
        if (op && op.name) op.log("opname: ", op.name);
        op.log("portName", portName);
        op.log("audioNode: ", audioNode);
        return;
    }
    op.webAudio = op.webAudio || {};
    op.webAudio.audioInPorts = op.webAudio.audioInPorts || [];
    // var port = op.inObject(portName);
    const port = op.inDynamic(
        portName,
        [CONSTANTS.OP.OP_PORT_TYPE_VALUE, CONSTANTS.OP.OP_PORT_TYPE_OBJECT],
        options,
        defaultValue,
    );
    port.webAudio = {};
    port.webAudio.previousAudioInNode = null;
    port.webAudio.audioNode = audioNode;

    op.webAudio.audioInPorts[portName] = port;

    /*
     * port.onLinkChanged = function() {
     *   op.log("onLinkChanged");
     *   if(port.isLinked()) {
     *
     *       if(port.links[0].portOut.type === CABLES.CONSTANTS.OP.OP_PORT_TYPE_) { // value
     *
     *       } else if(port.links[0].portOut.type === CABLES.CONSTANTS.OP.OP_PORT_TYPE_OBJECT) { // object
     *
     *       }
     *   } else { // unlinked
     *
     *   }
     * };
     */

    port.onChange = function ()
    {
        const audioInNode = port.get();
        const node = port.webAudio.audioNode;
        const audioCtx = WEBAUDIO.getAudioContext();

        if (audioInNode != undefined)
        {
            if (typeof audioInNode === "object" && audioInNode.connect)
            {
                try
                {
                    audioInNode.connect(node);
                }
                catch (e)
                {
                    op.log("Could not connect audio node: ", e);
                    if (e.printStackTrace)
                    {
                        e.printStackTrace();
                    }
                    throw e;
                }
                port.webAudio.previousAudioInNode = audioInNode;
            }
            else
            {
                // tone.js audio param
                if (node._param && node._param.minValue && node._param.maxValue)
                {
                    if (audioInNode >= node._param.minValue && audioInNode <= node._param.maxValue)
                    {
                        try
                        {
                            if (node.setValueAtTime)
                            {
                                node.setValueAtTime(audioInNode, audioCtx.currentTime);
                            }
                            else
                            {
                                node.value = audioInNode;
                            }
                        }
                        catch (e)
                        {
                            op.log("Possible AudioParam problem with tone.js op: ", e);
                            if (e.printStackTrace)
                            {
                                e.printStackTrace();
                            }
                            throw e;
                        }
                    }
                    else
                    {
                        op.log("Warning: The value for an audio parameter is out of range!");
                    }
                } // native Web Audio param
                else if (node.minValue && node.maxValue)
                {
                    if (audioInNode >= node.minValue && audioInNode <= node.maxValue)
                    {
                        try
                        {
                            if (node.setValueAtTime)
                            {
                                node.setValueAtTime(audioInNode, audioCtx.currentTime);
                            }
                            else
                            {
                                node.value = audioInNode;
                            }
                        }
                        catch (e)
                        {
                            op.log(
                                "AudioParam has minValue / maxValue defined, and value is in range, but setting the value failed! ",
                                e,
                            );
                            if (e.printStackTrace)
                            {
                                e.printStackTrace();
                            }
                            throw e;
                        }
                    }
                    else
                    {
                        op.log("Warning: The value for an audio parameter is out of range!");
                    }
                } // no min-max values, try anyway
                else
                {
                    try
                    {
                        if (node.setValueAtTime)
                        {
                            node.setValueAtTime(audioInNode, audioCtx.currentTime);
                        }
                        else
                        {
                            node.value = audioInNode;
                        }
                    }
                    catch (e)
                    {
                        op.log("Possible AudioParam problem (without minValue / maxValue): ", e);
                        if (e.printStackTrace)
                        {
                            e.printStackTrace();
                        }
                        throw e;
                    }
                }

                if (port.webAudio.previousAudioInNode && port.webAudio.previousAudioInNode.disconnect)
                {
                    try
                    {
                        port.webAudio.previousAudioInNode.disconnect(node);
                    }
                    catch (e)
                    {
                        op.log("Could not disconnect previous audio node: ", e);
                        throw e;
                    }
                    port.webAudio.previousAudioInNode = undefined;
                }
            }
        }
        else
        {
            // disconnected
            if (port.webAudio.previousAudioInNode)
            {
            }
        }
    };
    return port;
};

/**
 * Loads an audio file and updates the loading indicators when cables is run in the editor.
 * @param {Patch} patch - The cables patch, when called from inside an op this is `op.patch`
 * @param {string} url - The url of the audio file to load
 * @param {function} onFinished - The callback to be called when the loading is finished, passes the AudioBuffer
 * @param {function} onError - The callback when there was an error loading the file, the rror message is passed
 * @param loadingTask
 * @see {@link https://developer.mozilla.org/de/docs/Web/API/AudioContext/decodeAudioData}
 */
WEBAUDIO.loadAudioFile = function (patch, url, onFinished, onError, loadingTask)
{
    const audioContext = WEBAUDIO.createAudioContext();

    if (!audioContext) onError(new Error("No Audiocontext"));

    let loadingId = null;
    if (loadingTask || loadingTask === undefined)
    {
        loadingId = patch.loading.start("audio", url);
        if (patch.isEditorMode()) gui.jobs().start({ "id": "loadaudio" + loadingId, "title": " loading audio (" + url + ")" });
    }
    const request = new XMLHttpRequest();

    if (!url) return;

    request.open("GET", url, true);
    request.responseType = "arraybuffer";

    request.onload = function ()
    {
        patch.loading.finished(loadingId);
        if (patch.isEditorMode()) gui.jobs().finish("loadaudio" + loadingId);

        audioContext.decodeAudioData(request.response, onFinished, onError).catch((e) =>
        {
            onError(e);
        });
    };
    request.send();
};

/**
 * Checks if the passed time is a valid time to be used in any of the Tone.js ops.
 * @param {(string|number)} t - The time to check
 * @returns {boolean} - True if time is valid, false if not
 */
WEBAUDIO.isValidToneTime = function (t)
{
    try
    {
        const time = new Tone.Time(t);
    }
    catch (e)
    {
        return false;
    }
    return true;
};

/**
 * Checks if the passed note is a valid note to be used with Tone.js
 * @param {string} note - The note to be checked, e.g. `"C4"`
 * @returns {boolean} - True if the note is a valid note, false otherwise
 */
WEBAUDIO.isValidToneNote = function (note)
{
    try
    {
        Tone.Frequency(note);
    }
    catch (e)
    {
        return false;
    }
    return true;
};



;// CONCATENATED MODULE: ./src/core/sessionvar.js
// todo: old... remove this from ops...

/**
 * todo: old... remove this from ops...
 *
 * @class
 */
const Variable = function ()
{
    let value = null;
    const changedCallbacks = [];

    this.onChanged = function (f)
    {
        changedCallbacks.push(f);
    };

    this.getValue = function ()
    {
        return value;
    };

    this.setValue = function (v)
    {
        value = v;
        this.emitChanged();
    };

    this.emitChanged = function ()
    {
        for (let i = 0; i < changedCallbacks.length; i++)
        {
            changedCallbacks[i]();
        }
    };
};



;// CONCATENATED MODULE: ./src/core/cgp/cgp_shader_default.wgsl
/* harmony default export */ const cgp_shader_default = ("\nstruct MyVSInput\n{\n    @location(0) position: vec3<f32>,\n    @location(1) normal: vec3<f32>,\n    @location(2) texcoord: vec2<f32>,\n};\n\nstruct MyVSOutput\n{\n    @builtin(position) position: vec4<f32>,\n    @location(0) normal: vec3<f32>,\n    @location(1) texcoord: vec2<f32>,\n};\n\n@vertex\nfn myVSMain(v: MyVSInput) -> MyVSOutput\n{\n    var vsOut: MyVSOutput;\n    var pos =vec4<f32>(v.position, 1.0);\n\n    var mvMatrix=vsUniforms.viewMatrix * vsUniforms.modelMatrix;\n    vsOut.position = vsUniforms.projMatrix * mvMatrix * pos;\n\n    vsOut.normal = v.normal;\n    vsOut.texcoord = v.texcoord;\n    return vsOut;\n}\n\n@fragment\nfn myFSMain(v: MyVSOutput) -> @location(0) vec4<f32>\n{\n    return fsUniforms.color+vec4<f32>(.5,.5,.5,1.0);\n}\n\n");
;// CONCATENATED MODULE: ./src/core/cgp/cgp_uniform.js



class CgpUniform extends CgUniform
{

    /** @type {CgpContext} */
    #cgp = null;

    /** @type {GPUBuffer} */
    gpuBuffer = null;

    gpuBufferChanged = false;

    constructor(__shader, __type, __name, _value, _port2, _port3, _port4)
    {
        super(__shader, __type, __name, _value, _port2, _port3, _port4);
        this.#cgp = __shader._cgp;

        if (!_value || (_value.get && !_value.get()))
        {
            // if (this.getType() == "m4") this._value = mat4.create();
            if (this.getType() == "t")
            {
                this._value = this.#cgp.getEmptyTexture();
                console.log("TEXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX", this._value);
            }
            // else if (this.getType() == "2f") this._value = [0, 0];
            // else if (this.getType() == "4f") this._value = [0, 1, 0, 1];
            // else if (this.getType() == "3f") this._value = [0, 1, 0];
        }

    }

    getInfo()
    {
        return { "name": this.name, "type": this.type, "value": this.getValue() };
    }

    updateValueF() { }

    updateValueArrayF() {}

    setValueArrayF(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    setValueF(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValue2F() { }

    setValue2F(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValue3F() { }

    setValue3F(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValue4F() { }

    setValue4F(v)
    {
        if (v[0] == undefined)
        {
            this._log.stack("uniform value undefined");
            console.error("uniform value undefined");
        }
        this.needsUpdate = true;
        this._value = v;
    }

    setValueT(v)
    {
        if (this._value != v)
            this._shader.needsPipelineUpdate = "texture changed"; // todo really needed ? change binding instead?

        this.needsUpdate = true;
        this._value = v;
    }

    updateValueM4(v) {}

    setValueM4(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    setValueAny(v)
    {
        this.needsUpdate = true;
        this._value = v;
    }

    updateValueAny() {}

    updateValueT() {}

    /**
     * @param {GPUBuffer} b
     */
    setGpuBuffer(b)
    {
        this.gpuBufferChanged = true;
        this.gpuBuffer = b;
    }

    copyToBuffer(buff, pos = 0)
    {
        if (this._type == "f")
        {
            buff[pos] = this._value;
        }
        else if (this._type == "t")
        {
        }
        else if (this._type == "4f")
        {
            buff[pos] = this._value[0];
            buff[pos + 1] = this._value[1];
            buff[pos + 2] = this._value[2];
            buff[pos + 3] = this._value[3];
        }
        else if (this._type == "2f")
        {
            buff[pos] = this._value[0];
            buff[pos + 1] = this._value[1];
        }
        else if (this._type == "3f")
        {
            buff[pos] = this._value[0];
            buff[pos + 1] = this._value[1];
            buff[pos + 2] = this._value[2];
        }
        else if (this._type == "f[]")
        {
            for (let i = 0; i < this._value.length; i++)
                buff[pos + i] = this._value[i];
        }
        else if (this._type == "m4")
        {
            for (let i = 0; i < 16; i++)
                buff[pos + i] = this._value[i];
        }
        else
        {
            this._log.warn("uniform copy to buffer unknown", this._type);
        }
    }

    getWgslTypeStr()
    {
        if (this._type == "m4") return "mat4x4f";
        if (this._type == "4f") return "vec4f";
        if (this._type == "3f") return "vec3f";
        if (this._type == "2f") return "vec2f";
        if (this._type == "f") return "float";
        if (this._type == "f[]") return "array<vec4f>";
        if (this._type == "i") return "int";
        if (this._type == "sampler") return "sampler";
        if (this._type == "t") return "texture_2d<f32>";
        this._log.warn("unknown type getWgslTypeStr", this._type);
        return "???";
    }

    getSizeBytes()
    {
        const bytesPerFloat = 4;
        const bytesPerInt = 4;
        if (this._type == "t") return 4;
        if (this._type == "sampler") return 4;
        if (this._type == "f") return 1 * bytesPerFloat;
        if (this._type == "2f") return 2 * bytesPerFloat;
        if (this._type == "3f") return 3 * bytesPerFloat;
        if (this._type == "4f") return 4 * bytesPerFloat;
        if (this._type == "f[]") return this._value.length * bytesPerFloat;
        if (this._type == "m4") return 4 * 4 * bytesPerFloat;
        if (this._type == "i") return 1 * bytesPerInt;
        if (this._type == "2i") return 2 * bytesPerInt;

        this._log.warn("unknown type getSizeBytes", this._type);
        return 4;
    }

    copy(newShader)
    {
        const uni = new Uniform(newShader, this._type, this._name, this._value, this._port2, this._port3, this._port4);
        uni.shaderType = this.shaderType;

        console.log(this._name, this._value, uni._value);

        return uni;
    }

}

;// CONCATENATED MODULE: ./src/core/cg/preproc.js
function preproc(str, vars)
{
    if (!str)
    {
        console.warn("shader preproc no shader code given");
    }
    str = str || "";
    const lines = str.split("\n");
    const outLines = [];
    let stack = [];

    for (let i = 0; i < lines.length; i++)
    {
        let line = lines[i].trim();
        let parts = line.split(" ");

        if (line.startsWith("#ifdef "))
        {
            const s = vars[parts[1]];
            stack.push({ "state": s });
            continue;
        }
        if (line.startsWith("#ifndef "))
        {
            const s = vars[parts[1]];
            stack.push({ "state": !s });
            continue;
        }
        if (line.startsWith("#endif"))
        {
            stack.pop();
            continue;
        }
        const state = stack[stack.length - 1];

        if (line.startsWith("#else"))
        {
            state.state = !state.state;
            continue;
        }

        if (!state || state.state)
        {
            outLines.push(lines[i]);
        }
    }

    return outLines.join("\n");
}

;// CONCATENATED MODULE: ./src/core/cgp/cgp_gpubuffer.js



/** @typedef GPUBufferOptions
 * @property {number} length
 * @property {GPUBufferDescriptor} [buffCfg]
*/

class CgpGguBuffer extends Events
{
    #name = "unknown";

    /** @type {CgpContext} */
    #cgp = null;

    /** @type {GPUBuffer} */
    #gpuBuffer = null;

    /** @type {GPUBufferDescriptor} */
    buffCfg = null;

    #length = 0;
    id = CABLES.shortId();
    floatArr = null;
    needsUpdate = true;
    #log;
    // presentationFormat = null;

    static BINDINGTYPE_STORAGE = "storage";
    static BINDINGTYPE_UNIFORM = "uniform";
    static BINDINGTYPE_READONLY_STORAGE = "read-only-storage";

    /**
     * Description
     * @param {CgpContext} cgp
     * @param {String} name
     * @param {Array} data=null
     * @param {GPUBufferOptions} options={}
     */
    constructor(cgp, name, data = null, options = null)
    {
        super();
        this.#log = new Logger("cgpGpubuffer");
        if (!cgp.supported) return;

        this.#name = name;
        this.setData([0, 0, 0, 0]);

        if (options.buffCfg) this.buffCfg = options.buffCfg;
        if (data) this.setData(data);
        if (options.length) this.setLength(options.length);

        this.updateGpuBuffer(cgp);
    }

    /**
     * @param {Array} arr
     */
    setData(arr)
    {
        this.floatArr = new Float32Array(arr);
        this.setLength(this.floatArr.length);

        this.needsUpdate = true;
    }

    /**
     * @param {number} s
     */
    setLength(s)
    {
        this.#length = s;
        if (!this.floatArr || s != this.floatArr.length)
        {
            this.floatArr = new Float32Array(this.#length);
            this.needsUpdate = true;
        }
    }

    /** @param {CgpContext} cgp */
    updateGpuBuffer(cgp = null)
    {
        if (cgp) this.#cgp = cgp;
        if (!this.#cgp || !this.#cgp.device)
        {
            this.#log.warn("no cgp...", this.#name, this.#cgp);
            return;
        }

        this.#cgp.pushErrorScope("updateGpuBuffer");
        if (!this.#gpuBuffer)
        {
            this.buffCfg = /** @type {GPUBufferDescriptor} */(this.buffCfg || {});
            this.buffCfg.label = "gpuBuffer-" + this.#name;
            if (!this.buffCfg.hasOwnProperty("size") && this.floatArr) this.buffCfg.size = this.floatArr.length * 4;
            this.buffCfg.usage = this.buffCfg.usage || (GPUBufferUsage.COPY_DST | GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_SRC);

            this.#gpuBuffer = this.#cgp.device.createBuffer(this.buffCfg);
        }

        if (this.floatArr)
            this.#cgp.device.queue.writeBuffer(
                this.#gpuBuffer,
                0,
                this.floatArr.buffer,
                this.floatArr.byteOffset,
                this.floatArr.byteLength
            );

        this.#cgp.popErrorScope();

        this.needsUpdate = false;
    }

    get name()
    {
        return this.#name;
    }

    /** @returns {GPUBuffer} */
    get gpuBuffer()
    {
        if (!this.#gpuBuffer || this.needsUpdate) this.updateGpuBuffer();

        return this.#gpuBuffer;
    }

    get length()
    {
        return this.#length;
    }

    getSizeBytes()
    {
        return this.floatArr.length * 4;
    }

    dispose()
    {
        // setTimeout(() =>
        // {
        //     if (this._gpuBuffer) this._gpuBuffer.destroy();
        // }, 100);
    }
}

;// CONCATENATED MODULE: ./src/core/cgp/cgp_binding.js






/**
     * @typedef CgpBindingOptions
     * @property {string} bindingType  "uniform", "storage", "read-only-storage","read-write-storage",
     * @property {string} [define]
     * @property {CgpShader} shader
     * @property {number} stage
     * @property {number} index
     */

class Binding
{
    #name = "";
    #options = {};
    #id = CABLES.simpleId();

    /** @type {CgpContext} */
    #cgp = null;

    /** @type {Array<CgpUniform>} */
    uniforms = [];

    /** @type {Array<CgpGguBuffer>} */
    cGpuBuffers = [];

    /** @type {CgpShader} */
    #shader = null;

    /** @type {Array<GPUBindGroupEntry>} */
    bindingInstances = [];

    bindingType = "uniform";
    isValid = true;
    changed = 0;
    #index = -1;

    define = "";

    /**
     * Description
     * @param {CgpContext} cgp
     * @param {String} name
     * @param {CgpBindingOptions} [options]
     */
    constructor(cgp, name, options)
    {
        this._log = new Logger("cgp_binding");
        if (!options) this._log.error("binding options is not an object", name);

        this.#name = name;
        this.#cgp = cgp;
        this.#options = options || {};
        this.define = this.#options.define || "";
        if (this.#options.bindingType) this.bindingType = this.#options.bindingType;
        this.stage = options.stage;
        // if (options.hasOwnProperty("index")) this.#index = options.index;
        this.#shader = options.shader;

        if (this.#shader)
        {
            if (this.stage == GPUShaderStage.FRAGMENT) this.#shader.bindingsFrag.push(this);
            else if (this.stage == GPUShaderStage.VERTEX) this.#shader.bindingsVert.push(this);
            else if (this.stage == GPUShaderStage.COMPUTE) this.#shader.bindingsCompute.push(this);
            else this._log.warn("unknown shader stage binding");

            // if (this.#index == -1) this.#index = this.shader.getNextBindingCounter();
        }

        // if (this.#index == -1) this._log.warn("binding could not get an index", this.#name);

        this.#cgp.on("deviceChange", () =>
        {
            // this.reInit();
        });
    }

    getStageString()
    {
        if (this.stage == GPUShaderStage.FRAGMENT) return "fragment";
        if (this.stage == GPUShaderStage.VERTEX) return "vertex";
        if (this.stage == GPUShaderStage.COMPUTE) return "compute";
        return "unknown";
    }

    getInfo()
    {
        return {
            "class": this.constructor.name,
            "name": this.#name,
            "id": this.#id,
            "stage": this.getStageString(),
            "bindingType": this.bindingType,
            "numUniforms": this.uniforms.length,
            "bindingIndex": this.getBindingIndex(),
            "numInstances": this.bindingInstances.length
        };
    }

    getBindingIndex()
    {
        if (this.#index == -1)
            this.#index = this.#shader.getNewBindingGroupIndex();

        return this.#index;
    }

    isStruct()
    {
        if (this.bindingType != "uniform") return false;
        if (this.uniforms.length == 0) return false;

        if (this.uniforms.length == 1)
        {
            if (this.uniforms[0].type == "t" || this.uniforms[0].type == "sampler") return false;
        }

        return true;
    }

    /**
     * @param {CgpShader} newShader
     * @returns {Binding}
     */
    copy(newShader)
    {
        const options = {};

        for (const i in this.#options)
            options[i] = this.#options[i];

        options.shader = newShader;

        let binding = new Binding(this.#cgp, this, this.#name);

        for (let i = 0; i < this.uniforms.length; i++)
        {
            binding.addUniform(newShader.getUniform(this.uniforms[i].name)); // .copy(newShader)
        }

        return binding;
    }

    /**
     * @param {CgpUniform} uni
     */
    addUniform(uni)
    {
        this.uniforms.push(uni);
    }

    getSizeBytes()
    {
        let size = 0;
        for (let i = 0; i < this.uniforms.length; i++)
        {
            // this._log.log("UNIFORM!!!", i, this.uniforms[i], this.uniforms[i].getSizeBytes());
            // this._log.log("getSizeBytes", this.uniforms[i], this.uniforms[i].getSizeBytes);
            size += this.uniforms[i].getSizeBytes();
        }
        // if (this.uniforms.length == 0)this._log.log("NO UNIFORMS!!!");

        if (this.uniforms.length == 0 && this.bindingType != "uniform")
        {
            return 300;
        }
        return size;
    }

    getShaderHeaderCode()
    {
        let str = "";
        let name = this.#name;
        let typeStr = "";

        if (!this.isActive)
        {
            str += "// " + typeStr + " " + this.#name + ": excluded because define " + this.#options.define + "\n";
            return str;
        }

        str += "// bindingType:" + this.bindingType + "\n";
        str += "// uniforms:" + this.uniforms.length + "\n";

        if (this.uniforms.length == 0 && this.bindingType == "uniform") return str + "// nothing.... \n\n";

        if (this.uniforms.length > 0)
        {
            typeStr = "strct_" + this.#name;
            str += "// " + this.uniforms.length + " uniforms\n";

            if (this.isStruct())
            {
                str += "struct " + typeStr + "\n";
                str += "{\n";
                for (let i = 0; i < this.uniforms.length; i++)
                {

                    str += "    " + this.uniforms[i].name + ": " + this.uniforms[i].getWgslTypeStr();
                    if (i != this.uniforms.length - 1)str += ",";
                    str += "\n";
                }
                str += "};\n";
            }
            else
            {
                typeStr = this.uniforms[0].getWgslTypeStr();
                name = this.uniforms[0].name;
            }
        }

        if (this.bindingType.includes("storage") && this.uniforms.length == 0)
        {
            typeStr = "array<f32>";
        }

        str += "@group(0) ";
        str += "@binding(" + this.getBindingIndex() + ") ";

        if (this.#options.gpuBuffer)
        {
            str += "var<storage,read_write> ";
        }
        else
        if (this.isStruct())
        {
            str += "var<" + this.bindingType + "> ";
        }
        else if (this.bindingType == "read-only-storage")str += "var<storage,read> ";
        else if (this.bindingType == "read-write")str += "var<storage,read_write> ";
        else
        {
            str += "var ";
            str += "/* unknown bindingtype: " + this.bindingType + " */";
        }

        str += name + ": " + typeStr + ";\n";

        // @group(0) @binding(0) var<storage, read_write> resultMatrix : array<f32>;

        // if (this.#options.define) str += "#endif\n";

        return str + "\n";
    }

    /** @returns {GPUBindGroupLayoutEntry} */
    getBindingGroupLayoutEntry()
    {

        if (!this.isActive)
        {
            console.log("binding", this.#name, "not active");
            return null;
        }

        let label = "layout " + this.#name + " [";
        for (let i = 0; i < this.uniforms.length; i++) label += this.uniforms[i].getName() + ",";
        label += "]";

        const o = {
            "label": label,
            "binding": this.getBindingIndex(),
            "visibility": this.stage,
            "size": this.getSizeBytes()
        };

        if (this.#options.gpuBuffer)
        {
            o.buffer = this.#options.gpuBuffer.gpuBuffer;
            o.buffer.type = this.bindingType;
        }
        else
        if (this.uniforms.length == 1 && this.uniforms[0].getType() == "t")
        {
            o.texture = {};
        }
        else if (this.uniforms.length == 1 && this.uniforms[0].getType() == "sampler")
        {
            o.sampler = {};
        }
        else
        {
            o.buffer = {};
            o.buffer.type = this.bindingType;
        }

        return o;
    }

    get isActive()
    {
        if (!this.define) return true;
        if (this.define && !this.#shader.hasDefine(this.define)) return false;
        return true;
    }

    /**
     * @param {number} inst
     * @returns {GPUBindGroupEntry}
     */
    getBindingGroupEntry(inst)
    {

        if (!this.isActive) return null;
        this.isValid = false;

        /** @type {GPUBindGroupEntry} */
        const o = {
            "label": this.#name + " binding",
            "binding": this.getBindingIndex(),
            "size": this.getSizeBytes(),
            "visibility": this.stage
        };

        this.bindingInstances[inst] = o;
        // if (this.uniforms.length == 0)
        // {
        //     console.log("binding uniforms length 0", this);
        //     return;
        // }

        if (this.uniforms.length == 1 && this.uniforms[0].getType() == "t")
        {
            if (this.uniforms[0].getValue() && this.uniforms[0].getValue().gpuTexture) o.resource = this.uniforms[0].getValue().gpuTexture.createView();
            else o.resource = this.#cgp.getEmptyTexture().createView();
        }
        else if (this.uniforms.length == 1 && this.uniforms[0].getType() == "sampler")
        {
            let smplDesc = {
                "addressModeU": "mirror-repeat",
                "addressModeV": "mirror-repeat",
                "magFilter": "linear",
                "minFilter": "linear",
                "mipmapFilter": "linear",
            };

            if (this.uniforms[0].getValue())
            {
                if (!this.uniforms[0].getValue().getSampler)
                {
                    this._log.error("uniform texture does not have function getSampler... not a WebGpu Texture?");
                }
                else
                {
                    smplDesc = this.uniforms[0].getValue().getSampler();
                    const sampler = this.#cgp.device.createSampler(smplDesc);
                    if (sampler)o.resource = sampler;
                }
            }
        }
        else
        {

            this._createCgpuBuffer(inst);
            o.resource = {
                "buffer": this.cGpuBuffers[inst].gpuBuffer,
                "minBindingSize": this.getSizeBytes(),
                "hasDynamicOffset": 0
            };
        }

        this.isValid = true;

        // if (o.hasOwnProperty("resource"))
        // {
        //     console.log("rrrrrr ", o.label, o.resource);
        // }

        return o;
    }

    /**
     * @param {any} inst
     */
    _createCgpuBuffer(inst)
    {
        let buffCfg = {
            "label": this.#name,
            "size": this.getSizeBytes(),
        };

        if (this.bindingType == "read-write-storage") buffCfg.usage = GPUBufferUsage.MAP_WRITE | GPUBufferUsage.COPY_SRC;
        else if (this.bindingType == "read-only-storage" || this.bindingType == "storage") buffCfg.usage = GPUBufferUsage.STORAGE | GPUBufferUsage.COPY_DST;
        else if (this.bindingType == "uniform") buffCfg.usage = GPUBufferUsage.COPY_DST | GPUBufferUsage.UNIFORM;
        else this._log.warn("unknown binding type", this.bindingType);

        if (this.cGpuBuffers[inst]) this.cGpuBuffers[inst].dispose();

        // if (this.uniforms.length > 0 && this.uniforms[0].gpuBuffer) this.cGpuBuffers[inst] = this.uniforms[0].gpuBuffer;
        // else
        this.cGpuBuffers[inst] = new CgpGguBuffer(this.#cgp, this.#name + " buff", null, { "buffCfg": buffCfg });
    }

    /**
     * @param {Number} inst
     */
    update(inst)
    {
        if (!this.isActive) return;

        let b = this.bindingInstances[inst];
        if (!b) b = this.getBindingGroupEntry(inst);

        if (this.uniforms.length == 1 && this.uniforms[0].gpuBuffer)
        {
            if (this.uniforms[0].gpuBuffer != this.cGpuBuffers[inst])
            {
                this._log.log("changed?!");
                // this.#shader.setWhyCompile("binding update"); // TODO this should actually just rebuild the bindinggroup i guess ?
            }

            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("binding update uni", this.uniforms[0].getName(), { "uni": this.uniforms[0].getInfo(), "data": this.cGpuBuffers[inst].floatArr });
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();
        }
        else
        if (this.uniforms.length == 1 && this.uniforms[0].getType() == "t")
        {
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("binding update uni texture", "texture " + this.uniforms[0].getName(), { "uni": this.uniforms[0].getInfo() });
            if (this.uniforms[0].getValue())
                if (this.uniforms[0].getValue().gpuTexture)
                {
                    this.bindingInstances[inst] = this.getBindingGroupEntry(inst);
                }
                else
                {
                    this._log.log("uni t has no gputexture");
                    b.resource = this.#cgp.getErrorTexture().createView();
                }

            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();
        }
        else if (this.uniforms.length == 1 && this.uniforms[0].getType() == "sampler")
        {
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("binding update uni sampler");
            b.resource = this.uniforms[0].getValue();
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();
        }
        else
        {
            let info = { "name": this.uniforms.length + " uniforms", "stage ": CgpShader.getStageString(this.stage), "inst": inst, "uniforms": [] };

            // this._log.log("B",this.);
            // update uniform values to buffer
            const s = this.getSizeBytes() / 4;

            // if (!this.cGpuBuffers[inst])
            // this._createCgpuBuffer(inst);
            // this.cGpuBuffers[inst] = new GPUBuffer(this._cgp, "buff", null, { "buffCfg": buffCfg });

            if (!this.cGpuBuffers[inst])
            {
                console.log("no cpubuff? ", this.stage, this.#name);
                return;
            }
            this.cGpuBuffers[inst].setLength(s);

            let off = 0;
            for (let i = 0; i < this.uniforms.length; i++)
            {

                // console.log("o");
                // if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("copy to", this.getStageString() + " " + this.bindingType, { "info": info });

                this.uniforms[i].copyToBuffer(this.cGpuBuffers[inst].floatArr, off); // todo: check if uniform changed?

                if (this.uniforms[i].gpuBufferChanged)
                {
                    console.log("un changed");
                }
                // if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();

                // console.log(this.cGpuBuffers[inst].floatArr);

                info.uniforms.push(this.uniforms[i].getInfo());

                // if (isNaN(this.cGpuBuffers[inst].floatArr[0]))
                // {
                // this._log.log("s", this.cGpuBuffers[inst].floatArr[0], this.uniforms[i].getName(), this.cGpuBuffers[inst].name, this.uniforms[i]);
                // }

                off += this.uniforms[i].getSizeBytes() / 4;
            }
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("binding update buff", this.getStageString() + " " + this.bindingType, { "info": info });

            // this._log.log("upodate", inst);

            this.cGpuBuffers[inst].updateGpuBuffer();
            // todo: only if changed...
            // cgp.device.queue.writeBuffer(
            //     b.resource.buffer,
            //     0,
            //     this._buffer.buffer,
            //     this._buffer.byteOffset,
            //     this._buffer.byteLength
            // );

            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();
        }
    }
}

;// CONCATENATED MODULE: ./src/core/cgp/cgp_shader.js







/** @typedef CgpShaderOptions
 * @property {Boolean} [compute]
 * @property {String} [entryPoint]
 */

class CgpShader extends CgShader
{

    #computePipeline;
    #lastCompileReason = "first";

    /**
     * @param {CgpContext} _cgp
     * @param {String} _name
     * @param {CgpShaderOptions} options={}
     */
    constructor(_cgp, _name, options = {})
    {
        super();
        if (!_cgp) throw new Error("shader constructed without cgp " + _name);
        this._log = new Logger("cgp_shader");
        this._cgp = _cgp;
        this._name = _name;
        this._uniforms = [];
        this.options = options;
        this.options.compute = this.options.compute || false;

        if (!_name) this._log.stack("no shader name given");
        this._name = _name || "unknown";
        this.gpuShaderModule = null;
        this.frameUsageCounter = 0;
        this.lastFrameUsageCounter = -2;
        this.frameUsageFrame = -1;

        this._bindingIndexCount = 0;
        this._compileCount = 0;

        /** @type {Array<Binding>} */
        this.bindingsFrag = [];

        /** @type {Array<Binding>} */
        this.bindingsVert = [];

        /** @type {Array<Binding>} */
        this.bindingsCompute = [];// this.defaultBindingCompute

        /** @type {Binding} */
        this.defaultBindingCompute = null;

        /** @type {Binding} */
        this.defaultBindingVert = null;

        /** @type {Binding} */
        this.defaultBindingFrag = null;

        if (!this.options.compute)
        {
            this.defaultBindingVert = new Binding(_cgp, "vsUniforms", { "shader": this, "stage": GPUShaderStage.VERTEX, "bindingType": "uniform", "index": this.getNewBindingGroupIndex() });
            this.defaultBindingFrag = new Binding(_cgp, "fsUniforms", { "shader": this, "stage": GPUShaderStage.FRAGMENT, "bindingType": "uniform", "index": this.getNewBindingGroupIndex() });
        }
        else
        {
            this.defaultBindingCompute = new Binding(_cgp, "computeUniforms", { "shader": this, "stage": GPUShaderStage.COMPUTE, "bindingType": "uniform", "index": this.getNewBindingGroupIndex() });
        }

        if (!this.options.compute)
        {
            this.uniModelMatrix = this.addUniformVert("m4", "modelMatrix");
            this.uniViewMatrix = this.addUniformVert("m4", "viewMatrix");
            this.uniProjMatrix = this.addUniformVert("m4", "projMatrix");
            this.uniNormalMatrix = this.addUniformVert("m4", "normalMatrix");
            this.uniModelViewMatrix = this.addUniformVert("m4", "modelViewMatrix");
            this._tempNormalMatrix = mat4.create();
            this._tempModelViewMatrix = mat4.create();
        }

        this._src = "";

        this._cgp.on("deviceChange", () =>
        {

            this.gpuShaderModule = null;
            this.setWhyCompile("device changed");

        });
    }

    reInit()
    {

    }

    get isValid()
    {
        return this._isValid;
    }

    get uniforms()
    {
        return this._uniforms;
    }

    getName()
    {
        return this._name;
    }

    incFrameUsageCount()
    {
        if (this.frameUsageFrame != this._cgp.frame)
        {
            this.lastFrameUsageCounter = this.frameUsageCounter;
            this.frameUsageCounter = 0;
        }
        else this.frameUsageCounter++;
        this.frameUsageFrame = this._cgp.frame;

        return this.frameUsageCounter;
    }

    getNewBindingGroupIndex()
    {
        return ++this._bindingIndexCount;
    }

    /**
     * @param {String} src
     */
    setSource(src)
    {
        this._src = src;
        this.setWhyCompile("Source changed");
    }

    /**
     * @param {String} vs
     */
    _replaceMods(vs)
    {
        let srcHeadVert = "";
        for (let i = 0; i < this._moduleNames.length; i++)
        {
            let srcVert = "";

            for (let j = 0; j < this._modules.length; j++)
            {
                const mod = this._modules[j];
                if (mod.name == this._moduleNames[i])
                {
                    srcHeadVert += "\n//---- MOD: group:" + mod.group + ": idx:" + j + " - prfx:" + mod.prefix + " - " + mod.title + " ------\n";

                    srcVert += "\n\n//---- MOD: " + mod.title + " / " + mod.priority + " ------\n";

                    if (mod.attributes)
                        for (let k = 0; k < mod.attributes.length; k++)
                        {
                            const r = this._getAttrSrc(mod.attributes[k], false);
                            if (r.srcHeadVert)srcHeadVert += r.srcHeadVert;
                            if (r.srcVert)srcVert += r.srcVert;
                        }

                    srcHeadVert += mod.srcHead || "";
                    srcVert += mod.srcBody || "";

                    srcHeadVert += "\n//---- end mod ------\n";

                    srcVert += "\n//---- end mod ------\n";

                    srcVert = srcVert.replace(/{{mod}}/g, mod.prefix);
                    srcHeadVert = srcHeadVert.replace(/{{mod}}/g, mod.prefix);

                    srcVert = srcVert.replace(/MOD_/g, mod.prefix);
                    srcHeadVert = srcHeadVert.replace(/MOD_/g, mod.prefix);
                }
            }

            vs = vs.replace("{{" + this._moduleNames[i] + "}}", srcVert);
        }

        vs = vs.replace("{{MODULES_HEAD}}", srcHeadVert);
        return vs;
    }

    getProcessedSource()
    {
        const defs = {};
        for (let i = 0; i < this._defines.length; i++)
            defs[this._defines[i][0]] = this._defines[i][1] || true;

        let src = "";
        src += preproc(this._src, defs);

        let strDefs = "";
        for (let i = 0; i < this._defines.length; i++)
            strDefs += "// #define " + this._defines[i] + "\n";

        if (this.options.compute)
        {
            let bindingsHeadCompute = "";
            for (let i = 0; i < this.bindingsCompute.length; i++)
            {
                if (!this.bindingsCompute[i]) continue;
                bindingsHeadCompute += "// bindingsCompute " + i + "\n";
                bindingsHeadCompute += this.bindingsCompute[i].getShaderHeaderCode();
            }

            src = bindingsHeadCompute + "\n\n//////////////// \n\n" + src;
        }
        else
        {

            let bindingsHeadVert = "";
            for (let i = 0; i < this.bindingsFrag.length; i++)
                bindingsHeadVert += this.bindingsFrag[i].getShaderHeaderCode();

            let bindingsHeadFrag = "";
            for (let i = 0; i < this.bindingsVert.length; i++)
                bindingsHeadFrag += this.bindingsVert[i].getShaderHeaderCode();

            src = bindingsHeadFrag + "\n\n////////////////\n\n" + bindingsHeadVert + "\n\n////////////////\n\n" + src;

        }

        src = this._replaceMods(src);

        src = strDefs + "\n" + src;

        let srcHead = "//".endl() + "// ";
        if (this.options.compute)srcHead += "Compute ";
        else srcHead += "Render ";

        srcHead += "Shader: " + this._name.endl();
        srcHead += "//".endl().endl();

        return srcHead + src;
    }

    compile()
    {
        this._isValid = true;
        this._cgp.pushErrorScope("cgp_shader " + this._name);

        if (this._cgp.branchProfiler) this._cgp.branchProfiler.push("shadercompile", this._name, { "info": this.getInfo() });

        this.gpuShaderModule = this._cgp.device.createShaderModule({ "code": this.getProcessedSource(), "label": this._name });
        this._cgp.popErrorScope(this.error.bind(this));

        this.#lastCompileReason = this._compileReason;

        // console.log("#lastCompileReason", this.#lastCompileReason);

        this.emitEvent("compiled", this._compileReason);
        this._needsRecompile = false;
        this._compileReason = "none";
        this._compileCount++;
        if (this._cgp.branchProfiler) this._cgp.branchProfiler.pop();
    }

    error(e)
    {
        this._isValid = false;
    }

    bind()
    {

        this.incFrameUsageCount();
        if (!this.options.compute)
        {
            this.uniModelMatrix.setValue(this._cgp.mMatrix);
            this.uniViewMatrix.setValue(this._cgp.vMatrix);
            this.uniProjMatrix.setValue(this._cgp.pMatrix);

            // mat4.invert(this._tempNormalMatrix, this._cgp.mMatrix);
            // mat4.transpose(this._tempNormalMatrix, this._tempNormalMatrix);
            mat4.mul(this._tempModelViewMatrix, this._cgp.vMatrix, this._cgp.mMatrix);
            this.uniModelViewMatrix.setValue(this._tempModelViewMatrix);

            mat4.copy(this._tempNormalMatrix, this._cgp.mMatrix);
            mat4.invert(this._tempNormalMatrix, this._tempNormalMatrix);
            mat4.transpose(this._tempNormalMatrix, this._tempNormalMatrix);

            // cpu billboarding?
            // this._tempModelViewMatrix[0 * 4 + 0] = 1.0;
            // this._tempModelViewMatrix[0 * 4 + 1] = 0.0;
            // this._tempModelViewMatrix[0 * 4 + 2] = 0.0;

            // // #ifndef BILLBOARDING_CYLINDRIC
            // this._tempModelViewMatrix[1 * 4 + 0] = 0.0;
            // this._tempModelViewMatrix[1 * 4 + 1] = 1.0;
            // this._tempModelViewMatrix[1 * 4 + 2] = 0.0;
            // // #endif

            // this._tempModelViewMatrix[2 * 4 + 0] = 0.0;
            // this._tempModelViewMatrix[2 * 4 + 1] = 0.0;
            // this._tempModelViewMatrix[2 * 4 + 2] = 1.0;

            this.uniNormalMatrix.setValue(this._tempNormalMatrix);
        }

        if (this._needsRecompile) this.compile();
    }

    /**
     * add a uniform to the fragment shader
     * @param {String} type ['f','t', etc]
     * @param {String} name
     * @param {any} valueOrPort value or port
     * @param p2
     * @param p3
     * @param p4
     * @memberof Shader
     * @instance
     * @function addUniformFrag
     * @returns {CgpUniform}
     */
    addUniformFrag(type, name, valueOrPort, p2, p3, p4)
    {
        const uni = new CgpUniform(this, type, name, valueOrPort, p2, p3, p4);
        uni.shaderType = "frag";

        this.defaultBindingFrag.addUniform(uni);
        this.needsPipelineUpdate = "add frag uniform";

        return uni;
    }

    /**
     * add a uniform to the vertex shader
     * @param {String} type ['f','t', etc]
     * @param {String} name
     * @param {any} valueOrPort value or port
     * @param p2
     * @param p3
     * @param p4
     * @memberof Shader
     * @instance
     * @function addUniformVert
     * @returns {CgpUniform}
     */
    addUniformVert(type, name, valueOrPort, p2, p3, p4)
    {
        const uni = new CgpUniform(this, type, name, valueOrPort, p2, p3, p4);
        uni.shaderType = "vert";

        this.defaultBindingVert.addUniform(uni);
        this.needsPipelineUpdate = "add vert uniform";

        return uni;
    }

    /**
     * @typedef UniformDescriptor
     * @property {String} name
     * @property {Number} shaderType GPUShaderStage.FRAGMENT
     * @property {String} type 4f,f, etc
     * @property {Array} values ports or numbers
    */

    /**
     * @param {UniformDescriptor} o
     */
    addUniformObject(o)
    {
        if (!o.type) this._log.warn("no uni type: ", o.type);
        if (!o.name) this._log.warn("no uni name: ", o.name);

        const uni = new CgpUniform(this, o.type, o.name, o.values[0]);

        if (o.shaderType == GPUShaderStage.COMPUTE)
        {
            this.defaultBindingCompute.addUniform(uni);
            uni.shaderType = "compute";
        }
        else if (o.shaderType == GPUShaderStage.VERTEX)
        {
            this.defaultBindingVert.addUniform(uni);
            uni.shaderType = "vert";
        }
        else if (o.shaderType == GPUShaderStage.FRAGMENT)
        {
            this.defaultBindingFrag.addUniform(uni);
            uni.shaderType = "frag";
        }
        else this._log.warn("unknown shaderType: ", o.shaderType);

        this.needsPipelineUpdate = "add " + o.shaderType + " uniform";
        return uni;
    }

    /**
     * @param {CgpUniform} uni
     */
    _addUniform(uni)
    {
        this._uniforms.push(uni);
        this.setWhyCompile("add uniform " + name);
    }

    /**
     * @param {String} name
     */
    getUniform(name)
    {
        for (let i = 0; i < this._uniforms.length; i++)
        {
            if (this._uniforms[i].getName() == name) return this._uniforms[i];
        }
    }

    /**
     * copy current shader
     * @function copy
     * @memberof Shader
     * @instance
     * @returns newShader
     */
    copy()
    {
        const shader = new CgpShader(this._cgp, this._name + " copy");
        shader.setSource(this._src);

        shader._modules = JSON.parse(JSON.stringify(this._modules));
        shader._defines = JSON.parse(JSON.stringify(this._defines));

        shader._modGroupCount = this._modGroupCount;
        shader._moduleNames = this._moduleNames;

        // shader.glPrimitive = this.glPrimitive;
        // shader.offScreenPass = this.offScreenPass;
        // shader._extensions = this._extensions;
        // shader.wireframe = this.wireframe;
        // shader._attributes = this._attributes;

        for (let i = 0; i < this._uniforms.length; i++) this._uniforms[i].copy(shader);

        shader.bindingsFrag = [];
        for (let i = 0; i < this.bindingsFrag.length; i++) this.bindingsFrag[i].copy(shader);
        shader.defaultBindingFrag = this.bindingsFrag[0];

        shader.bindingsVert = [];
        for (let i = 0; i < this.bindingsVert.length; i++) this.bindingsVert[i].copy(shader);
        shader.defaultBindingVert = this.bindingsVert[0];

        shader.bindingsCompute = [];
        for (let i = 0; i < this.bindingsCompute.length; i++) this.bindingsCompute[i].copy(shader);
        shader.defaultBindingComp = this.bindingsCompute[0];

        console.log("copyyyyyyyyyy", shader.bindingsVert, this.bindingsVert);

        this.setWhyCompile("copy");
        return shader;
    }

    /**
     * copy all uniform values from another shader
     * @function copyUniforms
     * @memberof Shader
     * @instance
     * @param origShader uniform values will be copied from this shader
     */
    copyUniformValues(origShader)
    {
        for (let i = 0; i < origShader._uniforms.length; i++)
        {
            if (!this._uniforms[i])
            {
                this._log.log("unknown uniform?!");
                continue;
            }
            this.getUniform(origShader._uniforms[i].getName()).set(origShader._uniforms[i].getValue());
        }

        // this.popTextures();
        // for (let i = 0; i < origShader._textureStackUni.length; i++)
        // {
        //     this._textureStackUni[i] = origShader._textureStackUni[i];
        //     this._textureStackTex[i] = origShader._textureStackTex[i];
        //     this._textureStackType[i] = origShader._textureStackType[i];
        //     this._textureStackTexCgl[i] = origShader._textureStackTexCgl[i];
        // }
    }

    dispose()
    {

    }

    /**
     * @param {number} stage
     */
    static getStageString(stage)
    {
        if (stage == GPUShaderStage.FRAGMENT) return "frag";
        if (stage == GPUShaderStage.VERTEX) return "vertex";
        if (stage == GPUShaderStage.COMPUTE) return "compute";

    }

    getInfo()
    {
        return {
            "class": this.constructor.name,
            "name": this._name,
            "frameUsageCounter": this.lastFrameUsageCounter,
            "lastCompileReason": this.#lastCompileReason,
            "compileCount": this._compileCount,
            "numUniforms": this.uniforms.length,
            "numDefines": this._defines.length,
            "isCompute": this.options.compute
        };
    }
}

;// CONCATENATED MODULE: ./src/core/cgp/cgp_texture.js




class cgp_texture_Texture extends CgTexture
{
    #log = new Logger("cgp_texture");
    #cgp = null;
    gpuTexture = null;
    gpuTextureDescriptor = null;
    name = "unknown";
    width = 8;
    height = 8;
    textureType = "???";

    samplerDesc = {};

    /**
    * @param {CgpContext} _cgp
    * @param {Object} options={}
    */
    constructor(_cgp, options = {})
    {
        super(options);
        options = options || {};

        this.#cgp = _cgp;
        if (!this.#cgp) throw new Error("no cgp");

        if (options.name) this.name = options.name;
        if (options.height && options.width) this.setSize(options.width, options.height);

        this.#cgp.on("deviceChange", () =>
        {
        });
        this.samplerDesc = {
            "addressModeU": options.wrap || options.addressModeU || "clamp-to-edge",
            "addressModeV": options.wrap || options.addressModeV || "clamp-to-edge",
            "magFilter": options.magFilter || options.filter || "linear",
            "minFilter": options.minFilter || options.filter || "linear",
        };

    }

    /**
     * @param {Number} w
     * @param {Number} h
     */
    setSize(w, h)
    {
        this.width = w;
        this.height = h;
    }

    /**
     * set texture data from an image/canvas object
     * @function initTexture
     * @memberof Texture
     * @instance
     * @param {Object} img image
     * @param {Number} filter
     */
    initTexture(img, filter)
    {
        this.width = img.width;
        this.height = img.height;

        const textureType = "rgba8unorm";

        this.#cgp.pushErrorScope("inittexture", { "logger": this.#log });

        this.gpuTextureDescriptor = {

            "size": { "width": img.width, "height": img.height },
            "format": textureType,
            // "sampleCount": 4,
            "usage": GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST | GPUTextureUsage.RENDER_ATTACHMENT
        };

        this.gpuTexture = this.#cgp.device.createTexture(this.gpuTextureDescriptor);
        this.#cgp.device.queue.copyExternalImageToTexture({ "source": img }, { "texture": this.gpuTexture }, this.gpuTextureDescriptor.size);

        this.#cgp.popErrorScope();

        return this.gpuTexture;
    }

    dispose()
    {
        console.log("todo dispose");
    }

    getInfo()
    {
        const obj = {};

        obj.name = this.name || "???";
        obj.size = this.width + " x " + this.height;

        obj.textureType = this.textureType;

        return obj;
    }

    createView()
    {
        if (!this.gpuTexture)
        {
            console.log("no gputexture...");
            return null;
        }
        return this.gpuTexture.createView();
    }

    getSampler()
    {
        // "clamp-to-edge"
        // "repeat"
        // "mirror-repeat"

        return this.samplerDesc;
    }

    /**
     * @function initFromData
     * @memberof Texture
     * @instance
     * @description create texturem from rgb data
     * @param {Array<Number>} data rgb color array [r,g,b,a,r,g,b,a,...]
     * @param {Number} w width
     * @param {Number} h height
     * @param {Number} filter
     * @param {Number} wrap
     */
    initFromData(data, w, h, filter, wrap)
    {
        if (!w || !h) this.#log.error("texture size is 0");
        this.width = w;
        this.height = h;
        this.gpuTexture = this.#cgp.device.createTexture(
            {
                "size": [w, h],
                "format": "rgba8unorm",
                "usage": GPUTextureUsage.TEXTURE_BINDING | GPUTextureUsage.COPY_DST | GPUTextureUsage.RENDER_ATTACHMENT,
            });

        this.#cgp.device.queue.writeTexture(
            { "texture": this.gpuTexture },
            data,
            { "bytesPerRow": w * 4 },
            { "width": w, "height": h });
    }

    setWrap(v)
    {
        this.samplerDesc.addressModeU = this.samplerDesc.addressModeV = v;
    }

    setFilter(v)
    {
        this.samplerDesc.minFilter = this.samplerDesc.magFilter = v;
    }
}

/**
 * @function load
 * @static
 * @memberof Texture
 * @description load an image from an url
 * @param {Context} cgp
 * @param {String} url
 * @param {Function} onFinished
 * @param {Object} settings
 * @return {Texture}
 */
cgp_texture_Texture.load = function (cgp, url, onFinished, settings)
{
    fetch(url).then((response) =>
    {
        const texture = new cgp_texture_Texture(cgp, { "name": url });

        response.blob().then((blob) =>
        {
            createImageBitmap(blob).then((imgBitmap) =>
            {
                texture.initTexture(imgBitmap);
                if (onFinished)onFinished(texture);
                else console.log("Texture.load no onFinished callback");
            }).catch((err) =>
            {
                if (onFinished)onFinished(cgp.getErrorTexture());
            });
        });
    });
};

;// CONCATENATED MODULE: ./src/core/cgp/cgp_pipeline.js
/// <reference types="@webgpu/types" />





class Pipeline
{
    static DEPTH_COMPARE_FUNCS_STRINGS = ["never", "less", "equal", "lessequal", "greater", "notequal", "greaterequal", "always"];

    static TYPE_RENDER = 0;
    static TYPE_COMPUTE = 1;

    #log = new Logger("pipeline");
    #name = "";

    /** @type {CgpContext} */
    #cgp = null;
    #isValid = true;

    /** @type {GPURenderPipelineDescriptor|GPUComputePipelineDescriptor} */
    #pipeCfg = null;

    /** @type {GPUComputePipeline|GPURenderPipeline} */
    #renderPipeline = null;

    /** @type {GPUBindGroupLayout} */
    bindGroupLayout = null;

    /** @type {Array<GPUBindGroup>} */
    #bindingInstances = [];

    /** @type {GPURenderPassEncoder|GPUComputePassEncoder} */
    #passEncoder;

    #shaderListeners = [];
    #old = {};
    #errorCount = 0;
    #type = Pipeline.TYPE_RENDER;
    lastRebuildReason = "first";
    rebuildCount = 0;
    profile = false;
    #rebuildNumBindingGroups = false;

    profiler;

    /**
     * Description
     * @param {CgpContext} _cgp
     * @param {String} name
     * @param {Number} type
     */
    constructor(_cgp, name, type = 0)
    {
        if (!_cgp) throw new Error("Pipeline constructed without cgp " + name);
        this.#name = name;
        this.#cgp = _cgp;
        this.#type = type;

        this.#cgp.on("deviceChange", () =>
        {
            this.#renderPipeline = null;
        });
    }

    get isValid() { return this.#isValid; }

    /**
     * @param {String} name
     */
    setName(name)
    {
        this.#name = name;
    }

    /**
     * @param {CgpShader} oldShader
     * @param {CgpShader} newShader
     */
    setShaderListener(oldShader, newShader)
    {
        for (let i = 0; i < this.#shaderListeners.length; i++) oldShader.off(this.#shaderListeners[i]);

        this.#shaderListeners.push(
            newShader.on("compiled", (reason) =>
            {
                // this._log.log("pipe update shader compileeeeeee");
                // this.needsRebuildReason = "shader changed";
                this.needsRebuildReason = "shader compiled: " + reason || 0;
            }));
    }

    getInfo()
    {
        const info = {
            "class": this.constructor.name,
            "name": this.#name,
            "rebuildReason": this.lastRebuildReason,
            "rebuildCount": this.rebuildCount,
            "numBindgroups": this.#bindingInstances.length,
            "bindingGroupLayoutEntries": this.bindingGroupLayoutEntries,
        };

        if (this.#type == Pipeline.TYPE_COMPUTE)info.type = "COMPUTE";
        if (this.#type == Pipeline.TYPE_RENDER)info.type = "RENDER";

        return info;
    }

    pushDebug()
    {
        this.#cgp.currentPipeDebug =
        {
            "cfg": this.#pipeCfg,
            "bindingGroupLayoutEntries": this.bindingGroupLayoutEntries
        };
    }

    /**
     * @param {CgpShader} shader
     * @param {CgpMesh} mesh
     */
    setPipeline(shader, mesh = null,)
    {
        if (this.#type == Pipeline.TYPE_RENDER)
        {
            if (!mesh)
            {
                this.#log.log("pipeline unknown mesh");
                return;
            }
        }
        if (!shader)
        {
            this.#log.log("pipeline unknown shader");
            return;
        }

        if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("setPipeline", this.#name, { "info": this.getInfo(), "shader": shader.getInfo() });

        let needsRebuildReason = "";
        if (!this.#renderPipeline) needsRebuildReason = "no renderpipeline";
        if (!this.#pipeCfg)needsRebuildReason = "no pipecfg";
        if (this.#old.mesh != mesh)needsRebuildReason = "no mesh";
        if (this.#old.shader != shader)
        {
            this.setShaderListener(this.#old.shader, shader);
            console.log("shader changed?!@");
            needsRebuildReason = "shader changed";
        }

        if (shader.needsPipelineUpdate)
        {
            needsRebuildReason = "shader needs update: " + shader.needsPipelineUpdate;
            shader.needsPipelineUpdate = "";
        }

        if (this.#type == Pipeline.TYPE_RENDER && mesh.needsPipelineUpdate)
        {
            needsRebuildReason = "mesh needs update";
            mesh.needsPipelineUpdate = false;
        }

        if (this.#rebuildNumBindingGroups)
        {
            needsRebuildReason = "num bindgroups wrong...";
        }

        if (this.#pipeCfg)
        {
            if (this.#type == Pipeline.TYPE_RENDER)
            {
                this.#pipeCfg =/** @type {GPURenderPipelineDescriptor} */ (this.#pipeCfg || {});
                if (this.#pipeCfg.depthStencil.depthWriteEnabled != this.#cgp.stateDepthWrite())
                {
                    needsRebuildReason = "depth changed";
                    this.#pipeCfg.depthStencil.depthWriteEnabled = !!this.#cgp.stateDepthWrite();
                }

                if (this.#pipeCfg.fragment.targets[0].blend != this.#cgp.stateBlend())
                {
                    needsRebuildReason = "blend changed";
                    this.#pipeCfg.fragment.targets[0].blend = this.#cgp.stateBlend();
                }

                if (this.#cgp.stateDepthTest() === false)
                {
                    if (this.#pipeCfg.depthStencil.depthCompare != "never")
                    {
                        this.#pipeCfg.depthStencil.depthCompare = "never";
                        needsRebuildReason = "depth compare changed";
                    }
                }
                else
                if (this.#pipeCfg.depthStencil.depthCompare != this.#cgp.stateDepthFunc())
                {
                    needsRebuildReason = "depth state ";
                    this.#pipeCfg.depthStencil.depthCompare = this.#cgp.stateDepthFunc();
                }

                // if (this.#pipeCfg.primitive.cullMode != this.#cgp.stateCullFaceFacing())
                // {
                //     needsRebuildReason = "cullmode change";
                //     // this.#pipeCfg.primitive.cullMode = this.#cgp.stateCullFaceFacing();
                // console.log(this.#cgp.stateCullFaceFacing());
                // }

            }

        }

        this.pushDebug();

        if (needsRebuildReason != "")
        {
            this.lastRebuildReason = needsRebuildReason;
            this.rebuildCount++;
            // console.log("needsRebuildReason");
            console.log("rebuild pipe", needsRebuildReason);
            this.#cgp.pushErrorScope("createPipeline", { "logger": this.#log });

            this.#bindingInstances = [];
            this.#rebuildNumBindingGroups = false;

            this.#pipeCfg = this.getPipelineObject(shader);
            console.log(this.#pipeCfg);

            this.#old.device = this.#cgp.device;
            this.#old.shader = shader;
            this.#old.mesh = mesh;
            this.#isValid = true;

            try
            {

                if (this.#type == Pipeline.TYPE_RENDER) this.#renderPipeline = this.#cgp.device.createRenderPipeline(this.#pipeCfg);
                else if (this.#type == Pipeline.TYPE_COMPUTE) this.#renderPipeline = this.#cgp.device.createComputePipeline(this.#pipeCfg);

                // if (this.#bindGroups[shader.bindingCounter])
                // {
                //     console.log("bindgroupppppppp", this.#bindGroups[shader.bindingCounter]);
                // }

                // this.#computePipeline = this._cgp.device.createComputePipeline({
                //     "layout": "auto",
                //     "compute": {
                //         "module": this.gpuShaderModule,
                //         "entryPoint": this.options.entryPoint || "main"
                //     }
                // });

            }
            catch (e)
            {

                console.error("pipe error catch...", e.message, this.#pipeCfg);
                this.#isValid = false;
            }

            this.#cgp.popErrorScope(
                () =>
                {
                    console.log("this.#pipeCfg", this.#pipeCfg);
                });
        }

        if (this.#renderPipeline && this.#isValid)
        {
            this.#cgp.pushErrorScope("setpipeline", { "logger": this.#log });

            let passEnc = this.#cgp.passEncoder;

            if (this.#type != Pipeline.TYPE_RENDER) passEnc = this.#passEncoder;

            // this.#passEncoder.setPipeline(this.#renderPipeline);
            // this.#cgp.passEncoder.setPipeline(this.#renderPipeline);
            // else

            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("pipe updateUniforms", this.#name, { "shader": shader.getInfo() });

            // console.log("shader.frameUsageCounter", shader.frameUsageCounter);

            if (!this.#bindingInstances[shader.frameUsageCounter])
            {
                console.log("create bindgroups....");
                const bindingGroupEntries = [];

                if (this.#type == Pipeline.TYPE_RENDER && shader.bindingsVert)
                    for (let i = 0; i < shader.bindingsVert.length; i++)
                    {
                        if (shader.bindingsVert[i] && shader.bindingsVert[i].getSizeBytes() > 0)
                        {
                            const entry = shader.bindingsVert[i].getBindingGroupEntry(shader.frameUsageCounter);
                            if (entry)bindingGroupEntries.push(entry);
                        }
                        else this.#log.log("shader defaultBindingVert size 0");
                    }

                if (this.#type == Pipeline.TYPE_RENDER && shader.bindingsFrag)
                    for (let i = 0; i < shader.bindingsFrag.length; i++)
                    {
                        if (shader.bindingsFrag[i] && shader.bindingsFrag[i].getSizeBytes() > 0)
                        {
                            const entry = shader.bindingsFrag[i].getBindingGroupEntry(shader.frameUsageCounter);
                            if (entry)bindingGroupEntries.push(entry);
                        }
                        else this.#log.log("shader defaultBindingFrag size 0");
                    }

                if (this.#type == Pipeline.TYPE_COMPUTE && shader.bindingsCompute)
                    for (let i = 0; i < shader.bindingsCompute.length; i++)
                    {
                        if (shader.bindingsCompute[i] && shader.bindingsCompute[i].getSizeBytes() > 0)
                        {
                            const entry = shader.bindingsCompute[i].getBindingGroupEntry(shader.frameUsageCounter);
                            if (entry)bindingGroupEntries.push(entry);
                        }
                        else this.#log.log("shader defaultBindingCompute size 0");
                    }

                /** @type {GPUBindGroupDescriptor} */
                const bg = {
                    "label": "pipe bg " + this.#name,
                    "layout": this.bindGroupLayout,
                    "entries": bindingGroupEntries
                };

                if (bindingGroupEntries.length != this.bindingGroupLayoutEntries.length)
                {
                    this.#log.error("bindingGroupEntries.length!= this.bindingGroupLayoutEntries.length", bindingGroupEntries.length, this.bindingGroupLayoutEntries.length);
                    this.#rebuildNumBindingGroups = true;
                    this.#isValid = false;
                    return;
                }

                try
                {
                    // TODO bindgroup counter somehow ?!?!?!??!
                    this.#bindingInstances[shader.frameUsageCounter] = this.#cgp.device.createBindGroup(bg);

                }
                catch (e)
                {
                    this.#errorCount++;
                    if (this.#errorCount == 3) console.log("stopping error logging for cgp pipeline");
                    if (this.#errorCount >= 3) return;

                    console.log(bg);
                    console.error(e);
                    console.log("error mesh:", this.#name);
                }

            }

            /// ///////////////////

            // console.log("shader.bindingCounter", shader.bindingCounter, this.#bindGroups.length);

            // for (let i = 0; i < this.#bindingInstances.length; i++)
            // {
            //     // console.log("stBG", i, this.#bindGroups[i]);
            //     if (!this.#bindingInstances[i])
            //     {
            //         console.log("bindgroup " + i + " is undefined?!");
            //         // return;
            //     }
            //     else
            //         this.#cgp.passEncoder.setBindGroup(i, this.#bindingInstances[i]);
            // }

            this.#cgp.passEncoder.setBindGroup(0, this.#bindingInstances[shader.frameUsageCounter]);

            if (this.#bindingInstances.length == 0)
            {
                console.warn("No effing bindgroups...");
            }
            else
            {
                passEnc.setPipeline(this.#renderPipeline);

                this._bindUniforms(shader, shader.frameUsageCounter);
            }

            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();

            this.#cgp.popErrorScope();
        }
        if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();

    }

    /**
     * @param {CgpShader} shader
     * @returns {GPUPipelineDescriptorBase|GPURenderPipelineDescriptor|GPUComputePipelineDescriptor}
     */
    getPipelineObject(shader)
    {

        /** @type {Array<GPUBindGroupLayoutEntry} */
        this.bindingGroupLayoutEntries = [];

        if (!shader.bindingsVert)
        {
            console.error("shader has no bindingsvert...");
            return;
        }

        if (shader.bindingsVert)
            for (let i = 0; i < shader.bindingsVert.length; i++)
            {
                // if (shader.bindingsVert[i] && shader.bindingsVert[i].getSizeBytes() > 0)
                // {
                const entry = shader.bindingsVert[i].getBindingGroupLayoutEntry();
                if (entry) this.bindingGroupLayoutEntries.push(entry);
                // }
                // else this.#log.log("shader defaultBindingVert size 0");
            }

        if (shader.bindingsFrag)
            for (let i = 0; i < shader.bindingsFrag.length; i++)
            {
                // if (shader.bindingsFrag[i] && shader.bindingsFrag[i].getSizeBytes() > 0)
                // {
                const entry = shader.bindingsFrag[i].getBindingGroupLayoutEntry();
                if (entry) this.bindingGroupLayoutEntries.push(entry);
                // }
                // else this.#log.log("shader defaultBindingFrag size 0");
            }

        if (shader.bindingsCompute)
            for (let i = 0; i < shader.bindingsCompute.length; i++)
            {
                console.log("bindingsCompute", i, shader.bindingsCompute[i]);

                // if (shader.bindingsCompute[i] && shader.bindingsCompute[i].getSizeBytes() > 0)
                // {
                const entry = shader.bindingsCompute[i].getBindingGroupLayoutEntry();
                if (entry) this.bindingGroupLayoutEntries.push(entry);
                // }
                // else this.#log.log("shader defaultBindingCompute size 0");
            }
        // //////////

        /** @type {GPUBindGroupLayout} */
        this.bindGroupLayout = this.#cgp.device.createBindGroupLayout(
            {
                "label": "bindgrouplayout " + this.#name,
                "entries": this.bindingGroupLayoutEntries,
            });

        /** @type {GPUPipelineLayout} */
        const pipelineLayout = this.#cgp.device.createPipelineLayout({
            "label": "pipe layout " + this.#name,
            "bindGroupLayouts": [this.bindGroupLayout]
        });

        let buffers = [
            // position
            {
                "arrayStride": 3 * 4, // 3 floats, 4 bytes each
                "attributes": [
                    { "shaderLocation": 0, "offset": 0, "format": "float32x3" },
                ],
            },
            // texcoords
            {
                "arrayStride": 2 * 4, // 2 floats, 4 bytes each
                "attributes": [
                    { "shaderLocation": 2, "offset": 0, "format": "float32x2", },
                ],
            },
            // normals
            {
                "arrayStride": 3 * 4, // 3 floats, 4 bytes each
                "attributes": [
                    { "shaderLocation": 1, "offset": 0, "format": "float32x3" },
                ],
            }];

        /** @type {GPUPipelineDescriptorBase} */
        let pipeCfg = {
            // "layout": "auto",
            "label": this.#name,
            "layout": pipelineLayout,

        };

        if (this.#type == Pipeline.TYPE_RENDER)
        {
            const renderCfg = /** @type {GPURenderPipelineDescriptor} */ (pipeCfg || {});
            renderCfg.primitive = {
                "topology": "triangle-list",
                "cullMode": "none", // this.#cgp.stateCullFaceFacing(), // back/none/front

                // "point-list",
                // "line-list",
                // "line-strip",
                // "triangle-list",
                // "triangle-strip"
            };
            renderCfg.depthStencil = {
                "depthWriteEnabled": this.#cgp.stateDepthWrite(),
                "depthCompare": this.#cgp.stateDepthFunc(),
                "format": "depth24plus",
            };

            renderCfg.vertex =
            {
                "module": shader.gpuShaderModule,
                "entryPoint": "myVSMain",
                "buffers": buffers
            };

            renderCfg.fragment =
            {
                "module": shader.gpuShaderModule,
                "entryPoint": "myFSMain",
                "targets": [
                    {
                        "format": this.#cgp.presentationFormat,
                        "blend": this.#cgp.stateBlend()
                    },
                ],
            };
        }
        else if (this.#type == Pipeline.TYPE_COMPUTE)
        {
            const computeCfg = /** @type {GPUComputePipelineDescriptor} */ (pipeCfg || {});

            computeCfg.compute =
            {
                "module": shader.gpuShaderModule,
                "entryPoint": shader.options.entryPoint || "main"
            };
            console.log(computeCfg.compute);
        }

        console.log("bindgrouplayutEntries:", this.bindingGroupLayoutEntries.length);
        console.log("compute:", shader.bindingsCompute.length);
        console.log("frag:", shader.bindingsFrag.length);
        console.log("vert:", shader.bindingsVert.length);

        return pipeCfg;
    }

    getBindingsInfo(bings)
    {
        const arr = [];
        for (let i = 0; i < bings.length; i++)
        {
            arr.push(bings[i].getInfo());
        }
        return arr;
    }

    /**
     * @param {CgpShader} shader
     * @param {number} inst
     */
    _bindUniforms(shader, inst)
    {
        shader.bind();

        if (this.#type == Pipeline.TYPE_RENDER)
        {
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("bind uniforms vert", { "class": this.constructor.name, "name": this.#name, "instance": inst, "bindings": this.getBindingsInfo(shader.bindingsVert) });
            for (let i = 0; i < shader.bindingsVert.length; i++) shader.bindingsVert[i].update(inst);
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();

            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("bind uniforms frag", { "class": this.constructor.name, "name": this.#name, "instance": inst, "bindings": this.getBindingsInfo(shader.bindingsFrag) });
            for (let i = 0; i < shader.bindingsFrag.length; i++) shader.bindingsFrag[i].update(inst);
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();
        }
        if (this.#type == Pipeline.TYPE_COMPUTE)
        {
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.push("bind uniforms compute", { "class": this.constructor.name, "name": this.#name, "instance": inst, "bindings": this.getBindingsInfo(shader.bindingsFrag) });
            for (let i = 0; i < shader.bindingsCompute.length; i++) shader.bindingsCompute[i].update(inst);
            if (this.#cgp.branchProfiler) this.#cgp.branchProfiler.pop();
        }
    }

    /**
     * @param {CgpShader} shader
     * @param {Array} workGroups
     */
    compute(shader, workGroups = [8, 8])
    {

        if (this.#type != Pipeline.TYPE_COMPUTE)
        {
            this.#log.warn("no compute pipe");
            return;
        }

        if (!shader.gpuShaderModule) shader.compile();

        /** @type {GPUCommandEncoder} */
        const commandEncoder = this.#cgp.device.createCommandEncoder();

        this.#passEncoder = commandEncoder.beginComputePass({ "label": "computepass " + shader.getName() });

        if (!this.#renderPipeline) this.setPipeline(shader);
        if (!this.#renderPipeline)
        {
            this.#log.warn("no render pipe");
            return;
        }

        this.#passEncoder.setPipeline(this.#renderPipeline);

        // TODO BINDGROUPCOUNTER?!
        this.#passEncoder.setBindGroup(0, this.#bindingInstances[0]);

        if (workGroups.length == 1) this.#passEncoder.dispatchWorkgroups(workGroups[0] || 8);
        if (workGroups.length == 2) this.#passEncoder.dispatchWorkgroups(workGroups[0] || 8, workGroups[1] || 8);
        if (workGroups.length == 3) this.#passEncoder.dispatchWorkgroups(workGroups[0] || 8, workGroups[1] || 8, workGroups[2] || 8);

        this.#passEncoder.end();

        const gpuCommands = commandEncoder.finish();
        this.#cgp.device.queue.submit([gpuCommands]);
        this.pushDebug();
        // const entry = shader.bindingsVert[i].getBindingGroupEntry(shader.bindingCounter);
        // this._passEncoder = commandEncoder.beginComputePass();
        // this._passEncoder.setPipeline(computePipeline);
        // this._passEncoder.setBindGroup(0, bindGroup);
        // outBuff.setRef(gpuBuff);

    }

    dispose()
    {
        // todo...
    }

}

;// CONCATENATED MODULE: ./src/core/cgp/cgp_mesh.js






class CgpMesh extends CgMesh
{
    #log = new Logger("cgl_mesh");
    needsPipelineUpdate = false;

    constructor(_cgp, __geom)
    {
        super();

        this._cgp = _cgp;
        this._geom = null;
        this.numIndex = 0;
        this.instances = 1;

        this._pipe = new Pipeline(this._cgp, "pipe mesh " + __geom.name, Pipeline.TYPE_RENDER);
        this._numNonIndexed = 0;
        this._positionBuffer = null;

        this._attributes = [];

        if (__geom) this.setGeom(__geom);
    }

    _createBuffer(device, data, usage)
    {
        let bo = {
            "size": data.byteLength,
            "usage": usage,
            "mappedAtCreation": true,
        };
        const buffer = device.createBuffer(bo);
        const dst = new data.constructor(buffer.getMappedRange());
        dst.set(data);
        buffer.unmap();
        return buffer;
    }

    /**
     * @function setGeom
     * @memberof Mesh
     * @instance
     * @description set geometry for mesh
     * @param {Geometry} geom geometry
     */
    setGeom(geom)
    {
        this.needsPipelineUpdate = true;
        this._geom = geom;
        this._disposeAttributes();

        this._positionBuffer = this._createBuffer(this._cgp.device, new Float32Array(geom.vertices), GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_DST);

        let vi = geom.verticesIndices;
        if (!geom.isIndexed()) vi = Array.from(Array(geom.vertices.length / 3).keys());
        this._numIndices = vi.length;
        this._indicesBuffer = this._createBuffer(this._cgp.device, new Uint32Array(vi), GPUBufferUsage.INDEX | GPUBufferUsage.COPY_DST);

        if (geom.texCoords && geom.texCoords.length) this.setAttribute("texCoords", geom.texCoords, 2);
        if (geom.vertexNormals && geom.vertexNormals.length) this.setAttribute("normals", geom.vertexNormals, 3);

        this.setAttribute("normals", geom.vertexNormals, 3);
    }

    _disposeAttributes()
    {
        this.needsPipelineUpdate = true;
        for (let i = 0; i < this._attributes.length; i++) this._attributes[i].buffer.destroy();
        this._attributes.length = 0;
    }

    dispose()
    {
        this._disposeAttributes();
    }

    /**
     * @function setAttribute
     * @description update attribute
     * @memberof Mesh
     * @instance
     * @param {String} name attribute name
     * @param {Array} array data
     * @param {Number} itemSize
     * @param {Object} options
     */
    setAttribute(name, array, itemSize, options = {})
    {
        if (!array)
        {
            this.#log.error("mesh addAttribute - no array given! " + name);
            throw new Error();
        }

        let instanced = false;
        if (options.instanced) instanced = options.instanced;

        const buffer = this._createBuffer(this._cgp.device, new Float32Array(array), GPUBufferUsage.VERTEX | GPUBufferUsage.COPY_DST);

        const attr = {
            "buffer": buffer,
            "name": name,
            "instanced": instanced,
        };
        this._attributes.push(attr);

        return attr;
    }

    /**
     * @param {CgpShader} shader
     */
    render(shader)
    {
        if (!this._positionBuffer) return;
        if (this.instances <= 0) return;

        if (this._cgp.branchProfiler) this._cgp.branchProfiler.push("mesh.render()", "geom " + this._geom.name);

        shader = shader || this._cgp.getShader();
        if (shader)shader.bind();

        if (!shader || !shader.isValid)
        {
            // this.status = "shader invalid";
            return;
        }

        this._pipe.setName("mesh.render " + this._geom.name + " " + shader.getName());
        this._pipe.setPipeline(shader, this);

        if (this._pipe.isValid)
        {
            if (this._cgp.branchProfiler) this._cgp.branchProfiler.push("mesh.render().draw", "geom " + this._geom.name, {
                "geom ": this._geom.getInfo(),
                "shader ": shader.getInfo(),
                "numAttributes": this._attributes.length
            });
            // console.log(this._positionBuffer);
            this._cgp.passEncoder.setVertexBuffer(0, this._positionBuffer);
            for (let i = 0; i < this._attributes.length; i++)
                this._cgp.passEncoder.setVertexBuffer(i + 1, this._attributes[i].buffer);

            this._cgp.passEncoder.setIndexBuffer(this._indicesBuffer, "uint32");

            if (this._numNonIndexed)
                this._cgp.passEncoder.draw(this._numIndices, this.instances);
            else
                this._cgp.passEncoder.drawIndexed(this._numIndices, this.instances);

            if (this._cgp.branchProfiler) this._cgp.branchProfiler.pop();
        }
        else
        {
            if (this._cgp.branchProfiler)
            {
                this._cgp.branchProfiler.push("mesh invalid pipeline ", "geom " + this._geom.name);
                this._cgp.branchProfiler.pop();
            }
        }

        if (this._cgp.branchProfiler) this._cgp.branchProfiler.pop();

        // if (shader)shader.unbind();
    }
}

;// CONCATENATED MODULE: ./src/core/cgp/cgp_state.js











// https://github.com/greggman/webgpu-utils
// https://developer.chrome.com/blog/from-webgl-to-webgpu/
// https://gpuweb.github.io/gpuweb/explainer/

/**
 * cables webgpu context/state manager
 * @class
 * @namespace external:CGP
 * @hideconstructor
 */
class CgpContext extends CgContext
{

    branchProfiler = null;

    /**
     * @param {Patch} _patch
     */
    constructor(_patch)
    {
        super(_patch);
        this.patch = _patch;

        this.lastErrorMsg = "";

        this._log = new Logger("WebGpuContext");
        this.gApi = CgContext.API_WEBGPU;
        this._viewport = [0, 0, 256, 256];
        this._shaderStack = [];
        this._simpleShader = null;
        this.frame = 0;
        this.catchErrors = true;

        this._stackCullFaceFacing = [];
        this._stackDepthTest = [];
        this._stackCullFace = [];
        this._stackDepthFunc = [];
        this._stackDepthWrite = [];
        this._stackErrorScope = [];
        this._stackBlend = [];
        this._stackErrorScopeLogs = [];

        this.currentPipeDebug = null;
        this.canvasAttachments = [];

        /** @type {GPUDevice} */
        this.device = null;

        /** @type {GPURenderPassEncoder} */
        this.passEncoder = null;

        this._defaultBlend = {
            "color": {
                "operation": "add",
                "srcFactor": "one",
                "dstFactor": "zero",
            },
            "alpha": {
                "operation": "add",
                "srcFactor": "one",
                "dstFactor": "zero",
            },
        };

        this.DEPTH_FUNCS = [
            "never",
            "always",
            "less",
            "less-equal",
            "greater",
            "greater-equal",
            "equal",
            "not-equal"
        ];

        this.CULL_MODES = [
            "none",
            "back",
            "front",
            "none" // both does not exist in webgpu
        ];
    }

    get supported()
    {
        return !!navigator.gpu;

    }

    /// ////////////////////

    /**
     * Description
     * @param {any} cgp
     * @param {any} identTranslate
     * @param {any} identTranslateView
     * @returns {any}
     */
    renderStart(cgp, identTranslate, identTranslateView)
    {

        this.frame++;
        this.pushErrorScope("cgpstate internal", { "scope": "internal" });
        this.pushErrorScope("cgpstate out-of-memory", { "scope": "out-of-memory" });

        if (!this._simpleShader)
        {
            this._simpleShader = new CgpShader(this, "simple default shader");
            this._simpleShader.setSource(cgp_shader_default);

            this._simpleShader.addUniformFrag("4f", "color", [1, 1, 0, 1]);
        }

        this.fpsCounter.startFrame();

        this._startMatrixStacks(identTranslate, identTranslateView);
        this.setViewPort(0, 0, this.canvasWidth, this.canvasHeight);

        this.pushShader(this._simpleShader);
        this.pushDepthTest(true);
        this.pushDepthWrite(true);
        this.pushDepthFunc("less-equal");

        this.pushBlend(this._defaultBlend);

        this._execOneTimeCallbacks();

        this.emitEvent("beginFrame");
    }

    renderEnd()
    {
        this._endMatrixStacks();

        this.popShader();
        this.popDepthFunc();
        this.popDepthWrite();
        this.popDepthTest();

        this.popErrorScope();
        this.popErrorScope();

        if (this._stackErrorScope.length > 0)console.log("error scope stack length invalid...");
        this._stackErrorScope.length = 0;

        this.emitEvent("endFrame");
        this.fpsCounter.endFrame();
    }

    setViewPort(x, y, w, h)
    {
        this._viewport = [x, y, w, h];
    }

    /**
     * @function getViewPort
     * @memberof Context
     * @instance
     * @description get current gl viewport
     * @returns {Array} array [x,y,w,h]
     */
    getViewPort()
    {
        return this._viewPort;
    }

    /**
     * @param {Geometry} geom
     * @param {any} glPrimitive
     * @returns {CgpMesh}
     */
    createMesh(geom, glPrimitive)
    {
        return new CgpMesh(this, geom);
    }

    /**
     * @function popViewPort
     * @memberof Context
     * @instance
     * @description pop viewPort stack
     */
    popViewPort()
    {
        this._viewPortStack.pop();

        if (this._viewPortStack.length == 0)
            this._viewPort = [0, 0, this.canvasWidth, this.canvasHeight];
        else
            this.setViewPort(this._viewPortStack[this._viewPort.length - 1]);
    }

    /**
     * @function pushViewPort
     * @memberof Context
     * @instance
     * @description push a new viewport onto stack
     * @param {Number} x
     * @param {Number} y
     * @param {Number} w
     * @param {Number} h
     */

    pushViewPort(x, y, w, h)
    {
        this._viewPortStack.push([x, y, w, h]);
        this._viewPort = [x, y, w, h];
    }

    /**
     * push a shader to the shader stack
     * @function pushShader
     * @memberof Context
     * @instance
     * @param {Object} shader
     * @function
    */
    pushShader(shader)
    {
        this._shaderStack.push(shader);
        // currentShader = shader;
    }

    /**
     * pop current used shader from shader stack
     * @function popShader
     * @memberof Context
     * @instance
     * @function
     */
    popShader()
    {
        if (this._shaderStack.length === 0) throw new Error("Invalid shader stack pop!");
        this._shaderStack.pop();
        // currentShader = this._shaderStack[this._shaderStack.length - 1];
    }

    getShader()
    {
        return this._shaderStack[this._shaderStack.length - 1];
        // if (currentShader) if (!this.frameStore || ((this.frameStore.renderOffscreen === true) == currentShader.offScreenPass) === true) return currentShader;
        // for (let i = this._shaderStack.length - 1; i >= 0; i--) if (this._shaderStack[i]) if (this.frameStore.renderOffscreen == this._shaderStack[i].offScreenPass) return this._shaderStack[i];
    }

    /**
     * @param {GPUDevice} device
     */
    setDevice(device)
    {
        this.device = device;

        if (this._emptyTexture) this._emptyTexture = this._emptyTexture.dispose();
        if (this._defaultTexture) this._defaultTexture = this._defaultTexture.dispose();
        if (this._errorTexture) this._errorTexture = this._errorTexture.dispose();

        this.emitEvent("deviceChange");
    }

    /** @typedef ErrorScoprOptions
     * @property {string} scope
     */

    /**
     * @param {String} name
     * @param {ErrorScoprOptions} options
     */
    pushErrorScope(name, options = { "scope": "validation" })
    {
        if (this.catchErrors)
        {
            this._stackErrorScope.push(name);
            this._stackErrorScopeLogs.push(options.logger || null);
            this.device.pushErrorScope(options.scope || "validation");
        }
    }

    /**
     * @param {Function} [cb]
     */
    popErrorScope(cb)
    {
        if (this.catchErrors)
        {
            const name = this._stackErrorScope.pop();
            const logger = this._stackErrorScopeLogs.pop();
            this.device.popErrorScope().then((error) =>
            {
                if (error)
                {
                    if (this.lastErrorMsg == error.message)
                    {
                        // this._log.warn("last error once more...");
                    }
                    else
                    {
                        (logger || this._log).error(error.constructor.name, "in ERROR SCOPE:", name);
                        (logger || this._log).error(error.message);
                    }
                    this.lastErrorMsg = error.message;

                    if (cb)cb(error);
                }
            });
        }
    }

    /**
     * push depth testing enabled state
     * @function pushDepthTest
     * @param {Boolean} b enabled
     * @memberof Context
     * @instance
     */
    pushDepthTest(b)
    {
        this._stackDepthTest.push(b);
    }

    /**
     * current state of depth testing
     * @function stateDepthTest
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateDepthTest()
    {
        return this._stackDepthTest[this._stackDepthTest.length - 1];
    }

    /**
     * pop depth testing state
     * @function popDepthTest
     * @memberof Context
     * @instance
     */
    popDepthTest()
    {
        this._stackDepthTest.pop();
    }

    // --------------------------------------
    // state depthwrite

    /**
     * push depth write enabled state
     * @function pushDepthWrite
     * @param {Boolean} b enabled
     * @memberof Context
     * @instance
     */
    pushDepthWrite(b)
    {
        b = b || false;
        this._stackDepthWrite.push(b);
    }

    /**
     * current state of depth writing
     * @function stateCullFace
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateDepthWrite()
    {
        return this._stackDepthWrite[this._stackDepthWrite.length - 1];
    }

    /**
     * pop depth writing state
     * @function popCullFace
     * @memberof Context
     * @instance
     */
    popDepthWrite()
    {
        this._stackDepthWrite.pop();
    }

    // --------------------------------------
    // state depthfunc

    /**
     * @function pushDepthFunc
     * @memberof Context
     * @instance
     * @param {string} f depth compare func
     */
    pushDepthFunc(f)
    {
        this._stackDepthFunc.push(f);
    }

    /**
     * @function stateDepthFunc
     * @memberof Context
     * @instance
     * @returns {boolean}
     */
    stateDepthFunc()
    {
        if (this._stackDepthFunc.length > 0) return this._stackDepthFunc[this._stackDepthFunc.length - 1];
        return false;
    }

    /**
     * pop depth compare func
     * @function popDepthFunc
     * @memberof Context
     * @instance
     */
    popDepthFunc()
    {
        this._stackDepthFunc.pop();
    }

    // --------------------------------------
    // state CullFace

    /**
     * push face culling face enabled state
     * @function pushCullFace
     * @param {Boolean} b enabled
     * @memberof Context
     * @instance
     */
    pushCullFace(b)
    {
        this._stackCullFace.push(b);
    }

    /**
     * current state of face culling
     * @function stateCullFace
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateCullFace()
    {
        return this._stackCullFace[this._stackCullFace.length - 1];
    }

    /**
     * pop face culling enabled state
     * @function popCullFace
     * @memberof Context
     * @instance
     */
    popCullFace()
    {
        this._stackCullFace.pop();
    }

    // --------------------------------------
    // state CullFace Facing

    /**
     * push face culling face side
     * @function pushCullFaceFacing
     * @memberof Context
     * @param b
     * @instance
     */
    pushCullFaceFacing(b)
    {
        this._stackCullFaceFacing.push(b);
    }

    /**
     * current state of face culling side
     * @function stateCullFaceFacing
     * @returns {Boolean} enabled
     * @memberof Context
     * @instance
     */
    stateCullFaceFacing()
    {
        return this._stackCullFaceFacing[this._stackCullFaceFacing.length - 1];
    }

    /**
     * pop face culling face side
     * @function popCullFaceFacing
     * @memberof Context
     * @instance
     */
    popCullFaceFacing()
    {
        this._stackCullFaceFacing.pop();
    }

    pushBlend(b)
    {
        this._stackBlend.push(b);
    }

    popBlend()
    {
        this._stackBlend.pop();
    }

    stateBlend()
    {
        return this._stackBlend[this._stackBlend.length - 1];
    }

    getEmptyTexture()
    {
        if (this._emptyTexture) return this._emptyTexture;
        const size = 8;
        this._emptyTexture = new cgp_texture_Texture(this, {});
        this._emptyTexture.initFromData(CgTexture.getDefaultTextureData("empty", size), size, size);
        return this._emptyTexture;
    }

    getErrorTexture()
    {
        // if (this._errorTexture) return this._errorTexture;
        const size = 256;
        this._errorTexture = new cgp_texture_Texture(this, {});
        this._errorTexture.initFromData(CgTexture.getDefaultTextureData("stripes", size, { "r": 1, "g": 0, "b": 0 }), size, size);
        return this._errorTexture;
    }

    getDefaultTexture()
    {
        if (this._defaultTexture) return this._defaultTexture;
        const size = 256;
        this._defaultTexture = new cgp_texture_Texture(this, {});
        this._defaultTexture.initFromData(CgTexture.getDefaultTextureData("stripes", size), size, size);
        return this._defaultTexture;
    }

    /**
     * @param {function} cb
     * @param {boolean} doScreenshotClearAlpha
     * @param {string} mimeType
     * @param {number} quality
     */
    screenShot(cb, doScreenshotClearAlpha, mimeType, quality)
    {
        if (this.canvas && this.canvas.toBlob)
        {
            this.canvas.toBlob((blob) =>
            {
                if (cb) cb(blob);
                else this._log.log("no screenshot callback...");
            }, mimeType, quality);
        }

    }

}

;// CONCATENATED MODULE: ./src/core/cg/cg_boundingbox.js




/**
 * bounding box
 *
 * @namespace external:CGL
 * @param {Geometry} geometry or bounding box
 */
class BoundingBox
{

    /**
     * @param {Geometry} geom
     */
    constructor(geom)
    {
        this._init();
        this._first = true;
        this._wireMesh = null;

        if (geom) this.apply(geom);
    }

    _init()
    {
        this._max = [-0, -0, -0];
        this._min = [0, 0, 0];
        this._center = [0, 0, 0];
        this._size = [0, 0, 0];
        this._maxAxis = 0.0;
        this._first = true;
    }

    /**
     * get biggest number of maxX,maxY,maxZ
     * @type {Number}
     */
    get maxAxis() { return this._maxAxis || 1; }

    /**
     * size of bounding box
     * @type {vec3}
     */
    get size() { return this._size; }

    /**
     * center of bounding box
     * @type {vec3}
     */
    get center() { return this._center; }

    /**
     * center x
     * @type {Number}
     */
    get x() { return this._center[0]; }

    /**
     * center y
     * @type {Number}
     */
    get y() { return this._center[1]; }

    /**
     * center z
     * @type {Number}
     */
    get z() { return this._center[2]; }

    /**
     * minimum x
     * @type {Number}
     */
    get minX() { return this._min[0]; }

    /**
     * minimum y
     * @type {Number}
     */
    get minY() { return this._min[1]; }

    /**
     * minimum z
     * @type {Number}
     */
    get minZ() { return this._min[2]; }

    /**
     * maximum x
     * @type {Number}
     */
    get maxX() { return this._max[0]; }

    /**
     * maximum y
     * @type {Number}
     */
    get maxY() { return this._max[1]; }

    /**
     * maximum z
     * @type {Number}
     */
    get maxZ() { return this._max[2]; }

    apply(geom, mat)
    {
        if (!geom)
        {
            // console.warn("[boundingbox] no geom/vertices", geom);
            return;
        }

        if (geom instanceof BoundingBox)
        {
            const bb = geom;

            this.applyPos(bb.maxX, bb.maxY, bb.maxZ);
            this.applyPos(bb.minX, bb.minY, bb.minZ);
        }
        else
        {
            for (let i = 0; i < geom.vertices.length; i += 3)
                this.applyPos(geom.vertices[i], geom.vertices[i + 1], geom.vertices[i + 2]);
        }
        this.calcCenterSize();
    }

    /**
     * returns a copy of the bounding box
     * @function copy
     * @memberof BoundingBox
     * @instance
     */
    copy()
    {
        return new BoundingBox(this);
    }

    get changed()
    {
        return !(this._max[0] == -Number.MAX_VALUE && this._max[1] == -Number.MAX_VALUE && this._max[2] == -Number.MAX_VALUE);
    }

    applyPos(x, y, z)
    {
        if (x == Number.MAX_VALUE || x == -Number.MAX_VALUE ||
            y == Number.MAX_VALUE || y == -Number.MAX_VALUE ||
            z == Number.MAX_VALUE || z == -Number.MAX_VALUE) return;

        if (!CABLES.isNumeric(x) || !CABLES.isNumeric(y) || !CABLES.isNumeric(z)) return;

        if (this._first)
        {
            this._max[0] = x;
            this._max[1] = y;
            this._max[2] = z;

            this._min[0] = x;
            this._min[1] = y;
            this._min[2] = z;
            this._first = false;
            return;
        }

        this._max[0] = Math.max(this._max[0], x);
        this._max[1] = Math.max(this._max[1], y);
        this._max[2] = Math.max(this._max[2], z);

        this._min[0] = Math.min(this._min[0], x);
        this._min[1] = Math.min(this._min[1], y);
        this._min[2] = Math.min(this._min[2], z);
    }

    calcCenterSize()
    {
        if (this._first) return;

        this._size[0] = this._max[0] - this._min[0];
        this._size[1] = this._max[1] - this._min[1];
        this._size[2] = this._max[2] - this._min[2];

        this._center[0] = (this._min[0] + this._max[0]) / 2;
        this._center[1] = (this._min[1] + this._max[1]) / 2;
        this._center[2] = (this._min[2] + this._max[2]) / 2;

        this._maxAxis = Math.max(this._size[2], Math.max(this._size[0], this._size[1]));
    }

    mulMat4(m)
    {
        if (this._first)
        {
            this._max[0] = 0;
            this._max[1] = 0;
            this._max[2] = 0;

            this._min[0] = 0;
            this._min[1] = 0;
            this._min[2] = 0;
            this._first = false;
        }
        vec3.transformMat4(this._max, this._max, m);
        vec3.transformMat4(this._min, this._min, m);
        this.calcCenterSize();
    }

    render(cgl, shader, op)
    {
        if (!this._wireMesh) this._wireMesh = new CGL.WireCube(cgl);

        cgl.pushModelMatrix();
        mat4.translate(cgl.mMatrix, cgl.mMatrix, this._center);

        if (CABLES.UI && op)
        {
            CABLES.UI.OverlayMeshes.drawCube(op, this._size[0] / 2, this._size[1] / 2, this._size[2] / 2);
        }

        cgl.popModelMatrix();
    }
}

;// CONCATENATED MODULE: ./src/core/cg/cg_geom.js




/**
 * a geometry contains all information about a mesh, vertices, texturecoordinates etc. etc.
 * @namespace external:CGL#Geometry
 * @param {String} name
 * @class
 * @example
 * // create a triangle with all attributes
 * const geom=new Geometry("triangle"),
 *
 * geom.vertices = [
 *      0.0,           sizeH.get(),  0.0,
 *     -sizeW.get(),  -sizeH.get(),  0.0,
 *      sizeW.get(),  -sizeH.get(),  0.0 ];
 *
 * geom.vertexNormals = [
 *      0.0,  0.0,  1.0,
 *      0.0,  0.0,  1.0,
 *      0.0,  0.0,  1.0 ];
 *
 * geom.tangents = [
 *     1,0,0,
 *     1,0,0,
 *     1,0,0 ];
 *
 * geom.biTangents = [
 *     0,1,0,
 *     0,1,0,
 *     0,1,0 ];
 *
 * geom.texCoords = [
 *      0.5,  0.0,
 *      1.0,  1.0,
 *      0.0,  1.0, ];
 *
 * geom.verticesIndices = [
 *     0, 1, 2 ];
 *
 */

class Geometry
{

    /**
     * @param {String} name
     */
    constructor(name)
    {
        this.name = name || "unknown";
        this._log = new Logger("cgl_geometry");

        this.faceVertCount = 3;
        this.glPrimitive = null;
        this._attributes = {};

        /** @type {Array|Float32Array} */
        this._vertices = [];
        this.verticesIndices = [];

        this.isGeometry = true;

        this.morphTargets = [];
    }

    get vertices()
    {
        return this._vertices;
    }

    set vertices(v)
    {
        this.setVertices(v);
    }

    get texCoords()
    {
        const att = this.getAttribute("texCoords");
        if (!att) return [];
        return att.data;
    }

    set texCoords(v)
    {
        this.setAttribute("texCoords", v, 2);
    }

    get vertexNormals()
    {
        const att = this.getAttribute("vertexNormals");
        if (!att) return [];
        return att.data;
    }

    set vertexNormals(v)
    {
        this.setAttribute("vertexNormals", v, 3);
    }

    get tangents()
    {
        const att = this.getAttribute("tangents");
        if (!att) return [];
        return att.data;
    }

    set tangents(v)
    {
        this.setAttribute("tangents", v, 3);
    }

    get biTangents()
    {
        const att = this.getAttribute("biTangents");
        if (!att) return [];
        return att.data;
    }

    set biTangents(v)
    {
        this.setAttribute("biTangents", v, 3);
    }

    get vertexColors()
    {
        const att = this.getAttribute("vertexColors");
        if (!att) return [];
        return att.data;
    }

    set vertexColors(v)
    {
        this.setAttribute("vertexColors", v, 4);
    }

    /**
     * @function clear
     * @memberof Geometry
     * @instance
     * @description clear all buffers/set them to length 0
     */
    clear()
    {
        this._vertices = new Float32Array([]);
        this.verticesIndices = [];
        this.texCoords = new Float32Array([]);
        this.vertexNormals = new Float32Array([]);
        this.tangents = [];
        this.biTangents = [];
        this._attributes = {};
    }

    /**
     * @function getAttributes
     @memberof Geometry
    * @instance
    * @return {Array<Object>} returns array of attribute objects
    */
    getAttributes()
    {
        return this._attributes;
    }

    /**
     * @function getAttribute
     * @memberof Geometry
     * @instance
     * @param {String} name
     * @return {Object}
     */
    getAttribute(name)
    {
        for (const i in this._attributes)
        {
            if (this._attributes[i].name == name) return this._attributes[i];
        }
        return null;
    }

    /**
     * @function setAttribute
     * @description create an attribute
     * @memberof Geometry
     * @instance
     * @param {String} name
     * @param {Array} arr
     * @param {Number} itemSize
     */
    setAttribute(name, arr, itemSize)
    {
        let attrType = "";
        if (!itemSize || itemSize > 4)
        {
            this._log.warn("itemsize wrong?", itemSize, name);
            this._log.stack("itemsize");

            itemSize = 3;
        }

        if (itemSize == 1) attrType = "float";
        else if (itemSize == 2) attrType = "vec2";
        else if (itemSize == 3) attrType = "vec3";
        else if (itemSize == 4) attrType = "vec4";

        const attr = {
            "name": name,
            "data": arr,
            "itemSize": itemSize,
            "type": attrType,
        };

        this._attributes[name] = attr;
    }

    copyAttribute(name, newgeom)
    {
        const attr = this.getAttribute(name);
        newgeom.setAttribute(name, new Float32Array(attr.data), attr.itemSize);
    }

    /**
     * @function setVertices
     * @memberof Geometry
     * @instance
     * @description set vertices
     * @param {Array|Float32Array} arr [x,y,z,x,y,z,...]
     */
    setVertices(arr)
    {
        if (arr instanceof Float32Array) this._vertices = arr;
        else this._vertices = new Float32Array(arr);
    }

    /**
     * @function setTexCoords
     * @memberof Geometry
     * @instance
     * @description set texcoords
     * @param {Array|Float32Array} arr [u,v,u,v,...]
     */
    setTexCoords(arr)
    {
        if (arr instanceof Float32Array) this.texCoords = arr;
        else this.texCoords = new Float32Array(arr);
    }

    // deprecated
    calcNormals(smooth)
    {
        const options = { "smooth": smooth };
        this.calculateNormals(options);
    }

    /**
     * @param x
     * @param y
     * @param z
     */
    flipNormals(x, y, z)
    {
        let vec = vec3_create();

        if (x == undefined)x = 1;
        if (y == undefined)y = 1;
        if (z == undefined)z = 1;

        for (let i = 0; i < this.vertexNormals.length; i += 3)
        {
            vec3_set(vec,
                this.vertexNormals[i + 0],
                this.vertexNormals[i + 1],
                this.vertexNormals[i + 2]);

            vec[0] *= -x;
            vec[1] *= -y;
            vec[2] *= -z;

            normalize(vec, vec);

            this.vertexNormals[i + 0] = vec[0];
            this.vertexNormals[i + 1] = vec[1];
            this.vertexNormals[i + 2] = vec[2];
        }
    }

    getNumTriangles()
    {
        if (this.verticesIndices && this.verticesIndices.length) return this.verticesIndices.length / 3;
        return this.vertices.length / 3;
    }

    /**
     * @function flipVertDir
     * @description flip order of vertices in geom faces
     */
    flipVertDir()
    {
        const newInd = [];
        newInd.length = this.verticesIndices.length;
        for (let i = 0; i < this.verticesIndices.length; i += 3)
        {
            newInd[i] = this.verticesIndices[i + 2];
            newInd[i + 1] = this.verticesIndices[i + 1];
            newInd[i + 2] = this.verticesIndices[i];
        }
        this.verticesIndices = newInd;
    }

    /**
     * @param {Array} verts
     */
    setPointVertices(verts)
    {
        if (verts.length % 3 !== 0)
        {
            this._log.error("SetPointVertices: Array must be multiple of three.");
            return;
        }

        if (!(verts instanceof Float32Array)) this.vertices = new Float32Array(verts);
        else this.vertices = verts;

        if (!(this.texCoords instanceof Float32Array)) this.texCoords = new Float32Array((verts.length / 3) * 2);

        // this.texCoords.length=verts.length/3*2;
        this.verticesIndices.length = verts.length / 3;
        // this.verticesIndices=[];

        for (let i = 0; i < verts.length / 3; i++)
        {
            this.verticesIndices[i] = i;
            this.texCoords[i * 2] = 0;
            this.texCoords[i * 2 + 1] = 0;
        }
    }

    /**
     * merge a different geometry into the this geometry
     * @function merge
     * @param {Geometry} geom
     * @memberof Geometry
     * @instance
     */
    merge(geom)
    {
        if (!geom) return;

        if (this.isIndexed() != geom.isIndexed())
        {
            if (this.isIndexed())
            {
                this.unIndex(false, true);
            }
            if (geom.isIndexed())
            {
                const g = geom.copy();
                g.unIndex(false, true);
                geom = g;
            }
        }

        const oldIndizesLength = this.verticesIndices.length;
        const vertLength = this._vertices.length / 3;

        this.verticesIndices.length += geom.verticesIndices.length;
        for (let i = 0; i < geom.verticesIndices.length; i++)
            this.verticesIndices[oldIndizesLength + i] = geom.verticesIndices[i] + vertLength;

        this.vertices = CABLES.float32Concat(this._vertices, geom.vertices);
        this.texCoords = CABLES.float32Concat(this.texCoords, geom.texCoords);
        this.vertexNormals = CABLES.float32Concat(this.vertexNormals, geom.vertexNormals);
        this.tangents = CABLES.float32Concat(this.tangents, geom.tangents);
        this.biTangents = CABLES.float32Concat(this.biTangents, geom.biTangents);
    }

    /**
     *   a copy of the geometry
     * @function copy
     * @memberof Geometry
     * @instance
     */
    copy()
    {
        const geom = new Geometry(this.name + " copy");
        geom.faceVertCount = this.faceVertCount;
        geom.glPrimitive = this.glPrimitive;

        geom.setVertices(this._vertices.slice(0));

        if (this.verticesIndices)
        {
            geom.verticesIndices.length = this.verticesIndices.length;
            for (let i = 0; i < this.verticesIndices.length; i++) geom.verticesIndices[i] = this.verticesIndices[i];
        }

        for (let i in this._attributes) this.copyAttribute(i, geom);

        geom.morphTargets.length = this.morphTargets.length;
        for (let i = 0; i < this.morphTargets.length; i++) geom.morphTargets[i] = this.morphTargets[i];

        return geom;
    }

    /**
     * Calculaten normals
     * @function calculateNormals
     * @param options
     */
    calculateNormals(options)
    {
        // todo: should check angle of normals to get edges    https://community.khronos.org/t/calculating-accurate-vertex-normals/28152
        options = options || {};
        if (options.smooth === false) this.unIndex();

        const u = vec3_create();
        const v = vec3_create();
        const n = vec3_create();

        function calcNormal(triangle)
        {
            vec3_subtract(u, triangle[0], triangle[1]);
            vec3_subtract(v, triangle[0], triangle[2]);
            cross(n, u, v);
            normalize(n, n);

            if (options && options.forceZUp)
            {
                if (n[2] < 0)
                {
                    n[0] *= -1;
                    n[1] *= -1;
                    n[2] *= -1;
                }
            }
            return n;
        }

        this.getVertexVec = function (which)
        {
            const vec = [0, 0, 0];
            vec[0] = this.vertices[which * 3 + 0];
            vec[1] = this.vertices[which * 3 + 1];
            vec[2] = this.vertices[which * 3 + 2];
            return vec;
        };

        if (!(this.vertexNormals instanceof Float32Array) || this.vertexNormals.length != this.vertices.length) this.vertexNormals = new Float32Array(this.vertices.length);

        for (let i = 0; i < this.vertices.length; i++)
        {
            this.vertexNormals[i] = 0;
        }

        if (!this.isIndexed())
        {
            const norms = [];
            for (let i = 0; i < this.vertices.length; i += 9)
            {
                const triangle = [[this.vertices[i + 0], this.vertices[i + 1], this.vertices[i + 2]], [this.vertices[i + 3], this.vertices[i + 4], this.vertices[i + 5]], [this.vertices[i + 6], this.vertices[i + 7], this.vertices[i + 8]]];
                const nn = calcNormal(triangle);
                norms.push(nn[0], nn[1], nn[2], nn[0], nn[1], nn[2], nn[0], nn[1], nn[2]);
            }
            this.vertexNormals = norms;
        }
        else
        {
            const faceNormals = [];

            faceNormals.length = Math.floor(this.verticesIndices.length / 3);

            for (let i = 0; i < this.verticesIndices.length; i += 3)
            {
                const triangle = [this.getVertexVec(this.verticesIndices[i + 0]), this.getVertexVec(this.verticesIndices[i + 1]), this.getVertexVec(this.verticesIndices[i + 2])];

                faceNormals[i / 3] = calcNormal(triangle);

                this.vertexNormals[this.verticesIndices[i + 0] * 3 + 0] += faceNormals[i / 3][0];
                this.vertexNormals[this.verticesIndices[i + 0] * 3 + 1] += faceNormals[i / 3][1];
                this.vertexNormals[this.verticesIndices[i + 0] * 3 + 2] += faceNormals[i / 3][2];

                this.vertexNormals[this.verticesIndices[i + 1] * 3 + 0] += faceNormals[i / 3][0];
                this.vertexNormals[this.verticesIndices[i + 1] * 3 + 1] += faceNormals[i / 3][1];
                this.vertexNormals[this.verticesIndices[i + 1] * 3 + 2] += faceNormals[i / 3][2];

                this.vertexNormals[this.verticesIndices[i + 2] * 3 + 0] += faceNormals[i / 3][0];
                this.vertexNormals[this.verticesIndices[i + 2] * 3 + 1] += faceNormals[i / 3][1];
                this.vertexNormals[this.verticesIndices[i + 2] * 3 + 2] += faceNormals[i / 3][2];
            }

            for (let i = 0; i < this.verticesIndices.length; i += 3) // faces
            {
                for (let k = 0; k < 3; k++) // triangles
                {
                    const vv = [this.vertexNormals[this.verticesIndices[i + k] * 3 + 0], this.vertexNormals[this.verticesIndices[i + k] * 3 + 1], this.vertexNormals[this.verticesIndices[i + k] * 3 + 2]];
                    normalize(vv, vv);
                    this.vertexNormals[this.verticesIndices[i + k] * 3 + 0] = vv[0];
                    this.vertexNormals[this.verticesIndices[i + k] * 3 + 1] = vv[1];
                    this.vertexNormals[this.verticesIndices[i + k] * 3 + 2] = vv[2];
                }
            }
        }
    }

    /**
     * Calculates tangents & bitangents with the help of uv-coordinates. Adapted from
     * Lengyel, Eric. Computing Tangent Space Basis Vectors for an Arbitrary Mesh.
     * Terathon Software 3D Graphics Library.
     * https://fenix.tecnico.ulisboa.pt/downloadFile/845043405449073/Tangent%20Space%20Calculation.pdf
     *
     * @function calcTangentsBitangents
     */
    calcTangentsBitangents()
    {
        if (!this.vertices.length)
        {
            // this._log.error("Cannot calculate tangents/bitangents without vertices.");
            return;
        }
        if (!this.vertexNormals.length)
        {
            // this._log.error("Cannot calculate tangents/bitangents without normals.");
            return;
        }
        if (!this.texCoords.length)
        {
            const texCoordLength = (this.vertices.length / 3) * 2;
            this.texCoords = new Float32Array(texCoordLength);
            for (let i = 0; i < texCoordLength; i += 1) this.texCoords[i] = 0;
        }
        if (!this.verticesIndices || !this.verticesIndices.length)
        {
            // this._log.error("Cannot calculate tangents/bitangents without vertex indices.");
            return;
        }
        // this code assumes that we have three indices per triangle
        if (this.verticesIndices.length % 3 !== 0)
        {
            this._log.error("Vertex indices mismatch!");
            return;
        }

        const triangleCount = this.verticesIndices.length / 3;
        const vertexCount = this.vertices.length / 3;

        this.tangents = new Float32Array(this.vertexNormals.length);
        this.biTangents = new Float32Array(this.vertexNormals.length);

        // temporary buffers
        const tempVertices = [];
        tempVertices.length = vertexCount * 2;
        const v1 = vec3_create();
        const v2 = vec3_create();
        const v3 = vec3_create();

        const w1 = vec2.create();
        const w2 = vec2.create();
        const w3 = vec2.create();

        const sdir = vec3_create();
        const tdir = vec3_create();

        // for details on calculation, see article referenced above
        for (let tri = 0; tri < triangleCount; tri += 1)
        {
            // indices of the three vertices for a triangle
            const i1 = this.verticesIndices[tri * 3];
            const i2 = this.verticesIndices[tri * 3 + 1];
            const i3 = this.verticesIndices[tri * 3 + 2];

            // vertex position as vec3
            vec3_set(v1, this.vertices[i1 * 3], this.vertices[i1 * 3 + 1], this.vertices[i1 * 3 + 2]);
            vec3_set(v2, this.vertices[i2 * 3], this.vertices[i2 * 3 + 1], this.vertices[i2 * 3 + 2]);
            vec3_set(v3, this.vertices[i3 * 3], this.vertices[i3 * 3 + 1], this.vertices[i3 * 3 + 2]);

            // texture coordinate as vec2
            vec2.set(w1, this.texCoords[i1 * 2], this.texCoords[i1 * 2 + 1]);
            vec2.set(w2, this.texCoords[i2 * 2], this.texCoords[i2 * 2 + 1]);
            vec2.set(w3, this.texCoords[i3 * 2], this.texCoords[i3 * 2 + 1]);

            const x1 = v2[0] - v1[0];
            const x2 = v3[0] - v1[0];
            const y1 = v2[1] - v1[1];
            const y2 = v3[1] - v1[1];
            const z1 = v2[2] - v1[2];
            const z2 = v3[2] - v1[2];

            const s1 = w2[0] - w1[0];
            const s2 = w3[0] - w1[0];
            const t1 = w2[1] - w1[1];
            const t2 = w3[1] - w1[1];

            const r = 1.0 / (s1 * t2 - s2 * t1);

            vec3_set(sdir, (t2 * x1 - t1 * x2) * r, (t2 * y1 - t1 * y2) * r, (t2 * z1 - t1 * z2) * r);
            vec3_set(tdir, (s1 * x2 - s2 * x1) * r, (s1 * y2 - s2 * y1) * r, (s1 * z2 - s2 * z1) * r);

            tempVertices[i1] = sdir;
            tempVertices[i2] = sdir;
            tempVertices[i3] = sdir;

            tempVertices[i1 + vertexCount] = tdir;
            tempVertices[i2 + vertexCount] = tdir;
            tempVertices[i3 + vertexCount] = tdir;
        }

        const normal = vec3_create();
        const tempVert = vec3_create();
        const tan = vec3_create();
        const bitan = vec3_create();
        const temp1 = vec3_create();
        const temp2 = vec3_create();
        const crossPd = vec3_create();
        const normalized = vec3_create();

        for (let vert = 0; vert < vertexCount; vert += 1)
        {
            // NOTE: some meshes don't have index 0 - n in their indexbuffer, if this is the case, skip calculation of this vertex
            if (!tempVertices[vert]) continue;

            vec3_set(normal, this.vertexNormals[vert * 3], this.vertexNormals[vert * 3 + 1], this.vertexNormals[vert * 3 + 2]);
            vec3_set(tempVert, tempVertices[vert][0], tempVertices[vert][1], tempVertices[vert][2]);

            // Gram-Schmidt orthagonalize
            const _dp = vec3_dot(normal, tempVert);
            vec3_scale(temp1, normal, _dp);
            vec3_subtract(temp2, tempVert, temp1);

            normalize(normalized, temp2);
            cross(crossPd, normal, tempVert);

            // const intermDot = vec3.dot(crossPd, tempVertices[vert + vertexCount]);
            const w = 1.0;// intermDot < 0.0 ? -1.0 : 1.0;

            vec3_scale(tan, normalized, 1 / w);
            cross(bitan, normal, tan);

            this.tangents[vert * 3 + 0] = tan[0];
            this.tangents[vert * 3 + 1] = tan[1];
            this.tangents[vert * 3 + 2] = tan[2];
            this.biTangents[vert * 3 + 0] = bitan[0];
            this.biTangents[vert * 3 + 1] = bitan[1];
            this.biTangents[vert * 3 + 2] = bitan[2];
        }
    }

    isIndexed()
    {
        if (this._vertices.length == 0) return true;
        return this.verticesIndices.length != 0;
    }

    /**
     * @function unIndex
     * @memberof Geometry
     * @instance
     * @description remove all vertex indizes, vertices array will contain 3*XYZ for every triangle
     * @param {boolean} reIndex
     * @param {boolean} dontCalcNormals
     */
    unIndex(reIndex = false, dontCalcNormals = false)
    {
        const newVerts = [];
        const newIndizes = [];
        let count = 0;

        for (let j in this._attributes)
        {
            const attr = this._attributes[j];
            let na = [];

            for (let i = 0; i < this.verticesIndices.length; i += 3)
            {
                for (let s = 0; s < 3; s++)
                {
                    if (attr.itemSize == 3)
                        na.push(
                            attr.data[this.verticesIndices[i + s] * 3 + 0],
                            attr.data[this.verticesIndices[i + s] * 3 + 1],
                            attr.data[this.verticesIndices[i + s] * 3 + 2]);
                    else if (attr.itemSize == 4)
                        na.push(
                            attr.data[this.verticesIndices[i + s] * 4 + 0],
                            attr.data[this.verticesIndices[i + s] * 4 + 1],
                            attr.data[this.verticesIndices[i + s] * 4 + 2],
                            attr.data[this.verticesIndices[i + s] * 4 + 3]);
                    else if (attr.itemSize == 2)
                        na.push(
                            attr.data[this.verticesIndices[i + s] * 2 + 0],
                            attr.data[this.verticesIndices[i + s] * 2 + 1]);
                    else if (attr.itemSize == 1)
                        na.push(
                            attr.data[this.verticesIndices[i + s]]);
                    else this._log.warn("unknown attr", attr);
                }
            }
            this.setAttribute(attr.name, na, attr.itemSize);
        }

        for (let i = 0; i < this.verticesIndices.length; i += 3)
        {
            newVerts.push(
                this.vertices[this.verticesIndices[i + 0] * 3 + 0],
                this.vertices[this.verticesIndices[i + 0] * 3 + 1],
                this.vertices[this.verticesIndices[i + 0] * 3 + 2]);

            newIndizes.push(count);
            count++;

            newVerts.push(
                this.vertices[this.verticesIndices[i + 1] * 3 + 0],
                this.vertices[this.verticesIndices[i + 1] * 3 + 1],
                this.vertices[this.verticesIndices[i + 1] * 3 + 2]);

            newIndizes.push(count);
            count++;

            newVerts.push(
                this.vertices[this.verticesIndices[i + 2] * 3 + 0],
                this.vertices[this.verticesIndices[i + 2] * 3 + 1],
                this.vertices[this.verticesIndices[i + 2] * 3 + 2]);

            newIndizes.push(count);
            count++;
        }

        this.vertices = newVerts;

        this.verticesIndices = [];
        if (reIndex) this.verticesIndices = newIndizes;

        if (!dontCalcNormals) this.calculateNormals();
    }

    calcBarycentric()
    {
        let barycentrics = [];
        barycentrics.length = this.vertices.length;
        for (let i = 0; i < this.vertices.length; i++) barycentrics[i] = 0;

        let count = 0;
        for (let i = 0; i < this.vertices.length; i += 3)
        {
            barycentrics[i + count] = 1;
            count++;
            if (count == 3) count = 0;
        }

        this.setAttribute("attrBarycentric", barycentrics, 3);
    }

    getBounds()
    {
        return new BoundingBox(this);
    }

    /**
     * @param {number} x
     * @param {number} y
     * @param {number} z
     * @returns {Array} offset
     */
    center(x, y, z)
    {
        if (x === undefined)
        {
            x = true;
            y = true;
            z = true;
        }

        let i = 0;
        const bounds = this.getBounds();
        const offset = [bounds.minX + (bounds.maxX - bounds.minX) / 2, bounds.minY + (bounds.maxY - bounds.minY) / 2, bounds.minZ + (bounds.maxZ - bounds.minZ) / 2];

        for (i = 0; i < this.vertices.length; i += 3)
        {
            if (this.vertices[i + 0] == this.vertices[i + 0])
            {
                if (x) this.vertices[i + 0] -= offset[0];
                if (y) this.vertices[i + 1] -= offset[1];
                if (z) this.vertices[i + 2] -= offset[2];
            }
        }

        return offset;
    }

    mapTexCoords2d()
    {
        const bounds = this.getBounds();
        const num = this.vertices.length / 3;

        this.texCoords = new Float32Array(num * 2);

        for (let i = 0; i < num; i++)
        {
            const vertX = this.vertices[i * 3 + 0];
            const vertY = this.vertices[i * 3 + 1];
            this.texCoords[i * 2 + 0] = vertX / (bounds.maxX - bounds.minX) + 0.5;
            this.texCoords[i * 2 + 1] = 1.0 - vertY / (bounds.maxY - bounds.minY) + 0.5;
        }
    }

    getInfoOneLine()
    {
        let txt = "";
        if (this.faceVertCount == 3 && this.verticesIndices)txt += this.verticesIndices.length / 3;
        else txt += 0;

        txt += " tris ";

        if (this.vertices)txt += this.vertices.length / 3;
        else txt += 0;

        txt += " verts";

        return txt;
    }

    getInfo()
    {
        const info = {};

        info.name = this.name;
        info.class = this.constructor.name;

        if (this.faceVertCount == 3 && this.verticesIndices)info.numFaces = this.verticesIndices.length / 3;
        else info.numFaces = 0;

        if (this.verticesIndices && this.verticesIndices.length)info.indices = this.verticesIndices.length;

        if (this.vertices)info.numVerts = this.vertices.length / 3;
        else info.numVerts = 0;

        if (this.vertexNormals) info.numNormals = this.vertexNormals.length / 3;
        else info.numNormals = 0;

        if (this.texCoords) info.numTexCoords = this.texCoords.length / 2;
        else info.numTexCoords = 0;

        if (this.tangents) info.numTangents = this.tangents.length / 3;
        else info.numTangents = 0;

        if (this.biTangents) info.numBiTangents = this.biTangents.length / 3;
        else info.numBiTangents = 0;

        if (this.biTangents) info.numBiTangents = this.biTangents.length / 3;
        else info.numBiTangents = 0;

        if (this.vertexColors) info.numVertexColors = this.vertexColors.length / 4;
        else info.numVertexColors = 0;

        if (this.getAttributes()) info.numAttribs = Object.keys(this.getAttributes()).length;
        else info.numAttribs = 0;

        info.isIndexed = this.isIndexed();

        return info;
    }

    // -----------------
}

// TODO : rewritwe circle op 1
/** @deprecated */
Geometry.buildFromFaces = function (arr, name, optimize)
{
    const vertices = [];
    const verticesIndices = [];

    for (let i = 0; i < arr.length; i += 3)
    {
        const a = arr[i + 0];
        const b = arr[i + 1];
        const c = arr[i + 2];
        const face = [-1, -1, -1];

        if (optimize)
            for (let iv = 0; iv < vertices.length; iv += 3)
            {
                if (vertices[iv + 0] == a[0] && vertices[iv + 1] == a[1] && vertices[iv + 2] == a[2]) face[0] = iv / 3;
                if (vertices[iv + 0] == b[0] && vertices[iv + 1] == b[1] && vertices[iv + 2] == b[2]) face[1] = iv / 3;
                if (vertices[iv + 0] == c[0] && vertices[iv + 1] == c[1] && vertices[iv + 2] == c[2]) face[2] = iv / 3;
            }

        if (face[0] == -1)
        {
            vertices.push(a[0], a[1], a[2]);
            face[0] = (vertices.length - 1) / 3;
        }

        if (face[1] == -1)
        {
            vertices.push(b[0], b[1], b[2]);
            face[1] = (vertices.length - 1) / 3;
        }

        if (face[2] == -1)
        {
            vertices.push(c[0], c[1], c[2]);
            face[2] = (vertices.length - 1) / 3;
        }

        verticesIndices.push(parseInt(face[0], 10));
        verticesIndices.push(parseInt(face[1], 10));
        verticesIndices.push(parseInt(face[2], 10));
    }

    const geom = new Geometry(name);
    geom.name = name;
    geom.vertices = vertices;
    geom.verticesIndices = verticesIndices;

    return geom;
};

;// CONCATENATED MODULE: ./src/core/cgl/cgl_simplerect.js



const MESHES = {};

MESHES.getSimpleRect = function (cgl, name, size = 1.0)
{
    const geom = new Geometry(name);

    geom.vertices = [1.0 * size, 1.0 * size, 0.0, -1.0 * size, 1.0 * size, 0.0, 1.0 * size, -1.0 * size, 0.0, -1.0 * size, -1.0 * size, 0.0];
    geom.texCoords = [1.0, 1.0, 0.0, 1.0, 1.0, 0.0, 0.0, 0.0];
    geom.verticesIndices = [0, 1, 2, 2, 1, 3];
    geom.vertexNormals = [0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0];

    return cgl.createMesh(geom);
};

MESHES.getSimpleCube = function (cgl, name)
{
    const geom = new Geometry(name);
    geom.vertices = [-1, -1, 1, 1, -1, 1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, 1, -1, -1, 1, -1, -1, 1, -1, 1, 1, -1, 1, 1, 1, -1, 1, 1, -1, -1, -1, 1, -1, -1, 1, -1, 1, -1, -1, 1, 1, -1, -1, 1, -1, 1, 1, 1, 1, 1, 1, -1, -1, -1, -1, -1, -1, 1, -1, 1, 1, -1, 1, -1];
    geom.setTexCoords([0, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 0, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0,]);
    geom.verticesIndices = [0, 1, 2, 0, 2, 3, 4, 5, 6, 4, 6, 7, 8, 9, 10, 8, 10, 11, 12, 13, 14, 12, 14, 15, 16, 17, 18, 16, 18, 19, 20, 21, 22, 20, 22, 23];
    geom.vertexNormals = new Float32Array([0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, 1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0, -1.0, 0.0, 0.0]);
    geom.tangents = new Float32Array([0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1]);
    geom.biTangents = new Float32Array([-1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, 1, 0, 0, -1, 0, 0, -1, 0, 0, -1, 0, 0, -1]);

    return new Mesh(cgl, geom);
};



;// CONCATENATED MODULE: ./src/core/cgp/cgp_canvasattachment.js


class WebGpuCanvasAttachment
{

    /** @type {canvas} */
    #canvas = null;

    /** @type {CgpContext} */
    #cgp = null;

    /** @type {CanvasContext} */
    #ctx = null;

    /**
     * @param {CgpContext} cgp
     */
    constructor(cgp)
    {
        this.#cgp = cgp;
        this.#canvas = document.createElement("canvas");
        this.#canvas.id = "webgpucanvasOut";
        this.#canvas.style.width = 128 + "px";
        this.#canvas.style.height = 128 + "px";
    }

    get canvas()
    {
        return this.#canvas;
    }

    /**
     * @param {function} cb
     */
    render(cb)
    {

        const canvas = this.#cgp.canvas;
        if (this.#canvas.width != canvas.width || this.#canvas.height != canvas.height)
        {
            this.#canvas.style.width = canvas.width + "px";
            this.#canvas.style.height = canvas.height + "px";
            this.#canvas.width = canvas.width;
            this.#canvas.height = canvas.height;
        }

        if (!this.#ctx)
        {
            this.#ctx = this.#canvas.getContext("webgpu");

            if (!this.#ctx)
                return console.log("no context", this.#canvas, this.#ctx);
            this.#ctx.configure({
                "device": this.#cgp.device,
                "format": this.#cgp.presentationFormat
            });

        }

        // const cgp = this.#cgp;
        // cgp.canvasInfo.depthTextureView = this.#ctx.createView();

        this.#cgp.renderPassDescriptor = {
            "label": "preview renderpass",
            "colorAttachments": [
                {
                    "view": this.#ctx.getCurrentTexture().createView(),
                    "loadOp": "clear",
                    "storeOp": "store",
                },

            ],
            "depthStencilAttachment": {
                "view": this.#cgp.canvasInfo.depthTextureView,
                "depthClearValue": 1,
                "depthLoadOp": "clear",
                "depthStoreOp": "store",
            },
        };

        // make a render pass encoder to encode render specific commands
        this.#cgp.passEncoder = this.#cgp.commandEncoder.beginRenderPass(this.#cgp.renderPassDescriptor);
        this.#cgp.textureView = this.#ctx.getCurrentTexture().createView();
        this.#cgp.renderStart();

        cb();

        this.#cgp.tempPrevCanvas = this.#canvas;

        this.#cgp.renderEnd();
        this.#cgp.passEncoder.end();

    }

}

;// CONCATENATED MODULE: ./src/core/cgp/index.js











const CGP = {
    "Context": CgpContext,
    "Shader": CgpShader,
    "Mesh": CgpMesh,
    "Pipeline": Pipeline,
    "Texture": cgp_texture_Texture,
    "Binding": Binding,
    "Uniform": CgpUniform,
    "MESHES": MESHES,
    "GPUBuffer": CgpGguBuffer
};

window.CABLES = window.CABLES || {};
window.CABLES.CGP = CGP;
window.CGP = CGP;
window.CGP.WebGpuCanvasAttachment = WebGpuCanvasAttachment;
window.CGP.Pipeline = Pipeline;



;// CONCATENATED MODULE: ./src/core/cg/cg_fpscounter.js


class FpsCounter extends Events
{
    constructor()
    {
        super();
        this._timeStartFrame = 0;
        this._timeStartSecond = 0;
        this._fpsCounter = 0;
        this._msCounter = 0;
        this._frameCount = 0;

        this.stats = { "ms": 0, "fps": 0 };
    }

    get frameCount()
    {
        return this._frameCount;
    }

    startFrame()
    {
        this._timeStartFrame = CABLES.now();
    }

    endFrame()
    {
        this._frameCount++;
        this._fpsCounter++;

        const timeFrame = CABLES.now() - this._timeStartFrame;
        this._msCounter += timeFrame;

        if (CABLES.now() - this._timeStartSecond > 1000) this.endSecond();
    }

    endSecond()
    {
        this.stats.fps = this._fpsCounter;
        this.stats.ms = Math.round(this._msCounter / this._fpsCounter * 100) / 100;

        this.emitEvent("performance", this.stats);

        // reset
        this._fpsCounter = 0;
        this._msCounter = 0;
        this._timeStartSecond = CABLES.now();
    }
}

;// CONCATENATED MODULE: ./src/core/cg/cg_constants.js





const CG = {

    "DEPTH_COMPARE_NEVER": 0,
    "DEPTH_COMPARE_LESS": 1,
    "DEPTH_COMPARE_EQUAL": 2,
    "DEPTH_COMPARE_LESSEQUAL": 3,
    "DEPTH_COMPARE_GREATER": 4,
    "DEPTH_COMPARE_NOTEQUAL": 5,
    "DEPTH_COMPARE_GREATEREQUAL": 6,
    "DEPTH_COMPARE_ALWAYS": 7,

    "CULL_NONE": 0,
    "CULL_BACK": 1,
    "CULL_FRONT": 2,
    "CULL_BOTH": 3,

    "Geometry": Geometry,
    "BoundingBox": BoundingBox,
    "FpsCounter": FpsCounter,

    "CgCanvas": CgCanvas
};



;// CONCATENATED MODULE: ./src/core/cgl/cgl_framebuffer2.js



class Framebuffer2
{
    constructor(cgl, w, h, options)
    {
        this._log = new Logger("cgl_framebuffer2");
        if (cgl.glVersion == 1) this._log.error("framebuffer2 used on webgl1");
        this.Framebuffer2DrawTargetsDefault = null;
        this.Framebuffer2BlittingFramebuffer = null;
        this.Framebuffer2FinalFramebuffer = null;
        this._cgl = cgl;

        this._cgl.printError("before framebuffer2 constructor");

        this._width = 0;
        this._height = 0;
        this.valid = true;

        this._depthRenderbuffer = null;
        this._frameBuffer = null;
        this._textureFrameBuffer = null;
        this._colorRenderbuffers = [];
        this._drawTargetArray = [];
        this._disposed = false;

        if (!this.Framebuffer2BlittingFramebuffer) this.Framebuffer2BlittingFramebuffer = cgl.gl.createFramebuffer();
        if (!this.Framebuffer2FinalFramebuffer) this.Framebuffer2FinalFramebuffer = cgl.gl.createFramebuffer();

        if (!this.Framebuffer2DrawTargetsDefault) this.Framebuffer2DrawTargetsDefault = [cgl.gl.COLOR_ATTACHMENT0];

        this._options = options || {
            "isFloatingPointTexture": false,
        };

        this.name = this._options.name || "unknown";

        this._cgl.profileData.addHeavyEvent("framebuffer create", this.name);

        if (!this._options.hasOwnProperty("numRenderBuffers")) this._options.numRenderBuffers = 1;
        if (!this._options.hasOwnProperty("depth")) this._options.depth = true;
        if (!this._options.hasOwnProperty("clear")) this._options.clear = true;
        if (!this._options.hasOwnProperty("multisampling"))
        {
            this._options.multisampling = false;
            this._options.multisamplingSamples = 0;
        }

        if (this._options.multisamplingSamples)
        {
            if (this._cgl.glSlowRenderer) this._options.multisamplingSamples = 0;
            if (!this._cgl.gl.MAX_SAMPLES) this._options.multisamplingSamples = 0;
            else this._options.multisamplingSamples = Math.min(this._cgl.maxSamples, this._options.multisamplingSamples);
        }

        if (!this._options.hasOwnProperty("filter")) this._options.filter = Texture.FILTER_LINEAR;
        if (!this._options.hasOwnProperty("wrap")) this._options.wrap = Texture.WRAP_REPEAT;

        this._numRenderBuffers = this._options.numRenderBuffers;
        this._colorTextures = [];

        this.clearColors = [];
        for (let i = 0; i < this._numRenderBuffers; i++) this.clearColors.push([0, 0, 0, 1]);

        if (!options.pixelFormat)
        {
            if (options.isFloatingPointTexture) this._options.pixelFormat = Texture.PFORMATSTR_RGBA32F;
            else this._options.pixelFormat = Texture.PFORMATSTR_RGBA8UB;
        }

        for (let i = 0; i < this._numRenderBuffers; i++)
        {
            this._colorTextures[i] = new Texture(cgl, {
                "name": "fb2 " + this.name + " " + i,
                "isFloatingPointTexture": this._options.isFloatingPointTexture,
                "anisotropic": this._options.anisotropic || 0,
                "pixelFormat": this._options.pixelFormat,
                "filter": this._options.filter,
                "wrap": this._options.wrap,
            });
        }

        let fil = Texture.FILTER_NEAREST;
        if (this._options.shadowMap) fil = Texture.FILTER_LINEAR;

        const defaultTexSize = 512;

        if (this._options.depth)
        {
            this._textureDepth = new Texture(cgl,
                {
                    "name": "fb2 depth " + this.name,
                    "isDepthTexture": true,
                    "filter": fil,
                    "shadowMap": this._options.shadowMap || false,
                    "width": w || defaultTexSize,
                    "height": h || defaultTexSize,
                });
        }

        if (cgl.aborted) return;

        this.setSize(w || defaultTexSize, h || defaultTexSize);

        this._cgl.printError("framebuffer2 constructor");
    }

    getWidth()
    {
        return this._width;
    }

    getHeight()
    {
        return this._height;
    }

    getGlFrameBuffer()
    {
        return this._frameBuffer;
    }

    getDepthRenderBuffer()
    {
        return this._depthRenderbuffer;
    }

    getTextureColor()
    {
        return this._colorTextures[0];
    }

    getTextureColorNum(i)
    {
        return this._colorTextures[i];
    }

    getTextureDepth()
    {
        return this._textureDepth;
    }

    setFilter(f)
    {
        for (let i = 0; i < this._numRenderBuffers; i++)
        {
            this._colorTextures[i].filter = f;
            this._colorTextures[i].setSize(this._width, this._height);
        }
    }

    delete()
    {
        this.dispose();
    }

    dispose()
    {
        this._disposed = true;
        let i = 0;
        for (i = 0; i < this._numRenderBuffers; i++) this._colorTextures[i].delete();
        // this._texture.delete();
        if (this._textureDepth) this._textureDepth.delete();
        for (i = 0; i < this._numRenderBuffers; i++) this._cgl.gl.deleteRenderbuffer(this._colorRenderbuffers[i]);
        this._cgl.gl.deleteRenderbuffer(this._depthRenderbuffer);
        this._cgl.gl.deleteFramebuffer(this._frameBuffer);
        this._cgl.gl.deleteFramebuffer(this._textureFrameBuffer);
    }

    setSize(w, h)
    {
        if (this._disposed) return this._log.warn("disposed framebuffer setsize...");
        this._cgl.profileData.addHeavyEvent("framebuffer resize", this.name);

        let i = 0;

        this._width = this._cgl.checkTextureSize(w);
        this._height = this._cgl.checkTextureSize(h);

        this._cgl.profileData.profileFrameBuffercreate++;

        if (this._frameBuffer)
        {
            for (i = 0; i < this._numRenderBuffers; i++) this._cgl.gl.deleteRenderbuffer(this._colorRenderbuffers[i]);
            // this._cgl.gl.deleteRenderbuffer(this._colorRenderbuffer);
            this._cgl.gl.deleteRenderbuffer(this._depthRenderbuffer);
            this._cgl.gl.deleteFramebuffer(this._frameBuffer);
            this._cgl.gl.deleteFramebuffer(this._textureFrameBuffer);
        }

        this._frameBuffer = this._cgl.gl.createFramebuffer();
        this._textureFrameBuffer = this._cgl.gl.createFramebuffer();

        const depth = this._options.depth;

        for (i = 0; i < this._numRenderBuffers; i++)
        {
            this._colorTextures[i].setSize(this._width, this._height);
        }

        for (i = 0; i < this._numRenderBuffers; i++)
        {
            const renderBuffer = this._cgl.gl.createRenderbuffer();

            // color renderbuffer

            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuffer);
            this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER, renderBuffer);

            const info = Texture.setUpGlPixelFormat(this._cgl, this._options.pixelFormat);
            let internFormat = info.glInternalFormat;

            // if (this._options.isFloatingPointTexture)
            // {
            if (CGL.Texture.isPixelFormatHalfFloat(info.pixelFormat))
            {
                if (!this._cgl.enableExtension("OES_texture_float_linear"))
                {
                    this._options.filter = Texture.FILTER_NEAREST;
                    this.setFilter(this._options.filter);
                }
            }
            else if (CGL.Texture.isPixelFormatFloat(info.pixelFormat))
            {
                if (!this._cgl.enableExtension("OES_texture_float_linear"))
                {
                    this._log.warn("no linear pixelformat,using nearest");
                    this._options.filter = Texture.FILTER_NEAREST;
                    this.setFilter(this._options.filter);
                }
            }
            // else if (info.pixelFormat == Texture.PFORMATSTR_RGBA32F || info.pixelFormat == Texture.PFORMATSTR_R11FG11FB10F
            // else if (info.pixelFormat == Texture.PFORMATSTR_RGBA32F || info.pixelFormat == Texture.PFORMATSTR_R11FG11FB10F
            // else if (info.pixelFormat == Texture.PFORMATSTR_RG16F)
            // {
            //     const extcb = this._cgl.enableExtension("EXT_color_buffer_float");

            //     if (!this._cgl.enableExtension("OES_texture_float_linear"))
            //     {
            //         console.log("no linear pixelformat,switching to nearest");
            //         this._options.filter = Texture.FILTER_NEAREST;
            //         this.setFilter(this._options.filter);
            //     }
            // }
            // }

            if (this._options.multisampling && this._options.multisamplingSamples)
            {
                this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER, this._options.multisamplingSamples, internFormat, this._width, this._height);
            }
            else
            {
                this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER, internFormat, this._width, this._height);
            }

            this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0 + i, this._cgl.gl.RENDERBUFFER, renderBuffer);
            this._colorRenderbuffers[i] = renderBuffer;
        }

        // this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER, this._textureFrameBuffer);
        this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._textureFrameBuffer);

        for (i = 0; i < this._numRenderBuffers; i++)
        {
            this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0 + i, this._cgl.gl.TEXTURE_2D, this._colorTextures[i].tex, 0);
        }

        if (this._options.depth)
        {
            this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.DEPTH_ATTACHMENT, this._cgl.gl.TEXTURE_2D, this._textureDepth.tex, 0);
        }

        // depth renderbuffer

        this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuffer);

        let depthType = this._cgl.gl.DEPTH_COMPONENT32F;

        if (this._cgl.glSlowRenderer) depthType = this._cgl.gl.DEPTH_COMPONENT16;
        if (depth)
        {
            this._textureDepth.setSize(this._width, this._height);
            this._depthRenderbuffer = this._cgl.gl.createRenderbuffer();

            this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER, this._depthRenderbuffer);
            if (this._options.isFloatingPointTexture)
            {
                if (this._options.multisampling) this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER, this._options.multisamplingSamples, depthType, this._width, this._height);
                else this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER, depthType, this._width, this._height);
            }
            else if (this._options.multisampling)
            {
                this._cgl.gl.renderbufferStorageMultisample(this._cgl.gl.RENDERBUFFER, this._options.multisamplingSamples, depthType, this._width, this._height);
            // this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER,depthType, this._width, this._height);
            }
            else
            {
                this._cgl.gl.renderbufferStorage(this._cgl.gl.RENDERBUFFER, depthType, this._width, this._height);
            }

            this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.DEPTH_ATTACHMENT, this._cgl.gl.RENDERBUFFER, this._depthRenderbuffer);
        }

        // this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, null);
        // this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._textureFrameBuffer);

        this._drawTargetArray.length = 0;
        for (i = 0; i < this._numRenderBuffers; i++) this._drawTargetArray.push(this._cgl.gl.COLOR_ATTACHMENT0 + i);

        // this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, null);

        if (!this._cgl.gl.isFramebuffer(this._textureFrameBuffer)) this._log.warn("invalid framebuffer");// throw new Error("Invalid framebuffer");
        const status = this._cgl.gl.checkFramebufferStatus(this._cgl.gl.FRAMEBUFFER);

        if (status != this._cgl.gl.FRAMEBUFFER_COMPLETE)
        {
            this._log.error("framebuffer incomplete: " + this.name, this);
            this._log.log("options", this._options);
            this._log.log("options pixelformat", this._options.pixelFormat);

            switch (status)
            {
            case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:
                this._log.warn("FRAMEBUFFER_INCOMPLETE_ATTACHMENT...", this);
                throw new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");
            case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:
                this._log.warn("FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
                throw new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");
            case this._cgl.gl.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:
                this._log.warn("FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
                throw new Error("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");
            case this._cgl.gl.FRAMEBUFFER_UNSUPPORTED:
                this._log.warn("FRAMEBUFFER_UNSUPPORTED");
                throw new Error("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");
            default:
                this.valid = false;
                this._log.error("incomplete framebuffer", status, this._frameBuffer);
                this._cgl.printError();

                this._frameBuffer = null;
                // debugger;
                throw new Error("Incomplete framebuffer: " + status);

        // throw("Incomplete framebuffer: " + status);
            }
        }

        this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, null);
        this._cgl.gl.bindRenderbuffer(this._cgl.gl.RENDERBUFFER, null);

    // this._cgl.printError("fb setsize");
    }

    renderStart()
    {
        if (this._disposed) return this._log.warn("disposed framebuffer renderStart...");
        this._cgl.checkFrameStarted("fb2 renderstart");
        this._cgl.pushModelMatrix(); // needed ??

        this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuffer);
        this._cgl.pushGlFrameBuffer(this._frameBuffer);
        this._cgl.pushFrameBuffer(this);

        this._cgl.pushPMatrix();
        this._cgl.pushViewPort(0, 0, this._width, this._height);

        this._cgl.gl.drawBuffers(this._drawTargetArray);

        if (this._options.clear)
        {
            this._cgl.gl.clearColor(0, 0, 0, 0);
            this._cgl.gl.clear(this._cgl.gl.COLOR_BUFFER_BIT | this._cgl.gl.DEPTH_BUFFER_BIT);
        }
    }

    clear()
    {
        if (this._numRenderBuffers <= 1)
        {
            this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER, this._frameBuffer);
            this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER, this._textureFrameBuffer);
        }
        else this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._frameBuffer);

        this._cgl.gl.drawBuffers(this._drawTargetArray);

        for (let i = 0; i < this._numRenderBuffers; i++)
        {
            this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0 + i, this._cgl.gl.TEXTURE_2D, this._colorTextures[i].tex, 0);
            this._cgl.gl.clearBufferfv(this._cgl.gl.COLOR, i, this.clearColors[i]);
        }
        this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, null);
    }

    renderEnd()
    {
        if (this._disposed) return this._log.warn("disposed framebuffer renderEnd...");
        this._cgl.popPMatrix();

        this._cgl.profileData.profileFramebuffer++;

        if (this._numRenderBuffers <= 1)
        {
            this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER, this._frameBuffer);
            this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER, this._textureFrameBuffer);

            this._cgl.gl.clearBufferfv(this._cgl.gl.COLOR, 0, [0.0, 0.0, 0.0, 1.0]);
            this._cgl.gl.blitFramebuffer(0, 0, this._width, this._height, 0, 0, this._width, this._height, this._cgl.gl.COLOR_BUFFER_BIT | this._cgl.gl.DEPTH_BUFFER_BIT, this._cgl.gl.NEAREST);
        }
        else
        {
            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this.Framebuffer2BlittingFramebuffer);
            this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.DEPTH_ATTACHMENT, this._cgl.gl.RENDERBUFFER, this._depthRenderbuffer);

            this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this.Framebuffer2FinalFramebuffer);
            this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.DEPTH_ATTACHMENT, this._cgl.gl.TEXTURE_2D, this._textureDepth.tex, 0);

            for (let i = 0; i < this._numRenderBuffers; i++)
            {
                this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this.Framebuffer2BlittingFramebuffer);
                this._cgl.gl.framebufferRenderbuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0, this._cgl.gl.RENDERBUFFER, this._colorRenderbuffers[i]);

                this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this.Framebuffer2FinalFramebuffer);
                this._cgl.gl.framebufferTexture2D(this._cgl.gl.FRAMEBUFFER, this._cgl.gl.COLOR_ATTACHMENT0, this._cgl.gl.TEXTURE_2D, this._colorTextures[i].tex, 0);

                this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, null);

                this._cgl.gl.bindFramebuffer(this._cgl.gl.READ_FRAMEBUFFER, this.Framebuffer2BlittingFramebuffer);
                this._cgl.gl.bindFramebuffer(this._cgl.gl.DRAW_FRAMEBUFFER, this.Framebuffer2FinalFramebuffer);

                // this._cgl.gl.clearBufferfv(this._cgl.gl.COLOR, i, [0.0, 0.0, 0.0, 1.0]);

                let flags = this._cgl.gl.COLOR_BUFFER_BIT;
                if (i == 0) flags |= this._cgl.gl.DEPTH_BUFFER_BIT;

                this._cgl.gl.blitFramebuffer(0, 0, this._width, this._height, 0, 0, this._width, this._height, flags, this._cgl.gl.NEAREST);
            }
        }

        this._cgl.gl.bindFramebuffer(this._cgl.gl.FRAMEBUFFER, this._cgl.popGlFrameBuffer());
        this._cgl.popFrameBuffer();

        this._cgl.popModelMatrix();
        // this._cgl.resetViewPort();
        this._cgl.popViewPort();

        if (this._colorTextures[0].filter == Texture.FILTER_MIPMAP)
        {
            for (let i = 0; i < this._numRenderBuffers; i++)
            {
                this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D, this._colorTextures[i].tex);
                this._colorTextures[i].updateMipMap();
                this._cgl.gl.bindTexture(this._cgl.gl.TEXTURE_2D, null);
            }
        }
    }
}

;// CONCATENATED MODULE: ./src/core/cgl/cgl_marker.js
/** @type {function}
 * @deprecated
*/
const Marker = function (_cgl) // deprecated...
{
    this.draw = function (cgl, _size, depthTest) {};
};

/** @type {function}
 * @deprecated
*/
const WirePoint = function (cgl) // deprecated...
{
    this.render = function (_cgl, _size) {};
};

/** @type {function}
 * @deprecated
*/
const WireCube = function (cgl) // deprecated...
{
    this.render = function (_cgl, sizeX, sizeY, sizeZ) {};
};

;// CONCATENATED MODULE: ./src/core/cgl/cgl_unicolorshader.js


class UniColorShader
{
    constructor(_cgl)
    {
        this.shader = new CGL.Shader(_cgl, "markermaterial");

        const frag = ""
            .endl() + "void main()"
            .endl() + "{"
            .endl() + "    outColor = vec4(color.rgb,1.0);"
            .endl() + "}";

        const vert = ""
            .endl() + "IN vec3 vPosition;"
            .endl() + "UNI mat4 projMatrix;"
            .endl() + "UNI mat4 mvMatrix;"

            .endl() + "void main()"
            .endl() + "{"
            .endl() + "   gl_Position = projMatrix * mvMatrix * vec4(vPosition,1.0);"
            .endl() + "}";

        this.shader.setSource(vert, frag);
        this.coloruni = this.shader.addUniformFrag("4f", "color", [1, 0.777, 1, 1]);
    }

    setColor(r, g, b, a)
    {
        this.coloruni.set(r, g, b, a);
    }
}

;// CONCATENATED MODULE: ./src/core/cgl/cgl_utils.js
/**
 * @namespace CGL
 */

/**
 * multiply to get radians from degree, e.g. `360 * CGL.DEG2RAD`
 * @const {Number}
 * @memberof CGL
 * @static
 */
const cgl_utils_DEG2RAD = Math.PI / 180.0;

/**
 * to get degrees from radians, e.g. `3.14 * CGL.RAD2DEG`
 * @const {number}
 * @memberof CGL
 */
const cgl_utils_RAD2DEG = 180.0 / Math.PI;

const onLoadingAssetsFinished = null; // deprecated / remove later

/**
 * get normalized mouse wheel delta (including browser specific adjustment)
 * @function getWheelDelta
 * @static
 * @memberof CGL
 * @param {MouseEvent} event
 * @return {Number} normalized delta
 */
const isWindows = window.navigator.userAgent.includes("Windows");
const getWheelDelta_ = function (event)
{
    let normalized;
    if (event.wheelDelta)
    {
        // chrome
        normalized = (event.wheelDelta % 120) - 0 == -0 ? event.wheelDelta / 120 : event.wheelDelta / 30;
        normalized *= -1.5;
        if (isWindows) normalized *= 2;
    }
    else
    {
        // firefox
        let d = event.deltaY;
        if (event.shiftKey) d = event.deltaX;
        const rawAmmount = d || event.detail;
        normalized = -(rawAmmount % 3 ? rawAmmount * 10 : rawAmmount / 3);
        normalized *= -3;
    }

    if (normalized > 20) normalized = 20;
    if (normalized < -20) normalized = -20;

    return normalized;
};

const getWheelSpeed = getWheelDelta_;
const getWheelDelta = getWheelDelta_;

// from https://github.com/lodash/lodash/blob/master/escape.js

const htmlEscapes = {
    "&": "&amp;",
    "<": "&lt;",
    ">": "&gt;",
    "\"": "&quot;",
    "'": "&#39;",
};

/** Used to match HTML entities and HTML characters. */
const reUnescapedHtml = /[&<>"']/g;
const reHasUnescapedHtml = RegExp(reUnescapedHtml.source);

/*  eslint-disable */
const escapeHTML = function(string)
{
    return string && reHasUnescapedHtml.test(string) ?
        string.replace(reUnescapedHtml, function(chr) { return htmlEscapes[chr]; })
        : string || "";
}
/* eslint-enable */

;// CONCATENATED MODULE: ./src/core/cgl/index.js



















const cgl_CGL = {
    "Framebuffer2": Framebuffer2,
    "Geometry": Geometry,
    "BoundingBox": BoundingBox,
    "Marker": Marker,
    "WirePoint": WirePoint,
    "WireCube": WireCube,
    "MatrixStack": MatrixStack,
    "Mesh": Mesh,
    "MESH": MESH,
    "ShaderLibMods": ShaderLibMods,
    "Shader": CglShader,
    "Uniform": cgl_shader_uniform_Uniform,
    "MESHES": MESHES,
    "Context": CglContext,
    "Texture": Texture,
    "TextureEffect": TextureEffect,
    "isWindows": isWindows,
    "getWheelSpeed": getWheelSpeed,
    "getWheelDelta": getWheelDelta,
    "onLoadingAssetsFinished": onLoadingAssetsFinished,
    "ProfileData": ProfileData,
    "UniColorShader": UniColorShader,
    ...constants_CONSTANTS.BLEND_MODES,
    ...constants_CONSTANTS.SHADER,
    ...constants_CONSTANTS.MATH,
    ...constants_CONSTANTS.BLEND_MODES,
};

window.CGL = cgl_CGL;



;// CONCATENATED MODULE: ./src/core/index.js




















window.glMatrix = common_namespaceObject;
window.mat2 = mat2_namespaceObject;
window.mat2d = mat2d_namespaceObject;
window.mat3 = mat3_namespaceObject;
window.mat4 = mat4_namespaceObject;
window.quat = quat_namespaceObject;
window.quat2 = quat2_namespaceObject;
window.vec2 = vec2_namespaceObject;

window.vec3 = vec3_namespaceObject;
window.vec4 = vec4_namespaceObject;

window.CABLES = window.CABLES || {};

CABLES.CGL = cgl_CGL;
CABLES.CG = CG;
CABLES.CGP = CGP;
CABLES.EMBED = EMBED;
CABLES.Link = Link;
CABLES.Port = Port;
CABLES.Op = Op;
CABLES.Profiler = Profiler;
CABLES.Patch = Patch;
CABLES.Timer = Timer;
CABLES.WEBAUDIO = WEBAUDIO;
CABLES.Variable = Variable;
CABLES.LoadingStatus = LoadingStatus;
CABLES.now = now;
CABLES.internalNow = internalNow;
CABLES.Anim = Anim;
CABLES.AnimKey = AnimKey;

CABLES.shortId = shortId;
CABLES.uuid = uuid;
CABLES.getShortOpName = getShortOpName;
CABLES.simpleId = simpleId;
CABLES.clamp = clamp;
CABLES.map = map;
CABLES.shuffleArray = shuffleArray;
CABLES.generateUUID = generateUUID;
CABLES.prefixedHash = prefixedHash;
CABLES.smoothStep = smoothStep;
CABLES.smootherStep = smootherStep;
CABLES.cacheBust = cacheBust;
CABLES.copyArray = copyArray;
CABLES.basename = basename;
CABLES.logStack = logStack;
CABLES.filename = filename;
CABLES.ajaxSync = ajaxSync;
CABLES.ajax = ajax;
CABLES.request = request;
CABLES.logErrorConsole = logErrorConsole;
CABLES.isNumeric = isNumeric;
CABLES.isArray = isArray;
CABLES.float32Concat = float32Concat;
CABLES.uniqueArray = uniqueArray;
CABLES.CGState = CgContext;
CABLES.CgContext = CgContext;

CABLES = Object.assign(CABLES,
    CONSTANTS.PORT,
    CONSTANTS.PACO,
    CONSTANTS.ANIM,
    CONSTANTS.OP
);

// CABLES.map = utils.map;
/* harmony default export */ const core = (CABLES);

if (!(function () { return !this; }())) console.warn("not in strict mode: index core"); // eslint-disable-line

CABLES = __webpack_exports__["default"];
/******/ })()
;


var CABLES = CABLES || {}; CABLES.build = {"timestamp":1741713343557,"created":"2025-03-11T17:15:43.557Z","git":{"branch":"develop","commit":"6ba0616e0b4a7bbfda456ef0eed44e22d0b4a1dd","date":"1741711428","message":"t"}};
if(!CABLES.exportedPatches)CABLES.exportedPatches={};CABLES.exportedPatches["aZfgnp"]={_id:"66f3ce6623173e5d0f6832cc",ops:[{id:"0r99axrj1",uiAttribs:{},portsIn:[{name:"file",display:"file",title:"URL"},{name:"body",value:""},{name:"HTTP Method index",value:0},{name:"HTTP Method",value:"GET"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:1},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"Object",portOut:"Response Json Object",objIn:"7im8o3aby",objOut:"0r99axrj1"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:576},{name:"Status Code",value:200},{name:"Is Loading",value:0},{name:"Loaded",links:[{portIn:"730z43avr",portOut:"Loaded",objIn:"pq3jp8dkg",objOut:"0r99axrj1"}]}],objName:"Ops.Json.HttpRequest_v3"},{id:"66zqesi0w",uiAttribs:{},portsIn:[{name:"file",display:"file",title:"URL"},{name:"body",value:""},{name:"HTTP Method index",value:0},{name:"HTTP Method",value:"GET"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:1},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"Object",portOut:"Response Json Object",objIn:"x7rbzz597",objOut:"66zqesi0w"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:818},{name:"Status Code",value:200},{name:"Is Loading",value:0},{name:"Loaded",links:[{portIn:"730z43avr",portOut:"Loaded",objIn:"pq3jp8dkg",objOut:"66zqesi0w"}]}],objName:"Ops.Json.HttpRequest_v3"},{id:"ydp8b0q21",uiAttribs:{},portsIn:[{name:"Max Pixel Density (DPR)",value:2},{name:"FPS Limit",value:0},{name:"Reduce FPS unfocussed",value:0},{name:"Transparent",value:0},{name:"Active",value:1}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"krdgvwmaw",objOut:"ydp8b0q21"}]},{name:"width",value:1920},{name:"height",value:1080},{name:"Pixel Density",value:1}],objName:"Ops.Gl.MainLoop_v2"},{id:"j8ywtwjs3",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"recalcData"}],portsOut:[{name:"Triggered",links:[{portIn:"reload",portOut:"Triggered",objIn:"0r99axrj1",objOut:"j8ywtwjs3"},{portIn:"reload",portOut:"Triggered",objIn:"66zqesi0w",objOut:"j8ywtwjs3"},{portIn:"reload",portOut:"Triggered",objIn:"72zay0f6k",objOut:"j8ywtwjs3"},{portIn:"reload",portOut:"Triggered",objIn:"77f4lbr5s",objOut:"j8ywtwjs3"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"jtvmeqqoy",uiAttribs:{},portsIn:[{name:"Opacity",value:1},{name:"Default Minimized",value:1},{name:"Minimized Opacity",value:.5},{name:"Show undo button",value:0},{name:"Show Minimize",value:0},{name:"Title",value:""},{name:"Side",value:1},{name:"Default CSS",value:1}],portsOut:[{name:"childs",title:"Children",links:[{portIn:"link",portOut:"childs",objIn:"6uhi7em2l",objOut:"jtvmeqqoy"}]},{name:"Opfened",value:false,title:"Opened"}],objName:"Ops.Sidebar.Sidebar"},{id:"5oosul0lh",uiAttribs:{},portsIn:[{name:"a",value:1}],portsOut:[{name:"trigger",links:[{portIn:"In Trigger",portOut:"trigger",objIn:"fpb8eucar",objOut:"5oosul0lh"},{portIn:"Trigger",portOut:"trigger",objIn:"t876quj1v",objOut:"5oosul0lh"},{portIn:"Execute",portOut:"trigger",objIn:"k4vswg2ua",objOut:"5oosul0lh"}]}],objName:"Ops.Gl.ClearColor"},{id:"9o56qq06f",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"yf43omkz0",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"wxiqs4u5r",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],portsOut:[{name:"Value",links:[{portIn:"Links",portOut:"Value",objIn:"paxjpnxf4",objOut:"wxiqs4u5r"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"guffcb2sd",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Nodes",portOut:"Value",objIn:"paxjpnxf4",objOut:"guffcb2sd"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"byl39i68q",uiAttribs:{},portsIn:[{name:"file",value:"assets/66f3ce6623173e5d0f6832cc_ESKlarheitGroteskMono-Bk.woff2",display:"file"},{name:"family",value:"ES Klarheit Grotesk Mono"},{name:"Active",value:1}],portsOut:[{name:"Loaded",value:1}],objName:"Ops.Html.FontFile_v2"},{id:"7im8o3aby",uiAttribs:{},portsOut:[{name:"Array",links:[{portIn:"o23wa0mqe",portOut:"Array",objIn:"pq3jp8dkg",objOut:"7im8o3aby"}]}],objName:"Ops.Json.ObjectToArray"},{id:"x7rbzz597",uiAttribs:{},portsOut:[{name:"Array",links:[{portIn:"v05oytwcd",portOut:"Array",objIn:"pq3jp8dkg",objOut:"x7rbzz597"}]}],objName:"Ops.Json.ObjectToArray"},{id:"43edjbdnr",uiAttribs:{},portsIn:[{name:"Key",value:"x"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"59m1r5f84",objOut:"43edjbdnr"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"59m1r5f84",uiAttribs:{},portsIn:[{name:"Key",value:"y"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"t8p3xo56o",objOut:"59m1r5f84"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"hi748t6ix",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"43edjbdnr",objOut:"hi748t6ix"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"tq8a1tycb",uiAttribs:{},portsIn:[{name:"Text",value:"center"},{name:"Show Title",value:1},{name:"Default Minimized",value:1},{name:"Visible",value:1}],portsOut:[{name:"next",links:[{portIn:"link",portOut:"next",objIn:"k2hdg64vj",objOut:"tq8a1tycb"}]},{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"bfd3sga52",objOut:"tq8a1tycb"}]}],objName:"Ops.Sidebar.Group"},{id:"k2hdg64vj",uiAttribs:{},portsIn:[{name:"Text",value:"charge"},{name:"Show Title",value:1},{name:"Default Minimized",value:0},{name:"Visible",value:1}],portsOut:[{name:"next",links:[{portIn:"link",portOut:"next",objIn:"wkahm0a8h",objOut:"k2hdg64vj"}]},{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"y4ikc0n2q",objOut:"k2hdg64vj"}]}],objName:"Ops.Sidebar.Group"},{id:"wkahm0a8h",uiAttribs:{},portsIn:[{name:"Text",value:"collide"},{name:"Show Title",value:1},{name:"Default Minimized",value:0},{name:"Visible",value:1}],portsOut:[{name:"next",links:[{portIn:"link",portOut:"next",objIn:"efx7n0z49",objOut:"wkahm0a8h"}]},{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"z7imwae58",objOut:"wkahm0a8h"}]}],objName:"Ops.Sidebar.Group"},{id:"efx7n0z49",uiAttribs:{},portsIn:[{name:"Text",value:"forceX"},{name:"Show Title",value:1},{name:"Default Minimized",value:0},{name:"Visible",value:1}],portsOut:[{name:"next",links:[{portIn:"link",portOut:"next",objIn:"tlwbzbuxp",objOut:"efx7n0z49"}]},{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"hmjje7d3a",objOut:"efx7n0z49"}]}],objName:"Ops.Sidebar.Group"},{id:"tlwbzbuxp",uiAttribs:{},portsIn:[{name:"Text",value:"forceY"},{name:"Show Title",value:1},{name:"Default Minimized",value:0},{name:"Visible",value:1}],portsOut:[{name:"next",links:[{portIn:"link",portOut:"next",objIn:"5c8brevhy",objOut:"tlwbzbuxp"}]},{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"xrtpemkoq",objOut:"tlwbzbuxp"}]}],objName:"Ops.Sidebar.Group"},{id:"5c8brevhy",uiAttribs:{},portsIn:[{name:"Text",value:"link"},{name:"Show Title",value:1},{name:"Default Minimized",value:0},{name:"Visible",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"tep104xd4",objOut:"5c8brevhy"}]}],objName:"Ops.Sidebar.Group"},{id:"y4ikc0n2q",uiAttribs:{},portsIn:[{name:"Text",value:"enabled"},{name:"Input",value:1},{name:"Default",value:1},{name:"Grey Out",value:0},{name:"Visible",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"x76g0nhxm",objOut:"y4ikc0n2q"}]},{name:"Value",links:[{portIn:"Number",portOut:"Value",objIn:"64jc19533",objOut:"y4ikc0n2q"}]}],objName:"Ops.Sidebar.Toggle_v4"},{id:"x76g0nhxm",uiAttribs:{},portsIn:[{name:"Text",value:"strength"},{name:"Min",value:-500},{name:"Max",value:0},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:-50},{name:"Default",value:-50}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"rwmz49bmn",objOut:"x76g0nhxm"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"9m92kyo6k",objOut:"x76g0nhxm"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"rwmz49bmn",uiAttribs:{},portsIn:[{name:"Text",value:"distanceMin"},{name:"Min",value:0},{name:"Max",value:600},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:1},{name:"Default",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"xol2vv1hr",objOut:"rwmz49bmn"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"hlwy2ljnj",objOut:"rwmz49bmn"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"z7imwae58",uiAttribs:{},portsIn:[{name:"Text",value:"enabled"},{name:"Input",value:1},{name:"Default",value:1},{name:"Grey Out",value:0},{name:"Visible",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"9jw1edqku",objOut:"z7imwae58"}]},{name:"Value",links:[{portIn:"Number",portOut:"Value",objIn:"f3z94i3yj",objOut:"z7imwae58"}]}],objName:"Ops.Sidebar.Toggle_v4"},{id:"9jw1edqku",uiAttribs:{},portsIn:[{name:"Text",value:"strength"},{name:"Min",value:0},{name:"Max",value:1},{name:"Step",value:.01},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:1},{name:"Default",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"x739yojdp",objOut:"9jw1edqku"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"l63kjau2y",objOut:"9jw1edqku"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"x739yojdp",uiAttribs:{},portsIn:[{name:"Text",value:"iterations"},{name:"Min",value:0},{name:"Max",value:10},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:1},{name:"Default",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"b194i0y4l",objOut:"x739yojdp"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"mc6aa6bvo",objOut:"x739yojdp"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"hmjje7d3a",uiAttribs:{},portsIn:[{name:"Text",value:"enabled"},{name:"Input",value:0},{name:"Default",value:0},{name:"Grey Out",value:0},{name:"Visible",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"80um0a3xl",objOut:"hmjje7d3a"}]},{name:"Value",links:[{portIn:"Number",portOut:"Value",objIn:"ejc3ykqeq",objOut:"hmjje7d3a"}]}],objName:"Ops.Sidebar.Toggle_v4"},{id:"80um0a3xl",uiAttribs:{},portsIn:[{name:"Text",value:"strength"},{name:"Min",value:0},{name:"Max",value:1},{name:"Step",value:.01},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:.1},{name:"Default",value:.1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"ce3ohfq7a",objOut:"80um0a3xl"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"892vgxw68",objOut:"80um0a3xl"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"ce3ohfq7a",uiAttribs:{},portsIn:[{name:"Text",value:"x"},{name:"Min",value:-1},{name:"Max",value:1},{name:"Step",value:.1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:0},{name:"Default",value:0}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"5uj97ovd8",objOut:"ce3ohfq7a"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"xrtpemkoq",uiAttribs:{},portsIn:[{name:"Text",value:"enabled"},{name:"Input",value:0},{name:"Default",value:0},{name:"Grey Out",value:0},{name:"Visible",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"sb9tc5yk1",objOut:"xrtpemkoq"}]},{name:"Value",links:[{portIn:"Number",portOut:"Value",objIn:"20i1kt7nh",objOut:"xrtpemkoq"}]}],objName:"Ops.Sidebar.Toggle_v4"},{id:"tep104xd4",uiAttribs:{},portsIn:[{name:"Text",value:"enabled"},{name:"Input",value:1},{name:"Default",value:1},{name:"Grey Out",value:0},{name:"Visible",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"a7ccm842b",objOut:"tep104xd4"}]},{name:"Value",links:[{portIn:"Number",portOut:"Value",objIn:"hobikusiq",objOut:"tep104xd4"}]}],objName:"Ops.Sidebar.Toggle_v4"},{id:"a7ccm842b",uiAttribs:{},portsIn:[{name:"Text",value:"distance"},{name:"Min",value:0},{name:"Max",value:100},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:75},{name:"Default",value:75}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"ob7il0pz8",objOut:"a7ccm842b"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"hk3sr0qb4",objOut:"a7ccm842b"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"knfh8gr6t",uiAttribs:{},portsIn:[{name:"Text",value:"iterations"},{name:"Min",value:1},{name:"Max",value:10},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:1},{name:"Default",value:1}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"6atx7yr8u",objOut:"knfh8gr6t"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"xol2vv1hr",uiAttribs:{},portsIn:[{name:"Text",value:"distanceMax"},{name:"Min",value:0},{name:"Max",value:1e3},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:1e3},{name:"Default",value:1e3}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"1l5zet19a",objOut:"xol2vv1hr"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"b194i0y4l",uiAttribs:{},portsIn:[{name:"Text",value:"radius"},{name:"Min",value:0},{name:"Max",value:300},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:1},{name:"Default",value:1}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"a3defoeuu",objOut:"b194i0y4l"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"sb9tc5yk1",uiAttribs:{},portsIn:[{name:"Text",value:"strength"},{name:"Min",value:0},{name:"Max",value:1},{name:"Step",value:.01},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:.1},{name:"Default",value:.1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"v3z6pz81k",objOut:"sb9tc5yk1"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"d65foa8m7",objOut:"sb9tc5yk1"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"v3z6pz81k",uiAttribs:{},portsIn:[{name:"Text",value:"y"},{name:"Min",value:-1},{name:"Max",value:1},{name:"Step",value:.1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:0},{name:"Default",value:0}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"seji2xh0h",objOut:"v3z6pz81k"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"56h7z0n5s",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"64jc19533",objOut:"56h7z0n5s"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"9m92kyo6k",uiAttribs:{},portsIn:[{name:"Key",value:"strength"}],portsOut:[{name:"Result Object",links:[{portIn:"Object Value",portOut:"Result Object",objIn:"mha568081",objOut:"9m92kyo6k"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"1l5zet19a",uiAttribs:{},portsIn:[{name:"Key",value:"distanceMax"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"9m92kyo6k",objOut:"1l5zet19a"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"64jc19533",uiAttribs:{},portsIn:[{name:"Key",value:"enabled"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"hlwy2ljnj",objOut:"64jc19533"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"hlwy2ljnj",uiAttribs:{},portsIn:[{name:"Key",value:"distanceMin"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"1l5zet19a",objOut:"hlwy2ljnj"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"g9yc1gd4x",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"f3z94i3yj",objOut:"g9yc1gd4x"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"l63kjau2y",uiAttribs:{},portsIn:[{name:"Key",value:"strength"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"mc6aa6bvo",objOut:"l63kjau2y"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"a3defoeuu",uiAttribs:{},portsIn:[{name:"Key",value:"radius"}],portsOut:[{name:"Result Object",links:[{portIn:"Object Value",portOut:"Result Object",objIn:"0py34z6sm",objOut:"a3defoeuu"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"f3z94i3yj",uiAttribs:{},portsIn:[{name:"Key",value:"enabled"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"l63kjau2y",objOut:"f3z94i3yj"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"mc6aa6bvo",uiAttribs:{},portsIn:[{name:"Key",value:"iterations"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"a3defoeuu",objOut:"mc6aa6bvo"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"kpdsar41v",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"ejc3ykqeq",objOut:"kpdsar41v"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"892vgxw68",uiAttribs:{},portsIn:[{name:"Key",value:"strength"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"5uj97ovd8",objOut:"892vgxw68"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"ejc3ykqeq",uiAttribs:{},portsIn:[{name:"Key",value:"enabled"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"892vgxw68",objOut:"ejc3ykqeq"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"5uj97ovd8",uiAttribs:{},portsIn:[{name:"Key",value:"x"}],portsOut:[{name:"Result Object",links:[{portIn:"Object Value",portOut:"Result Object",objIn:"s9umw5927",objOut:"5uj97ovd8"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"nweq7btci",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"20i1kt7nh",objOut:"nweq7btci"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"d65foa8m7",uiAttribs:{},portsIn:[{name:"Key",value:"strength"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"seji2xh0h",objOut:"d65foa8m7"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"20i1kt7nh",uiAttribs:{},portsIn:[{name:"Key",value:"enabled"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"d65foa8m7",objOut:"20i1kt7nh"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"seji2xh0h",uiAttribs:{},portsIn:[{name:"Key",value:"y"}],portsOut:[{name:"Result Object",links:[{portIn:"Object Value",portOut:"Result Object",objIn:"7r2j4s7h1",objOut:"seji2xh0h"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"to3e2w3x7",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"hobikusiq",objOut:"to3e2w3x7"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"hk3sr0qb4",uiAttribs:{},portsIn:[{name:"Key",value:"distance"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"9rq5x40nc",objOut:"hk3sr0qb4"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"hobikusiq",uiAttribs:{},portsIn:[{name:"Key",value:"enabled"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"hk3sr0qb4",objOut:"hobikusiq"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"6atx7yr8u",uiAttribs:{},portsIn:[{name:"Key",value:"iterations"}],portsOut:[{name:"Result Object",links:[{portIn:"Object Value",portOut:"Result Object",objIn:"b7rkoab5w",objOut:"6atx7yr8u"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"48hkwfdpa",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_forceParameters"}],portsOut:[{name:"Value",links:[{portIn:"Force Props",portOut:"Value",objIn:"paxjpnxf4",objOut:"48hkwfdpa"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"6z11r035j",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"3cayf9dhz",objOut:"6z11r035j"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"3cayf9dhz",uiAttribs:{},portsIn:[{name:"Key",value:"center"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"mha568081",objOut:"3cayf9dhz"}]}],objName:"Ops.Json.ObjectSetObject_v2"},{id:"mha568081",uiAttribs:{},portsIn:[{name:"Key",value:"charge"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"0py34z6sm",objOut:"mha568081"}]}],objName:"Ops.Json.ObjectSetObject_v2"},{id:"0py34z6sm",uiAttribs:{},portsIn:[{name:"Key",value:"collide"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"s9umw5927",objOut:"0py34z6sm"}]}],objName:"Ops.Json.ObjectSetObject_v2"},{id:"s9umw5927",uiAttribs:{},portsIn:[{name:"Key",value:"forceX"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"7r2j4s7h1",objOut:"s9umw5927"}]}],objName:"Ops.Json.ObjectSetObject_v2"},{id:"7r2j4s7h1",uiAttribs:{},portsIn:[{name:"Key",value:"forceY"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"b7rkoab5w",objOut:"7r2j4s7h1"}]}],objName:"Ops.Json.ObjectSetObject_v2"},{id:"b7rkoab5w",uiAttribs:{},portsIn:[{name:"Key",value:"link"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"dh2yuf2jh",objOut:"b7rkoab5w"}]}],objName:"Ops.Json.ObjectSetObject_v2"},{id:"72zay0f6k",uiAttribs:{},portsIn:[{name:"file",display:"file",title:"URL"},{name:"body",value:""},{name:"HTTP Method index",value:0},{name:"HTTP Method",value:"GET"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:1},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"Object",portOut:"Response Json Object",objIn:"rgiu00iwx",objOut:"72zay0f6k"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:49},{name:"Status Code",value:200},{name:"Is Loading",value:0}],objName:"Ops.Json.HttpRequest_v3"},{id:"rgiu00iwx",uiAttribs:{},portsOut:[{name:"Array",links:[{portIn:"rto7lw458",portOut:"Array",objIn:"pq3jp8dkg",objOut:"rgiu00iwx"},{portIn:"Array",portOut:"Array",objIn:"43f4afjtj",objOut:"rgiu00iwx"}]}],objName:"Ops.Json.ObjectToArray"},{id:"pq3jp8dkg",uiAttribs:{},storage:{blueprintVer:2,subPatchVer:2},portsIn:[{name:"730z43avr",title:"update"},{name:"o23wa0mqe",title:"gruppen"},{name:"v05oytwcd",title:"personen"},{name:"rto7lw458",title:"ausstellungen"},{name:"e30lutyuo",title:"publikationen"},{name:"r7blsc36u",title:"filters"},{name:"patchId",value:"bp2sub_pq3jp8dkg"}],portsOut:[{name:"9mf4x6iay",title:"d3 nodes",links:[{portIn:"Value",portOut:"9mf4x6iay",objIn:"iv55k15mu",objOut:"pq3jp8dkg"}]},{name:"ncrwvgje9",title:"d3 links",links:[{portIn:"Value",portOut:"ncrwvgje9",objIn:"yd8i5ai1r",objOut:"pq3jp8dkg"}]}],objName:"Ops.Team.ACAR.Data"},{id:"43f4afjtj",uiAttribs:{},portsIn:[{name:"Path",value:"0.ID"}],portsOut:[{name:"Output",links:[{portIn:"Value",portOut:"Output",objIn:"o9qfcienz",objOut:"43f4afjtj"}]},{name:"Found",value:1}],objName:"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{id:"o9qfcienz",uiAttribs:{},portsIn:[{name:"Variable",value:"allExhibitions"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"m888m20oj",uiAttribs:{},portsIn:[{name:"delay",value:.3}],portsOut:[{name:"next",links:[{portIn:"Trigger",portOut:"next",objIn:"vcl7gd4ir",objOut:"m888m20oj"}]},{name:"Delaying",value:false}],objName:"Ops.Trigger.DelayedTrigger"},{id:"vcl7gd4ir",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_graph"}],objName:"Ops.Trigger.TriggerSend"},{id:"77f4lbr5s",uiAttribs:{},portsIn:[{name:"file",display:"file",title:"URL"},{name:"body",value:""},{name:"HTTP Method index",value:0},{name:"HTTP Method",value:"GET"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:1},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"Object",portOut:"Response Json Object",objIn:"x0b40e2x5",objOut:"77f4lbr5s"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:32},{name:"Status Code",value:200},{name:"Is Loading",value:0}],objName:"Ops.Json.HttpRequest_v3"},{id:"x0b40e2x5",uiAttribs:{},portsOut:[{name:"Array",links:[{portIn:"e30lutyuo",portOut:"Array",objIn:"pq3jp8dkg",objOut:"x0b40e2x5"}]}],objName:"Ops.Json.ObjectToArray"},{id:"1kffadlx2",uiAttribs:{},portsIn:[{name:"File 0",value:"assets/66f3ce6623173e5d0f6832cc_data_export_gruppen.json",display:"file"},{name:"File 1",value:"assets/66f3ce6623173e5d0f6832cc_data_export_gruppen_test.json",display:"file"},{name:"File 2",value:0,display:"file"},{name:"File 3",value:0,display:"file"},{name:"File 4",value:0,display:"file"},{name:"File 5",value:0,display:"file"},{name:"File 6",value:0,display:"file"},{name:"File 7",value:0,display:"file"},{name:"File 8",value:0,display:"file"},{name:"File 9",value:0,display:"file"},{name:"File 10",value:0,display:"file"},{name:"File 11",value:0,display:"file"},{name:"File 12",value:0,display:"file"},{name:"File 13",value:0,display:"file"},{name:"File 14",value:0,display:"file"},{name:"File 15",value:0,display:"file"}],portsOut:[{name:"Result",links:[{portIn:"file",portOut:"Result",objIn:"0r99axrj1",objOut:"1kffadlx2"}]}],objName:"Ops.String.File.SwitchFile_v2"},{id:"zen66z0q9",uiAttribs:{},portsIn:[{name:"File 0",value:"assets/66f3ce6623173e5d0f6832cc_data_export_personen.json",display:"file"},{name:"File 1",value:"assets/66f3ce6623173e5d0f6832cc_data_export_personen_test.json",display:"file"},{name:"File 2",value:0,display:"file"},{name:"File 3",value:0,display:"file"},{name:"File 4",value:0,display:"file"},{name:"File 5",value:0,display:"file"},{name:"File 6",value:0,display:"file"},{name:"File 7",value:0,display:"file"},{name:"File 8",value:0,display:"file"},{name:"File 9",value:0,display:"file"},{name:"File 10",value:0,display:"file"},{name:"File 11",value:0,display:"file"},{name:"File 12",value:0,display:"file"},{name:"File 13",value:0,display:"file"},{name:"File 14",value:0,display:"file"},{name:"File 15",value:0,display:"file"}],portsOut:[{name:"Result",links:[{portIn:"file",portOut:"Result",objIn:"66zqesi0w",objOut:"zen66z0q9"}]}],objName:"Ops.String.File.SwitchFile_v2"},{id:"v082j7adw",uiAttribs:{},portsIn:[{name:"File 0",value:"assets/66f3ce6623173e5d0f6832cc_data_export_ausstellungen.json",display:"file"},{name:"File 1",value:"assets/66f3ce6623173e5d0f6832cc_data_export_ausstellungen_test.json",display:"file"},{name:"File 2",value:0,display:"file"},{name:"File 3",value:0,display:"file"},{name:"File 4",value:0,display:"file"},{name:"File 5",value:0,display:"file"},{name:"File 6",value:0,display:"file"},{name:"File 7",value:0,display:"file"},{name:"File 8",value:0,display:"file"},{name:"File 9",value:0,display:"file"},{name:"File 10",value:0,display:"file"},{name:"File 11",value:0,display:"file"},{name:"File 12",value:0,display:"file"},{name:"File 13",value:0,display:"file"},{name:"File 14",value:0,display:"file"},{name:"File 15",value:0,display:"file"}],portsOut:[{name:"Result",links:[{portIn:"file",portOut:"Result",objIn:"72zay0f6k",objOut:"v082j7adw"}]}],objName:"Ops.String.File.SwitchFile_v2"},{id:"d2qsa1r5e",uiAttribs:{},portsIn:[{name:"File 0",value:"assets/66f3ce6623173e5d0f6832cc_data_export_publikationen.json",display:"file"},{name:"File 1",value:"assets/66f3ce6623173e5d0f6832cc_data_export_publikationen_test.json",display:"file"},{name:"File 2",value:0,display:"file"},{name:"File 3",value:0,display:"file"},{name:"File 4",value:0,display:"file"},{name:"File 5",value:0,display:"file"},{name:"File 6",value:0,display:"file"},{name:"File 7",value:0,display:"file"},{name:"File 8",value:0,display:"file"},{name:"File 9",value:0,display:"file"},{name:"File 10",value:0,display:"file"},{name:"File 11",value:0,display:"file"},{name:"File 12",value:0,display:"file"},{name:"File 13",value:0,display:"file"},{name:"File 14",value:0,display:"file"},{name:"File 15",value:0,display:"file"}],portsOut:[{name:"Result",links:[{portIn:"file",portOut:"Result",objIn:"77f4lbr5s",objOut:"d2qsa1r5e"}]}],objName:"Ops.String.File.SwitchFile_v2"},{id:"z7zaja85z",uiAttribs:{},portsIn:[{name:"Variable",value:"useTestData"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"1kffadlx2",objOut:"z7zaja85z"},{portIn:"Index",portOut:"Value",objIn:"zen66z0q9",objOut:"z7zaja85z"},{portIn:"Index",portOut:"Value",objIn:"v082j7adw",objOut:"z7zaja85z"},{portIn:"Index",portOut:"Value",objIn:"d2qsa1r5e",objOut:"z7zaja85z"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"wl7akj1nd",uiAttribs:{},portsIn:[{name:"Bytes",value:0}],portsOut:[{name:"R",links:[{portIn:"r",portOut:"R",objIn:"5oosul0lh",objOut:"wl7akj1nd"}]},{name:"G",links:[{portIn:"g",portOut:"G",objIn:"5oosul0lh",objOut:"wl7akj1nd"}]},{name:"B",links:[{portIn:"b",portOut:"B",objIn:"5oosul0lh",objOut:"wl7akj1nd"}]}],objName:"Ops.Color.HexToRGB_v2"},{id:"8bityd3ae",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Execute",portOut:"Next",objIn:"t7mamsdm9",objOut:"8bityd3ae"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"zvu4o6ow7",objOut:"8bityd3ae"},{portIn:"Array",portOut:"Result",objIn:"xvxj8o7kf",objOut:"8bityd3ae"},{portIn:"Positions",portOut:"Result",objIn:"6u9ozilaf",objOut:"8bityd3ae"},{portIn:"array",portOut:"Result",objIn:"w1qrga39m",objOut:"8bityd3ae"},{portIn:"array",portOut:"Result",objIn:"n9h46x21d",objOut:"8bityd3ae"},{portIn:"Value",portOut:"Result",objIn:"mt84em94z",objOut:"8bityd3ae"},{portIn:"Array",portOut:"Result",objIn:"0d92hipgj",objOut:"8bityd3ae"},{portIn:"Array",portOut:"Result",objIn:"4fityxjhn",objOut:"8bityd3ae"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"t7mamsdm9",uiAttribs:{},portsIn:[{name:"Step",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"Update",portOut:"Trigger",objIn:"9nh0g9z5l",objOut:"t7mamsdm9"}]},{name:"Index",value:1321},{name:"Value 1",links:[{portIn:"number1",portOut:"Value 1",objIn:"8wk90cgvm",objOut:"t7mamsdm9"}]},{name:"Value 2",links:[{portIn:"number1",portOut:"Value 2",objIn:"8qefokili",objOut:"t7mamsdm9"}]},{name:"Value 3",value:0}],objName:"Ops.Array.Array3Iterator"},{id:"9nh0g9z5l",uiAttribs:{},portsIn:[{name:"Z",value:0},{name:"W",value:1},{name:"Num index",value:2},{name:"Num",value:"3"}],objName:"Ops.Data.Compose.Array.CompArrayPushNumbers"},{id:"r2jpy56j4",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Execute",portOut:"Next",objIn:"zxowq6l2q",objOut:"r2jpy56j4"}]},{name:"Result",links:[{portIn:"Points",portOut:"Result",objIn:"9wd61cznb",objOut:"r2jpy56j4"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"zxowq6l2q",uiAttribs:{},portsIn:[{name:"Step",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"Update",portOut:"Trigger",objIn:"49vgl2hxb",objOut:"zxowq6l2q"}]},{name:"Index",value:4419},{name:"Value 1",links:[{portIn:"number1",portOut:"Value 1",objIn:"jwje3rvoi",objOut:"zxowq6l2q"}]},{name:"Value 2",links:[{portIn:"number1",portOut:"Value 2",objIn:"2lkmoye0z",objOut:"zxowq6l2q"}]},{name:"Value 3",value:0}],objName:"Ops.Array.Array3Iterator"},{id:"49vgl2hxb",uiAttribs:{},portsIn:[{name:"Z",value:0},{name:"W",value:1},{name:"Num index",value:2},{name:"Num",value:"3"}],objName:"Ops.Data.Compose.Array.CompArrayPushNumbers"},{id:"zvu4o6ow7",uiAttribs:{},portsIn:[{name:"Array",title:"Positions"},{name:"Num Points",value:0},{name:"Scramble Texcoords",value:0},{name:"Seed",value:1},{name:"Coordinates",value:0,title:"Texture Coordinates"}],portsOut:[{name:"Trigger out",links:[{portIn:"exe",portOut:"Trigger out",objIn:"xz0m8o11t",objOut:"zvu4o6ow7"}]}],objName:"Ops.Gl.Meshes.PointCloudFromArray_v2"},{id:"q8u4u2but",uiAttribs:{},portsIn:[{name:"PointSize",value:3},{name:"Size in Pixels",value:0},{name:"Random Size",value:0},{name:"Round",value:1},{name:"Round Antialias",value:1},{name:"Scale by Distance",value:0},{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"a",value:1},{name:"Vertex Colors",value:1},{name:"Colorize Texture",value:0},{name:"Mask Channel index",value:0},{name:"Mask Channel",value:"R"},{name:"Colorize Randomize",value:0},{name:"Point Size Channel index",value:0},{name:"Point Size Channel",value:"R"},{name:"Texture Point Size Mul",value:1},{name:"Map Size 0 index",value:0},{name:"Map Size 0",value:"Black"},{name:"Flip Texture",value:0},{name:"Atlas Cross Fade",value:0},{name:"Atlas Repeat X ",value:1},{name:"Min Point Size",value:0}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"zvu4o6ow7",objOut:"q8u4u2but"},{portIn:"Execute",portOut:"trigger",objIn:"x6t1nkmxz",objOut:"q8u4u2but"}]}],objName:"Ops.Gl.Shader.PointMaterial_v6"},{id:"20fzfyu88",uiAttribs:{},portsIn:[{name:"Check Body Collisions",value:0}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"aj30mksaq",objOut:"20fzfyu88"}]},{name:"Total Bodies",value:1322}],objName:"Ops.Graphics.Intersection.IntersectWorld"},{id:"npdugjg6q",uiAttribs:{},portsOut:[{name:"trigger 2",links:[{portIn:"render",portOut:"trigger 2",objIn:"3dyqki83o",objOut:"npdugjg6q"}]},{name:"trigger 4",links:[{portIn:"render",portOut:"trigger 4",objIn:"q8u4u2but",objOut:"npdugjg6q"}]},{name:"trigger 5",links:[{portIn:"render",portOut:"trigger 5",objIn:"rw3t3en26",objOut:"npdugjg6q"}]}],objName:"Ops.Trigger.Sequence"},{id:"aj30mksaq",uiAttribs:{},portsIn:[{name:"Coordinate Format index",value:0},{name:"Coordinate Format",value:"-1 to 1"},{name:"Z",value:0},{name:"To X",value:0},{name:"To Y",value:0},{name:"To Z",value:0},{name:"Active",value:0},{name:"Change Cursor",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"wqvhosllj",objOut:"aj30mksaq"},{portIn:"Trigger",portOut:"Next",objIn:"6u9ozilaf",objOut:"aj30mksaq"}]},{name:"Has Hit",links:[{portIn:"boolean",portOut:"Has Hit",objIn:"wqvhosllj",objOut:"aj30mksaq"},{portIn:"Value",portOut:"Has Hit",objIn:"lkgbsmdjq",objOut:"aj30mksaq"},{portIn:"boolean",portOut:"Has Hit",objIn:"jmulr8i63",objOut:"aj30mksaq"}]},{name:"Hit Body Name",links:[{portIn:"String",portOut:"Hit Body Name",objIn:"f5fr7cbme",objOut:"aj30mksaq"}]},{name:"Hit X",value:0},{name:"Hit Y",value:0},{name:"Hit Z",value:0}],objName:"Ops.Graphics.Intersection.IntersectTestRaycast"},{id:"ubi4zibcb",uiAttribs:{},portsIn:[{name:"Coordinates index",value:0},{name:"Coordinates",value:"-1 to 1"},{name:"Area index",value:3},{name:"Area",value:"Canvas Area"},{name:"flip y",value:1},{name:"right click prevent default",value:1},{name:"Touch support",value:1},{name:"Passive Events",value:0},{name:"Active",value:1}],portsOut:[{name:"x",links:[{portIn:"Value In",portOut:"x",objIn:"1jb5ox59x",objOut:"ubi4zibcb"}]},{name:"y",links:[{portIn:"Value In",portOut:"y",objIn:"i59lhc0x5",objOut:"ubi4zibcb"}]},{name:"click",links:[{portIn:"exe",portOut:"click",objIn:"jmulr8i63",objOut:"ubi4zibcb"}]},{name:"Button is down",value:0},{name:"Mouse is hovering",links:[{portIn:"Pass Through",portOut:"Mouse is hovering",objIn:"1jb5ox59x",objOut:"ubi4zibcb"},{portIn:"Pass Through",portOut:"Mouse is hovering",objIn:"i59lhc0x5",objOut:"ubi4zibcb"}]},{name:"Movement X",value:-26},{name:"Movement Y",value:11}],objName:"Ops.Devices.Mouse.Mouse_v3"},{id:"wqvhosllj",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Trigger",portOut:"then",objIn:"f5fr7cbme",objOut:"wqvhosllj"},{portIn:"Reset",portOut:"then",objIn:"v8r31f94d",objOut:"wqvhosllj"}]},{name:"else",links:[{portIn:"Trigger",portOut:"else",objIn:"6uesnqye0",objOut:"wqvhosllj"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"dl03uc6kx",uiAttribs:{},portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"57t1cmpqy",objOut:"dl03uc6kx"},{portIn:"Value",portOut:"value",objIn:"srmwcl2se",objOut:"dl03uc6kx"},{portIn:"data",portOut:"value",objIn:"g6mt9lz42",objOut:"dl03uc6kx"},{portIn:"Object",portOut:"value",objIn:"3ycw3jbo7",objOut:"dl03uc6kx"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"dradrudnv",uiAttribs:{},portsIn:[{name:"separator",value:"."},{name:"Numbers",value:0},{name:"Trim",value:1},{name:"Split Lines",value:0}],portsOut:[{name:"array",links:[{portIn:"array",portOut:"array",objIn:"8ref6pitz",objOut:"dradrudnv"}]},{name:"length",value:2}],objName:"Ops.Array.StringToArray_v2"},{id:"8ref6pitz",uiAttribs:{},portsIn:[{name:"index",value:1},{name:"Value Invalid Index",value:-1}],portsOut:[{name:"value",links:[{portIn:"Value",portOut:"value",objIn:"7sjx3qkok",objOut:"8ref6pitz"},{portIn:"index",portOut:"value",objIn:"dl03uc6kx",objOut:"8ref6pitz"},{portIn:"Value",portOut:"value",objIn:"yb9q2iapk",objOut:"8ref6pitz"}]},{name:"Valid Index",value:1}],objName:"Ops.Array.ArrayGetNumber"},{id:"s8tx55k6d",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"dl03uc6kx",objOut:"s8tx55k6d"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"57t1cmpqy",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"Text",portOut:"Result",objIn:"6q2vsbg7f",objOut:"57t1cmpqy"}]}],objName:"Ops.Json.ObjectGetString"},{id:"xvxj8o7kf",uiAttribs:{},portsOut:[{name:"X",links:[{portIn:"posX",portOut:"X",objIn:"8b2gi9cu5",objOut:"xvxj8o7kf"}]},{name:"Y",links:[{portIn:"posY",portOut:"Y",objIn:"8b2gi9cu5",objOut:"xvxj8o7kf"}]},{name:"Z"}],objName:"Ops.Array.Array3GetNumbers"},{id:"8b2gi9cu5",uiAttribs:{},portsIn:[{name:"posZ",value:0},{name:"scale",value:1},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Exec",portOut:"trigger",objIn:"ilc868mwp",objOut:"8b2gi9cu5"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"ilc868mwp",uiAttribs:{},portsIn:[{name:"Scale",value:1},{name:"Orthogonal",value:0},{name:"Rotate",value:0},{name:"Hide out of view",value:0},{name:"Align Vertical index",value:0},{name:"Align Vertical",value:"Left"},{name:"Align Horizontal index",value:0},{name:"Align Horizontal",value:"Top"},{name:"Active",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"mfnug45fc",objOut:"ilc868mwp"}]},{name:"HTML Element",links:[{portIn:"Element",portOut:"HTML Element",objIn:"hq0vlm5ws",objOut:"ilc868mwp"}]}],objName:"Ops.Html.CSS.TransformElement"},{id:"guq268c5b",uiAttribs:{},portsIn:[{name:"Reset Model Transform",value:1},{name:"Reset View Transform",value:0},{name:"Default View",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"8b2gi9cu5",objOut:"guq268c5b"}]}],objName:"Ops.Gl.ResetTransform"},{id:"f5fr7cbme",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"guq268c5b",objOut:"f5fr7cbme"}]},{name:"Result",links:[{portIn:"text",portOut:"Result",objIn:"dradrudnv",objOut:"f5fr7cbme"}]}],objName:"Ops.Trigger.TriggerString"},{id:"x2jif4rgi",uiAttribs:{},portsOut:[{name:"Result",value:""},{name:"Error",value:0}],objName:"Ops.Cables.UploadAsset"},{id:"lxt2q2o9w",uiAttribs:{},portsOut:[{name:"Result",value:""},{name:"Error",value:0}],objName:"Ops.Cables.UploadAsset"},{id:"4bomwkpzl",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"yd8i5ai1r",objOut:"4bomwkpzl"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"yd8i5ai1r",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"eahllz58n",objOut:"yd8i5ai1r"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"icm5qwn5z",uiAttribs:{},portsIn:[{name:"MimeType",value:"text/plain"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"t0n8ptdop",objOut:"icm5qwn5z"}]}],objName:"Ops.String.Base64.Base64Encode_v3"},{id:"eahllz58n",uiAttribs:{},portsIn:[{name:"Beautify",value:1}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"icm5qwn5z",objOut:"eahllz58n"}]},{name:"Error",value:0}],objName:"Ops.Json.ObjectStringify_v2"},{id:"jk4lrmo05",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"iv55k15mu",objOut:"jk4lrmo05"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"iv55k15mu",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"4gakglcjt",objOut:"iv55k15mu"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"kawfvu30e",uiAttribs:{},portsIn:[{name:"MimeType",value:"text/plain"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"q19ehh799",objOut:"kawfvu30e"}]}],objName:"Ops.String.Base64.Base64Encode_v3"},{id:"4gakglcjt",uiAttribs:{},portsIn:[{name:"Beautify",value:1}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"kawfvu30e",objOut:"4gakglcjt"}]},{name:"Error",value:0}],objName:"Ops.Json.ObjectStringify_v2"},{id:"uof5hb8vk",uiAttribs:{},portsIn:[{name:"file",display:"file",title:"URL"},{name:"body",value:""},{name:"HTTP Method index",value:0},{name:"HTTP Method",value:"GET"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:1},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"data",portOut:"Response Json Object",objIn:"3nw6zuxna",objOut:"uof5hb8vk"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:800},{name:"Status Code",value:200},{name:"Is Loading",value:0},{name:"Loaded",links:[{portIn:"reload",portOut:"Loaded",objIn:"8uhekg1bu",objOut:"uof5hb8vk"},{portIn:"Update",portOut:"Loaded",objIn:"8gb5urrks",objOut:"uof5hb8vk"}]}],objName:"Ops.Json.HttpRequest_v3"},{id:"8uhekg1bu",uiAttribs:{},portsIn:[{name:"file",display:"file",title:"URL"},{name:"body",value:""},{name:"HTTP Method index",value:0},{name:"HTTP Method",value:"GET"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:0},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"data",portOut:"Response Json Object",objIn:"k2ey03z0s",objOut:"8uhekg1bu"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:127},{name:"Status Code",value:200},{name:"Is Loading",value:0},{name:"Loaded",links:[{portIn:"exe",portOut:"Loaded",objIn:"l4kycyn3r",objOut:"8uhekg1bu"}]}],objName:"Ops.Json.HttpRequest_v3"},{id:"l4kycyn3r",uiAttribs:{},portsOut:[{name:"trigger 1",links:[{portIn:"Trigger",portOut:"trigger 1",objIn:"ti3b1wdan",objOut:"l4kycyn3r"}]},{name:"trigger 8",links:[{portIn:"exe",portOut:"trigger 8",objIn:"m888m20oj",objOut:"l4kycyn3r"}]}],objName:"Ops.Trigger.Sequence"},{id:"5hdav1k41",uiAttribs:{},portsIn:[{name:"Variable",value:"filters"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"0liwr1sj1",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"5hdav1k41",objOut:"0liwr1sj1"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"wm2t4ehav",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"recalcData"}],objName:"Ops.Trigger.TriggerSend"},{id:"04ai34vkt",uiAttribs:{},portsIn:[{name:"Text",value:"upload data"},{name:"Grey Out",value:0}],portsOut:[{name:"Pressed Trigger",links:[{portIn:"Trigger",portOut:"Pressed Trigger",objIn:"wm2t4ehav",objOut:"04ai34vkt"}]}],objName:"Ops.Sidebar.Button_v2"},{id:"8dh6kccee",uiAttribs:{},portsOut:[{name:"UI",links:[{portIn:"Visible",portOut:"UI",objIn:"04ai34vkt",objOut:"8dh6kccee"},{portIn:"bool 2",portOut:"UI",objIn:"7a5d5ccsv",objOut:"8dh6kccee"}]},{name:"Overlay Mode",value:0},{name:"Remote Viewer",value:0},{name:"Is Standalone",value:0},{name:"Canvas Mode",value:0},{name:"Patch Field Visible",value:0}],objName:"Ops.Cables.UIMode"},{id:"1a58jm7wo",uiAttribs:{},portsIn:[{name:"CSS File",value:"assets/66f3ce6623173e5d0f6832cc_style.css",display:"file"},{name:"Media",value:"all"},{name:"Active",value:1}],objName:"Ops.Html.CSS.CssFile"},{id:"qyb5uuiiy",uiAttribs:{},portsIn:[{name:"Text",value:"d3"},{name:"Show Title",value:1},{name:"Default Minimized",value:1}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"tq8a1tycb",objOut:"qyb5uuiiy"}]}],objName:"Ops.Sidebar.Group"},{id:"mrxu0gkpe",uiAttribs:{},portsIn:[{name:"String 0",value:"nodes.json"},{name:"String 1",value:"test_nodes.json"},{name:"String 2",value:""},{name:"String 3",value:""},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""}],portsOut:[{name:"Result",links:[{portIn:"Filename",portOut:"Result",objIn:"lxt2q2o9w",objOut:"mrxu0gkpe"}]}],objName:"Ops.String.SwitchString"},{id:"ebj2tgpz1",uiAttribs:{},portsIn:[{name:"String 0",value:"links.json"},{name:"String 1",value:"test_links.json"},{name:"String 2",value:""},{name:"String 3",value:""},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""}],portsOut:[{name:"Result",links:[{portIn:"Filename",portOut:"Result",objIn:"x2jif4rgi",objOut:"ebj2tgpz1"}]}],objName:"Ops.String.SwitchString"},{id:"15kh04ug6",uiAttribs:{},portsIn:[{name:"Variable",value:"useTestData"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"mrxu0gkpe",objOut:"15kh04ug6"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"wx8qnicmm",uiAttribs:{},portsIn:[{name:"Variable",value:"useTestData"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"ebj2tgpz1",objOut:"wx8qnicmm"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"ym4p0jj2d",uiAttribs:{},portsIn:[{name:"String 0",value:"links.json"},{name:"String 1",value:"test_links.json"},{name:"String 2",value:""},{name:"String 3",value:""},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""}],portsOut:[{name:"Result",links:[{portIn:"Filename",portOut:"Result",objIn:"tot083umz",objOut:"ym4p0jj2d"}]}],objName:"Ops.String.SwitchString"},{id:"41p5vooxk",uiAttribs:{},portsIn:[{name:"Variable",value:"useTestData"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"ym4p0jj2d",objOut:"41p5vooxk"},{portIn:"Index",portOut:"Value",objIn:"xmof6016h",objOut:"41p5vooxk"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"xmof6016h",uiAttribs:{},portsIn:[{name:"String 0",value:"nodes.json"},{name:"String 1",value:"test_nodes.json"},{name:"String 2",value:""},{name:"String 3",value:""},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""}],portsOut:[{name:"Result",links:[{portIn:"Filename",portOut:"Result",objIn:"z9zxm5n4m",objOut:"xmof6016h"}]}],objName:"Ops.String.SwitchString"},{id:"z9zxm5n4m",uiAttribs:{},portsOut:[{name:"Path",links:[{portIn:"file",portOut:"Path",objIn:"uof5hb8vk",objOut:"z9zxm5n4m"}]}],objName:"Ops.Cables.AssetPathURL"},{id:"tot083umz",uiAttribs:{},portsOut:[{name:"Path",links:[{portIn:"file",portOut:"Path",objIn:"8uhekg1bu",objOut:"tot083umz"}]}],objName:"Ops.Cables.AssetPathURL"},{id:"q19ehh799",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Base64 String",portOut:"Result",objIn:"lxt2q2o9w",objOut:"q19ehh799"}]}],objName:"Ops.Trigger.TriggerOnChangeString"},{id:"t0n8ptdop",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Base64 String",portOut:"Result",objIn:"x2jif4rgi",objOut:"t0n8ptdop"}]}],objName:"Ops.Trigger.TriggerOnChangeString"},{id:"uu7n8nnqf",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters .level_1 > li.filter > .item > .title"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Elements",portOut:"Elements",objIn:"sb2dqbxjb",objOut:"uu7n8nnqf"},{portIn:"array",portOut:"Elements",objIn:"pmfjxo2gi",objOut:"uu7n8nnqf"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"408ctzmdt",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"navTemplateReady"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"shfsrpmtz",objOut:"408ctzmdt"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"vbhxe2d86",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"useTestData"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"bfd3sga52",uiAttribs:{},portsIn:[{name:"Text",value:"strength"},{name:"Min",value:0},{name:"Max",value:10},{name:"Step",value:1},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:1},{name:"Default",value:1}],portsOut:[{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"t8p3xo56o",objOut:"bfd3sga52"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"t8p3xo56o",uiAttribs:{},portsIn:[{name:"Key",value:"strength"}],portsOut:[{name:"Result Object",links:[{portIn:"Object Value",portOut:"Result Object",objIn:"3cayf9dhz",objOut:"t8p3xo56o"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"ob7il0pz8",uiAttribs:{},portsIn:[{name:"Text",value:"strength"},{name:"Min",value:0},{name:"Max",value:1},{name:"Step",value:.01},{name:"Suffix",value:""},{name:"Grey Out",value:0},{name:"Visible",value:1},{name:"Input",value:.7},{name:"Default",value:.7}],portsOut:[{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"knfh8gr6t",objOut:"ob7il0pz8"}]},{name:"Result",links:[{portIn:"Number",portOut:"Result",objIn:"9rq5x40nc",objOut:"ob7il0pz8"}]}],objName:"Ops.Sidebar.Slider_v3"},{id:"9rq5x40nc",uiAttribs:{},portsIn:[{name:"Key",value:"strength"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"6atx7yr8u",objOut:"9rq5x40nc"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"6u9ozilaf",uiAttribs:{},portsIn:[{name:"Shape index",value:0},{name:"Shape",value:"Sphere"},{name:"Name",value:"entity"},{name:"Radius",value:.1},{name:"Size X",value:1},{name:"Size Y",value:1},{name:"Size Z",value:1},{name:"Append Index to name",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"npdugjg6q",objOut:"6u9ozilaf"}]}],objName:"Ops.Graphics.Intersection.IntersectBody"},{id:"byoawy8bu",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Pass Through",portOut:"result",objIn:"k4vswg2ua",objOut:"byoawy8bu"}]}],objName:"Ops.Math.Compare.Equals"},{id:"w1qrga39m",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"number1",portOut:"length",objIn:"byoawy8bu",objOut:"w1qrga39m"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"ryumt51bq",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"number2",portOut:"length",objIn:"byoawy8bu",objOut:"ryumt51bq"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"k4vswg2ua",uiAttribs:{},portsOut:[{name:"Trigger out",links:[{portIn:"Trigger",portOut:"Trigger out",objIn:"20fzfyu88",objOut:"k4vswg2ua"}]}],objName:"Ops.Trigger.GateTrigger"},{id:"z5z0i1qex",uiAttribs:{},portsIn:[{name:"Var Name",value:"black-1"}],portsOut:[{name:"Result",links:[{portIn:"Hex",portOut:"Result",objIn:"wl7akj1nd",objOut:"z5z0i1qex"}]}],objName:"Ops.Html.CSS.GetCssVariable"},{id:"bwvht6bbl",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"z5z0i1qex",objOut:"bwvht6bbl"}]},{name:"Was Triggered",value:1}],objName:"Ops.Trigger.TriggerOnce"},{id:"hq0vlm5ws",uiAttribs:{},portsIn:[{name:"Property",value:"color"},{name:"Active",value:1}],portsOut:[{name:"HTML Element",links:[{portIn:"Element",portOut:"HTML Element",objIn:"kl9pkhf3g",objOut:"hq0vlm5ws"}]}],objName:"Ops.Html.CSS.CSSPropertyString"},{id:"xekni5688",uiAttribs:{},portsIn:[{name:"posZ",value:0},{name:"scale",value:1},{name:"rotX",value:180},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Exec",portOut:"trigger",objIn:"bwvht6bbl",objOut:"xekni5688"},{portIn:"exe",portOut:"trigger",objIn:"9ox0ycysj",objOut:"xekni5688"}]}],objName:"Ops.Gl.Matrix.TransformView"},{id:"mfnug45fc",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"hq0vlm5ws",objOut:"mfnug45fc"}]}],objName:"Ops.Html.CSS.GetCssVariable"},{id:"dh2yuf2jh",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"Trigger",portOut:"Changed",objIn:"8xi3iano1",objOut:"dh2yuf2jh"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"8xi3iano1",objOut:"dh2yuf2jh"}]}],objName:"Ops.Trigger.TriggerOnChangeObject"},{id:"l6jc0pzcc",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"mainLoop"}],objName:"Ops.Trigger.TriggerSend"},{id:"8xi3iano1",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_forceParameters"}],objName:"Ops.Vars.VarTriggerObject"},{id:"wqoh58zzy",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_graph"}],portsOut:[{name:"Triggered",links:[{portIn:"Trigger",portOut:"Triggered",objIn:"8xi3iano1",objOut:"wqoh58zzy"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"9wd61cznb",uiAttribs:{},portsIn:[{name:"Num Points",value:0},{name:"Line Strip",value:0},{name:"TexCoords index",value:0},{name:"TexCoords",value:"0"},{name:"TexCoords Array",value:0}],objName:"Ops.Gl.Meshes.SimpleSpline_v2"},{id:"3dyqki83o",uiAttribs:{},portsIn:[{name:"r",value:1},{name:"g",value:1},{name:"b",value:1},{name:"a",value:1},{name:"colorizeTexture",value:0},{name:"Vertex Colors",value:1},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:0},{name:"Discard Transparent Pixels",value:0},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:0},{name:"billboard",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Render",portOut:"trigger",objIn:"9wd61cznb",objOut:"3dyqki83o"},{portIn:"Execute",portOut:"trigger",objIn:"mynuvkdww",objOut:"3dyqki83o"}]}],objName:"Ops.Gl.Shader.BasicMaterial_v3"},{id:"sl01kqrsg",uiAttribs:{},portsIn:[{name:"Chunk Size",value:4}],portsOut:[{name:"Combined Array",links:[{portIn:"Array In",portOut:"Combined Array",objIn:"mynuvkdww",objOut:"sl01kqrsg"}]}],objName:"Ops.Array.WeaveArrays"},{id:"jwje3rvoi",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"X",portOut:"result",objIn:"49vgl2hxb",objOut:"jwje3rvoi"}]}],objName:"Ops.Math.Multiply"},{id:"d5apewhsr",uiAttribs:{},portsIn:[{name:"value",value:.01}],portsOut:[{name:"result",links:[{portIn:"number2",portOut:"result",objIn:"jwje3rvoi",objOut:"d5apewhsr"},{portIn:"number2",portOut:"result",objIn:"2lkmoye0z",objOut:"d5apewhsr"},{portIn:"number2",portOut:"result",objIn:"8wk90cgvm",objOut:"d5apewhsr"},{portIn:"number2",portOut:"result",objIn:"8qefokili",objOut:"d5apewhsr"}]}],objName:"Ops.Number.Number"},{id:"2lkmoye0z",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Y",portOut:"result",objIn:"49vgl2hxb",objOut:"2lkmoye0z"}]}],objName:"Ops.Math.Multiply"},{id:"8wk90cgvm",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"X",portOut:"result",objIn:"9nh0g9z5l",objOut:"8wk90cgvm"}]}],objName:"Ops.Math.Multiply"},{id:"8qefokili",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Y",portOut:"result",objIn:"9nh0g9z5l",objOut:"8qefokili"}]}],objName:"Ops.Math.Multiply"},{id:"shfsrpmtz",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"na922wgpx",objOut:"shfsrpmtz"}]},{name:"trigger 1",links:[{portIn:"Update",portOut:"trigger 1",objIn:"uu7n8nnqf",objOut:"shfsrpmtz"}]},{name:"trigger 2",links:[{portIn:"Update",portOut:"trigger 2",objIn:"c0jq4rzht",objOut:"shfsrpmtz"}]},{name:"trigger 3",links:[{portIn:"Update",portOut:"trigger 3",objIn:"fpkedop4b",objOut:"shfsrpmtz"}]},{name:"trigger 11",links:[{portIn:"Update",portOut:"trigger 11",objIn:"9fmiu2hhd",objOut:"shfsrpmtz"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"d3a79d29m",objOut:"shfsrpmtz"}]}],objName:"Ops.Trigger.Sequence"},{id:"dwyf49ck3",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"All Nodes",portOut:"Value",objIn:"psxi24j9d",objOut:"dwyf49ck3"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"yhbkr998r",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"updateNav"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"64dk0xga7",objOut:"yhbkr998r"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"7btpemv7w",uiAttribs:{},portsIn:[{name:"Variable",value:"activeFilters"}],portsOut:[{name:"Value",links:[{portIn:"Active Filters",portOut:"Value",objIn:"psxi24j9d",objOut:"7btpemv7w"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"csoqaa4xh",uiAttribs:{},objName:"Ops.Html.ElementChilds_v2"},{id:"lbx6dr4d5",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"navTemplateReady"}],objName:"Ops.Trigger.TriggerSend"},{id:"4p1056a4v",uiAttribs:{},portsIn:[{name:"Name",value:"graph"}],portsOut:[{name:"Exit",multiPortNum:2},{name:"Exit_0",links:[{portIn:"Entrance",portOut:"Exit_0",objIn:"0zq2xv8nn",objOut:"4p1056a4v"}]},{name:"Exit_1",title:"add port",links:[{portIn:"Entrance",portOut:"Exit_1",objIn:"qncexrqrk",objOut:"4p1056a4v"}]},{name:"Exit_2",value:0,title:"add port"}],objName:"Ops.Team.Plan.Place"},{id:"jwuu7bzi4",uiAttribs:{},portsIn:[{name:"Title",value:"acar"},{name:"Default Place",value:"graph"},{name:"Root Place",value:""},{name:"Duration Enter",value:.5},{name:"Easing Enter index",value:0},{name:"Easing Enter",value:"linear"},{name:"Duration Exit",value:.25},{name:"Easing Exit index",value:0},{name:"Easing Exit",value:"linear"},{name:"Data",value:'{"places":[{"name":"graph","exits":{"Exit_0":{"place":"magazin"},"Exit_1":{"place":"stories"}}},{"name":"stories","exits":{"Exit_0":{"place":"magazin"},"Exit_1":{"place":"graph"}}},{"name":"magazin","exits":{"Exit_0":{"place":"graph"},"Exit_1":{"place":"stories"}}}]}'}],portsOut:[{name:"Current Place",value:"graph"}],objName:"Ops.Team.Plan.Plan"},{id:"qncexrqrk",uiAttribs:{},portsIn:[{name:"Name",value:"stories"}],portsOut:[{name:"Exit",multiPortNum:2},{name:"Exit_0",links:[{portIn:"Entrance",portOut:"Exit_0",objIn:"0zq2xv8nn",objOut:"qncexrqrk"}]},{name:"Exit_1",title:"add port",links:[{portIn:"Entrance",portOut:"Exit_1",objIn:"4p1056a4v",objOut:"qncexrqrk"}]},{name:"Exit_2",value:0,title:"add port"}],objName:"Ops.Team.Plan.Place"},{id:"0zq2xv8nn",uiAttribs:{},portsIn:[{name:"Name",value:"magazin"}],portsOut:[{name:"Exit",multiPortNum:2},{name:"Exit_0",links:[{portIn:"Entrance",portOut:"Exit_0",objIn:"4p1056a4v",objOut:"0zq2xv8nn"}]},{name:"Exit_1",title:"add port",links:[{portIn:"Entrance",portOut:"Exit_1",objIn:"qncexrqrk",objOut:"0zq2xv8nn"}]},{name:"Exit_2",value:0,title:"add port"}],objName:"Ops.Team.Plan.Place"},{id:"7ih2sxuet",uiAttribs:{},portsIn:[{name:"Route",value:"/:place"}],portsOut:[{name:"Values",links:[{portIn:"data",portOut:"Values",objIn:"iagd0l21k",objOut:"7ih2sxuet"}]},{name:"Changed",links:[{portIn:"exe",portOut:"Changed",objIn:"cpjolljkf",objOut:"7ih2sxuet"}]},{name:"Matching",links:[{portIn:"boolean",portOut:"Matching",objIn:"cpjolljkf",objOut:"7ih2sxuet"}]}],objName:"Ops.Website.LocationHashRoute"},{id:"kbm3iuzbg",uiAttribs:{},portsIn:[{name:"Route",value:"/:place/:id"}],portsOut:[{name:"Values",links:[{portIn:"data",portOut:"Values",objIn:"8jtihn84w",objOut:"kbm3iuzbg"}]},{name:"Changed",links:[{portIn:"exe",portOut:"Changed",objIn:"149tivv5b",objOut:"kbm3iuzbg"}]},{name:"Matching",value:false}],objName:"Ops.Website.LocationHashRoute"},{id:"mhe9nrhlr",uiAttribs:{},objName:"Ops.Team.Plan.GotoPlace"},{id:"cpjolljkf",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Execute",portOut:"then",objIn:"mhe9nrhlr",objOut:"cpjolljkf"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"iagd0l21k",uiAttribs:{},portsIn:[{name:"Key",value:"place"}],portsOut:[{name:"Result",links:[{portIn:"Go To Place",portOut:"Result",objIn:"mhe9nrhlr",objOut:"iagd0l21k"}]}],objName:"Ops.Json.ObjectGetString"},{id:"lucvswer1",uiAttribs:{},objName:"Ops.Team.Plan.GotoPlace"},{id:"149tivv5b",uiAttribs:{},portsIn:[{name:"boolean",value:0}],portsOut:[{name:"then",links:[{portIn:"Execute",portOut:"then",objIn:"lucvswer1",objOut:"149tivv5b"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"8jtihn84w",uiAttribs:{},portsIn:[{name:"Key",value:"place"}],portsOut:[{name:"Result",links:[{portIn:"Go To Place",portOut:"Result",objIn:"lucvswer1",objOut:"8jtihn84w"}]}],objName:"Ops.Json.ObjectGetString"},{id:"hzyz64r3r",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"cpjolljkf",objOut:"hzyz64r3r"},{portIn:"exe",portOut:"Next",objIn:"149tivv5b",objOut:"hzyz64r3r"}]},{name:"Was Triggered",value:1}],objName:"Ops.Trigger.TriggerOnce"},{id:"k3uliqeq3",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"mainLoop"}],portsOut:[{name:"Triggered",links:[{portIn:"Exec",portOut:"Triggered",objIn:"hzyz64r3r",objOut:"k3uliqeq3"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"7it8kgb6r",uiAttribs:{},portsIn:[{name:"Value",value:"acar"},{name:"Variable",value:"mainPlanName"}],objName:"Ops.Vars.VarSetString_v2"},{id:"n5vpnhwj8",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"mhe9nrhlr",objOut:"n5vpnhwj8"},{portIn:"Plan",portOut:"Value",objIn:"lucvswer1",objOut:"n5vpnhwj8"}]}],objName:"Ops.Vars.VarGetString"},{id:"ti3b1wdan",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"updateNav"}],objName:"Ops.Trigger.TriggerSend"},{id:"04d0ku5xw",uiAttribs:{},portsIn:[{name:"Variable",value:"entityInfoElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"fx5im1lmg",uiAttribs:{},portsIn:[{name:"Mode select index",value:0},{name:"Mode select",value:"Number"},{name:"Reverse",value:0}],portsOut:[{name:"Array",links:[{portIn:"Array",portOut:"Array",objIn:"oqh5cfhq2",objOut:"fx5im1lmg"}]},{name:"Array length out",value:1322}],objName:"Ops.Array.Array_v3"},{id:"n9h46x21d",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"number1",portOut:"length",objIn:"5i4phuxio",objOut:"n9h46x21d"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"5i4phuxio",uiAttribs:{},portsIn:[{name:"number2",value:3}],portsOut:[{name:"result",links:[{portIn:"Array length",portOut:"result",objIn:"fx5im1lmg",objOut:"5i4phuxio"}]}],objName:"Ops.Math.Divide"},{id:"oqh5cfhq2",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"1vttast7m",objOut:"oqh5cfhq2"}]}],objName:"Ops.Array.ArraySetNumber_v3"},{id:"7sjx3qkok",uiAttribs:{},portsIn:[{name:"Variable",value:"hoverPointIndex"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"q9kws9wz9",uiAttribs:{},portsIn:[{name:"Variable",value:"hoverPointIndex"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"xvxj8o7kf",objOut:"q9kws9wz9"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"8odmbmwt7",uiAttribs:{},portsIn:[{name:"Variable",value:"hoverPointIndex"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"oqh5cfhq2",objOut:"8odmbmwt7"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"6uesnqye0",uiAttribs:{},portsIn:[{name:"Value",value:-1},{name:"Variable",value:"hoverPointIndex"}],portsOut:[{name:"Next",links:[{portIn:"Exec",portOut:"Next",objIn:"v8r31f94d",objOut:"6uesnqye0"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"feoj1lt3y",uiAttribs:{},portsIn:[{name:"old min",value:0},{name:"old max",value:5},{name:"new min",value:1},{name:"new max",value:10},{name:"Easing index",value:1},{name:"Easing",value:"Smoothstep"},{name:"Clamp",value:1}],portsOut:[{name:"result",links:[{portIn:"number1",portOut:"result",objIn:"49metc4nq",objOut:"feoj1lt3y"},{portIn:"Default Value",portOut:"result",objIn:"fx5im1lmg",objOut:"feoj1lt3y"}]}],objName:"Ops.Math.MapRange"},{id:"49metc4nq",uiAttribs:{},portsIn:[{name:"number2",value:2.5}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"oqh5cfhq2",objOut:"49metc4nq"},{portIn:"Number",portOut:"result",objIn:"1vttast7m",objOut:"49metc4nq"}]}],objName:"Ops.Math.Multiply"},{id:"enhod0smp",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"Filter Value",portOut:"Result",objIn:"v374z3xic",objOut:"enhod0smp"},{portIn:"Filter Value",portOut:"Result",objIn:"zjdmgxdmi",objOut:"enhod0smp"},{portIn:"String",portOut:"Result",objIn:"17yidurmi",objOut:"enhod0smp"}]}],objName:"Ops.Json.ObjectGetString"},{id:"oie36hw53",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"v374z3xic",objOut:"oie36hw53"},{portIn:"Array",portOut:"Value",objIn:"zjdmgxdmi",objOut:"oie36hw53"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"5i1e274oj",uiAttribs:{},portsIn:[{name:"Size index",value:0},{name:"Size",value:"Canvas"},{name:"texture width",value:1920},{name:"texture height",value:1080},{name:"Auto Aspect",value:1},{name:"filter index",value:1},{name:"filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"Repeat"},{name:"MSAA index",value:2},{name:"MSAA",value:"4x"},{name:"Pixel Format index",value:4},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"Depth",value:1},{name:"Clear",value:1}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"5oosul0lh",objOut:"5i1e274oj"}]},{name:"texture",links:[{portIn:"Base Texture",portOut:"texture",objIn:"mhv3ysbjt",objOut:"5i1e274oj"}]}],objName:"Ops.Gl.RenderToTexture_v3"},{id:"9ox0ycysj",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"5i1e274oj",objOut:"9ox0ycysj"}]},{name:"trigger 11",links:[{portIn:"Render",portOut:"trigger 11",objIn:"mhv3ysbjt",objOut:"9ox0ycysj"}]},{name:"trigger 15",links:[{portIn:"render",portOut:"trigger 15",objIn:"fxl8g0lkh",objOut:"9ox0ycysj"}]}],objName:"Ops.Trigger.Sequence"},{id:"fxl8g0lkh",uiAttribs:{},portsIn:[{name:"Scale index",value:1},{name:"Scale",value:"Fit"},{name:"Flip Y",value:0},{name:"Flip X",value:0}],objName:"Ops.Gl.Meshes.FullscreenRectangle_v2"},{id:"mhv3ysbjt",uiAttribs:{},portsIn:[{name:"Size index",value:0},{name:"Size",value:"Auto"},{name:"Width",value:640},{name:"Height",value:480},{name:"Filter index",value:1},{name:"Filter",value:"linear"},{name:"Wrap index",value:1},{name:"Wrap",value:"repeat"},{name:"Anisotropic index",value:0},{name:"Anisotropic",value:"0"},{name:"Pixel Format index",value:4},{name:"Pixel Format",value:"RGBA 8bit ubyte"},{name:"Clear",value:1},{name:"R",value:0},{name:"G",value:0},{name:"B",value:0},{name:"A",value:0}],portsOut:[{name:"texture_out",links:[{portIn:"Texture",portOut:"texture_out",objIn:"fxl8g0lkh",objOut:"mhv3ysbjt"}]},{name:"Aspect Ratio",value:1.7777777777777777},{name:"Texture Width",value:1920},{name:"Texture Height",value:1080}],objName:"Ops.Gl.ImageCompose.ImageCompose_v4"},{id:"styai9khh",uiAttribs:{},portsIn:[{name:"Variable",value:"splineColors"}],portsOut:[{name:"Value",links:[{portIn:"Array 1",portOut:"Value",objIn:"sl01kqrsg",objOut:"styai9khh"},{portIn:"Array 2",portOut:"Value",objIn:"sl01kqrsg",objOut:"styai9khh"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"sks0jxw94",uiAttribs:{},portsIn:[{name:"Variable",value:"splinesPositions"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"tdd2w3yro",uiAttribs:{},portsIn:[{name:"Text",value:""},{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"menu"},{name:"Disable CSS Props",value:""},{name:"Display index",value:4},{name:"Display",value:"flex"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Parent",portOut:"DOM Element",objIn:"ltvq9gchz",objOut:"tdd2w3yro"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"5p93vazez",uiAttribs:{},portsIn:[{name:"Text",value:'<span class="icon icon-graph"></span> Graph'},{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:0},{name:"Height",value:20},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"button"},{name:"Disable CSS Props",value:""},{name:"Display index",value:4},{name:"Display",value:"flex"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Child 1",portOut:"DOM Element",objIn:"ltvq9gchz",objOut:"5p93vazez"},{portIn:"HTML Element",portOut:"DOM Element",objIn:"gwut853ol",objOut:"5p93vazez"}]},{name:"Hovering",value:0},{name:"Clicked",links:[{portIn:"Execute",portOut:"Clicked",objIn:"39rnqjasa",objOut:"5p93vazez"}]}],objName:"Ops.Html.Elements.Element_v2"},{id:"s1v4blf1y",uiAttribs:{},portsIn:[{name:"Text",value:'<span class="icon icon-magazin"></span> Magazin'},{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:0},{name:"Height",value:20},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"button"},{name:"Disable CSS Props",value:""},{name:"Display index",value:4},{name:"Display",value:"flex"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Child 2",portOut:"DOM Element",objIn:"ltvq9gchz",objOut:"s1v4blf1y"},{portIn:"HTML Element",portOut:"DOM Element",objIn:"bj60kw8b9",objOut:"s1v4blf1y"}]},{name:"Hovering",value:0},{name:"Clicked",links:[{portIn:"Execute",portOut:"Clicked",objIn:"wequb1o4h",objOut:"s1v4blf1y"}]}],objName:"Ops.Html.Elements.Element_v2"},{id:"ltvq9gchz",uiAttribs:{},portsOut:[{name:"Parent Out",links:[{portIn:"Value",portOut:"Parent Out",objIn:"gyrgmqkg7",objOut:"ltvq9gchz"}]}],objName:"Ops.Html.ElementChilds_v2"},{id:"hq6r5sz26",uiAttribs:{},portsIn:[{name:"bool 1",value:1}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"e9qt65h4b",objOut:"hq6r5sz26"}]}],objName:"Ops.Boolean.And"},{id:"e9qt65h4b",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"lbx6dr4d5",objOut:"e9qt65h4b"}]}],objName:"Ops.Boolean.TriggerChangedTrue"},{id:"yrp8rezyw",uiAttribs:{},portsIn:[{name:"Text",value:""},{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:1},{name:"Interactive",value:"False"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"acar"},{name:"Disable CSS Props",value:""},{name:"Display index",value:1},{name:"Display",value:"Block"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Parent",portOut:"DOM Element",objIn:"csoqaa4xh",objOut:"yrp8rezyw"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"yi7divvoo",uiAttribs:{},portsIn:[{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:1},{name:"Interactive",value:"False"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"filters"},{name:"Disable CSS Props",value:""},{name:"Display index",value:4},{name:"Display",value:"flex"},{name:"Tag Name",value:"div"},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Value",portOut:"DOM Element",objIn:"hzxxbbxx3",objOut:"yi7divvoo"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"39rnqjasa",uiAttribs:{},portsIn:[{name:"Go To Place",value:"graph"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"7thyqkhqy",objOut:"39rnqjasa"}]}],objName:"Ops.Team.Plan.GotoPlace"},{id:"wequb1o4h",uiAttribs:{},portsIn:[{name:"Go To Place",value:"magazin"}],objName:"Ops.Team.Plan.GotoPlace"},{id:"zltblgcxb",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"39rnqjasa",objOut:"zltblgcxb"},{portIn:"Plan",portOut:"Value",objIn:"wequb1o4h",objOut:"zltblgcxb"},{portIn:"Plan",portOut:"Value",objIn:"6krmnfnjd",objOut:"zltblgcxb"},{portIn:"Plan",portOut:"Value",objIn:"04lbzow4e",objOut:"zltblgcxb"},{portIn:"Plan",portOut:"Value",objIn:"f6cztcqmz",objOut:"zltblgcxb"}]}],objName:"Ops.Vars.VarGetString"},{id:"l0sx8bzao",uiAttribs:{},portsIn:[{name:"file",value:"https://staging.aca-rh.net/api/query",display:"file",title:"URL"},{name:"HTTP Method index",value:1},{name:"HTTP Method",value:"POST"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:1},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"Object",portOut:"Response Json Object",objIn:"b3xp3o5uf",objOut:"l0sx8bzao"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:796},{name:"Status Code",value:200},{name:"Is Loading",links:[{portIn:"Visible",portOut:"Is Loading",objIn:"dec5ysmhf",objOut:"l0sx8bzao"}]}],objName:"Ops.Json.HttpRequest_v3"},{id:"s13c7i6m7",uiAttribs:{},portsIn:[{name:"Place Name",value:"magazin"}],portsOut:[{name:"Is Current Place",links:[{portIn:"Value",portOut:"Is Current Place",objIn:"31sp6o963",objOut:"s13c7i6m7"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"31sp6o963",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"reload",portOut:"Next",objIn:"l0sx8bzao",objOut:"31sp6o963"}]}],objName:"Ops.Boolean.TriggerChangedTrue"},{id:"dec5ysmhf",uiAttribs:{},portsIn:[{name:"Style index",value:1},{name:"Style",value:"Ring"}],objName:"Ops.Html.Utils.LoadingIndicator"},{id:"g17dcg5x2",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"s13c7i6m7",objOut:"g17dcg5x2"}]}],objName:"Ops.Vars.VarGetString"},{id:"6q2vsbg7f",uiAttribs:{},portsIn:[{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:1},{name:"Interactive",value:"False"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"entityName hovered"},{name:"Disable CSS Props",value:""},{name:"Display",value:"Block"},{name:"Tag Name",value:"div"},{name:"Opacity",value:0},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Value",portOut:"DOM Element",objIn:"jecx4wivm",objOut:"6q2vsbg7f"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"qf444jnra",uiAttribs:{},portsIn:[{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:1},{name:"Interactive",value:"False"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:3},{name:"Overflow",value:"Auto"},{name:"Inline Style",value:""},{name:"CSS Class",value:"info"},{name:"Disable CSS Props",value:""},{name:"Display",value:"None"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Value",portOut:"DOM Element",objIn:"04d0ku5xw",objOut:"qf444jnra"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"64dk0xga7",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"reset",portOut:"trigger 0",objIn:"9t6mp6wsl",objOut:"64dk0xga7"}]},{name:"trigger 14",links:[{portIn:"Rebuild",portOut:"trigger 14",objIn:"psxi24j9d",objOut:"64dk0xga7"}]}],objName:"Ops.Trigger.Sequence"},{id:"ne7zs5ztk",uiAttribs:{},portsIn:[{name:"JSON String",value:'{\n    "Authorization": ""\n}'}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"rgbloxvp6",objOut:"ne7zs5ztk"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"k4kjr5q0i",uiAttribs:{},portsIn:[{name:"MimeType",value:"text/plain"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"av51gq8bn",objOut:"k4kjr5q0i"}]}],objName:"Ops.String.Base64.Base64Encode_v3"},{id:"25yil0l26",uiAttribs:{},portsIn:[{name:"string 0",value:"api@giacomo.website"},{name:"string 1",value:":"},{name:"string 2",value:"HjZa8f4u8eX3aYr"},{name:"string 3",value:""},{name:"string 4",value:""},{name:"string 5",value:""},{name:"string 6",value:""},{name:"string 7",value:""},{name:"add spaces",value:0},{name:"new lines",value:0}],portsOut:[{name:"concat string",links:[{portIn:"String",portOut:"concat string",objIn:"k4kjr5q0i",objOut:"25yil0l26"}]}],objName:"Ops.String.ConcatMulti_v2"},{id:"rgbloxvp6",uiAttribs:{},portsIn:[{name:"Key",value:"Authorization"}],portsOut:[{name:"Result Object",links:[{portIn:"Value",portOut:"Result Object",objIn:"ek2srapcp",objOut:"rgbloxvp6"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"lwie4mlsn",uiAttribs:{},portsIn:[{name:"string 0",value:"Basic "},{name:"string 2",value:""},{name:"string 3",value:""},{name:"string 4",value:""},{name:"string 5",value:""},{name:"string 6",value:""},{name:"string 7",value:""},{name:"add spaces",value:0},{name:"new lines",value:0}],portsOut:[{name:"concat string",links:[{portIn:"Value",portOut:"concat string",objIn:"rgbloxvp6",objOut:"lwie4mlsn"}]}],objName:"Ops.String.ConcatMulti_v2"},{id:"av51gq8bn",uiAttribs:{},portsIn:[{name:"Search For",value:"data:text/plain;base64,"},{name:"Replace",value:""},{name:"Replace What index",value:1},{name:"Replace What",value:"First"}],portsOut:[{name:"Result",links:[{portIn:"string 1",portOut:"Result",objIn:"lwie4mlsn",objOut:"av51gq8bn"}]}],objName:"Ops.String.StringReplace"},{id:"8ur384i9r",uiAttribs:{},portsIn:[{name:"JSON String",value:'{\n    "query": "site.children.template(\'project\')",\n    "select": {\n        "title": true,\n        "url": true,\n        "teaser": "page.description.kirbytext",\n        "description": "page.description.kirbytext",\n        "weiter": true,\n        "author": "page.author.yaml()",\n        "categories": true,\n        "tags": "page.tags.yaml()",\n        "coordinates": "page.coordinates.yaml()",\n        "zeit": "page.zeit.toDate(\'d.m.Y\')",\n        "zeitend": "page.zeit.toDate(\'d.m.Y\')",\n        "images": {\n            "query": "page.images",\n            "select": {\n                "url": true,\n                "niceSize": true,\n                "alt": "file.alt.kirbytext",\n                "caption": true,\n                "copyright": true\n            }\n        }\n    }\n}'}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"1rqs126yn",objOut:"8ur384i9r"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"1rqs126yn",uiAttribs:{},portsIn:[{name:"Beautify",value:1}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"toaabod8p",objOut:"1rqs126yn"}]},{name:"Error",value:0}],objName:"Ops.Json.ObjectStringify_v2"},{id:"b3xp3o5uf",uiAttribs:{},portsIn:[{name:"Path",value:"result"}],portsOut:[{name:"Output",links:[{portIn:"Array",portOut:"Output",objIn:"r6bqj9dny",objOut:"b3xp3o5uf"}]},{name:"Found",value:1}],objName:"Ops.Data.JsonPath.ObjectGetArrayByPath"},{id:"toaabod8p",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"reload",portOut:"Changed",objIn:"l0sx8bzao",objOut:"toaabod8p"}]},{name:"Result",links:[{portIn:"body",portOut:"Result",objIn:"l0sx8bzao",objOut:"toaabod8p"}]}],objName:"Ops.Trigger.TriggerOnChangeString"},{id:"7ayj6tock",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"x2kfpu9yh",objOut:"7ayj6tock"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"x2kfpu9yh",uiAttribs:{},portsIn:[{name:"Key",value:"entries"}],portsOut:[{name:"Result Object",links:[{portIn:"Data",portOut:"Result Object",objIn:"lkdgylmm9",objOut:"x2kfpu9yh"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"weq938i0u",uiAttribs:{},portsIn:[{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:2},{name:"Overflow",value:"Scroll"},{name:"Inline Style",value:""},{name:"CSS Class",value:"magazin"},{name:"Disable CSS Props",value:""},{name:"Display",value:"None"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Value",portOut:"DOM Element",objIn:"zz79vb42k",objOut:"weq938i0u"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"38rhtm2j4",uiAttribs:{},portsIn:[{name:"Place Name",value:"magazin"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 1",portOut:"Is Current Place",objIn:"n3xig6cso",objOut:"38rhtm2j4"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"83102y5ro",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"38rhtm2j4",objOut:"83102y5ro"}]}],objName:"Ops.Vars.VarGetString"},{id:"zz79vb42k",uiAttribs:{},portsIn:[{name:"Variable",value:"magazinElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"hvlgisnpl",uiAttribs:{},portsIn:[{name:"Text",value:"DATA"},{name:"Show Title",value:1},{name:"Default Minimized",value:1},{name:"Visible",value:1}],portsOut:[{name:"next",links:[{portIn:"link",portOut:"next",objIn:"qyb5uuiiy",objOut:"hvlgisnpl"}]},{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"04ai34vkt",objOut:"hvlgisnpl"}]}],objName:"Ops.Sidebar.Group"},{id:"3nw6zuxna",uiAttribs:{},portsIn:[{name:"key",value:"data"}],portsOut:[{name:"result",links:[{portIn:"array",portOut:"result",objIn:"ugfearomb",objOut:"3nw6zuxna"}]},{name:"Length",value:1322}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"k2ey03z0s",uiAttribs:{},portsIn:[{name:"key",value:"data"}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"yf43omkz0",objOut:"k2ey03z0s"}]},{name:"Length",value:2210}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"j9gzqe6qv",uiAttribs:{},portsOut:[{name:"d3",links:[{portIn:"D3",portOut:"d3",objIn:"paxjpnxf4",objOut:"j9gzqe6qv"}]}],objName:"Ops.Patch.PaZfgnp.D3"},{id:"fpb8eucar",uiAttribs:{},portsOut:[{name:"Out Trigger",links:[{portIn:"Tick",portOut:"Out Trigger",objIn:"paxjpnxf4",objOut:"fpb8eucar"}]},{name:"Progress",value:1}],objName:"Ops.Trigger.TriggerLimiter"},{id:"j8t8q1v6m",uiAttribs:{},portsIn:[{name:"value",value:32}],portsOut:[{name:"result",links:[{portIn:"Milliseconds",portOut:"result",objIn:"fpb8eucar",objOut:"j8t8q1v6m"},{portIn:"Ticks per Frame",portOut:"result",objIn:"paxjpnxf4",objOut:"j8t8q1v6m"}]}],objName:"Ops.Number.Number"},{id:"srcvr6gh1",uiAttribs:{},portsOut:[{name:"CSS Width",links:[{portIn:"number1",portOut:"CSS Width",objIn:"3kn6qjbsm",objOut:"srcvr6gh1"}]},{name:"CSS Height",links:[{portIn:"number1",portOut:"CSS Height",objIn:"6er4ktq39",objOut:"srcvr6gh1"}]},{name:"Pixel Ratio",value:1},{name:"Pixel Width",value:1920},{name:"Pixel Height",value:1080},{name:"Aspect Ratio",value:1.7777777777777777},{name:"Landscape",value:1}],objName:"Ops.Gl.CanvasInfo_v3"},{id:"3kn6qjbsm",uiAttribs:{},portsIn:[{name:"number2",value:2}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"43edjbdnr",objOut:"3kn6qjbsm"}]}],objName:"Ops.Math.Divide"},{id:"6er4ktq39",uiAttribs:{},portsIn:[{name:"number2",value:2}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"59m1r5f84",objOut:"6er4ktq39"}]}],objName:"Ops.Math.Divide"},{id:"rrfhdlrgu",uiAttribs:{},portsIn:[{name:"CSS File",value:"assets/66f3ce6623173e5d0f6832cc_icons.css",display:"file"},{name:"Media",value:"all"},{name:"Active",value:1}],objName:"Ops.Html.CSS.CssFile"},{id:"7fvdbg92f",uiAttribs:{},portsIn:[{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"oaulca2pe",objOut:"7fvdbg92f"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"0sx1hxgoi",objOut:"7fvdbg92f"}]}],objName:"Ops.Data.Compose.Object.CompObject"},{id:"oaulca2pe",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"fe6jqtseo",objOut:"oaulca2pe"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"fe6jqtseo",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"hvrdb1kou",objOut:"fe6jqtseo"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"e5x5vmboo",uiAttribs:{},portsIn:[{name:"Key",value:"text"}],objName:"Ops.Data.Compose.Object.CompObjectSetObject"},{id:"lkgbsmdjq",uiAttribs:{},portsIn:[{name:"Variable",value:"entityHovered"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"qym5khud7",uiAttribs:{},portsIn:[{name:"Variable",value:"entityHovered"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"kl9pkhf3g",objOut:"qym5khud7"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"srmwcl2se",uiAttribs:{},portsIn:[{name:"Variable",value:"hoveredEntityData"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"nm3hw8mm5",uiAttribs:{},portsIn:[{name:"Variable",value:"hoveredEntityData"}],portsOut:[{name:"Value",links:[{portIn:"data",portOut:"Value",objIn:"enhod0smp",objOut:"nm3hw8mm5"},{portIn:"Object",portOut:"Value",objIn:"0pn520t3o",objOut:"nm3hw8mm5"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"6ua0lmfvk",uiAttribs:{},portsIn:[{name:"Key",value:"graph"}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"po4yjugua",objOut:"6ua0lmfvk"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetObject"},{id:"lwtr0ohsm",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"fe6jqtseo",objOut:"lwtr0ohsm"}]}],objName:"Ops.Json.ObjectGetString"},{id:"3hr4ul3yx",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"oaulca2pe",objOut:"3hr4ul3yx"}]}],objName:"Ops.Json.ObjectGetString"},{id:"hvrdb1kou",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"l3hvns3zp",objOut:"hvrdb1kou"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetObject"},{id:"2ne1jvezk",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"l1ypdpyqj",objOut:"2ne1jvezk"}]}],objName:"Ops.Json.Object"},{id:"l1ypdpyqj",uiAttribs:{},portsIn:[{name:"Value",value:""}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"rbqeqhify",objOut:"l1ypdpyqj"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"rbqeqhify",uiAttribs:{},portsIn:[{name:"Key",value:"content"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"os9xnrdak",objOut:"rbqeqhify"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"os9xnrdak",uiAttribs:{},portsIn:[{name:"Key",value:"sources"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"e5x5vmboo",objOut:"os9xnrdak"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"57sw3frpo",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"7lgqbazf4",objOut:"57sw3frpo"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"xcvfy4eer",uiAttribs:{},portsIn:[{name:"Variable",value:"entityHovered"}],portsOut:[{name:"Value",links:[{portIn:"boolean",portOut:"Value",objIn:"57sw3frpo",objOut:"xcvfy4eer"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"z232iul3s",uiAttribs:{},portsIn:[{name:"Variable",value:"magazinElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 4",portOut:"Value",objIn:"csoqaa4xh",objOut:"z232iul3s"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"ay0i825w0",uiAttribs:{},portsIn:[{name:"Variable",value:"entityInfoElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 5",portOut:"Value",objIn:"csoqaa4xh",objOut:"ay0i825w0"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"z2isxfakw",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"e473nrkkm",objOut:"z2isxfakw"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"x2kfpu9yh",objOut:"z2isxfakw"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"r6bqj9dny",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"Update",portOut:"Changed",objIn:"z2isxfakw",objOut:"r6bqj9dny"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"e473nrkkm",objOut:"r6bqj9dny"}]}],objName:"Ops.Trigger.TriggerOnChangeArray"},{id:"e473nrkkm",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"lbam9zh36",objOut:"e473nrkkm"}]},{name:"index",value:2},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"33e94vnp1",objOut:"e473nrkkm"},{portIn:"data",portOut:"value",objIn:"3g7utdyn3",objOut:"e473nrkkm"},{portIn:"data",portOut:"value",objIn:"wpa10bvq3",objOut:"e473nrkkm"},{portIn:"data",portOut:"value",objIn:"mquohmgwt",objOut:"e473nrkkm"},{portIn:"data",portOut:"value",objIn:"0qhc2hqqg",objOut:"e473nrkkm"},{portIn:"data",portOut:"value",objIn:"f9q68amxm",objOut:"e473nrkkm"},{portIn:"Object",portOut:"value",objIn:"o5yk4ot6u",objOut:"e473nrkkm"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"lbam9zh36",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"2k4g2fchc",objOut:"lbam9zh36"}]},{name:"trigger 6",links:[{portIn:"Update",portOut:"trigger 6",objIn:"dp2b80sjt",objOut:"lbam9zh36"}]},{name:"trigger 14",links:[{portIn:"Update",portOut:"trigger 14",objIn:"a99rfusa6",objOut:"lbam9zh36"}]}],objName:"Ops.Trigger.Sequence"},{id:"dp2b80sjt",uiAttribs:{},portsIn:[{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"khyrew7q7",objOut:"dp2b80sjt"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"a99rfusa6",objOut:"dp2b80sjt"}]}],objName:"Ops.Data.Compose.Object.CompObject"},{id:"a99rfusa6",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"khyrew7q7",uiAttribs:{},portsIn:[{name:"Key",value:"author"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"lvzokxtif",objOut:"khyrew7q7"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"lvzokxtif",uiAttribs:{},portsIn:[{name:"Key",value:"date"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"mcyooo52u",objOut:"lvzokxtif"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"fh37zk998",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"1vsaf5xos",objOut:"fh37zk998"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"1vsaf5xos",uiAttribs:{},portsIn:[{name:"Key",value:"teaser"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"w4utpz1ir",objOut:"1vsaf5xos"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"w4utpz1ir",uiAttribs:{},portsIn:[{name:"Key",value:"text"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"0tpx59amn",objOut:"w4utpz1ir"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"0tpx59amn",uiAttribs:{},portsIn:[{name:"Key",value:"tags"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"mcyooo52u",uiAttribs:{},portsIn:[{name:"Key",value:"image"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"fh37zk998",objOut:"mcyooo52u"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetObject"},{id:"33e94vnp1",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"fh37zk998",objOut:"33e94vnp1"}]}],objName:"Ops.Json.ObjectGetString"},{id:"3g7utdyn3",uiAttribs:{},portsIn:[{name:"Key",value:"teaser"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"1vsaf5xos",objOut:"3g7utdyn3"}]}],objName:"Ops.Json.ObjectGetString"},{id:"wpa10bvq3",uiAttribs:{},portsIn:[{name:"Key",value:"description"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"w4utpz1ir",objOut:"wpa10bvq3"}]}],objName:"Ops.Json.ObjectGetString"},{id:"mquohmgwt",uiAttribs:{},portsIn:[{name:"Key",value:"zeit"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"lvzokxtif",objOut:"mquohmgwt"}]}],objName:"Ops.Json.ObjectGetString"},{id:"2k4g2fchc",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"0qtgle5fj",objOut:"2k4g2fchc"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"0tpx59amn",objOut:"2k4g2fchc"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"0qhc2hqqg",uiAttribs:{},portsIn:[{name:"Key",value:"tags"}],portsOut:[{name:"Result",links:[{portIn:"text",portOut:"Result",objIn:"sugi3ulco",objOut:"0qhc2hqqg"}]}],objName:"Ops.Json.ObjectGetString"},{id:"sugi3ulco",uiAttribs:{},portsIn:[{name:"separator",value:","},{name:"Numbers",value:0},{name:"Trim",value:1},{name:"Split Lines",value:0}],portsOut:[{name:"array",links:[{portIn:"Array",portOut:"array",objIn:"0qtgle5fj",objOut:"sugi3ulco"}]},{name:"length",value:0}],objName:"Ops.Array.StringToArray_v2"},{id:"0qtgle5fj",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"Update",portOut:"Trigger",objIn:"8jnojeu1z",objOut:"0qtgle5fj"}]},{name:"Index",value:1},{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"ylvz1r0sj",objOut:"0qtgle5fj"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"8jnojeu1z",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"t3rj3sy1r",uiAttribs:{},portsIn:[{name:"JSON String",value:'{\n    "type": "",\n    "title": ""\n}'}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"ylvz1r0sj",objOut:"t3rj3sy1r"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"ylvz1r0sj",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"8jnojeu1z",objOut:"ylvz1r0sj"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"n3xig6cso",uiAttribs:{},portsIn:[{name:"bool 2",value:1}],portsOut:[{name:"result",links:[{portIn:"Display index",portOut:"result",objIn:"weq938i0u",objOut:"n3xig6cso"}]}],objName:"Ops.Boolean.And"},{id:"h0v946cvo",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result",links:[{portIn:"data",portOut:"Result",objIn:"4fmm4t5by",objOut:"h0v946cvo"}]}],objName:"Ops.Json.ObjectGetObject_v2"},{id:"4fmm4t5by",uiAttribs:{},portsIn:[{name:"Key",value:"Info"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"ppls6t2lx",objOut:"4fmm4t5by"}]}],objName:"Ops.Json.ObjectGetString"},{id:"lkk4ahmy5",uiAttribs:{},portsIn:[{name:"CSS Cursors",value:"auto"},{name:"Set Parent Element",value:1}],objName:"Ops.Html.Cursor_v2"},{id:"zwifpmioo",uiAttribs:{},portsIn:[{name:"Variable",value:"entityHovered"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"7d5uoc5oh",objOut:"zwifpmioo"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"7d5uoc5oh",uiAttribs:{},portsOut:[{name:"True",links:[{portIn:"2",portOut:"True",objIn:"i435jo6eb",objOut:"7d5uoc5oh"}]},{name:"False",links:[{portIn:"0",portOut:"False",objIn:"i435jo6eb",objOut:"7d5uoc5oh"}]}],objName:"Ops.Boolean.TriggerOnChangeBoolean"},{id:"i435jo6eb",uiAttribs:{},portsOut:[{name:"number",links:[{portIn:"CSS Cursors index",portOut:"number",objIn:"lkk4ahmy5",objOut:"i435jo6eb"}]},{name:"Triggered",links:[{portIn:"Update",portOut:"Triggered",objIn:"lkk4ahmy5",objOut:"i435jo6eb"}]}],objName:"Ops.Trigger.NumberByTrigger"},{id:"x27pmhrjm",uiAttribs:{},portsOut:[{name:"trigger 1",links:[{portIn:"Update",portOut:"trigger 1",objIn:"c3789wtfr",objOut:"x27pmhrjm"}]},{name:"trigger 6",links:[{portIn:"Execute",portOut:"trigger 6",objIn:"hujpm1e7t",objOut:"x27pmhrjm"}]},{name:"trigger 9",links:[{portIn:"Update",portOut:"trigger 9",objIn:"9lv2i5m7p",objOut:"x27pmhrjm"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"q1a6jssr1",objOut:"x27pmhrjm"}]}],objName:"Ops.Trigger.Sequence"},{id:"z3980qxx8",uiAttribs:{},portsIn:[{name:"Array 2",value:0},{name:"Array 3",value:0},{name:"Array 4",value:0},{name:"Array 5",value:0},{name:"Array 6",value:0},{name:"Array 7",value:0}],portsOut:[{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"1tniu0w1r",objOut:"z3980qxx8"}]},{name:"Array length",value:0}],objName:"Ops.Array.ArrayMerge_v3"},{id:"1tniu0w1r",uiAttribs:{},portsIn:[{name:"Format index",value:0},{name:"Format",value:"X"}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"wy4ghn65p",objOut:"1tniu0w1r"}]},{name:"Array Length Out",value:0}],objName:"Ops.Array.ArrayUnique"},{id:"q1a6jssr1",uiAttribs:{},portsIn:[{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"vt0z57zfj",objOut:"q1a6jssr1"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"6ua0lmfvk",objOut:"q1a6jssr1"}]}],objName:"Ops.Data.Compose.Object.CompObject"},{id:"vt0z57zfj",uiAttribs:{},portsIn:[{name:"Key",value:"Verbindungen"}],portsOut:[{name:"Next",links:[{portIn:"Execute",portOut:"Next",objIn:"28ptf4kya",objOut:"vt0z57zfj"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"rzk1abtn5",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"6t8ibxuax",objOut:"rzk1abtn5"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"vt0z57zfj",objOut:"rzk1abtn5"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"gnjrpicd0",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"8vcy8twbg",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"4qgcye9ro",objOut:"8vcy8twbg"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"4qgcye9ro",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"yjkxuxn8v",objOut:"4qgcye9ro"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"yjkxuxn8v",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"gnjrpicd0",objOut:"yjkxuxn8v"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"6t8ibxuax",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"2yrxospuk",objOut:"6t8ibxuax"}]},{name:"index",value:2},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"of0ovk8l7",objOut:"6t8ibxuax"},{portIn:"data",portOut:"value",objIn:"f4aimeu9v",objOut:"6t8ibxuax"},{portIn:"data",portOut:"value",objIn:"z65xx679z",objOut:"6t8ibxuax"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"of0ovk8l7",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"4qgcye9ro",objOut:"of0ovk8l7"},{portIn:"String 1",portOut:"Result",objIn:"qv0dqlx6r",objOut:"of0ovk8l7"}]}],objName:"Ops.Json.ObjectGetString"},{id:"f4aimeu9v",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"yjkxuxn8v",objOut:"f4aimeu9v"}]}],objName:"Ops.Json.ObjectGetString"},{id:"0g05biswn",uiAttribs:{},portsIn:[{name:"Key",value:"Mitglieder"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"n5uaxhg1x",objOut:"0g05biswn"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"n5uaxhg1x",uiAttribs:{},portsIn:[{name:"Key",value:"Freunde"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"lomksqnvu",uiAttribs:{},portsIn:[{name:"key",value:"Personen/Lehrer_innen"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"1zzy5i40z",objOut:"lomksqnvu"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"1stx90lo7",uiAttribs:{},portsIn:[{name:"key",value:"Personen/Freunde"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"zepxs5w54",objOut:"1stx90lo7"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"th94c72fo",uiAttribs:{},portsIn:[{name:"key",value:"Personen/Familie"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"xar7fqsb5",objOut:"th94c72fo"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"auigs0smj",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result",links:[{portIn:"data",portOut:"Result",objIn:"lomksqnvu",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"th94c72fo",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"s11wk9efu",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"2ykxm4n76",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"ykfauyr8l",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"9k6nflp9n",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"1stx90lo7",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"v4unm07bm",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"2o8ge4ksq",objOut:"auigs0smj"},{portIn:"data",portOut:"Result",objIn:"evbdj0vc5",objOut:"auigs0smj"}]}],objName:"Ops.Json.ObjectGetObject_v2"},{id:"enclqcxyo",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"senvrprzq",objOut:"enclqcxyo"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"senvrprzq",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"ud9janle8",objOut:"senvrprzq"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"ud9janle8",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"efkgzo53o",objOut:"ud9janle8"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"iwyyix379",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"vtz1qvo9a",objOut:"iwyyix379"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"vtz1qvo9a",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"0mkkcodis",objOut:"vtz1qvo9a"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"0mkkcodis",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"354hsyssl",objOut:"0mkkcodis"},{portIn:"data",portOut:"Result Object",objIn:"xzh8mafvh",objOut:"0mkkcodis"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"1zzy5i40z",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"j0teumu0s",objOut:"1zzy5i40z"}]},{name:"Index",value:1},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"rn97rtv5n",objOut:"1zzy5i40z"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"xar7fqsb5",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"yu6dlar75",objOut:"xar7fqsb5"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"yi7a1btai",objOut:"xar7fqsb5"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"zepxs5w54",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"moq8th3r4",objOut:"zepxs5w54"}]},{name:"Index",value:0},{name:"Value",value:"Person_Levin_Julo"}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"efqtdo4yr",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"rn97rtv5n",objOut:"efqtdo4yr"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"40qovvpqw",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"dpttpo2u1",objOut:"40qovvpqw"}]},{name:"trigger 1",links:[{portIn:"Update",portOut:"trigger 1",objIn:"b9hk3n8xo",objOut:"40qovvpqw"}]},{name:"trigger 2",links:[{portIn:"Update",portOut:"trigger 2",objIn:"q9xl0h8jd",objOut:"40qovvpqw"}]}],objName:"Ops.Trigger.Sequence"},{id:"nww1fz4wx",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"12y4n92ja",objOut:"nww1fz4wx"},{portIn:"data",portOut:"value",objIn:"7r4yqozk7",objOut:"nww1fz4wx"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"dpttpo2u1",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"1zzy5i40z",objOut:"dpttpo2u1"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"f8z7ofczr",objOut:"dpttpo2u1"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"efkgzo53o",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"12y4n92ja",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"senvrprzq",objOut:"12y4n92ja"}]}],objName:"Ops.Json.ObjectGetString"},{id:"7r4yqozk7",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"dvap0xta6",objOut:"7r4yqozk7"}]}],objName:"Ops.Json.ObjectGetString"},{id:"j0teumu0s",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"efkgzo53o",objOut:"j0teumu0s"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"qn8cvkwb5",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Heinrich Nauen"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"j0teumu0s",objOut:"qn8cvkwb5"}]}],objName:"Ops.String.FilterValidString"},{id:"b9hk3n8xo",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"xar7fqsb5",objOut:"b9hk3n8xo"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"q6nodtgk0",objOut:"b9hk3n8xo"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"354hsyssl",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"yu6dlar75",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"354hsyssl",objOut:"yu6dlar75"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"vfeguo47c",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"yi7a1btai",objOut:"vfeguo47c"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"exqw03rdh",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"afjf07d9v",objOut:"exqw03rdh"},{portIn:"data",portOut:"value",objIn:"oggmg7ysk",objOut:"exqw03rdh"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"afjf07d9v",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"vtz1qvo9a",objOut:"afjf07d9v"}]}],objName:"Ops.Json.ObjectGetString"},{id:"oggmg7ysk",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"0mkkcodis",objOut:"oggmg7ysk"}]}],objName:"Ops.Json.ObjectGetString"},{id:"csd784tgc",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Mieke Monjau"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"yu6dlar75",objOut:"csd784tgc"}]}],objName:"Ops.String.FilterValidString"},{id:"qmvw1pbvs",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"r6poq0coj",objOut:"qmvw1pbvs"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"r6poq0coj",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"xs1hnmx7l",objOut:"r6poq0coj"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"xs1hnmx7l",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],objName:"Ops.Json.ObjectSetString_v2"},{id:"rfs060tf3",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"moq8th3r4",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"rfs060tf3",objOut:"moq8th3r4"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"mhe3antsz",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"drif6942z",objOut:"mhe3antsz"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"9ak8lklkg",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"pmxjwetwm",objOut:"9ak8lklkg"},{portIn:"data",portOut:"value",objIn:"9360bl8fn",objOut:"9ak8lklkg"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"pmxjwetwm",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"r6poq0coj",objOut:"pmxjwetwm"}]}],objName:"Ops.Json.ObjectGetString"},{id:"9360bl8fn",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"f5sdqpl53",objOut:"9360bl8fn"},{portIn:"Value",portOut:"Result",objIn:"xs1hnmx7l",objOut:"9360bl8fn"}]}],objName:"Ops.Json.ObjectGetString"},{id:"f5sdqpl53",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Werkleute auf Haus Nyland"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"moq8th3r4",objOut:"f5sdqpl53"}]}],objName:"Ops.String.FilterValidString"},{id:"q9xl0h8jd",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"zepxs5w54",objOut:"q9xl0h8jd"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"29g2ta0bo",objOut:"q9xl0h8jd"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"c3789wtfr",uiAttribs:{},portsIn:[{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Execute",portOut:"Next",objIn:"6z5xivsgw",objOut:"c3789wtfr"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"hvrdb1kou",objOut:"c3789wtfr"}]}],objName:"Ops.Data.Compose.Object.CompObject"},{id:"94jinx4bp",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"q0see6f1t",objOut:"94jinx4bp"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"q0see6f1t",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"bdpt08zz1",objOut:"q0see6f1t"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"uorkdjccf",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"qshn2xncn",objOut:"uorkdjccf"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"qshn2xncn",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"1pdbuwr2l",objOut:"qshn2xncn"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"yfc1dsz9d",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"k1l00p76g",objOut:"yfc1dsz9d"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"k1l00p76g",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"35hjnugr7",objOut:"k1l00p76g"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"v7tvar5nj",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"v7i1tj7zu",objOut:"v7tvar5nj"}]},{name:"trigger 4",links:[{portIn:"Update",portOut:"trigger 4",objIn:"1id2m5mq4",objOut:"v7tvar5nj"}]},{name:"trigger 6",links:[{portIn:"Update",portOut:"trigger 6",objIn:"lwzle77bz",objOut:"v7tvar5nj"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"iugg7mq15",objOut:"v7tvar5nj"}]}],objName:"Ops.Trigger.Sequence"},{id:"iugg7mq15",uiAttribs:{},portsIn:[{name:"Key",value:"Lebensdaten"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"kqezdvqqj",objOut:"iugg7mq15"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"kqezdvqqj",uiAttribs:{},portsIn:[{name:"Key",value:"Profession"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"a07edhras",objOut:"kqezdvqqj"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"a07edhras",uiAttribs:{},portsIn:[{name:"Key",value:"Wirkungsort"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"1id2m5mq4",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"rahcrzqbr",objOut:"1id2m5mq4"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"kqezdvqqj",objOut:"1id2m5mq4"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"35hjnugr7",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"bdpt08zz1",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"1pdbuwr2l",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"rahcrzqbr",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"rulckdcdw",objOut:"rahcrzqbr"}]},{name:"Index",value:2},{name:"Value",links:[{portIn:"String",portOut:"Value",objIn:"7jnvvd8zd",objOut:"rahcrzqbr"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"r069vbctq",uiAttribs:{},portsIn:[{name:"key",value:"Profession"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"rahcrzqbr",objOut:"r069vbctq"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"piag244uc",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result",links:[{portIn:"data",portOut:"Result",objIn:"r069vbctq",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"y91eswniy",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"8mopkz1gh",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"ys06ug3pv",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"b0uow51pq",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"1icxdjpp7",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"f8m47m90e",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"8gyrvcccv",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"9ap9dgh2k",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"g6kv216i1",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"p0tskf8az",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"yspxem80w",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"0k2ic02ez",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"nafy9g63u",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"yl1olbck4",objOut:"piag244uc"},{portIn:"data",portOut:"Result",objIn:"hhihh0t3e",objOut:"piag244uc"}]}],objName:"Ops.Json.ObjectGetObject_v2"},{id:"y91eswniy",uiAttribs:{},portsIn:[{name:"key",value:"Wirkungsorte"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"r757yza6s",objOut:"y91eswniy"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"r757yza6s",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"k45ksyi5t",objOut:"r757yza6s"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"String",portOut:"Value",objIn:"j2npp96fq",objOut:"r757yza6s"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"8mopkz1gh",uiAttribs:{},portsIn:[{name:"key",value:"Geburtsort"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"dpnkguoqz",objOut:"8mopkz1gh"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"ys06ug3pv",uiAttribs:{},portsIn:[{name:"key",value:"Daten"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"hp2wse1n2",objOut:"ys06ug3pv"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"dpnkguoqz",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"aerz2ur0f",objOut:"dpnkguoqz"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"k1l00p76g",objOut:"dpnkguoqz"},{portIn:"String",portOut:"Value",objIn:"xdkwpug5z",objOut:"dpnkguoqz"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"v7i1tj7zu",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"chgc2dnel",objOut:"v7i1tj7zu"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"iugg7mq15",objOut:"v7i1tj7zu"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"chgc2dnel",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Exe",portOut:"trigger 0",objIn:"dpnkguoqz",objOut:"chgc2dnel"}]},{name:"trigger 15",links:[{portIn:"exe",portOut:"trigger 15",objIn:"wehcwmfbo",objOut:"chgc2dnel"}]}],objName:"Ops.Trigger.Sequence"},{id:"cjr8n5pnj",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"b253q8ne8",objOut:"cjr8n5pnj"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"b253q8ne8",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"l1tfbaxph",objOut:"b253q8ne8"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"l1tfbaxph",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"hp2wse1n2",uiAttribs:{},portsIn:[{name:"Seperator",value:"-"},{name:"New Line",value:0}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"b253q8ne8",objOut:"hp2wse1n2"},{portIn:"String",portOut:"Result",objIn:"rtel3gxof",objOut:"hp2wse1n2"}]}],objName:"Ops.Array.ArrayToString_v3"},{id:"kl9pkhf3g",uiAttribs:{},portsIn:[{name:"Property",value:"opacity"},{name:"Value Suffix",value:""}],objName:"Ops.Html.CSS.CSSProperty_v2"},{id:"y7pi2m3jz",uiAttribs:{},portsOut:[{name:"URL",value:"https://devsandbox.cables.gl/ui/#/stories"},{name:"Host",value:"devsandbox.cables.gl"},{name:"Hash",links:[{portIn:"String 1",portOut:"Hash",objIn:"wr4zfv6pb",objOut:"y7pi2m3jz"}]},{name:"Pathname",value:"/ui/"},{name:"Protocol",value:"https:"},{name:"Port",value:""}],objName:"Ops.Website.InfoURL"},{id:"wr4zfv6pb",uiAttribs:{},portsIn:[{name:"String 2",value:"#sidebar"}],portsOut:[{name:"Result",links:[{portIn:"bool 1",portOut:"Result",objIn:"7a5d5ccsv",objOut:"wr4zfv6pb"}]}],objName:"Ops.String.StringEquals"},{id:"7a5d5ccsv",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0},{name:"bool 10",value:0}],portsOut:[{name:"result",links:[{portIn:"Visible",portOut:"result",objIn:"jtvmeqqoy",objOut:"7a5d5ccsv"},{portIn:"Visible",portOut:"result",objIn:"qyb5uuiiy",objOut:"7a5d5ccsv"}]}],objName:"Ops.Boolean.Or"},{id:"sep2kxr5r",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosX"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"o9qjd8ndp",objOut:"sep2kxr5r"},{portIn:"Value",portOut:"Value",objIn:"mdm4uv0ou",objOut:"sep2kxr5r"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"w5ac9bwi4",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosY"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"o9qjd8ndp",objOut:"w5ac9bwi4"},{portIn:"Value",portOut:"Value",objIn:"4k634ctwz",objOut:"w5ac9bwi4"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"mk8nfrsf7",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Speed",value:.001},{name:"Input Type index",value:0},{name:"Input Type",value:"All"},{name:"Area index",value:0},{name:"Area",value:"Canvas Area"}],portsOut:[{name:"Delta X",links:[{portIn:"Delta Value",portOut:"Delta X",objIn:"6e1acdko4",objOut:"mk8nfrsf7"}]},{name:"Delta Y",links:[{portIn:"Delta Value",portOut:"Delta Y",objIn:"tbmos6p7e",objOut:"mk8nfrsf7"}]},{name:"Is Dragging",value:false}],objName:"Ops.Devices.Mouse.MouseDrag"},{id:"gurz4xvpn",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"viewPosX"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"1zejz0t0n",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"viewPosY"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"90a7tsqcy",uiAttribs:{},portsIn:[{name:"Default",value:"text-default"},{name:"String 1",value:"gruppe"},{name:"Result String 1",value:"gruppe-default"},{name:"String 2",value:"person"},{name:"Result String 2",value:"text-default"},{name:"String 3",value:"ausstellung"},{name:"Result String 3",value:"ausstellung-default"},{name:"String 4",value:"publikation"},{name:"Result String 4",value:"publikation-default"},{name:"String 5",value:""},{name:"Result String 5",value:""},{name:"String 6",value:""},{name:"Result String 6",value:""},{name:"String 7",value:""},{name:"Result String 7",value:""},{name:"String 8",value:""},{name:"Result String 8",value:""},{name:"String 9",value:""},{name:"Result String 9",value:""},{name:"String 10",value:""},{name:"Result String 10",value:""}],portsOut:[{name:"Result",links:[{portIn:"Var Name",portOut:"Result",objIn:"mfnug45fc",objOut:"90a7tsqcy"}]}],objName:"Ops.String.StringSwitchByString"},{id:"g6mt9lz42",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"90a7tsqcy",objOut:"g6mt9lz42"}]}],objName:"Ops.Json.ObjectGetString"},{id:"7y46351he",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Display index",portOut:"Result",objIn:"6q2vsbg7f",objOut:"7y46351he"}]}],objName:"Ops.Boolean.Not"},{id:"803cu7s2p",uiAttribs:{},portsIn:[{name:"Variable",value:"graphLoading"}],portsOut:[{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"7y46351he",objOut:"803cu7s2p"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"ipz65mlj7",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"exe",portOut:"Changed",objIn:"9t6mp6wsl",objOut:"ipz65mlj7"}]}],objName:"Ops.Trigger.TriggerOnChangeString"},{id:"tbmos6p7e",uiAttribs:{},portsIn:[{name:"Default Value",value:0},{name:"Multiply",value:3},{name:"Limit",value:0},{name:"Min",value:0},{name:"Max",value:100},{name:"Rubberband",value:0}],portsOut:[{name:"Absolute Value",links:[{portIn:"number1",portOut:"Absolute Value",objIn:"4ywuvcms5",objOut:"tbmos6p7e"}]}],objName:"Ops.Math.DeltaSum"},{id:"6e1acdko4",uiAttribs:{},portsIn:[{name:"Default Value",value:0},{name:"Multiply",value:3},{name:"Limit",value:0},{name:"Min",value:0},{name:"Max",value:100},{name:"Rubberband",value:0}],portsOut:[{name:"Absolute Value",links:[{portIn:"Value",portOut:"Absolute Value",objIn:"6hit95x3t",objOut:"6e1acdko4"}]}],objName:"Ops.Math.DeltaSum"},{id:"6hit95x3t",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosX"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"s6xxr47qt",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosY"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"9l1t4934r",uiAttribs:{},portsIn:[{name:"Text",value:""},{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:1},{name:"Interactive",value:"False"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"zoom"},{name:"Disable CSS Props",value:""},{name:"Display",value:"Block"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Parent",portOut:"DOM Element",objIn:"iy8virtoc",objOut:"9l1t4934r"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"oezryf6v8",uiAttribs:{},portsIn:[{name:"Text",value:'<span class="icon icon-plus"></span>'},{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:0},{name:"Height",value:20},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"button zoom-in"},{name:"Disable CSS Props",value:""},{name:"Display index",value:5},{name:"Display",value:"inline-flex"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Child 1",portOut:"DOM Element",objIn:"iy8virtoc",objOut:"oezryf6v8"},{portIn:"HTML Element",portOut:"DOM Element",objIn:"kbybbjm7b",objOut:"oezryf6v8"}]},{name:"Hovering",value:0},{name:"Clicked",links:[{portIn:"Trigger",portOut:"Clicked",objIn:"16o2296ny",objOut:"oezryf6v8"}]}],objName:"Ops.Html.Elements.Element_v2"},{id:"nw7je5d09",uiAttribs:{},portsIn:[{name:"Text",value:'<span class="icon icon-minus"></span>'},{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:0},{name:"Height",value:20},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"button zoom-out"},{name:"Disable CSS Props",value:""},{name:"Display index",value:5},{name:"Display",value:"inline-flex"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Child 2",portOut:"DOM Element",objIn:"iy8virtoc",objOut:"nw7je5d09"},{portIn:"HTML Element",portOut:"DOM Element",objIn:"yqar0tvz9",objOut:"nw7je5d09"}]},{name:"Hovering",value:0},{name:"Clicked",links:[{portIn:"Trigger",portOut:"Clicked",objIn:"ktwrdwzit",objOut:"nw7je5d09"}]}],objName:"Ops.Html.Elements.Element_v2"},{id:"iy8virtoc",uiAttribs:{},portsOut:[{name:"Parent Out",links:[{portIn:"Value",portOut:"Parent Out",objIn:"m1blg3p74",objOut:"iy8virtoc"}]}],objName:"Ops.Html.ElementChilds_v2"},{id:"hzxxbbxx3",uiAttribs:{},portsIn:[{name:"Variable",value:"filtersElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"3pm4ga8zn",uiAttribs:{},portsIn:[{name:"Variable",value:"filtersElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 1",portOut:"Value",objIn:"csoqaa4xh",objOut:"3pm4ga8zn"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"m1blg3p74",uiAttribs:{},portsIn:[{name:"Variable",value:"zoomElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"7vu19bcpq",uiAttribs:{},portsIn:[{name:"Variable",value:"zoomElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 6",portOut:"Value",objIn:"csoqaa4xh",objOut:"7vu19bcpq"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"gyrgmqkg7",uiAttribs:{},portsIn:[{name:"Variable",value:"menuElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"fg69yejo7",uiAttribs:{},portsIn:[{name:"Variable",value:"menuElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 2",portOut:"Value",objIn:"csoqaa4xh",objOut:"fg69yejo7"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"wp2bvvb3c",uiAttribs:{},portsIn:[{name:"Variable",value:"stateElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 3",portOut:"Value",objIn:"csoqaa4xh",objOut:"wp2bvvb3c"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"oy3v6nnfe",uiAttribs:{},portsIn:[{name:"text",value:"0.09,0.18,0.4,0.8,1.5,2"},{name:"separator",value:","},{name:"Numbers",value:1},{name:"Trim",value:1},{name:"Split Lines",value:0}],portsOut:[{name:"array",links:[{portIn:"Value",portOut:"array",objIn:"17swkmnkx",objOut:"oy3v6nnfe"}]},{name:"length",value:6}],objName:"Ops.Array.StringToArray_v2"},{id:"17swkmnkx",uiAttribs:{},portsIn:[{name:"Variable",value:"zoomLevels"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"9m1f01jc3",uiAttribs:{},portsIn:[{name:"Variable",value:"zoomLevels"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"87xz1tm49",objOut:"9m1f01jc3"},{portIn:"array",portOut:"Value",objIn:"53xeicyy7",objOut:"9m1f01jc3"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"iao3h05n4",uiAttribs:{},portsIn:[{name:"Variable",value:"viewMappedZoom"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"jqn86lfi4",uiAttribs:{},portsIn:[{name:"Separate inc/dec",value:0},{name:"Inc factor",value:8,title:"Inc/Dec factor"},{name:"Dec factor",value:4}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"iao3h05n4",objOut:"jqn86lfi4"}]}],objName:"Ops.Anim.Smooth"},{id:"pr2dmxzi9",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"mainLoop"}],portsOut:[{name:"Triggered",links:[{portIn:"Update",portOut:"Triggered",objIn:"jqn86lfi4",objOut:"pr2dmxzi9"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"jecx4wivm",uiAttribs:{},portsIn:[{name:"Variable",value:"entityNameElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"u1ktjfn24",uiAttribs:{},portsIn:[{name:"Variable",value:"entityNameElement"}],portsOut:[{name:"Value",links:[{portIn:"Element",portOut:"Value",objIn:"ilc868mwp",objOut:"u1ktjfn24"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"bi8a7yjy2",uiAttribs:{},portsIn:[{name:"Variable",value:"entityNameElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 7",portOut:"Value",objIn:"csoqaa4xh",objOut:"bi8a7yjy2"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"jmulr8i63",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Trigger",portOut:"then",objIn:"yb9q2iapk",objOut:"jmulr8i63"}]},{name:"else",links:[{portIn:"Trigger",portOut:"else",objIn:"k2jyk8vov",objOut:"jmulr8i63"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"fkezpet4i",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"entityClicked"}],objName:"Ops.Trigger.TriggerSend"},{id:"rr8n3wlqr",uiAttribs:{},portsIn:[{name:"Variable",value:"infoElementVisible"}],portsOut:[{name:"Value",links:[{portIn:"Display index",portOut:"Value",objIn:"qf444jnra",objOut:"rr8n3wlqr"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"k2jyk8vov",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"entityRelease"}],objName:"Ops.Trigger.TriggerSend"},{id:"di1p266cl",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"Trigger",portOut:"Event Trigger",objIn:"fktyyj85f",objOut:"di1p266cl"}]}],objName:"Ops.Html.Event.ElementEventListener_v2"},{id:"jize7jys9",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"Update",portOut:"Changed",objIn:"8delntgus",objOut:"jize7jys9"}]}],objName:"Ops.Trigger.TriggerOnChangeString"},{id:"fktyyj85f",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"entityRelease"}],objName:"Ops.Trigger.TriggerSend"},{id:"3re6kn2rr",uiAttribs:{},portsIn:[{name:"Variable",value:"pointColors"}],portsOut:[{name:"Value",links:[{portIn:"Array In",portOut:"Value",objIn:"x6t1nkmxz",objOut:"3re6kn2rr"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"mt84em94z",uiAttribs:{},portsIn:[{name:"Variable",value:"pointPositions"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"wooqz6jqs",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"ya2ffvcec",objOut:"wooqz6jqs"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"3zz3vi4ac",objOut:"wooqz6jqs"},{portIn:"Array",portOut:"Result",objIn:"os60wm1fi",objOut:"wooqz6jqs"},{portIn:"array",portOut:"Result",objIn:"gj6c3nff6",objOut:"wooqz6jqs"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"v4325vo2v",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"ya2ffvcec",objOut:"v4325vo2v"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"uyxu7rre5",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"iuce07sk2",objOut:"uyxu7rre5"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"i0fh6hbag",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"xkgkuam4s",objOut:"i0fh6hbag"}]}],objName:"Ops.Json.ObjectGetString"},{id:"iuce07sk2",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"3zz3vi4ac",uiAttribs:{},portsIn:[{name:"Variable",value:"activeConnectionNodes"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"1lh5o3jrh",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"1spchiq0v",objOut:"1lh5o3jrh"}]},{name:"trigger 1",links:[{portIn:"Update",portOut:"trigger 1",objIn:"gt0t61u5x",objOut:"1lh5o3jrh"}]},{name:"trigger 5",links:[{portIn:"Update",portOut:"trigger 5",objIn:"wooqz6jqs",objOut:"1lh5o3jrh"}]},{name:"trigger 7",links:[{portIn:"exe",portOut:"trigger 7",objIn:"qkcny2soa",objOut:"1lh5o3jrh"}]},{name:"trigger 10",links:[{portIn:"Update",portOut:"trigger 10",objIn:"ksrsyvqbf",objOut:"1lh5o3jrh"}]}],objName:"Ops.Trigger.Sequence"},{id:"ksrsyvqbf",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"gfqcrmyqf",objOut:"ksrsyvqbf"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"cevazgado",objOut:"ksrsyvqbf"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"6jqgkqvzn",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"string 0",portOut:"Result",objIn:"yyydyz2yc",objOut:"6jqgkqvzn"}]}],objName:"Ops.Json.ObjectGetString"},{id:"hligdkdfw",uiAttribs:{},portsIn:[{name:"W",value:1},{name:"Num index",value:3},{name:"Num",value:"4"}],objName:"Ops.Data.Compose.Array.CompArrayPushNumbers"},{id:"cakejhyt0",uiAttribs:{},portsIn:[{name:"Bytes",value:0}],portsOut:[{name:"R",links:[{portIn:"X",portOut:"R",objIn:"hligdkdfw",objOut:"cakejhyt0"}]},{name:"G",links:[{portIn:"Y",portOut:"G",objIn:"hligdkdfw",objOut:"cakejhyt0"}]},{name:"B",links:[{portIn:"Z",portOut:"B",objIn:"hligdkdfw",objOut:"cakejhyt0"}]}],objName:"Ops.Color.HexToRGB_v2"},{id:"llogv0dw3",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Hex",portOut:"Result",objIn:"cakejhyt0",objOut:"llogv0dw3"}]}],objName:"Ops.Html.CSS.GetCssVariable"},{id:"cevazgado",uiAttribs:{},portsIn:[{name:"Variable",value:"pointColors"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"r3upoqc83",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"Boolean",portOut:"Found",objIn:"s0j6oh1s1",objOut:"r3upoqc83"}]},{name:"Index",value:-1}],objName:"Ops.Array.ArrayContains_v2"},{id:"fynwgp9o7",uiAttribs:{},portsIn:[{name:"Variable",value:"hoverPointIndex"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"dl61piy88",objOut:"fynwgp9o7"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"dl61piy88",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Boolean",portOut:"result",objIn:"qekdttuz5",objOut:"dl61piy88"}]}],objName:"Ops.Math.Compare.Equals"},{id:"20gn6izd7",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"gfqcrmyqf",objOut:"20gn6izd7"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"ch0g6i1yu",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"llogv0dw3",objOut:"ch0g6i1yu"}]},{name:"trigger 1",links:[{portIn:"Update",portOut:"trigger 1",objIn:"hligdkdfw",objOut:"ch0g6i1yu"}]}],objName:"Ops.Trigger.Sequence"},{id:"ld6p4k56r",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"abpbsh3bf",objOut:"ld6p4k56r"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"h74563434",objOut:"ld6p4k56r"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"8a7up067t",uiAttribs:{},portsIn:[{name:"Direction index",value:0},{name:"Direction",value:"Forward"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"evucwg7bo",objOut:"8a7up067t"}]},{name:"index",links:[{portIn:"SearchValue",portOut:"index",objIn:"cm85i3cxq",objOut:"8a7up067t"}]}],objName:"Ops.Trigger.Repeat_v2"},{id:"nvtd23tph",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"Repeats",portOut:"length",objIn:"8a7up067t",objOut:"nvtd23tph"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"evucwg7bo",uiAttribs:{},portsIn:[{name:"W",value:1},{name:"Num index",value:3},{name:"Num",value:"4"}],objName:"Ops.Data.Compose.Array.CompArrayPushNumbers"},{id:"l24n01bbe",uiAttribs:{},portsIn:[{name:"Var Name",value:"link-active"}],portsOut:[{name:"Result",links:[{portIn:"String 1",portOut:"Result",objIn:"i3wapufut",objOut:"l24n01bbe"}]}],objName:"Ops.Html.CSS.GetCssVariable"},{id:"y9o7xna3s",uiAttribs:{},portsIn:[{name:"Bytes",value:0}],portsOut:[{name:"R",links:[{portIn:"X",portOut:"R",objIn:"evucwg7bo",objOut:"y9o7xna3s"}]},{name:"G",links:[{portIn:"Y",portOut:"G",objIn:"evucwg7bo",objOut:"y9o7xna3s"}]},{name:"B",links:[{portIn:"Z",portOut:"B",objIn:"evucwg7bo",objOut:"y9o7xna3s"}]}],objName:"Ops.Color.HexToRGB_v2"},{id:"i3wapufut",uiAttribs:{},portsIn:[{name:"String 2",value:""},{name:"String 3",value:""},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""}],portsOut:[{name:"Result",links:[{portIn:"Hex",portOut:"Result",objIn:"y9o7xna3s",objOut:"i3wapufut"}]}],objName:"Ops.String.SwitchString"},{id:"cm85i3cxq",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"Index",portOut:"Found",objIn:"i3wapufut",objOut:"cm85i3cxq"}]},{name:"Index",value:-1}],objName:"Ops.Array.ArrayContains_v2"},{id:"vbch4ly2q",uiAttribs:{},portsIn:[{name:"Var Name",value:"link-inactive"}],portsOut:[{name:"Result",links:[{portIn:"String 0",portOut:"Result",objIn:"i3wapufut",objOut:"vbch4ly2q"}]}],objName:"Ops.Html.CSS.GetCssVariable"},{id:"h74563434",uiAttribs:{},portsIn:[{name:"Variable",value:"splineColors"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"qj9q0u9qp",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"mainLoop"}],portsOut:[{name:"Triggered",links:[{portIn:"Exec",portOut:"Triggered",objIn:"zmu964z9c",objOut:"qj9q0u9qp"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"zmu964z9c",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe 14",portOut:"Next",objIn:"1lh5o3jrh",objOut:"zmu964z9c"}]},{name:"Was Triggered",value:1}],objName:"Ops.Trigger.TriggerOnce"},{id:"v1uqg5j7b",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"v8r31f94d",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"se8qvcqzm",objOut:"v8r31f94d"}]},{name:"Was Triggered",value:1}],objName:"Ops.Trigger.TriggerOnce"},{id:"nlr6n4oai",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Boolean",portOut:"result",objIn:"jii0hdru5",objOut:"nlr6n4oai"}]}],objName:"Ops.Boolean.And"},{id:"bvq272eip",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 1",portOut:"Result",objIn:"nlr6n4oai",objOut:"bvq272eip"}]}],objName:"Ops.Boolean.Not"},{id:"9hjws5mhb",uiAttribs:{},portsIn:[{name:"Variable",value:"graphLoading"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"xak1pte5q",uiAttribs:{},portsIn:[{name:"Style index",value:1},{name:"Style",value:"Ring"}],objName:"Ops.Html.Utils.LoadingIndicator"},{id:"aq5545odt",uiAttribs:{},portsIn:[{name:"Variable",value:"graphLoading"}],portsOut:[{name:"Value",links:[{portIn:"Visible",portOut:"Value",objIn:"xak1pte5q",objOut:"aq5545odt"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"uk0bw43kq",uiAttribs:{},portsIn:[{name:"Variable",value:"graphLoading"}],portsOut:[{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"bvq272eip",objOut:"uk0bw43kq"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"x6t1nkmxz",uiAttribs:{},portsIn:[{name:"Separate inc/dec",value:1},{name:"Inc factor",value:12,title:"Inc factor"},{name:"Dec factor",value:20}],portsOut:[{name:"Array Out",links:[{portIn:"Vertex Colors",portOut:"Array Out",objIn:"zvu4o6ow7",objOut:"x6t1nkmxz"}]}],objName:"Ops.Array.SmoothArray"},{id:"mynuvkdww",uiAttribs:{},portsIn:[{name:"Separate inc/dec",value:1},{name:"Inc factor",value:12,title:"Inc factor"},{name:"Dec factor",value:20}],portsOut:[{name:"Array Out",links:[{portIn:"Vertex Colors",portOut:"Array Out",objIn:"9wd61cznb",objOut:"mynuvkdww"}]}],objName:"Ops.Array.SmoothArray"},{id:"krdgvwmaw",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Trigger",portOut:"then",objIn:"l6jc0pzcc",objOut:"krdgvwmaw"},{portIn:"render",portOut:"then",objIn:"nycgz16ar",objOut:"krdgvwmaw"},{portIn:"Update",portOut:"then",objIn:"mdm4uv0ou",objOut:"krdgvwmaw"},{portIn:"Update",portOut:"then",objIn:"4k634ctwz",objOut:"krdgvwmaw"},{portIn:"Update",portOut:"then",objIn:"daxmi3q8c",objOut:"krdgvwmaw"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"zt0ipfv3k",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Opacity",portOut:"Result",objIn:"yi7divvoo",objOut:"zt0ipfv3k"}]}],objName:"Ops.Boolean.Not"},{id:"004pfitzh",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"eqtv67e0n",objOut:"004pfitzh"}]}],objName:"Ops.Vars.VarGetString"},{id:"eqtv67e0n",uiAttribs:{},portsIn:[{name:"Place Name",value:"magazin"}],portsOut:[{name:"Is Current Place",links:[{portIn:"Boolean",portOut:"Is Current Place",objIn:"zt0ipfv3k",objOut:"eqtv67e0n"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"0xwe0a566",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"exe",portOut:"trigger 0",objIn:"x27pmhrjm",objOut:"0xwe0a566"}]},{name:"trigger 7",links:[{portIn:"Update",portOut:"trigger 7",objIn:"fdma3ycmc",objOut:"0xwe0a566"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"7fvdbg92f",objOut:"0xwe0a566"}]}],objName:"Ops.Trigger.Sequence"},{id:"28ptf4kya",uiAttribs:{},portsIn:[{name:"String 0",value:"gruppe"},{name:"String 1",value:"person"},{name:"String 2",value:"ausstellung"},{name:"String 3",value:"publikation"},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""},{name:"String 10",value:""},{name:"String 11",value:""},{name:"String 12",value:""},{name:"String 13",value:""},{name:"String 14",value:""},{name:"String 15",value:""},{name:"String 16",value:""},{name:"String 17",value:""},{name:"String 18",value:""},{name:"String 19",value:""},{name:"String 20",value:""},{name:"String 21",value:""},{name:"String 22",value:""},{name:"String 23",value:""}],portsOut:[{name:"Switched Index",value:0},{name:"Trigger 0",links:[{portIn:"Update",portOut:"Trigger 0",objIn:"0g05biswn",objOut:"28ptf4kya"}]},{name:"Trigger 1",links:[{portIn:"Update",portOut:"Trigger 1",objIn:"q6nodtgk0",objOut:"28ptf4kya"}]},{name:"Trigger 2",links:[{portIn:"Update",portOut:"Trigger 2",objIn:"8laq507nk",objOut:"28ptf4kya"}]},{name:"Trigger 3",links:[{portIn:"Update",portOut:"Trigger 3",objIn:"bp6nx4sai",objOut:"28ptf4kya"}]}],objName:"Ops.Trigger.RouteTriggerString_v2"},{id:"9f5zwge79",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Switch Value",portOut:"Result",objIn:"28ptf4kya",objOut:"9f5zwge79"}]}],objName:"Ops.Json.ObjectGetString"},{id:"q6nodtgk0",uiAttribs:{},portsIn:[{name:"Key",value:"Freunde"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"f8z7ofczr",objOut:"q6nodtgk0"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"f8z7ofczr",uiAttribs:{},portsIn:[{name:"Key",value:"Lehrer_Innen"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"29g2ta0bo",objOut:"f8z7ofczr"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"29g2ta0bo",uiAttribs:{},portsIn:[{name:"Key",value:"Familie"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"8laq507nk",uiAttribs:{},portsIn:[{name:"Key",value:"VeranstalterInnen"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"1d0wn7ak3",objOut:"8laq507nk"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"1d0wn7ak3",uiAttribs:{},portsIn:[{name:"Key",value:"Besucher"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"k9hw94s7z",objOut:"1d0wn7ak3"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"k9hw94s7z",uiAttribs:{},portsIn:[{name:"Key",value:"KuratorInnen"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"bp6nx4sai",uiAttribs:{},portsIn:[{name:"Key",value:"HerausgeberInnen"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"i8w87zx9y",objOut:"bp6nx4sai"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"i8w87zx9y",uiAttribs:{},portsIn:[{name:"Key",value:"Beitragende"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"vq3jmugde",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"zqzy2kbur",objOut:"vq3jmugde"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"wmijzzlrn",objOut:"vq3jmugde"}]}],objName:"Ops.Trigger.Sequence"},{id:"nhbd9wo03",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"zo1hfztus",objOut:"nhbd9wo03"}]},{name:"trigger 7",links:[{portIn:"Update",portOut:"trigger 7",objIn:"r4a825bxx",objOut:"nhbd9wo03"}]},{name:"trigger 14",links:[{portIn:"Update",portOut:"trigger 14",objIn:"hyrzvo6f3",objOut:"nhbd9wo03"}]}],objName:"Ops.Trigger.Sequence"},{id:"cxt42cx8j",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"3xzkj8ezr",objOut:"cxt42cx8j"}]},{name:"trigger 7",links:[{portIn:"Update",portOut:"trigger 7",objIn:"37d71e0pw",objOut:"cxt42cx8j"}]}],objName:"Ops.Trigger.Sequence"},{id:"bd5x8stlz",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Switch Value",portOut:"Result",objIn:"hujpm1e7t",objOut:"bd5x8stlz"}]}],objName:"Ops.Json.ObjectGetString"},{id:"hujpm1e7t",uiAttribs:{},portsIn:[{name:"String 0",value:"gruppe"},{name:"String 1",value:"person"},{name:"String 2",value:"ausstellung"},{name:"String 3",value:"publikation"},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""},{name:"String 10",value:""},{name:"String 11",value:""},{name:"String 12",value:""},{name:"String 13",value:""},{name:"String 14",value:""},{name:"String 15",value:""},{name:"String 16",value:""},{name:"String 17",value:""},{name:"String 18",value:""},{name:"String 19",value:""},{name:"String 20",value:""},{name:"String 21",value:""},{name:"String 22",value:""},{name:"String 23",value:""}],portsOut:[{name:"Switched Index",value:0},{name:"Trigger 0",links:[{portIn:"exe",portOut:"Trigger 0",objIn:"vq3jmugde",objOut:"hujpm1e7t"}]},{name:"Trigger 1",links:[{portIn:"exe",portOut:"Trigger 1",objIn:"40qovvpqw",objOut:"hujpm1e7t"}]},{name:"Trigger 2",links:[{portIn:"exe",portOut:"Trigger 2",objIn:"nhbd9wo03",objOut:"hujpm1e7t"}]},{name:"Trigger 3",links:[{portIn:"exe",portOut:"Trigger 3",objIn:"cxt42cx8j",objOut:"hujpm1e7t"}]}],objName:"Ops.Trigger.RouteTriggerString_v2"},{id:"zqzy2kbur",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"opq48cqqw",objOut:"zqzy2kbur"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"0g05biswn",objOut:"zqzy2kbur"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"wmijzzlrn",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"2zzq835bf",objOut:"wmijzzlrn"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"n5uaxhg1x",objOut:"wmijzzlrn"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"opq48cqqw",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"g2yb26t7i",objOut:"opq48cqqw"}]},{name:"Index",value:3},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"1kmppqzwa",objOut:"opq48cqqw"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"s11wk9efu",uiAttribs:{},portsIn:[{name:"key",value:"Mitglieder"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"opq48cqqw",objOut:"s11wk9efu"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"yg5iy6vi3",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Walter Corde"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"g2yb26t7i",objOut:"yg5iy6vi3"}]}],objName:"Ops.String.FilterValidString"},{id:"g2yb26t7i",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"09wvz7o39",objOut:"g2yb26t7i"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"09wvz7o39",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"p40bfrl4m",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"1kmppqzwa",objOut:"p40bfrl4m"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"gaayfilzy",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"jxjnu8d1j",objOut:"gaayfilzy"},{portIn:"data",portOut:"value",objIn:"nisqwcs84",objOut:"gaayfilzy"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"jxjnu8d1j",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"w7c3im2e1",objOut:"jxjnu8d1j"}]}],objName:"Ops.Json.ObjectGetString"},{id:"nisqwcs84",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"8uchtuswy",objOut:"nisqwcs84"}]}],objName:"Ops.Json.ObjectGetString"},{id:"lkynyozdz",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"w7c3im2e1",objOut:"lkynyozdz"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"w7c3im2e1",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"knoykqwg0",objOut:"w7c3im2e1"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"knoykqwg0",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"09wvz7o39",objOut:"knoykqwg0"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"8uchtuswy",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"knoykqwg0",objOut:"8uchtuswy"},{portIn:"String",portOut:"Result",objIn:"yg5iy6vi3",objOut:"8uchtuswy"}]}],objName:"Ops.String.StringTrim_v2"},{id:"dvap0xta6",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"qn8cvkwb5",objOut:"dvap0xta6"},{portIn:"Value",portOut:"Result",objIn:"ud9janle8",objOut:"dvap0xta6"}]}],objName:"Ops.String.StringTrim_v2"},{id:"2ykxm4n76",uiAttribs:{},portsIn:[{name:"key",value:"Freunde"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"2zzq835bf",objOut:"2ykxm4n76"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"2zzq835bf",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"zblei1o86",objOut:"2zzq835bf"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"1awlfv8ts",objOut:"2zzq835bf"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"ytpi6uhj2",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Bernhard Sopher"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"zblei1o86",objOut:"ytpi6uhj2"}]}],objName:"Ops.String.FilterValidString"},{id:"zblei1o86",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"x3jtj7tmy",objOut:"zblei1o86"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"x3jtj7tmy",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"7iz1kiscw",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"1awlfv8ts",objOut:"7iz1kiscw"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"8fcmko1n1",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"5tjr2de8d",objOut:"8fcmko1n1"},{portIn:"data",portOut:"value",objIn:"p9z7t6i3k",objOut:"8fcmko1n1"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"5tjr2de8d",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"1xvc40lwq",objOut:"5tjr2de8d"}]}],objName:"Ops.Json.ObjectGetString"},{id:"p9z7t6i3k",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"2thghvojh",objOut:"p9z7t6i3k"}]}],objName:"Ops.Json.ObjectGetString"},{id:"cm0oqvwk2",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"1xvc40lwq",objOut:"cm0oqvwk2"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"1xvc40lwq",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"8j80d67zx",objOut:"1xvc40lwq"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"8j80d67zx",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"x3jtj7tmy",objOut:"8j80d67zx"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"2thghvojh",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"8j80d67zx",objOut:"2thghvojh"},{portIn:"String",portOut:"Result",objIn:"ytpi6uhj2",objOut:"2thghvojh"}]}],objName:"Ops.String.StringTrim_v2"},{id:"3xzkj8ezr",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"1bna0bxx7",objOut:"3xzkj8ezr"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"bp6nx4sai",objOut:"3xzkj8ezr"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"37d71e0pw",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"gyfraqfvj",objOut:"37d71e0pw"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"i8w87zx9y",objOut:"37d71e0pw"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"1bna0bxx7",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"iljd0nmi0",objOut:"1bna0bxx7"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"9yj6xjk13",objOut:"1bna0bxx7"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"ykfauyr8l",uiAttribs:{},portsIn:[{name:"key",value:"Personen/Hrsg"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"1bna0bxx7",objOut:"ykfauyr8l"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"qgtix19bi",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Heinrich Hoerle"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"iljd0nmi0",objOut:"qgtix19bi"}]}],objName:"Ops.String.FilterValidString"},{id:"iljd0nmi0",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"1cx67mtoy",objOut:"iljd0nmi0"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"1cx67mtoy",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"ofb9if8vg",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"9yj6xjk13",objOut:"ofb9if8vg"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"8nshgx5tv",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"jm0ztahpn",objOut:"8nshgx5tv"},{portIn:"data",portOut:"value",objIn:"rjk5576do",objOut:"8nshgx5tv"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"jm0ztahpn",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"atrqsa639",objOut:"jm0ztahpn"}]}],objName:"Ops.Json.ObjectGetString"},{id:"rjk5576do",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"s7v344an8",objOut:"rjk5576do"}]}],objName:"Ops.Json.ObjectGetString"},{id:"avyaw0azu",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"atrqsa639",objOut:"avyaw0azu"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"atrqsa639",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"tlosdjw4t",objOut:"atrqsa639"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"tlosdjw4t",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"1cx67mtoy",objOut:"tlosdjw4t"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"s7v344an8",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"tlosdjw4t",objOut:"s7v344an8"},{portIn:"String",portOut:"Result",objIn:"qgtix19bi",objOut:"s7v344an8"}]}],objName:"Ops.String.StringTrim_v2"},{id:"9k6nflp9n",uiAttribs:{},portsIn:[{name:"key",value:"Personen/Beitragende"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"gyfraqfvj",objOut:"9k6nflp9n"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"gyfraqfvj",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"4yq4lvx9v",objOut:"gyfraqfvj"}]},{name:"Index",value:4},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"3xfq7hvmx",objOut:"gyfraqfvj"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"mhqayolb8",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Peter Straufeld"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"4yq4lvx9v",objOut:"mhqayolb8"}]}],objName:"Ops.String.FilterValidString"},{id:"4yq4lvx9v",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"q7tl9fhc3",objOut:"4yq4lvx9v"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"q7tl9fhc3",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"edvr0awu2",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"3xfq7hvmx",objOut:"edvr0awu2"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"23yxonvmx",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"i53ttxz7k",objOut:"23yxonvmx"},{portIn:"data",portOut:"value",objIn:"8ymlz8j2g",objOut:"23yxonvmx"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"i53ttxz7k",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"jqoe8rk02",objOut:"i53ttxz7k"}]}],objName:"Ops.Json.ObjectGetString"},{id:"8ymlz8j2g",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"r87b27p39",objOut:"8ymlz8j2g"}]}],objName:"Ops.Json.ObjectGetString"},{id:"w83nvh4q2",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"jqoe8rk02",objOut:"w83nvh4q2"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"jqoe8rk02",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"6ulnxlytj",objOut:"jqoe8rk02"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"6ulnxlytj",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"q7tl9fhc3",objOut:"6ulnxlytj"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"r87b27p39",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"6ulnxlytj",objOut:"r87b27p39"},{portIn:"String",portOut:"Result",objIn:"mhqayolb8",objOut:"r87b27p39"}]}],objName:"Ops.String.StringTrim_v2"},{id:"zo1hfztus",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"n124i6m7k",objOut:"zo1hfztus"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"8laq507nk",objOut:"zo1hfztus"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"r4a825bxx",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"o1eavyqsw",objOut:"r4a825bxx"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"1d0wn7ak3",objOut:"r4a825bxx"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"n124i6m7k",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"j1krzwxgl",objOut:"n124i6m7k"}]},{name:"Index",value:122},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"x889i1ox2",objOut:"n124i6m7k"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"v4unm07bm",uiAttribs:{},portsIn:[{name:"key",value:"Veranstalter"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"n124i6m7k",objOut:"v4unm07bm"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"igkbnk8oh",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Paul Wellershaus"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"j1krzwxgl",objOut:"igkbnk8oh"}]}],objName:"Ops.String.FilterValidString"},{id:"j1krzwxgl",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"t2pvp2c6v",objOut:"j1krzwxgl"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"t2pvp2c6v",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"hrjybshlj",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"x889i1ox2",objOut:"hrjybshlj"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"qykx3naqz",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"dsgee9vnz",objOut:"qykx3naqz"},{portIn:"data",portOut:"value",objIn:"0004x2dcm",objOut:"qykx3naqz"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"dsgee9vnz",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"ml8m5k53h",objOut:"dsgee9vnz"}]}],objName:"Ops.Json.ObjectGetString"},{id:"0004x2dcm",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"rbkznrekv",objOut:"0004x2dcm"}]}],objName:"Ops.Json.ObjectGetString"},{id:"2a56vqk44",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"ml8m5k53h",objOut:"2a56vqk44"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"ml8m5k53h",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"ilpkgsb4w",objOut:"ml8m5k53h"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"ilpkgsb4w",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"t2pvp2c6v",objOut:"ilpkgsb4w"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"rbkznrekv",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"ilpkgsb4w",objOut:"rbkznrekv"},{portIn:"String",portOut:"Result",objIn:"igkbnk8oh",objOut:"rbkznrekv"}]}],objName:"Ops.String.StringTrim_v2"},{id:"2o8ge4ksq",uiAttribs:{},portsIn:[{name:"key",value:"Besucher"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"o1eavyqsw",objOut:"2o8ge4ksq"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"o1eavyqsw",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"0bdm7jatw",objOut:"o1eavyqsw"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"1f78n1t6s",objOut:"o1eavyqsw"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"87el2jm23",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Heinrich Campendonk"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"0bdm7jatw",objOut:"87el2jm23"}]}],objName:"Ops.String.FilterValidString"},{id:"0bdm7jatw",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"fokdket6c",objOut:"0bdm7jatw"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"fokdket6c",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"qdiwn1kyo",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"1f78n1t6s",objOut:"qdiwn1kyo"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"dm8g4oqm0",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"6c7723abs",objOut:"dm8g4oqm0"},{portIn:"data",portOut:"value",objIn:"gjzyps0x0",objOut:"dm8g4oqm0"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"6c7723abs",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"00zgkpl76",objOut:"6c7723abs"}]}],objName:"Ops.Json.ObjectGetString"},{id:"gjzyps0x0",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"vgak0p00g",objOut:"gjzyps0x0"}]}],objName:"Ops.Json.ObjectGetString"},{id:"vybjl600y",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"00zgkpl76",objOut:"vybjl600y"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"00zgkpl76",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"fndtahw7b",objOut:"00zgkpl76"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"fndtahw7b",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"fokdket6c",objOut:"fndtahw7b"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"vgak0p00g",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"fndtahw7b",objOut:"vgak0p00g"},{portIn:"String",portOut:"Result",objIn:"87el2jm23",objOut:"vgak0p00g"}]}],objName:"Ops.String.StringTrim_v2"},{id:"hyrzvo6f3",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"8ojfh5esi",objOut:"hyrzvo6f3"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"k9hw94s7z",objOut:"hyrzvo6f3"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"evbdj0vc5",uiAttribs:{},portsIn:[{name:"key",value:"Kurator"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"8ojfh5esi",objOut:"evbdj0vc5"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"8ojfh5esi",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"zo18xmfoj",objOut:"8ojfh5esi"}]},{name:"Index",value:11},{name:"Value",links:[{portIn:"Filter Value",portOut:"Value",objIn:"8c9ovumto",objOut:"8ojfh5esi"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"4bv1wpuma",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Werner Sehlbach"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"zo18xmfoj",objOut:"4bv1wpuma"}]}],objName:"Ops.String.FilterValidString"},{id:"zo18xmfoj",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"iuu17jbj9",objOut:"zo18xmfoj"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"iuu17jbj9",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"327wb76i4",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"8c9ovumto",objOut:"327wb76i4"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"jykedregr",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"hd26a0ocb",objOut:"jykedregr"},{portIn:"data",portOut:"value",objIn:"kf6lptjmm",objOut:"jykedregr"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"hd26a0ocb",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"r8it3nv4u",objOut:"hd26a0ocb"}]}],objName:"Ops.Json.ObjectGetString"},{id:"kf6lptjmm",uiAttribs:{},portsIn:[{name:"Key",value:"name"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"1qb12xlja",objOut:"kf6lptjmm"}]}],objName:"Ops.Json.ObjectGetString"},{id:"oaph078y4",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"r8it3nv4u",objOut:"oaph078y4"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"r8it3nv4u",uiAttribs:{},portsIn:[{name:"Key",value:"type"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"yv1wnqa8n",objOut:"r8it3nv4u"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"yv1wnqa8n",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"iuu17jbj9",objOut:"yv1wnqa8n"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"1qb12xlja",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"yv1wnqa8n",objOut:"1qb12xlja"},{portIn:"String",portOut:"Result",objIn:"4bv1wpuma",objOut:"1qb12xlja"}]}],objName:"Ops.String.StringTrim_v2"},{id:"6z5xivsgw",uiAttribs:{},portsIn:[{name:"String 0",value:"gruppe"},{name:"String 1",value:"person"},{name:"String 2",value:"ausstellung"},{name:"String 3",value:"publikation"},{name:"String 4",value:""},{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:""},{name:"String 9",value:""},{name:"String 10",value:""},{name:"String 11",value:""},{name:"String 12",value:""},{name:"String 13",value:""},{name:"String 14",value:""},{name:"String 15",value:""},{name:"String 16",value:""},{name:"String 17",value:""},{name:"String 18",value:""},{name:"String 19",value:""},{name:"String 20",value:""},{name:"String 21",value:""},{name:"String 22",value:""},{name:"String 23",value:""}],portsOut:[{name:"Switched Index",value:0},{name:"Trigger 0",links:[{portIn:"exe",portOut:"Trigger 0",objIn:"ojjd3i7cq",objOut:"6z5xivsgw"}]},{name:"Trigger 1",links:[{portIn:"exe",portOut:"Trigger 1",objIn:"v7tvar5nj",objOut:"6z5xivsgw"}]},{name:"Trigger 2",links:[{portIn:"exe",portOut:"Trigger 2",objIn:"m3pia3ygt",objOut:"6z5xivsgw"}]},{name:"Trigger 3",links:[{portIn:"exe",portOut:"Trigger 3",objIn:"tbjg8o85h",objOut:"6z5xivsgw"}]}],objName:"Ops.Trigger.RouteTriggerString_v2"},{id:"2ou5pkaw3",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Switch Value",portOut:"Result",objIn:"6z5xivsgw",objOut:"2ou5pkaw3"}]}],objName:"Ops.Json.ObjectGetString"},{id:"rulckdcdw",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"bdpt08zz1",objOut:"rulckdcdw"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"qna03ni2v",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Filmarchitektur"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"rulckdcdw",objOut:"qna03ni2v"}]}],objName:"Ops.String.FilterValidString"},{id:"7jnvvd8zd",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"q0see6f1t",objOut:"7jnvvd8zd"},{portIn:"String",portOut:"Result",objIn:"qna03ni2v",objOut:"7jnvvd8zd"}]}],objName:"Ops.String.StringTrim_v2"},{id:"k45ksyi5t",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"1pdbuwr2l",objOut:"k45ksyi5t"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"093tia94u",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Berlin"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"k45ksyi5t",objOut:"093tia94u"}]}],objName:"Ops.String.FilterValidString"},{id:"j2npp96fq",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"qshn2xncn",objOut:"j2npp96fq"},{portIn:"String",portOut:"Result",objIn:"093tia94u",objOut:"j2npp96fq"}]}],objName:"Ops.String.StringTrim_v2"},{id:"rtel3gxof",uiAttribs:{},portsIn:[{name:"Search For",value:"-"},{name:"Replace",value:""},{name:"Replace What index",value:0},{name:"Replace What",value:"All"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"8e3o5o1ec",objOut:"rtel3gxof"}]}],objName:"Ops.String.StringReplace"},{id:"8e3o5o1ec",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"18881966"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"wehcwmfbo",objOut:"8e3o5o1ec"}]}],objName:"Ops.String.FilterValidString"},{id:"wehcwmfbo",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"l1tfbaxph",objOut:"wehcwmfbo"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"aerz2ur0f",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"35hjnugr7",objOut:"aerz2ur0f"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"xdkwpug5z",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Budapest"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"aerz2ur0f",objOut:"xdkwpug5z"}]}],objName:"Ops.String.FilterValidString"},{id:"w8b90ziho",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"03n2vtilw",objOut:"w8b90ziho"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"03n2vtilw",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"kdn5tfzhk",objOut:"03n2vtilw"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"9quqsjp1i",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"y241tdmsg",objOut:"9quqsjp1i"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"y241tdmsg",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"5n18qnh5z",objOut:"y241tdmsg"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"4qk4felkh",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"d1jdrniih",objOut:"4qk4felkh"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"d1jdrniih",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"zhyvr48lp",objOut:"d1jdrniih"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"ojjd3i7cq",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"pq042d4f2",objOut:"ojjd3i7cq"}]},{name:"trigger 4",links:[{portIn:"Update",portOut:"trigger 4",objIn:"evplrd044",objOut:"ojjd3i7cq"}]},{name:"trigger 6",links:[{portIn:"Update",portOut:"trigger 6",objIn:"v6jh97xb2",objOut:"ojjd3i7cq"}]},{name:"trigger 11",links:[{portIn:"Update",portOut:"trigger 11",objIn:"28pw49jb4",objOut:"ojjd3i7cq"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"pxxjcqrpq",objOut:"ojjd3i7cq"}]}],objName:"Ops.Trigger.Sequence"},{id:"pxxjcqrpq",uiAttribs:{},portsIn:[{name:"Key",value:"Grndung"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"y37wfekl3",objOut:"pxxjcqrpq"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"y37wfekl3",uiAttribs:{},portsIn:[{name:"Key",value:"Thematik"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"8dgo24iby",objOut:"y37wfekl3"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"8dgo24iby",uiAttribs:{},portsIn:[{name:"Key",value:"Gruppenart"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"ncl91pj3l",objOut:"8dgo24iby"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"zhyvr48lp",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"kdn5tfzhk",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"5n18qnh5z",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"r7snao449",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"lxso2oesu",objOut:"r7snao449"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"String",portOut:"Value",objIn:"4wrs9u0s1",objOut:"r7snao449"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"b0uow51pq",uiAttribs:{},portsIn:[{name:"key",value:"Ziele"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"r7snao449",objOut:"b0uow51pq"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"1icxdjpp7",uiAttribs:{},portsIn:[{name:"key",value:"Gruppenart"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"td9edx7dh",objOut:"1icxdjpp7"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"td9edx7dh",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"0lwg9ntyv",objOut:"td9edx7dh"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"String",portOut:"Value",objIn:"8sfls4ky2",objOut:"td9edx7dh"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"pq042d4f2",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"b0k8lqedm",objOut:"pq042d4f2"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"pxxjcqrpq",objOut:"pq042d4f2"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"b0k8lqedm",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"exe",portOut:"trigger 0",objIn:"cam9z83ma",objOut:"b0k8lqedm"}]},{name:"trigger 15",links:[{portIn:"exe",portOut:"trigger 15",objIn:"p7mzpkjot",objOut:"b0k8lqedm"}]}],objName:"Ops.Trigger.Sequence"},{id:"3cfu02ele",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"3i27attm1",objOut:"3cfu02ele"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"3i27attm1",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"evovj1xy9",objOut:"3i27attm1"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"evovj1xy9",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"lxso2oesu",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"kdn5tfzhk",objOut:"lxso2oesu"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"pqtcdtc8w",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"anarcho-syndikalismus"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"lxso2oesu",objOut:"pqtcdtc8w"}]}],objName:"Ops.String.FilterValidString"},{id:"4wrs9u0s1",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"03n2vtilw",objOut:"4wrs9u0s1"},{portIn:"String",portOut:"Result",objIn:"pqtcdtc8w",objOut:"4wrs9u0s1"}]}],objName:"Ops.String.StringTrim_v2"},{id:"0lwg9ntyv",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"5n18qnh5z",objOut:"0lwg9ntyv"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"h0y4jxpd3",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"lebensgemeinschaft"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"0lwg9ntyv",objOut:"h0y4jxpd3"}]}],objName:"Ops.String.FilterValidString"},{id:"8sfls4ky2",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"y241tdmsg",objOut:"8sfls4ky2"},{portIn:"String",portOut:"Result",objIn:"h0y4jxpd3",objOut:"8sfls4ky2"}]}],objName:"Ops.String.StringTrim_v2"},{id:"8cbvrxi09",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"1921"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"p7mzpkjot",objOut:"8cbvrxi09"}]}],objName:"Ops.String.FilterValidString"},{id:"p7mzpkjot",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"evovj1xy9",objOut:"p7mzpkjot"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"cam9z83ma",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"zhyvr48lp",objOut:"cam9z83ma"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"met5ymd5e",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Dsseldorf-Eller"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"cam9z83ma",objOut:"met5ymd5e"}]}],objName:"Ops.String.FilterValidString"},{id:"ncl91pj3l",uiAttribs:{},portsIn:[{name:"Key",value:"Preise"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"f8m47m90e",uiAttribs:{},portsIn:[{name:"key",value:"Preise"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"xsa37zuyt",objOut:"f8m47m90e"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"hrorieyyc",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"6ceozjwwb",objOut:"hrorieyyc"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"6ceozjwwb",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"8erv1azi2",objOut:"6ceozjwwb"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"8erv1azi2",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"xsa37zuyt",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"0j2sa5cqr",objOut:"xsa37zuyt"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"String",portOut:"Value",objIn:"s28uj2yic",objOut:"xsa37zuyt"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"0j2sa5cqr",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"8erv1azi2",objOut:"0j2sa5cqr"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"bxgkngmn9",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"#nein"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"0j2sa5cqr",objOut:"bxgkngmn9"}]}],objName:"Ops.String.FilterValidString"},{id:"s28uj2yic",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"6ceozjwwb",objOut:"s28uj2yic"},{portIn:"String",portOut:"Result",objIn:"bxgkngmn9",objOut:"s28uj2yic"}]}],objName:"Ops.String.StringTrim_v2"},{id:"qqatoinls",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"pklqpexkz",objOut:"qqatoinls"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"pklqpexkz",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"667uteo3s",objOut:"pklqpexkz"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"8rk416pfl",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"d2p2bsrwm",objOut:"8rk416pfl"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"d2p2bsrwm",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"xor2fmzeb",objOut:"d2p2bsrwm"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"96c9il3bu",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"d4dtsayvy",objOut:"96c9il3bu"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"d4dtsayvy",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"4554vp1ag",objOut:"d4dtsayvy"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"m3pia3ygt",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"av39g5yh7",objOut:"m3pia3ygt"}]},{name:"trigger 4",links:[{portIn:"Update",portOut:"trigger 4",objIn:"3gcv2eqez",objOut:"m3pia3ygt"}]},{name:"trigger 6",links:[{portIn:"Update",portOut:"trigger 6",objIn:"inxn0uf72",objOut:"m3pia3ygt"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"je9c23wk2",objOut:"m3pia3ygt"}]}],objName:"Ops.Trigger.Sequence"},{id:"je9c23wk2",uiAttribs:{},portsIn:[{name:"Key",value:"Daten"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"ugo3zpq5r",objOut:"je9c23wk2"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"ugo3zpq5r",uiAttribs:{},portsIn:[{name:"Key",value:"Venue"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"a174l5ycl",objOut:"ugo3zpq5r"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"a174l5ycl",uiAttribs:{},portsIn:[{name:"Key",value:"Thematik"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"3gcv2eqez",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"fi04nlp58",objOut:"3gcv2eqez"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"ugo3zpq5r",objOut:"3gcv2eqez"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"4554vp1ag",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"667uteo3s",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"xor2fmzeb",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"yspxem80w",uiAttribs:{},portsIn:[{name:"key",value:"Ziele"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"27igt0zkw",objOut:"yspxem80w"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"27igt0zkw",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"z3c56y19t",objOut:"27igt0zkw"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"String",portOut:"Value",objIn:"jhx6ztpq4",objOut:"27igt0zkw"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"av39g5yh7",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"mg225e2iw",objOut:"av39g5yh7"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"je9c23wk2",objOut:"av39g5yh7"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"mg225e2iw",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"exe",portOut:"trigger 0",objIn:"sd5jafsm7",objOut:"mg225e2iw"}]},{name:"trigger 15",links:[{portIn:"exe",portOut:"trigger 15",objIn:"4b8a6j4i5",objOut:"mg225e2iw"}]}],objName:"Ops.Trigger.Sequence"},{id:"6122ryj5n",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"hdw5pnqqv",objOut:"6122ryj5n"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"hdw5pnqqv",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"swom7paa6",objOut:"hdw5pnqqv"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"swom7paa6",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"fi04nlp58",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"667uteo3s",objOut:"fi04nlp58"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"w0yess5n3",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Bildhauerei"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"fi04nlp58",objOut:"w0yess5n3"}]}],objName:"Ops.String.FilterValidString"},{id:"f1clnvpk0",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"pklqpexkz",objOut:"f1clnvpk0"},{portIn:"String",portOut:"Result",objIn:"w0yess5n3",objOut:"f1clnvpk0"}]}],objName:"Ops.String.StringTrim_v2"},{id:"z3c56y19t",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"xor2fmzeb",objOut:"z3c56y19t"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"pq6ey6m1q",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"gegenwartskunst"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"z3c56y19t",objOut:"pq6ey6m1q"}]}],objName:"Ops.String.FilterValidString"},{id:"jhx6ztpq4",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"d2p2bsrwm",objOut:"jhx6ztpq4"},{portIn:"String",portOut:"Result",objIn:"pq6ey6m1q",objOut:"jhx6ztpq4"}]}],objName:"Ops.String.StringTrim_v2"},{id:"jn93crv60",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"1921"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"4b8a6j4i5",objOut:"jn93crv60"}]}],objName:"Ops.String.FilterValidString"},{id:"4b8a6j4i5",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"swom7paa6",objOut:"4b8a6j4i5"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"sd5jafsm7",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"4554vp1ag",objOut:"sd5jafsm7"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"cep0oxp7g",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Solingen"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"sd5jafsm7",objOut:"cep0oxp7g"}]}],objName:"Ops.String.FilterValidString"},{id:"8gyrvcccv",uiAttribs:{},portsIn:[{name:"Key",value:"Grndungsdatum"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"mbgy501bm",objOut:"8gyrvcccv"}]}],objName:"Ops.Json.ObjectGetString"},{id:"p0tskf8az",uiAttribs:{},portsIn:[{name:"Key",value:"Grndungsdatum"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"vix1dp3li",objOut:"p0tskf8az"}]}],objName:"Ops.Json.ObjectGetString"},{id:"g6kv216i1",uiAttribs:{},portsIn:[{name:"Key",value:"Ausstellungsort"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"k7duipqv5",objOut:"g6kv216i1"}]}],objName:"Ops.Json.ObjectGetString"},{id:"vix1dp3li",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"hdw5pnqqv",objOut:"vix1dp3li"},{portIn:"String",portOut:"Result",objIn:"jn93crv60",objOut:"vix1dp3li"}]}],objName:"Ops.String.StringTrim_v2"},{id:"k7duipqv5",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"d4dtsayvy",objOut:"k7duipqv5"},{portIn:"String",portOut:"Result",objIn:"cep0oxp7g",objOut:"k7duipqv5"}]}],objName:"Ops.String.StringTrim_v2"},{id:"mbgy501bm",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"3i27attm1",objOut:"mbgy501bm"},{portIn:"String",portOut:"Result",objIn:"8cbvrxi09",objOut:"mbgy501bm"}]}],objName:"Ops.String.StringTrim_v2"},{id:"ssunohahu",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"met5ymd5e",objOut:"ssunohahu"},{portIn:"Value",portOut:"Result",objIn:"d1jdrniih",objOut:"ssunohahu"}]}],objName:"Ops.String.StringTrim_v2"},{id:"9ap9dgh2k",uiAttribs:{},portsIn:[{name:"Key",value:"Grndungsort"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"ssunohahu",objOut:"9ap9dgh2k"}]}],objName:"Ops.Json.ObjectGetString"},{id:"0k2ic02ez",uiAttribs:{},portsIn:[{name:"Key",value:"Venue"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"f1clnvpk0",objOut:"0k2ic02ez"}]}],objName:"Ops.Json.ObjectGetString"},{id:"zyeyc32ok",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"1pq9j0bqv",objOut:"zyeyc32ok"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"1pq9j0bqv",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"33l41fcch",objOut:"1pq9j0bqv"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"my8dp9d9u",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"32gfbtli8",objOut:"my8dp9d9u"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"32gfbtli8",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"717lhp39j",objOut:"32gfbtli8"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"tbjg8o85h",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"sl3xwr4ao",objOut:"tbjg8o85h"}]},{name:"trigger 6",links:[{portIn:"Update",portOut:"trigger 6",objIn:"69jex1m81",objOut:"tbjg8o85h"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"4ddtuq7r6",objOut:"tbjg8o85h"}]}],objName:"Ops.Trigger.Sequence"},{id:"4ddtuq7r6",uiAttribs:{},portsIn:[{name:"Key",value:"Verffentlichung"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"se03mjtd2",objOut:"4ddtuq7r6"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"se03mjtd2",uiAttribs:{},portsIn:[{name:"Key",value:"Thematik"}],objName:"Ops.Data.Compose.Object.CompObjectSetArray"},{id:"717lhp39j",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"33l41fcch",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"hhihh0t3e",uiAttribs:{},portsIn:[{name:"key",value:"Ziele"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"qygz1qnxo",objOut:"hhihh0t3e"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"qygz1qnxo",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"itaedbaw7",objOut:"qygz1qnxo"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"String",portOut:"Value",objIn:"r705sy8fx",objOut:"qygz1qnxo"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"sl3xwr4ao",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"l1qpm96tx",objOut:"sl3xwr4ao"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"4ddtuq7r6",objOut:"sl3xwr4ao"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"l1qpm96tx",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"exe",portOut:"trigger 0",objIn:"25113ttc8",objOut:"l1qpm96tx"}]},{name:"trigger 15",links:[{portIn:"exe",portOut:"trigger 15",objIn:"wg8d6gsa8",objOut:"l1qpm96tx"}]}],objName:"Ops.Trigger.Sequence"},{id:"ig03ueh6r",uiAttribs:{},portsIn:[{name:"JSON String",value:"{}"}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"wcs1ahsk3",objOut:"ig03ueh6r"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"wcs1ahsk3",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"5yjzpuj1n",objOut:"wcs1ahsk3"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"5yjzpuj1n",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"itaedbaw7",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"33l41fcch",objOut:"itaedbaw7"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"0aukeqo93",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"theateravantgarde"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"itaedbaw7",objOut:"0aukeqo93"}]}],objName:"Ops.String.FilterValidString"},{id:"r705sy8fx",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"1pq9j0bqv",objOut:"r705sy8fx"},{portIn:"String",portOut:"Result",objIn:"0aukeqo93",objOut:"r705sy8fx"}]}],objName:"Ops.String.StringTrim_v2"},{id:"hi5a0d01i",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"1934"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"wg8d6gsa8",objOut:"hi5a0d01i"}]}],objName:"Ops.String.FilterValidString"},{id:"wg8d6gsa8",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"5yjzpuj1n",objOut:"wg8d6gsa8"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"25113ttc8",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"717lhp39j",objOut:"25113ttc8"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"gaj3kpmm7",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Kln"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"25113ttc8",objOut:"gaj3kpmm7"}]}],objName:"Ops.String.FilterValidString"},{id:"yl1olbck4",uiAttribs:{},portsIn:[{name:"Key",value:"Erscheinungsdatum"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"mc6os0bgz",objOut:"yl1olbck4"}]}],objName:"Ops.Json.ObjectGetString"},{id:"nafy9g63u",uiAttribs:{},portsIn:[{name:"Key",value:"Erscheinungsort"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"wrvgmupdc",objOut:"nafy9g63u"}]}],objName:"Ops.Json.ObjectGetString"},{id:"mc6os0bgz",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"wcs1ahsk3",objOut:"mc6os0bgz"},{portIn:"String",portOut:"Result",objIn:"hi5a0d01i",objOut:"mc6os0bgz"}]}],objName:"Ops.String.StringTrim_v2"},{id:"wrvgmupdc",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"32gfbtli8",objOut:"wrvgmupdc"},{portIn:"String",portOut:"Result",objIn:"gaj3kpmm7",objOut:"wrvgmupdc"}]}],objName:"Ops.String.StringTrim_v2"},{id:"xzh8mafvh",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"csd784tgc",objOut:"xzh8mafvh"}]}],objName:"Ops.Json.ObjectGetString"},{id:"ya2ffvcec",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"uyxu7rre5",objOut:"ya2ffvcec"}]},{name:"index",value:1321},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"i0fh6hbag",objOut:"ya2ffvcec"},{portIn:"Object",portOut:"value",objIn:"iuce07sk2",objOut:"ya2ffvcec"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"xkgkuam4s",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"boolean",portOut:"Found",objIn:"uyxu7rre5",objOut:"xkgkuam4s"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"mv47vmv34",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_infobox"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"57sw3frpo",objOut:"mv47vmv34"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"evplrd044",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"r7snao449",objOut:"evplrd044"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"y37wfekl3",objOut:"evplrd044"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"v6jh97xb2",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"td9edx7dh",objOut:"v6jh97xb2"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"8dgo24iby",objOut:"v6jh97xb2"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"28pw49jb4",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"xsa37zuyt",objOut:"28pw49jb4"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"ncl91pj3l",objOut:"28pw49jb4"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"lwzle77bz",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"r757yza6s",objOut:"lwzle77bz"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"a07edhras",objOut:"lwzle77bz"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"inxn0uf72",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"27igt0zkw",objOut:"inxn0uf72"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"a174l5ycl",objOut:"inxn0uf72"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"69jex1m81",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"qygz1qnxo",objOut:"69jex1m81"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"se03mjtd2",objOut:"69jex1m81"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"ppls6t2lx",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"rbqeqhify",objOut:"ppls6t2lx"},{portIn:"String",portOut:"Result",objIn:"knfscvldv",objOut:"ppls6t2lx"}]}],objName:"Ops.String.StringTrim_v2"},{id:"198o2szwx",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result",links:[{portIn:"data",portOut:"Result",objIn:"ngmj95sak",objOut:"198o2szwx"}]}],objName:"Ops.Json.ObjectGetObject_v2"},{id:"ngmj95sak",uiAttribs:{},portsIn:[{name:"Key",value:"Stand"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"u18bty7k9",objOut:"ngmj95sak"}]}],objName:"Ops.Json.ObjectGetString"},{id:"u18bty7k9",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Key",portOut:"Result",objIn:"l1ypdpyqj",objOut:"u18bty7k9"}]}],objName:"Ops.String.StringTrim_v2"},{id:"fdma3ycmc",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"ggj7ih58t",objOut:"fdma3ycmc"},{portIn:"exe",portOut:"Next",objIn:"zstw63enm",objOut:"fdma3ycmc"},{portIn:"exe",portOut:"Next",objIn:"a6j8if82t",objOut:"fdma3ycmc"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"os9xnrdak",objOut:"fdma3ycmc"},{portIn:"array",portOut:"Result",objIn:"unc5nlzyk",objOut:"fdma3ycmc"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"hd3sjswzm",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"g6jtl2wsm",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"zlsw3jis2",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"e8zsm7f7c",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"5nhnd2yny",objOut:"e8zsm7f7c"}]}],objName:"Ops.Json.Object"},{id:"5nhnd2yny",uiAttribs:{},portsIn:[{name:"Key",value:"title"},{name:"Value",value:"Referenzen"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"1hd413ui4",objOut:"5nhnd2yny"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"1hd413ui4",uiAttribs:{},portsIn:[{name:"Key",value:"items"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"zlsw3jis2",objOut:"1hd413ui4"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"qdgw6kdzc",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"ixanudm35",objOut:"qdgw6kdzc"}]}],objName:"Ops.Json.Object"},{id:"ixanudm35",uiAttribs:{},portsIn:[{name:"Key",value:"title"},{name:"Value",value:"GND-Link"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"2chu4tlnh",objOut:"ixanudm35"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"2chu4tlnh",uiAttribs:{},portsIn:[{name:"Key",value:"href"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"g6jtl2wsm",objOut:"2chu4tlnh"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"rpgqgu1iu",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"m76tzum8k",objOut:"rpgqgu1iu"}]}],objName:"Ops.Json.Object"},{id:"m76tzum8k",uiAttribs:{},portsIn:[{name:"Key",value:"title"},{name:"Value",value:"Quelle-Info"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"kbov6o8be",objOut:"m76tzum8k"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"kbov6o8be",uiAttribs:{},portsIn:[{name:"Key",value:"href"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"hd3sjswzm",objOut:"kbov6o8be"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"83dukzhuj",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result",links:[{portIn:"data",portOut:"Result",objIn:"rks6wlkn6",objOut:"83dukzhuj"},{portIn:"data",portOut:"Result",objIn:"02msc32wv",objOut:"83dukzhuj"},{portIn:"data",portOut:"Result",objIn:"f3h3pusmr",objOut:"83dukzhuj"}]}],objName:"Ops.Json.ObjectGetObject_v2"},{id:"rks6wlkn6",uiAttribs:{},portsIn:[{name:"Key",value:"GND"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"e07o025g8",objOut:"rks6wlkn6"}]}],objName:"Ops.Json.ObjectGetString"},{id:"02msc32wv",uiAttribs:{},portsIn:[{name:"Key",value:"Quelle-Info"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"83vl52vp8",objOut:"02msc32wv"}]}],objName:"Ops.Json.ObjectGetString"},{id:"f3h3pusmr",uiAttribs:{},portsIn:[{name:"key",value:"Referenzen"}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"1hd413ui4",objOut:"f3h3pusmr"}]},{name:"Length",links:[{portIn:"boolean",portOut:"Length",objIn:"zstw63enm",objOut:"f3h3pusmr"}]}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"d3ye5ls6b",uiAttribs:{},portsIn:[{name:"string 0",value:"https://explore.gnd.network/gnd/"},{name:"string 2",value:"/relations"},{name:"string 3",value:""},{name:"string 4",value:""},{name:"string 5",value:""},{name:"string 6",value:""},{name:"string 7",value:""},{name:"add spaces",value:0},{name:"new lines",value:0}],portsOut:[{name:"concat string",links:[{portIn:"Value",portOut:"concat string",objIn:"2chu4tlnh",objOut:"d3ye5ls6b"}]}],objName:"Ops.String.ConcatMulti_v2"},{id:"e07o025g8",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"63zjua8t6",objOut:"e07o025g8"}]}],objName:"Ops.String.StringTrim_v2"},{id:"ggj7ih58t",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"g6jtl2wsm",objOut:"ggj7ih58t"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"3eaibycji",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"http://d-nb.info/gnd/7788165-5"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"ggj7ih58t",objOut:"3eaibycji"}]}],objName:"Ops.String.FilterValidString"},{id:"83vl52vp8",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"8huhqmd53",objOut:"83vl52vp8"}]}],objName:"Ops.String.StringTrim_v2"},{id:"abaa1erhc",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",links:[{portIn:"Value",portOut:"Last Valid String",objIn:"kbov6o8be",objOut:"abaa1erhc"}]},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"a6j8if82t",objOut:"abaa1erhc"}]}],objName:"Ops.String.FilterValidString"},{id:"zstw63enm",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"zlsw3jis2",objOut:"zstw63enm"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"8huhqmd53",uiAttribs:{},portsIn:[{name:"Search For",value:"\\n"},{name:"Replace",value:""},{name:"Replace What index",value:0},{name:"Replace What",value:"All"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"abaa1erhc",objOut:"8huhqmd53"}]}],objName:"Ops.String.StringReplace"},{id:"63zjua8t6",uiAttribs:{},portsIn:[{name:"Search For",value:"\\n"},{name:"Replace",value:""},{name:"Replace What index",value:0},{name:"Replace What",value:"All"}],portsOut:[{name:"Result",links:[{portIn:"string 1",portOut:"Result",objIn:"d3ye5ls6b",objOut:"63zjua8t6"},{portIn:"String",portOut:"Result",objIn:"3eaibycji",objOut:"63zjua8t6"}]}],objName:"Ops.String.StringReplace"},{id:"a6j8if82t",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"hd3sjswzm",objOut:"a6j8if82t"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"po4yjugua",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"e5x5vmboo",objOut:"po4yjugua"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"ux0mcvauo",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0},{name:"bool 10",value:0}],portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"po4yjugua",objOut:"ux0mcvauo"}]}],objName:"Ops.Boolean.Or"},{id:"knfscvldv",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"\"Dsseldorf, das ist heute weitgehend unbekannt, war eine Hochburg der anarcho-syndikalistischen Bewegung. Die FAUD hatte hier zeitweise bis zu 20.000 Mitglieder, und zwar 'berwiegend Metall und Stahlarbeiter, Bauarbeiter und Fliesenleger, und sogar einzelne (kaufmnnische und technische) Angestellte'. In Dsseldorf wurde auch  von 1921 bis 1923  die einzige anarcho-syndikalistische Tageszeitung herausgegeben, die den programmatischen Titel trug: 'Die Schpfung  sozialrevolutionres Organ fr ein sozialistisches Neuland'. [...] Weitere Solidaritt finden die SiedlerInnen im anarcho-syndikalistischen Sngerverein Freie Snger 04, der auf dem Gelnde der Freien Erde ein Solidarittskonzert gibt, oder auch bei namhaften Knstlern wie zum Beispiel Gustav Grndgens, dem Ensemble des Dsseldorfer Schauspielhauses, Gerd Wollheim  Mitglied der KnstlerInnengruppe Junges Rheinland  oder auch Dr. Erwin Quedenfeld, dem Vorsitzenden des Dsseldorfer Monistenbundes."},{name:"Is Valid",links:[{portIn:"bool 2",portOut:"Is Valid",objIn:"ux0mcvauo",objOut:"knfscvldv"}]}],objName:"Ops.String.FilterValidString"},{id:"unc5nlzyk",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"bool 1",portOut:"length",objIn:"ux0mcvauo",objOut:"unc5nlzyk"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"9t6mp6wsl",uiAttribs:{},portsOut:[{name:"timesTriggered",links:[{portIn:"bool 2",portOut:"timesTriggered",objIn:"hq6r5sz26",objOut:"9t6mp6wsl"}]}],objName:"Ops.Trigger.TriggerCounter"},{id:"abpbsh3bf",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"vbch4ly2q",objOut:"abpbsh3bf"}]},{name:"trigger 1",links:[{portIn:"Update",portOut:"trigger 1",objIn:"l24n01bbe",objOut:"abpbsh3bf"}]},{name:"trigger 2",links:[{portIn:"Execute",portOut:"trigger 2",objIn:"8a7up067t",objOut:"abpbsh3bf"}]}],objName:"Ops.Trigger.Sequence"},{id:"fvhc9wduj",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"entityClicked"}],portsOut:[{name:"Triggered",links:[{portIn:"Update",portOut:"Triggered",objIn:"lezp94owa",objOut:"fvhc9wduj"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"se8qvcqzm",uiAttribs:{},portsIn:[{name:"String",value:"entity.-1"}],portsOut:[{name:"Result",links:[{portIn:"text",portOut:"Result",objIn:"dradrudnv",objOut:"se8qvcqzm"}]}],objName:"Ops.Trigger.TriggerString"},{id:"7lgqbazf4",uiAttribs:{},portsIn:[{name:"Variable",value:"hoveredEntityData"}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"0xwe0a566",objOut:"7lgqbazf4"}]},{name:"Value",links:[{portIn:"data",portOut:"Value",objIn:"lwtr0ohsm",objOut:"7lgqbazf4"},{portIn:"data",portOut:"Value",objIn:"3hr4ul3yx",objOut:"7lgqbazf4"},{portIn:"Object",portOut:"Value",objIn:"h0v946cvo",objOut:"7lgqbazf4"},{portIn:"Object",portOut:"Value",objIn:"auigs0smj",objOut:"7lgqbazf4"},{portIn:"Object",portOut:"Value",objIn:"piag244uc",objOut:"7lgqbazf4"},{portIn:"data",portOut:"Value",objIn:"9f5zwge79",objOut:"7lgqbazf4"},{portIn:"data",portOut:"Value",objIn:"bd5x8stlz",objOut:"7lgqbazf4"},{portIn:"data",portOut:"Value",objIn:"2ou5pkaw3",objOut:"7lgqbazf4"},{portIn:"Object",portOut:"Value",objIn:"198o2szwx",objOut:"7lgqbazf4"},{portIn:"Object",portOut:"Value",objIn:"83dukzhuj",objOut:"7lgqbazf4"},{portIn:"Object",portOut:"Value",objIn:"55pku98ln",objOut:"7lgqbazf4"},{portIn:"data",portOut:"Value",objIn:"wmb25ibkw",objOut:"7lgqbazf4"}]}],objName:"Ops.Vars.TriggerVarGetObject"},{id:"1jb5ox59x",uiAttribs:{},portsIn:[{name:"When False index",value:0},{name:"When False",value:"keep last number"},{name:"Custom Value",value:0}],portsOut:[{name:"Value Out",links:[{portIn:"X",portOut:"Value Out",objIn:"aj30mksaq",objOut:"1jb5ox59x"}]}],objName:"Ops.Number.GateNumber"},{id:"i59lhc0x5",uiAttribs:{},portsIn:[{name:"When False index",value:0},{name:"When False",value:"keep last number"},{name:"Custom Value",value:0}],portsOut:[{name:"Value Out",links:[{portIn:"Y",portOut:"Value Out",objIn:"aj30mksaq",objOut:"i59lhc0x5"}]}],objName:"Ops.Number.GateNumber"},{id:"3gnzo333p",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"vvh54t7z9",objOut:"3gnzo333p"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"xz0m8o11t",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Exec",portOut:"then",objIn:"nx8a329ko",objOut:"xz0m8o11t"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"nb3k9lita",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"exe",portOut:"then",objIn:"iqz8z6k11",objOut:"nb3k9lita"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"iqz8z6k11",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"wbskmxe00",objOut:"iqz8z6k11"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"j4dcaeylw",uiAttribs:{},portsIn:[{name:"Range 1",value:0}],portsOut:[{name:"Result",links:[{portIn:"boolean",portOut:"Result",objIn:"nb3k9lita",objOut:"j4dcaeylw"}]}],objName:"Ops.Math.Compare.BetweenEquals"},{id:"qp8r9uinc",uiAttribs:{},portsIn:[{name:"Range 1",value:0}],portsOut:[{name:"Result",links:[{portIn:"boolean",portOut:"Result",objIn:"iqz8z6k11",objOut:"qp8r9uinc"}]}],objName:"Ops.Math.Compare.BetweenEquals"},{id:"80srd7ryz",uiAttribs:{},portsOut:[{name:"CSS Width",links:[{portIn:"Range 2",portOut:"CSS Width",objIn:"j4dcaeylw",objOut:"80srd7ryz"}]},{name:"CSS Height",links:[{portIn:"Range 2",portOut:"CSS Height",objIn:"qp8r9uinc",objOut:"80srd7ryz"}]},{name:"Pixel Ratio",value:1},{name:"Pixel Width",value:1920},{name:"Pixel Height",value:1080},{name:"Aspect Ratio",value:1.7777777777777777},{name:"Landscape",value:1}],objName:"Ops.Gl.CanvasInfo_v3"},{id:"0d92hipgj",uiAttribs:{},portsIn:[{name:"Step",value:0}],portsOut:[{name:"Trigger",links:[{portIn:"render",portOut:"Trigger",objIn:"szofb2ma9",objOut:"0d92hipgj"}]},{name:"Index",links:[{portIn:"Z",portOut:"Index",objIn:"wbskmxe00",objOut:"0d92hipgj"}]},{name:"Value 1",links:[{portIn:"posX",portOut:"Value 1",objIn:"szofb2ma9",objOut:"0d92hipgj"}]},{name:"Value 2",links:[{portIn:"posY",portOut:"Value 2",objIn:"szofb2ma9",objOut:"0d92hipgj"}]},{name:"Value 3",links:[{portIn:"posZ",portOut:"Value 3",objIn:"szofb2ma9",objOut:"0d92hipgj"}]}],objName:"Ops.Array.Array3Iterator"},{id:"szofb2ma9",uiAttribs:{},portsIn:[{name:"scale",value:1},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"Execute",portOut:"trigger",objIn:"gx99ptobl",objOut:"szofb2ma9"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"gx99ptobl",uiAttribs:{},portsIn:[{name:"Pixel Unit index",value:0},{name:"Pixel Unit",value:"Display"}],portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"nb3k9lita",objOut:"gx99ptobl"}]},{name:"X",links:[{portIn:"Value",portOut:"X",objIn:"j4dcaeylw",objOut:"gx99ptobl"},{portIn:"X",portOut:"X",objIn:"wbskmxe00",objOut:"gx99ptobl"}]},{name:"Y",links:[{portIn:"Value",portOut:"Y",objIn:"qp8r9uinc",objOut:"gx99ptobl"},{portIn:"Y",portOut:"Y",objIn:"wbskmxe00",objOut:"gx99ptobl"}]},{name:"Visible",value:false}],objName:"Ops.Gl.Matrix.ScreenCoordinates_v2"},{id:"frmk79ct2",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Execute",portOut:"Next",objIn:"0d92hipgj",objOut:"frmk79ct2"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"srs198ksg",objOut:"frmk79ct2"},{portIn:"Array",portOut:"Result",objIn:"qxqhuger3",objOut:"frmk79ct2"},{portIn:"Array",portOut:"Result",objIn:"ay98ewd6d",objOut:"frmk79ct2"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"wbskmxe00",uiAttribs:{},portsIn:[{name:"W",value:1},{name:"Num index",value:2},{name:"Num",value:"3"}],objName:"Ops.Data.Compose.Array.CompArrayPushNumbers"},{id:"nx8a329ko",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"xvaedvg45",objOut:"nx8a329ko"}]},{name:"Was Triggered",value:0}],objName:"Ops.Trigger.TriggerOnce"},{id:"xvaedvg45",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"frmk79ct2",objOut:"xvaedvg45"}]},{name:"trigger 15",links:[{portIn:"exe",portOut:"trigger 15",objIn:"lb49mz3pd",objOut:"xvaedvg45"}]}],objName:"Ops.Trigger.Sequence"},{id:"bamapcden",uiAttribs:{},portsIn:[{name:"Class",value:"cablesEle entityName reckless"},{name:"Active",value:1}],portsOut:[{name:"Elements",links:[{portIn:"array",portOut:"Elements",objIn:"lb49mz3pd",objOut:"bamapcden"}]},{name:"Index Clicked",value:0},{name:"Index Hovered",value:-1}],objName:"Ops.Extension.HtmlElementArray.DivElements"},{id:"folat4ntg",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"cvzy7c1vc",objOut:"folat4ntg"},{portIn:"Array",portOut:"Value",objIn:"rp00ly5di",objOut:"folat4ntg"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"9zt3onw1e",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"Num",portOut:"length",objIn:"bamapcden",objOut:"9zt3onw1e"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"lb49mz3pd",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"8jl033f2h",objOut:"lb49mz3pd"}]},{name:"index",links:[{portIn:"index",portOut:"index",objIn:"px6bzq6k0",objOut:"lb49mz3pd"},{portIn:"Index",portOut:"index",objIn:"qxqhuger3",objOut:"lb49mz3pd"}]},{name:"value",links:[{portIn:"Element",portOut:"value",objIn:"q9wsb4lkh",objOut:"lb49mz3pd"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"jk3yjaujz",uiAttribs:{},portsIn:[{name:"Property",value:"top"},{name:"Value Suffix",value:"px"}],portsOut:[{name:"HTML Element",links:[{portIn:"Element",portOut:"HTML Element",objIn:"eayxzh22k",objOut:"jk3yjaujz"}]}],objName:"Ops.Extension.HtmlElementArray.ElementArrayCssPropertyNumber"},{id:"eayxzh22k",uiAttribs:{},portsIn:[{name:"Property",value:"left"},{name:"Value Suffix",value:"px"}],portsOut:[{name:"HTML Element",links:[{portIn:"HTML Element",portOut:"HTML Element",objIn:"v03l24icy",objOut:"eayxzh22k"},{portIn:"HTML Element",portOut:"HTML Element",objIn:"1qdd96xhc",objOut:"eayxzh22k"}]}],objName:"Ops.Extension.HtmlElementArray.ElementArrayCssPropertyNumber"},{id:"qxqhuger3",uiAttribs:{},portsOut:[{name:"X",links:[{portIn:"Value",portOut:"X",objIn:"eayxzh22k",objOut:"qxqhuger3"}]},{name:"Y",links:[{portIn:"Value",portOut:"Y",objIn:"jk3yjaujz",objOut:"qxqhuger3"}]},{name:"Z",value:1279}],objName:"Ops.Array.Array3GetNumbers"},{id:"ei07ave9v",uiAttribs:{},portsIn:[{name:"Key",value:"entity"}],portsOut:[{name:"Result",links:[{portIn:"Classname",portOut:"Result",objIn:"v03l24icy",objOut:"ei07ave9v"}]}],objName:"Ops.Json.ObjectGetString"},{id:"px6bzq6k0",uiAttribs:{},portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"ei07ave9v",objOut:"px6bzq6k0"},{portIn:"Data",portOut:"value",objIn:"nt0ewp1kz",objOut:"px6bzq6k0"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"cvzy7c1vc",uiAttribs:{},portsIn:[{name:"Array Stride index",value:0},{name:"Array Stride",value:"1"}],portsOut:[{name:"Results",links:[{portIn:"array",portOut:"Results",objIn:"px6bzq6k0",objOut:"cvzy7c1vc"},{portIn:"Array",portOut:"Results",objIn:"u9mnhtdo3",objOut:"cvzy7c1vc"}]}],objName:"Ops.Array.ArrayGetValuesByIndexArray"},{id:"srs198ksg",uiAttribs:{},portsIn:[{name:"Array Stride index",value:2},{name:"Array Stride",value:"3"},{name:"Result Stride index",value:0},{name:"Result Stride",value:"1"},{name:"X index",value:2},{name:"X",value:"Z"},{name:"Y index",value:4},{name:"Y",value:"0"},{name:"Z index",value:4},{name:"Z",value:"0"},{name:"W index",value:5},{name:"W",value:"1"}],portsOut:[{name:"Result",links:[{portIn:"Indices",portOut:"Result",objIn:"cvzy7c1vc",objOut:"srs198ksg"}]}],objName:"Ops.Array.ArraySwizzle"},{id:"o9qjd8ndp",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"l466tri8n",objOut:"o9qjd8ndp"}]},{name:"Number",value:.09}],objName:"Ops.Number.TriggerOnChangeNumber"},{id:"y1j6pa5mk",uiAttribs:{},portsIn:[{name:"Value",value:1},{name:"Variable",value:"dragOrZoom"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"3voef2dla",uiAttribs:{},portsIn:[{name:"Duration",value:.75},{name:"Value True",value:1},{name:"Value False",value:0}],portsOut:[{name:"Activated",links:[{portIn:"Trigger",portOut:"Activated",objIn:"y1j6pa5mk",objOut:"3voef2dla"}]},{name:"Ended",links:[{portIn:"Trigger",portOut:"Ended",objIn:"jsttbn9xd",objOut:"3voef2dla"}]},{name:"Result",value:0}],objName:"Ops.Boolean.MonoFlop"},{id:"l466tri8n",uiAttribs:{},portsOut:[{name:"else",links:[{portIn:"Trigger",portOut:"else",objIn:"3voef2dla",objOut:"l466tri8n"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"jdcq5tgh5",uiAttribs:{},portsIn:[{name:"Variable",value:"dragOrZoom"}],portsOut:[{name:"Value",links:[{portIn:"boolean",portOut:"Value",objIn:"l466tri8n",objOut:"jdcq5tgh5"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"rgkvq0657",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_entity_names"}],objName:"Ops.Trigger.TriggerSend"},{id:"uzueeycs7",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_entity_names"}],portsOut:[{name:"Triggered",links:[{portIn:"Reset",portOut:"Triggered",objIn:"nx8a329ko",objOut:"uzueeycs7"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"b93ufnf46",uiAttribs:{},portsIn:[{name:"Var Name",value:"entity-name-opacity"},{name:"Output quoted string",value:0}],objName:"Ops.Html.CSS.SetCssVariableString"},{id:"c3n94cxdv",uiAttribs:{},portsIn:[{name:"Decimal Places",value:4}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"b93ufnf46",objOut:"c3n94cxdv"}]}],objName:"Ops.String.NumberToString_v2"},{id:"jsttbn9xd",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"dragOrZoom"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"rgkvq0657",objOut:"jsttbn9xd"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"ao2ebfjjk",uiAttribs:{},portsIn:[{name:"easing index",value:0},{name:"easing",value:"linear"},{name:"duration",value:.1},{name:"Direction index",value:1},{name:"Direction",value:"Only True"},{name:"value false",value:0},{name:"value true",value:1}],portsOut:[{name:"value",links:[{portIn:"Number",portOut:"value",objIn:"c3n94cxdv",objOut:"ao2ebfjjk"}]},{name:"finished",value:1}],objName:"Ops.Anim.BoolAnim"},{id:"if8gv33us",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"mainLoop"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"ao2ebfjjk",objOut:"if8gv33us"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"84eo00ihp",uiAttribs:{},portsIn:[{name:"Variable",value:"showEntityNames"}],portsOut:[{name:"Value",links:[{portIn:"bool",portOut:"Value",objIn:"ao2ebfjjk",objOut:"84eo00ihp"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"0xeeqxijr",uiAttribs:{},portsIn:[{name:"Variable",value:"showEntityNames"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"880qw6mg1",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"tn38h9aq1",objOut:"880qw6mg1"}]}],objName:"Ops.Boolean.Not"},{id:"tn38h9aq1",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"bool 1",portOut:"result",objIn:"g6hhfedaw",objOut:"tn38h9aq1"}]}],objName:"Ops.Boolean.And"},{id:"joihtjenq",uiAttribs:{},portsIn:[{name:"Variable",value:"graphLoading"}],portsOut:[{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"880qw6mg1",objOut:"joihtjenq"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"gbjstpzfw",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_entity_names"}],objName:"Ops.Trigger.TriggerSend"},{id:"4ywuvcms5",uiAttribs:{},portsIn:[{name:"number2",value:-1}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"s6xxr47qt",objOut:"4ywuvcms5"}]}],objName:"Ops.Math.Multiply"},{id:"vvh54t7z9",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"xz0m8o11t",objOut:"vvh54t7z9"}]}],objName:"Ops.Math.Compare.GreaterOrEquals"},{id:"eli6lftpk",uiAttribs:{},portsIn:[{name:"Variable",value:"showEntityNamesZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"number2",portOut:"Value",objIn:"vvh54t7z9",objOut:"eli6lftpk"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"r2u9php8n",uiAttribs:{},portsIn:[{name:"Value",value:3},{name:"Variable",value:"showEntityNamesZoomLevel"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"g1gtdz3nl",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"bool 1",portOut:"result",objIn:"rtn4c6f6y",objOut:"g1gtdz3nl"}]}],objName:"Ops.Math.Compare.GreaterOrEquals"},{id:"lgogm5gfh",uiAttribs:{},portsIn:[{name:"Variable",value:"showEntityNamesZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"number2",portOut:"Value",objIn:"g1gtdz3nl",objOut:"lgogm5gfh"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"cnmau8w8q",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"g1gtdz3nl",objOut:"cnmau8w8q"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"8delntgus",uiAttribs:{},portsIn:[{name:"Query",value:".info .header .close"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Element",links:[{portIn:"Element",portOut:"Element",objIn:"di1p266cl",objOut:"8delntgus"}]}],objName:"Ops.Html.QuerySelector_v2"},{id:"d3a79d29m",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters .level_0 li.main .title"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Element",links:[{portIn:"Element",portOut:"Element",objIn:"cd95pyn3j",objOut:"d3a79d29m"}]}],objName:"Ops.Html.QuerySelector_v2"},{id:"4og6jx3u7",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters ul.level_1 > li"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Array",portOut:"Elements",objIn:"f8kk823gl",objOut:"4og6jx3u7"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"lw0s0awv5",uiAttribs:{},portsOut:[{name:"index",value:8},{name:"value",links:[{portIn:"HTML Element",portOut:"value",objIn:"icdhb68w6",objOut:"lw0s0awv5"},{portIn:"HTML Element",portOut:"value",objIn:"qtou7bj6j",objOut:"lw0s0awv5"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"f8kk823gl",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"exe",portOut:"Changed",objIn:"lw0s0awv5",objOut:"f8kk823gl"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"lw0s0awv5",objOut:"f8kk823gl"}]}],objName:"Ops.Trigger.TriggerOnChangeArray"},{id:"cd95pyn3j",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"Update",portOut:"Event Trigger",objIn:"4og6jx3u7",objOut:"cd95pyn3j"},{portIn:"Trigger",portOut:"Event Trigger",objIn:"o55gm60uw",objOut:"cd95pyn3j"}]},{name:"Event Object",links:[{portIn:"Object",portOut:"Event Object",objIn:"q6fmzuy3f",objOut:"cd95pyn3j"}]}],objName:"Ops.Html.Event.ElementEventListener_v2"},{id:"sb2dqbxjb",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"exe",portOut:"Event Trigger",objIn:"pmfjxo2gi",objOut:"sb2dqbxjb"}]},{name:"Index",value:1},{name:"Event Element",links:[{portIn:"HTML Element",portOut:"Event Element",objIn:"wvtwdol9g",objOut:"sb2dqbxjb"},{portIn:"HTML Element",portOut:"Event Element",objIn:"pnhp0985i",objOut:"sb2dqbxjb"}]}],objName:"Ops.Html.Event.ElementsArrayEventHandler"},{id:"q6fmzuy3f",uiAttribs:{},portsIn:[{name:"Key",value:"currentTarget"}],portsOut:[{name:"Result",links:[{portIn:"HTML Element",portOut:"Result",objIn:"ezwinn412",objOut:"q6fmzuy3f"}]}],objName:"Ops.Json.ObjectGetObject_v2"},{id:"bj60kw8b9",uiAttribs:{},portsIn:[{name:"Classname",value:"active"}],objName:"Ops.Html.CSS.ToggleClass"},{id:"gwut853ol",uiAttribs:{},portsIn:[{name:"Classname",value:"active"}],objName:"Ops.Html.CSS.ToggleClass"},{id:"6krmnfnjd",uiAttribs:{},portsIn:[{name:"Place Name",value:"graph"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 1",portOut:"Is Current Place",objIn:"b9gq223co",objOut:"6krmnfnjd"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"04lbzow4e",uiAttribs:{},portsIn:[{name:"Place Name",value:"magazin"}],portsOut:[{name:"Is Current Place",links:[{portIn:"Active",portOut:"Is Current Place",objIn:"bj60kw8b9",objOut:"04lbzow4e"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"yi7a1btai",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"exqw03rdh",objOut:"yi7a1btai"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"v374z3xic",uiAttribs:{},portsIn:[{name:"Filter Key",value:"source"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"4ypklnzbp",objOut:"v374z3xic"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"zjdmgxdmi",uiAttribs:{},portsIn:[{name:"Filter Key",value:"target"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"47qj861h7",objOut:"zjdmgxdmi"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"rn97rtv5n",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"nww1fz4wx",objOut:"rn97rtv5n"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"drif6942z",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Filter Value",value:""},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"9ak8lklkg",objOut:"drif6942z"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"1kmppqzwa",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"gaayfilzy",objOut:"1kmppqzwa"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"1awlfv8ts",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"8fcmko1n1",objOut:"1awlfv8ts"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"9yj6xjk13",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"8nshgx5tv",objOut:"9yj6xjk13"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"3xfq7hvmx",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"23yxonvmx",objOut:"3xfq7hvmx"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"x889i1ox2",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"qykx3naqz",objOut:"x889i1ox2"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"1f78n1t6s",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"dm8g4oqm0",objOut:"1f78n1t6s"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"8c9ovumto",uiAttribs:{},portsIn:[{name:"Filter Key",value:"id"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"jykedregr",objOut:"8c9ovumto"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"jml0zh1br",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"}],portsOut:[{name:"Result",links:[{portIn:"Boolean",portOut:"Result",objIn:"sveqq5zth",objOut:"jml0zh1br"}]},{name:"Found",value:0}],objName:"Ops.Json.ObjectGetNumber_v2"},{id:"yyydyz2yc",uiAttribs:{},portsIn:[{name:"string 1",value:"-"},{name:"string 3",value:""},{name:"string 4",value:""},{name:"string 5",value:""},{name:"string 6",value:""},{name:"string 7",value:""},{name:"add spaces",value:0},{name:"new lines",value:0}],portsOut:[{name:"concat string",links:[{portIn:"Var Name",portOut:"concat string",objIn:"llogv0dw3",objOut:"yyydyz2yc"}]}],objName:"Ops.String.ConcatMulti_v2"},{id:"gfqcrmyqf",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"ch0g6i1yu",objOut:"gfqcrmyqf"}]},{name:"index",links:[{portIn:"SearchValue",portOut:"index",objIn:"r3upoqc83",objOut:"gfqcrmyqf"},{portIn:"number2",portOut:"index",objIn:"dl61piy88",objOut:"gfqcrmyqf"}]},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"6jqgkqvzn",objOut:"gfqcrmyqf"},{portIn:"Data",portOut:"value",objIn:"jml0zh1br",objOut:"gfqcrmyqf"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"ye0tk3tuv",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_colors"}],portsOut:[{name:"Triggered",links:[{portIn:"exe 7",portOut:"Triggered",objIn:"1lh5o3jrh",objOut:"ye0tk3tuv"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"d8cap6cxt",uiAttribs:{},portsIn:[{name:"Array 2",value:0},{name:"Array 3",value:0},{name:"Array 4",value:0},{name:"Array 5",value:0},{name:"Array 6",value:0},{name:"Array 7",value:0}],portsOut:[{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"zjwnusy8y",objOut:"d8cap6cxt"}]},{name:"Array length",value:9}],objName:"Ops.Array.ArrayMerge_v3"},{id:"fh560ql9r",uiAttribs:{},portsOut:[{name:"Index",links:[{portIn:"Array 0",portOut:"Index",objIn:"d8cap6cxt",objOut:"fh560ql9r"}]},{name:"Found",value:1}],objName:"Ops.Patch.PaZfgnp.ArrayStringIndexes"},{id:"g89fvvig7",uiAttribs:{},portsOut:[{name:"Index",links:[{portIn:"Array 1",portOut:"Index",objIn:"d8cap6cxt",objOut:"g89fvvig7"}]},{name:"Found",value:1}],objName:"Ops.Patch.PaZfgnp.ArrayStringIndexes"},{id:"zjwnusy8y",uiAttribs:{},portsIn:[{name:"Format index",value:0},{name:"Format",value:"X"}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"27noe65dg",objOut:"zjwnusy8y"}]},{name:"Array Length Out",value:9}],objName:"Ops.Array.ArrayUnique"},{id:"g52ws1ww2",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"v5oidtrns",objOut:"g52ws1ww2"},{portIn:"Array",portOut:"Value",objIn:"i2n541gaf",objOut:"g52ws1ww2"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"fsssbtdbk",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Update",portOut:"trigger",objIn:"27noe65dg",objOut:"fsssbtdbk"}]},{name:"index",value:0},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"0rjfmehbr",objOut:"fsssbtdbk"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"0rjfmehbr",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"fh560ql9r",objOut:"0rjfmehbr"},{portIn:"SearchValue",portOut:"Result",objIn:"g89fvvig7",objOut:"0rjfmehbr"}]}],objName:"Ops.Json.ObjectGetString"},{id:"qkcny2soa",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"80d6t2595",objOut:"qkcny2soa"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"ld6p4k56r",objOut:"qkcny2soa"}]}],objName:"Ops.Trigger.Sequence"},{id:"80d6t2595",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"fsssbtdbk",objOut:"80d6t2595"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"k51k28lr4",objOut:"80d6t2595"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"27noe65dg",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushArrayItems"},{id:"k51k28lr4",uiAttribs:{},portsIn:[{name:"Format index",value:0},{name:"Format",value:"X"}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"cm85i3cxq",objOut:"k51k28lr4"},{portIn:"Value",portOut:"arrayOut",objIn:"bb8ft3udy",objOut:"k51k28lr4"}]},{name:"Array Length Out",value:0}],objName:"Ops.Array.ArrayUnique"},{id:"y3u8jaaav",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"nvtd23tph",objOut:"y3u8jaaav"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"lg0wiiwv3",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"4cux1bfqh",objOut:"lg0wiiwv3"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"4cux1bfqh",uiAttribs:{},portsIn:[{name:"Filter Key",value:"filtered"},{name:"Filter Value",value:"1"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"iljs4eo7r",objOut:"4cux1bfqh"},{portIn:"Array",portOut:"arrayOut",objIn:"f54rq5piw",objOut:"4cux1bfqh"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"gt0t61u5x",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"xk3v4klwe",objOut:"gt0t61u5x"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"xkgkuam4s",objOut:"gt0t61u5x"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"xk3v4klwe",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"exe",portOut:"trigger 0",objIn:"iljs4eo7r",objOut:"xk3v4klwe"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"wy4ghn65p",objOut:"xk3v4klwe"}]}],objName:"Ops.Trigger.Sequence"},{id:"iljs4eo7r",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Update",portOut:"trigger",objIn:"z10wq9s2f",objOut:"iljs4eo7r"}]},{name:"index",value:245},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"0ako7a52a",objOut:"iljs4eo7r"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"z10wq9s2f",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"l1qdyta0k",objOut:"z10wq9s2f"}]}],objName:"Ops.Data.Compose.Array.CompArrayPushArrayItems"},{id:"tm99dfqjt",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"rcxncugzh",objOut:"tm99dfqjt"},{portIn:"Array",portOut:"Value",objIn:"lty48dqw4",objOut:"tm99dfqjt"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"dufxpz3pk",uiAttribs:{},portsIn:[{name:"Array 2",value:0},{name:"Array 3",value:0},{name:"Array 4",value:0},{name:"Array 5",value:0},{name:"Array 6",value:0},{name:"Array 7",value:0}],portsOut:[{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"tsdqb48kc",objOut:"dufxpz3pk"}]},{name:"Array length",value:0}],objName:"Ops.Array.ArrayMerge_v3"},{id:"rcxncugzh",uiAttribs:{},portsIn:[{name:"Filter Key",value:"source"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"n76p2wvia",objOut:"rcxncugzh"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"lty48dqw4",uiAttribs:{},portsIn:[{name:"Filter Key",value:"target"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"vp7z2ncq2",objOut:"lty48dqw4"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"tsdqb48kc",uiAttribs:{},portsIn:[{name:"Format index",value:0},{name:"Format",value:"X"}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"z10wq9s2f",objOut:"tsdqb48kc"}]},{name:"Array Length Out",value:0}],objName:"Ops.Array.ArrayUnique"},{id:"wy4ghn65p",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushArrayItems"},{id:"3ycw3jbo7",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"Trigger",portOut:"Changed",objIn:"p3i679jsb",objOut:"3ycw3jbo7"}]}],objName:"Ops.Trigger.TriggerOnChangeObject"},{id:"p3i679jsb",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_colors"}],objName:"Ops.Trigger.TriggerSend"},{id:"0ako7a52a",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"Filter Value",portOut:"Result",objIn:"rcxncugzh",objOut:"0ako7a52a"},{portIn:"Filter Value",portOut:"Result",objIn:"lty48dqw4",objOut:"0ako7a52a"},{portIn:"String",portOut:"Result",objIn:"l1qdyta0k",objOut:"0ako7a52a"}]}],objName:"Ops.Json.ObjectGetString"},{id:"l1qdyta0k",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushString"},{id:"4ypklnzbp",uiAttribs:{},portsIn:[{name:"Key",value:"target"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array 0",portOut:"Result",objIn:"z3980qxx8",objOut:"4ypklnzbp"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"47qj861h7",uiAttribs:{},portsIn:[{name:"Key",value:"source"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array 1",portOut:"Result",objIn:"z3980qxx8",objOut:"47qj861h7"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"u9mnhtdo3",uiAttribs:{},portsIn:[{name:"Key",value:"name"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Text",portOut:"Result",objIn:"bamapcden",objOut:"u9mnhtdo3"},{portIn:"array",portOut:"Result",objIn:"9zt3onw1e",objOut:"u9mnhtdo3"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"v5oidtrns",uiAttribs:{},portsIn:[{name:"Key",value:"source"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"fh560ql9r",objOut:"v5oidtrns"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"i2n541gaf",uiAttribs:{},portsIn:[{name:"Key",value:"target"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"g89fvvig7",objOut:"i2n541gaf"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"n76p2wvia",uiAttribs:{},portsIn:[{name:"Key",value:"target"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array 0",portOut:"Result",objIn:"dufxpz3pk",objOut:"n76p2wvia"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"vp7z2ncq2",uiAttribs:{},portsIn:[{name:"Key",value:"source"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array 1",portOut:"Result",objIn:"dufxpz3pk",objOut:"vp7z2ncq2"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"os60wm1fi",uiAttribs:{},portsIn:[{name:"Key",value:"index"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"r3upoqc83",objOut:"os60wm1fi"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"17yidurmi",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"Person_Schlemmer_Oskar"},{name:"Is Valid",links:[{portIn:"boolean",portOut:"Is Valid",objIn:"vb50vz8iw",objOut:"17yidurmi"}]}],objName:"Ops.String.FilterValidString"},{id:"1spchiq0v",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"f54rq5piw",objOut:"1spchiq0v"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"fsssbtdbk",objOut:"1spchiq0v"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"f54rq5piw",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"vb50vz8iw",objOut:"f54rq5piw"}]}],objName:"Ops.Data.Compose.Array.CompArrayPushArrayItems"},{id:"vb50vz8iw",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"0pn520t3o",objOut:"vb50vz8iw"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"0pn520t3o",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"f9q68amxm",uiAttribs:{},portsIn:[{name:"key",value:"images"}],portsOut:[{name:"result",links:[{portIn:"array",portOut:"result",objIn:"ruzefrzkn",objOut:"f9q68amxm"}]},{name:"Length",value:0}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"ruzefrzkn",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"mcyooo52u",objOut:"ruzefrzkn"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"o5yk4ot6u",uiAttribs:{},portsIn:[{name:"Path",value:"author"}],portsOut:[{name:"Output",links:[{portIn:"array",portOut:"Output",objIn:"3tsyjcsib",objOut:"o5yk4ot6u"}]},{name:"Found",value:1}],objName:"Ops.Data.JsonPath.ObjectGetArrayByPath"},{id:"3tsyjcsib",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"ec78c5va6",objOut:"3tsyjcsib"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"ec78c5va6",uiAttribs:{},portsIn:[{name:"Key",value:"text"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"khyrew7q7",objOut:"ec78c5va6"}]}],objName:"Ops.Json.ObjectGetString"},{id:"s7mj8v9am",uiAttribs:{},portsIn:[{name:"file",value:"assets/66f3ce6623173e5d0f6832cc_ESKlarheitGrotesk-Smbd.woff2",display:"file"},{name:"family",value:"ES Klarheit Grotesk"},{name:"Active",value:1}],portsOut:[{name:"Loaded",value:1}],objName:"Ops.Html.FontFile_v2"},{id:"icdhb68w6",uiAttribs:{},portsIn:[{name:"Classname",value:"hidden"}],objName:"Ops.Patch.PaZfgnp.ElementArrayToggleClass"},{id:"paxjpnxf4",uiAttribs:{},portsOut:[{name:"Updated",links:[{portIn:"Update",portOut:"Updated",objIn:"8bityd3ae",objOut:"paxjpnxf4"},{portIn:"Update",portOut:"Updated",objIn:"r2jpy56j4",objOut:"paxjpnxf4"}]},{name:"Finished",links:[{portIn:"Trigger",portOut:"Finished",objIn:"gbjstpzfw",objOut:"paxjpnxf4"}]},{name:"Loading",links:[{portIn:"Value",portOut:"Loading",objIn:"9hjws5mhb",objOut:"paxjpnxf4"}]},{name:"Nodes Pos",links:[{portIn:"Array",portOut:"Nodes Pos",objIn:"t7mamsdm9",objOut:"paxjpnxf4"},{portIn:"array",portOut:"Nodes Pos",objIn:"ryumt51bq",objOut:"paxjpnxf4"}]},{name:"Splines Pos",links:[{portIn:"Array",portOut:"Splines Pos",objIn:"zxowq6l2q",objOut:"paxjpnxf4"},{portIn:"Value",portOut:"Splines Pos",objIn:"sks0jxw94",objOut:"paxjpnxf4"}]}],objName:"Ops.Team.ACAR.CalculateGraph"},{id:"wa0035w6m",uiAttribs:{},portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"k83erl27s",objOut:"wa0035w6m"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"k83erl27s",uiAttribs:{},portsIn:[{name:"key",value:"steps"}],portsOut:[{name:"result",links:[{portIn:"array",portOut:"result",objIn:"3pgu1xcac",objOut:"k83erl27s"}]},{name:"Length",links:[{portIn:"number1",portOut:"Length",objIn:"9mmhspv6d",objOut:"k83erl27s"}]}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"3pgu1xcac",uiAttribs:{},portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"6tekt16cv",objOut:"3pgu1xcac"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"5janpgaa7",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"tl0stiak1",objOut:"5janpgaa7"},{portIn:"Plan",portOut:"Value",objIn:"9zz0rcmtk",objOut:"5janpgaa7"}]}],objName:"Ops.Vars.VarGetString"},{id:"tmv3t5efw",uiAttribs:{},portsIn:[{name:"Id",value:""},{name:"Visible",value:1}],objName:"Ops.Sidebar.SidebarText_v3"},{id:"0ctgyprgo",uiAttribs:{},portsOut:[{name:"Current Place",links:[{portIn:"Text",portOut:"Current Place",objIn:"tmv3t5efw",objOut:"0ctgyprgo"}]},{name:"Level",value:0}],objName:"Ops.Team.Plan.CurrentPlace"},{id:"6uhi7em2l",uiAttribs:{},portsIn:[{name:"Text",value:"Place"},{name:"Show Title",value:1},{name:"Default Minimized",value:1},{name:"Visible",value:1}],portsOut:[{name:"next",links:[{portIn:"link",portOut:"next",objIn:"hvlgisnpl",objOut:"6uhi7em2l"}]},{name:"childs",links:[{portIn:"link",portOut:"childs",objIn:"tmv3t5efw",objOut:"6uhi7em2l"}]}],objName:"Ops.Sidebar.Group"},{id:"6tekt16cv",uiAttribs:{},portsIn:[{name:"key",value:"points"}],portsOut:[{name:"result",links:[{portIn:"Array",portOut:"result",objIn:"31xlo1jdh",objOut:"6tekt16cv"}]},{name:"Length",value:4}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"31xlo1jdh",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"exe",portOut:"Changed",objIn:"h6lrh23fz",objOut:"31xlo1jdh"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"6kld08yjc",objOut:"31xlo1jdh"}]}],objName:"Ops.Trigger.TriggerOnChangeArray"},{id:"h6lrh23fz",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"exe",portOut:"then",objIn:"0av59vo2r",objOut:"h6lrh23fz"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"tl0stiak1",uiAttribs:{},portsIn:[{name:"Place Name",value:"stories"}],portsOut:[{name:"Is Current Place",links:[{portIn:"boolean",portOut:"Is Current Place",objIn:"h6lrh23fz",objOut:"tl0stiak1"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"kbzct8dqw",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"gsot2gpxz",objOut:"kbzct8dqw"}]},{name:"index",value:1321},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"izuigst6w",objOut:"kbzct8dqw"},{portIn:"Object",portOut:"value",objIn:"uptju1mg3",objOut:"kbzct8dqw"},{portIn:"Object",portOut:"value",objIn:"ukunf0p74",objOut:"kbzct8dqw"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"76jhd2uc1",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"kbzct8dqw",objOut:"76jhd2uc1"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"gsot2gpxz",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Trigger",portOut:"then",objIn:"uptju1mg3",objOut:"gsot2gpxz"}]},{name:"else",links:[{portIn:"Trigger",portOut:"else",objIn:"ukunf0p74",objOut:"gsot2gpxz"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"izuigst6w",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"6kld08yjc",objOut:"izuigst6w"}]}],objName:"Ops.Json.ObjectGetString"},{id:"6kld08yjc",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"boolean",portOut:"Found",objIn:"gsot2gpxz",objOut:"6kld08yjc"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"yjz4j9pqz",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"kbzct8dqw",objOut:"yjz4j9pqz"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"4y3rmr5i4",objOut:"yjz4j9pqz"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"0av59vo2r",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"yjz4j9pqz",objOut:"0av59vo2r"}]},{name:"trigger 9",links:[{portIn:"Trigger",portOut:"trigger 9",objIn:"4y3rmr5i4",objOut:"0av59vo2r"}]},{name:"trigger 12",links:[{portIn:"Trigger",portOut:"trigger 12",objIn:"2trr2gdmv",objOut:"0av59vo2r"}]},{name:"trigger 15",links:[{portIn:"Trigger",portOut:"trigger 15",objIn:"4d2frj1f4",objOut:"0av59vo2r"}]}],objName:"Ops.Trigger.Sequence"},{id:"4y3rmr5i4",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"d0td8nt1y",objOut:"4y3rmr5i4"}]}],objName:"Ops.Vars.VarTriggerArray"},{id:"uptju1mg3",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"},{name:"Number",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"bh2stsizm",objOut:"uptju1mg3"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"bh2stsizm",objOut:"uptju1mg3"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"bh2stsizm",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"39l1ykgvt",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"ukunf0p74",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"},{name:"Number",value:0}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"39l1ykgvt",objOut:"ukunf0p74"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"39l1ykgvt",objOut:"ukunf0p74"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"xl528dl3c",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"h6lrh23fz",objOut:"xl528dl3c"}]}],objName:"Ops.Boolean.TriggerChangedTrue"},{id:"9zz0rcmtk",uiAttribs:{},portsIn:[{name:"Place Name",value:"stories"}],portsOut:[{name:"Is Current Place",links:[{portIn:"Value",portOut:"Is Current Place",objIn:"xl528dl3c",objOut:"9zz0rcmtk"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"d0td8nt1y",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_colors"}],objName:"Ops.Trigger.TriggerSend"},{id:"hxz5g9pbn",uiAttribs:{},portsIn:[{name:"Variable",value:"viewMappedZoom"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"daxmi3q8c",objOut:"hxz5g9pbn"},{portIn:"Value",portOut:"Value",objIn:"o9qjd8ndp",objOut:"hxz5g9pbn"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"nycgz16ar",uiAttribs:{},portsIn:[{name:"posX",value:0},{name:"posY",value:0},{name:"posZ",value:0},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"xekni5688",objOut:"nycgz16ar"}]}],objName:"Ops.Gl.Matrix.TransformView"},{id:"t876quj1v",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"transformedView"}],objName:"Ops.Trigger.TriggerSend"},{id:"h1wh8tx74",uiAttribs:{},portsIn:[{name:"Value",value:.09},{name:"Variable",value:"viewMinZoom"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"z8cj2e79i",uiAttribs:{},portsIn:[{name:"Value",value:2},{name:"Variable",value:"viewMaxZoom"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"mdm4uv0ou",uiAttribs:{},portsIn:[{name:"Separate inc/dec",value:0},{name:"Inc factor",value:4,title:"Inc/Dec factor"},{name:"Dec factor",value:4}],portsOut:[{name:"Result",links:[{portIn:"posX",portOut:"Result",objIn:"xekni5688",objOut:"mdm4uv0ou"}]}],objName:"Ops.Anim.Smooth"},{id:"4k634ctwz",uiAttribs:{},portsIn:[{name:"Separate inc/dec",value:0},{name:"Inc factor",value:4,title:"Inc/Dec factor"},{name:"Dec factor",value:4}],portsOut:[{name:"Result",links:[{portIn:"posY",portOut:"Result",objIn:"xekni5688",objOut:"4k634ctwz"}]}],objName:"Ops.Anim.Smooth"},{id:"daxmi3q8c",uiAttribs:{},portsIn:[{name:"Separate inc/dec",value:0},{name:"Inc factor",value:4,title:"Inc/Dec factor"},{name:"Dec factor",value:4}],portsOut:[{name:"Result",links:[{portIn:"scale",portOut:"Result",objIn:"nycgz16ar",objOut:"daxmi3q8c"}]}],objName:"Ops.Anim.Smooth"},{id:"2trr2gdmv",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_viewXYZ"}],objName:"Ops.Trigger.TriggerSend"},{id:"4jsqyf6zx",uiAttribs:{},portsIn:[{name:"Variable",value:"pointPositions"}],portsOut:[{name:"Value",links:[{portIn:"Values",portOut:"Value",objIn:"mfozcgsk4",objOut:"4jsqyf6zx"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"rqe3t5c3d",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosY"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"o4cv7er1n",objOut:"rqe3t5c3d"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"j09pwrh91",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosX"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"rqe3t5c3d",objOut:"j09pwrh91"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"o4cv7er1n",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"5v2pxav3a",objOut:"o4cv7er1n"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"mfozcgsk4",uiAttribs:{},portsIn:[{name:"Stride",value:3}],portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"ld9jchqtj",objOut:"mfozcgsk4"}]}],objName:"Ops.Array.ArrayLookup"},{id:"ld9jchqtj",uiAttribs:{},portsOut:[{name:"Num Items",value:0},{name:"Min X",links:[{portIn:"x1",portOut:"Min X",objIn:"uvt4qz020",objOut:"ld9jchqtj"}]},{name:"Min Y",links:[{portIn:"y1",portOut:"Min Y",objIn:"uvt4qz020",objOut:"ld9jchqtj"}]},{name:"Min Z",value:999999999},{name:"Max X",links:[{portIn:"x2",portOut:"Max X",objIn:"uvt4qz020",objOut:"ld9jchqtj"}]},{name:"Max Y",links:[{portIn:"y2",portOut:"Max Y",objIn:"uvt4qz020",objOut:"ld9jchqtj"}]},{name:"Max Z",value:-999999999},{name:"Average X",value:null},{name:"Average Y",value:null},{name:"Average Z",value:null},{name:"Center X",links:[{portIn:"Value",portOut:"Center X",objIn:"679syaosv",objOut:"ld9jchqtj"}]},{name:"Center Y",links:[{portIn:"Value",portOut:"Center Y",objIn:"rqe3t5c3d",objOut:"ld9jchqtj"}]},{name:"Center Z",value:0}],objName:"Ops.Array.InfoArray3"},{id:"l87qao6vd",uiAttribs:{},portsIn:[{name:"Variable",value:"activeConnectionNodes"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"hkmsmbye1",objOut:"l87qao6vd"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"hkmsmbye1",uiAttribs:{},portsIn:[{name:"Key",value:"index"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Indices",portOut:"Result",objIn:"mfozcgsk4",objOut:"hkmsmbye1"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"qyrlpqnk4",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_viewXYZ"}],portsOut:[{name:"Triggered",links:[{portIn:"Trigger",portOut:"Triggered",objIn:"j09pwrh91",objOut:"qyrlpqnk4"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"uvt4qz020",uiAttribs:{},portsOut:[{name:"distance",links:[{portIn:"value",portOut:"distance",objIn:"zie5n6wp4",objOut:"uvt4qz020"}]}],objName:"Ops.Math.Distance2d"},{id:"reiuw9dgt",uiAttribs:{},portsIn:[{name:"Variable",value:"viewMinZoom"}],portsOut:[{name:"Value",links:[{portIn:"new max",portOut:"Value",objIn:"zie5n6wp4",objOut:"reiuw9dgt"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"tzmhbc8i5",uiAttribs:{},portsIn:[{name:"Variable",value:"viewMaxZoom"}],portsOut:[{name:"Value",links:[{portIn:"new min",portOut:"Value",objIn:"zie5n6wp4",objOut:"tzmhbc8i5"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"zie5n6wp4",uiAttribs:{},portsIn:[{name:"old min",value:0},{name:"old max",value:7},{name:"Easing index",value:0},{name:"Easing",value:"Linear"},{name:"Clamp",value:1}],portsOut:[{name:"result",links:[{portIn:"Number for comparison",portOut:"result",objIn:"4kidih36r",objOut:"zie5n6wp4"},{portIn:"Value",portOut:"result",objIn:"5v2pxav3a",objOut:"zie5n6wp4"}]}],objName:"Ops.Math.MapRange"},{id:"679syaosv",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"j09pwrh91",objOut:"679syaosv"}]}],objName:"Ops.Math.FlipSign"},{id:"f79ij60q7",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"dvnaw4kbz",objOut:"f79ij60q7"},{portIn:"number1",portOut:"Value",objIn:"wkacxk4bj",objOut:"f79ij60q7"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"wkacxk4bj",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"16o2296ny",objOut:"wkacxk4bj"}]}],objName:"Ops.Math.Sum"},{id:"dvnaw4kbz",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"ktwrdwzit",objOut:"dvnaw4kbz"}]}],objName:"Ops.Math.Subtract"},{id:"gl1ictdjq",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"q1jyb246a",objOut:"gl1ictdjq"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"kbybbjm7b",uiAttribs:{},portsIn:[{name:"Classname",value:"inactive"}],objName:"Ops.Html.CSS.ToggleClass"},{id:"q1jyb246a",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Boolean",portOut:"result",objIn:"ytz0phahc",objOut:"q1jyb246a"}]}],objName:"Ops.Math.Compare.LessThan"},{id:"zuxlmls5p",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"2zkk95jlr",objOut:"zuxlmls5p"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"yqar0tvz9",uiAttribs:{},portsIn:[{name:"Classname",value:"inactive"}],objName:"Ops.Html.CSS.ToggleClass"},{id:"ytz0phahc",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Active",portOut:"Result",objIn:"kbybbjm7b",objOut:"ytz0phahc"}]}],objName:"Ops.Boolean.Not"},{id:"4kidih36r",uiAttribs:{},portsIn:[{name:"Comparison mode index",value:3},{name:"Comparison mode",value:"<="},{name:"value if true",value:1},{name:"value if false",value:0}],portsOut:[{name:"Array result",links:[{portIn:"Array",portOut:"Array result",objIn:"2d6ppn39a",objOut:"4kidih36r"},{portIn:"Array",portOut:"Array result",objIn:"4om106fcp",objOut:"4kidih36r"}]},{name:"Array length",value:6}],objName:"Ops.Array.ArrayLogic"},{id:"2d6ppn39a",uiAttribs:{},portsIn:[{name:"SearchValue",value:0}],portsOut:[{name:"Found",value:1},{name:"Index",links:[{portIn:"number1",portOut:"Index",objIn:"1pws9qiho",objOut:"2d6ppn39a"}]}],objName:"Ops.Array.ArrayContains_v2"},{id:"4q0wb5nc8",uiAttribs:{},portsIn:[{name:"Variable",value:"zoomLevels"}],portsOut:[{name:"Value",links:[{portIn:"array 0",portOut:"Value",objIn:"4kidih36r",objOut:"4q0wb5nc8"},{portIn:"Array",portOut:"Value",objIn:"0dcjsbb8e",objOut:"4q0wb5nc8"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"i7lmczoo2",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"index",portOut:"Value",objIn:"87xz1tm49",objOut:"i7lmczoo2"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"87xz1tm49",uiAttribs:{},portsIn:[{name:"Value Invalid Index",value:0}],portsOut:[{name:"value",links:[{portIn:"Value",portOut:"value",objIn:"jqn86lfi4",objOut:"87xz1tm49"}]},{name:"Valid Index",value:1}],objName:"Ops.Array.ArrayGetNumber"},{id:"16o2296ny",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"ktwrdwzit",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"53xeicyy7",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"number1",portOut:"length",objIn:"gbfhbuvh6",objOut:"53xeicyy7"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"gbfhbuvh6",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"number2",portOut:"result",objIn:"q1jyb246a",objOut:"gbfhbuvh6"}]}],objName:"Ops.Math.Subtract"},{id:"2zkk95jlr",uiAttribs:{},portsIn:[{name:"number2",value:0}],portsOut:[{name:"result",links:[{portIn:"Boolean",portOut:"result",objIn:"xg2vpsoym",objOut:"2zkk95jlr"}]}],objName:"Ops.Math.Compare.GreaterThan"},{id:"xg2vpsoym",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Active",portOut:"Result",objIn:"yqar0tvz9",objOut:"xg2vpsoym"}]}],objName:"Ops.Boolean.Not"},{id:"wrk7wr46z",uiAttribs:{},portsIn:[{name:"Value",value:.21},{name:"Variable",value:"viewMappedZoom"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"8gb5urrks",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"ugfearomb",objOut:"8gb5urrks"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"9o56qq06f",objOut:"8gb5urrks"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"ugfearomb",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Trigger",portOut:"trigger",objIn:"0jl5gssvs",objOut:"ugfearomb"}]},{name:"index",links:[{portIn:"Number",portOut:"index",objIn:"0jl5gssvs",objOut:"ugfearomb"}]},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"0jl5gssvs",objOut:"ugfearomb"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"amcr88d5p",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"0jl5gssvs",uiAttribs:{},portsIn:[{name:"Key",value:"index"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"amcr88d5p",objOut:"0jl5gssvs"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"amcr88d5p",objOut:"0jl5gssvs"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"jaeb5opqj",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Boolean",portOut:"result",objIn:"nhey8ohim",objOut:"jaeb5opqj"},{portIn:"Boolean",portOut:"result",objIn:"yb8cryatj",objOut:"jaeb5opqj"}]}],objName:"Ops.Boolean.And"},{id:"zicv7cc5s",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"bool 1",portOut:"length",objIn:"jaeb5opqj",objOut:"zicv7cc5s"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"rtn4c6f6y",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0},{name:"bool 10",value:0}],portsOut:[{name:"result",links:[{portIn:"bool 1",portOut:"result",objIn:"tn38h9aq1",objOut:"rtn4c6f6y"}]}],objName:"Ops.Boolean.Or"},{id:"8jl033f2h",uiAttribs:{},portsOut:[{name:"trigger 1",links:[{portIn:"Update",portOut:"trigger 1",objIn:"q9wsb4lkh",objOut:"8jl033f2h"}]},{name:"trigger 4",links:[{portIn:"Update",portOut:"trigger 4",objIn:"jk3yjaujz",objOut:"8jl033f2h"}]},{name:"trigger 6",links:[{portIn:"Update",portOut:"trigger 6",objIn:"eayxzh22k",objOut:"8jl033f2h"}]}],objName:"Ops.Trigger.Sequence"},{id:"4d2frj1f4",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_entity_names"}],objName:"Ops.Trigger.TriggerSend"},{id:"g6hhfedaw",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"0xeeqxijr",objOut:"g6hhfedaw"}]}],objName:"Ops.Boolean.And"},{id:"vd0qop485",uiAttribs:{},portsIn:[{name:"Variable",value:"dragOrZoom"}],portsOut:[{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"jvnh7g3o7",objOut:"vd0qop485"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"jvnh7g3o7",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"g6hhfedaw",objOut:"jvnh7g3o7"}]}],objName:"Ops.Boolean.Not"},{id:"q9wsb4lkh",uiAttribs:{},portsIn:[{name:"Property",value:"display"},{name:"Value Suffix",value:""}],portsOut:[{name:"HTML Element",links:[{portIn:"Element",portOut:"HTML Element",objIn:"jk3yjaujz",objOut:"q9wsb4lkh"}]}],objName:"Ops.Extension.HtmlElementArray.ElementArrayCssPropertyString"},{id:"ay98ewd6d",uiAttribs:{},portsIn:[{name:"Index",value:2}],portsOut:[{name:"X",value:899.7334456443787},{name:"Y",value:1004.4573962688446},{name:"Z",value:154}],objName:"Ops.Array.Array3GetNumbers"},{id:"rp00ly5di",uiAttribs:{},portsIn:[{name:"Filter Key",value:"filtered"},{name:"Filter Value",value:"1"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"zicv7cc5s",objOut:"rp00ly5di"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"nt0ewp1kz",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"}],portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"jaeb5opqj",objOut:"nt0ewp1kz"}]},{name:"Found",value:0}],objName:"Ops.Json.ObjectGetNumber_v2"},{id:"nt975adwk",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe 11",portOut:"Next",objIn:"64dk0xga7",objOut:"nt975adwk"}]}],objName:"Ops.Trigger.TriggerButton"},{id:"c1otsoqnf",uiAttribs:{},portsIn:[{name:"Text",value:""},{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"state"},{name:"Disable CSS Props",value:""},{name:"Display",value:"Block"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Parent",portOut:"DOM Element",objIn:"96hr2dawg",objOut:"c1otsoqnf"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"ec8ojsl2f",uiAttribs:{},portsIn:[{name:"Variable",value:"stateElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"96hr2dawg",uiAttribs:{},portsOut:[{name:"Parent Out",links:[{portIn:"Value",portOut:"Parent Out",objIn:"ec8ojsl2f",objOut:"96hr2dawg"}]}],objName:"Ops.Html.ElementChilds_v2"},{id:"mn3stc1sz",uiAttribs:{},portsIn:[{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"stories"},{name:"Disable CSS Props",value:""},{name:"Display",value:"None"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Child 2",portOut:"DOM Element",objIn:"rg8p9qn2z",objOut:"mn3stc1sz"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"cw1hz0nzu",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"bukcn8hrw",objOut:"cw1hz0nzu"}]}],objName:"Ops.Json.Object"},{id:"7mvkv97ps",uiAttribs:{},portsIn:[{name:"Key",value:"stories"}],portsOut:[{name:"Result Object",links:[{portIn:"Data",portOut:"Result Object",objIn:"kivk6jc9u",objOut:"7mvkv97ps"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"jii0hdru5",uiAttribs:{},portsIn:[{name:"False",value:""},{name:"True",value:"inactive"}],portsOut:[{name:"String",links:[{portIn:"String 4",portOut:"String",objIn:"0m3j4vfua",objOut:"jii0hdru5"}]}],objName:"Ops.Boolean.BoolToString"},{id:"0m3j4vfua",uiAttribs:{},portsIn:[{name:"String 5",value:""},{name:"String 6",value:""},{name:"String 7",value:""},{name:"String 8",value:"default"}],portsOut:[{name:"Result",links:[{portIn:"string 2",portOut:"Result",objIn:"yyydyz2yc",objOut:"0m3j4vfua"}]}],objName:"Ops.String.OrString"},{id:"sveqq5zth",uiAttribs:{},portsIn:[{name:"False",value:""},{name:"True",value:"active"}],portsOut:[{name:"String",links:[{portIn:"String 1",portOut:"String",objIn:"0m3j4vfua",objOut:"sveqq5zth"}]}],objName:"Ops.Boolean.BoolToString"},{id:"qekdttuz5",uiAttribs:{},portsIn:[{name:"False",value:""},{name:"True",value:"highlighted"}],portsOut:[{name:"String",links:[{portIn:"String 2",portOut:"String",objIn:"0m3j4vfua",objOut:"qekdttuz5"}]}],objName:"Ops.Boolean.BoolToString"},{id:"s0j6oh1s1",uiAttribs:{},portsIn:[{name:"False",value:""},{name:"True",value:"active"}],portsOut:[{name:"String",links:[{portIn:"String 3",portOut:"String",objIn:"0m3j4vfua",objOut:"s0j6oh1s1"}]}],objName:"Ops.Boolean.BoolToString"},{id:"gj6c3nff6",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"bool 2",portOut:"length",objIn:"nlr6n4oai",objOut:"gj6c3nff6"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"e7i9j5r7n",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"currentZoomLevel"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"jdqmn6eat",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"d54mq4f9p",objOut:"jdqmn6eat"}]}],objName:"Ops.Vars.VarGetString"},{id:"d54mq4f9p",uiAttribs:{},portsIn:[{name:"Place Name",value:"stories"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 2",portOut:"Is Current Place",objIn:"rtn4c6f6y",objOut:"d54mq4f9p"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"nhey8ohim",uiAttribs:{},portsIn:[{name:"False",value:"none"},{name:"True",value:"block"}],portsOut:[{name:"String",links:[{portIn:"Value",portOut:"String",objIn:"q9wsb4lkh",objOut:"nhey8ohim"}]}],objName:"Ops.Boolean.BoolToString"},{id:"yb8cryatj",uiAttribs:{},portsIn:[{name:"False",value:""},{name:"True",value:"active"}],portsOut:[{name:"String",links:[{portIn:"Classname",portOut:"String",objIn:"1qdd96xhc",objOut:"yb8cryatj"}]}],objName:"Ops.Boolean.BoolToString"},{id:"lezp94owa",uiAttribs:{},portsIn:[{name:"Variable",value:"hoveredEntityData"}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"8o6io5i5s",objOut:"lezp94owa"}]},{name:"Value",links:[{portIn:"data",portOut:"Value",objIn:"c8jpstu48",objOut:"lezp94owa"},{portIn:"Data",portOut:"Value",objIn:"ne6w5gpz3",objOut:"lezp94owa"}]}],objName:"Ops.Vars.TriggerVarGetObject"},{id:"5ua923o5z",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_infobox"}],objName:"Ops.Trigger.TriggerSend"},{id:"c8jpstu48",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"Filter Value",portOut:"Result",objIn:"1qxs17bwz",objOut:"c8jpstu48"},{portIn:"Filter Value",portOut:"Result",objIn:"xyxsubwfu",objOut:"c8jpstu48"},{portIn:"String",portOut:"Result",objIn:"b77lzdaas",objOut:"c8jpstu48"}]}],objName:"Ops.Json.ObjectGetString"},{id:"hva70o2su",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"1qxs17bwz",objOut:"hva70o2su"},{portIn:"Array",portOut:"Value",objIn:"xyxsubwfu",objOut:"hva70o2su"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"2g56g35p4",uiAttribs:{},portsIn:[{name:"Array 2",value:0},{name:"Array 3",value:0},{name:"Array 4",value:0},{name:"Array 5",value:0},{name:"Array 6",value:0},{name:"Array 7",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"b77lzdaas",objOut:"2g56g35p4"}]},{name:"Array length",value:0}],objName:"Ops.Array.ArrayMerge_v3"},{id:"349tx5piv",uiAttribs:{},portsIn:[{name:"Format index",value:0},{name:"Format",value:"X"}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"ibmakk6jd",objOut:"349tx5piv"}]},{name:"Array Length Out",value:1}],objName:"Ops.Array.ArrayUnique"},{id:"1qxs17bwz",uiAttribs:{},portsIn:[{name:"Filter Key",value:"source"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"z5tg4r51h",objOut:"1qxs17bwz"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"xyxsubwfu",uiAttribs:{},portsIn:[{name:"Filter Key",value:"target"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"Array",portOut:"arrayOut",objIn:"urlowz0lz",objOut:"xyxsubwfu"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"z5tg4r51h",uiAttribs:{},portsIn:[{name:"Key",value:"target"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array 0",portOut:"Result",objIn:"2g56g35p4",objOut:"z5tg4r51h"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"urlowz0lz",uiAttribs:{},portsIn:[{name:"Key",value:"source"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array 1",portOut:"Result",objIn:"2g56g35p4",objOut:"urlowz0lz"}]}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"4er3dwd16",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"ein5razgn",objOut:"4er3dwd16"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"izp6wokd5",objOut:"4er3dwd16"},{portIn:"Array",portOut:"Result",objIn:"foqfbwffd",objOut:"4er3dwd16"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"kxpyayaos",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"ein5razgn",objOut:"kxpyayaos"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"8o6io5i5s",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"4er3dwd16",objOut:"8o6io5i5s"}]},{name:"trigger 4",links:[{portIn:"Trigger",portOut:"trigger 4",objIn:"izp6wokd5",objOut:"8o6io5i5s"}]},{name:"trigger 9",links:[{portIn:"Trigger",portOut:"trigger 9",objIn:"5ua923o5z",objOut:"8o6io5i5s"}]},{name:"trigger 12",links:[{portIn:"Trigger",portOut:"trigger 12",objIn:"13e4wfy8c",objOut:"8o6io5i5s"}]},{name:"trigger 15",links:[{portIn:"Trigger",portOut:"trigger 15",objIn:"nj9wsohad",objOut:"8o6io5i5s"}]}],objName:"Ops.Trigger.Sequence"},{id:"izp6wokd5",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"aian2gumc",objOut:"izp6wokd5"}]}],objName:"Ops.Vars.VarTriggerArray"},{id:"k3ej1vjbw",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"},{name:"Number",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"iid85d478",objOut:"k3ej1vjbw"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"iid85d478",objOut:"k3ej1vjbw"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"ein5razgn",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"z5c8rc6vj",objOut:"ein5razgn"}]},{name:"index",value:1321},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"321dj125q",objOut:"ein5razgn"},{portIn:"Object",portOut:"value",objIn:"k3ej1vjbw",objOut:"ein5razgn"},{portIn:"Object",portOut:"value",objIn:"5i3wilsre",objOut:"ein5razgn"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"z5c8rc6vj",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Trigger",portOut:"then",objIn:"k3ej1vjbw",objOut:"z5c8rc6vj"}]},{name:"else",links:[{portIn:"Trigger",portOut:"else",objIn:"5i3wilsre",objOut:"z5c8rc6vj"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"ibmakk6jd",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"boolean",portOut:"Found",objIn:"z5c8rc6vj",objOut:"ibmakk6jd"}]},{name:"Index",value:0}],objName:"Ops.String.ArrayContainsString"},{id:"321dj125q",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"ibmakk6jd",objOut:"321dj125q"}]}],objName:"Ops.Json.ObjectGetString"},{id:"iid85d478",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"5i3wilsre",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"},{name:"Number",value:0}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"0ejiud2hi",objOut:"5i3wilsre"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"0ejiud2hi",objOut:"5i3wilsre"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"0ejiud2hi",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"13e4wfy8c",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_colors"}],objName:"Ops.Trigger.TriggerSend"},{id:"gyl7hdg8i",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe 0",portOut:"Next",objIn:"8o6io5i5s",objOut:"gyl7hdg8i"}]}],objName:"Ops.Trigger.TriggerButton"},{id:"6a99mhs9d",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosY"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"rotbj70mc",objOut:"6a99mhs9d"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"nj9wsohad",uiAttribs:{},portsIn:[{name:"Variable",value:"viewPosX"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"6a99mhs9d",objOut:"nj9wsohad"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"rotbj70mc",uiAttribs:{},portsIn:[{name:"Value",value:3},{name:"Variable",value:"currentZoomLevel"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"t22h134cl",uiAttribs:{},portsOut:[{name:"X",links:[{portIn:"number1",portOut:"X",objIn:"3dc6h33wy",objOut:"t22h134cl"}]},{name:"Y",links:[{portIn:"Value",portOut:"Y",objIn:"6a99mhs9d",objOut:"t22h134cl"}]},{name:"Z",value:0}],objName:"Ops.Array.Array3GetNumbers"},{id:"ne6w5gpz3",uiAttribs:{},portsIn:[{name:"Key",value:"index"}],portsOut:[{name:"Result",links:[{portIn:"Index",portOut:"Result",objIn:"t22h134cl",objOut:"ne6w5gpz3"}]},{name:"Found",value:0}],objName:"Ops.Json.ObjectGetNumber_v2"},{id:"fr8v9z1pz",uiAttribs:{},portsIn:[{name:"Variable",value:"pointPositions"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"t22h134cl",objOut:"fr8v9z1pz"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"zqfr2x1hy",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"nj9wsohad",objOut:"zqfr2x1hy"}]}],objName:"Ops.Math.FlipSign"},{id:"3dc6h33wy",uiAttribs:{},portsIn:[{name:"number2",value:.25}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"zqfr2x1hy",objOut:"3dc6h33wy"}]}],objName:"Ops.Math.Sum"},{id:"foqfbwffd",uiAttribs:{},portsIn:[{name:"Filter Key",value:"filtered"},{name:"Filter Value",value:"1"},{name:"Invert Filter",value:0}],portsOut:[{name:"arrayOut",links:[{portIn:"Value",portOut:"arrayOut",objIn:"aian2gumc",objOut:"foqfbwffd"},{portIn:"Array",portOut:"arrayOut",objIn:"2gujk4wks",objOut:"foqfbwffd"}]}],objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{id:"b77lzdaas",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"349tx5piv",objOut:"b77lzdaas"}]}],objName:"Ops.Array.ArrayPushString"},{id:"u8n9vp0je",uiAttribs:{},portsIn:[{name:"Variable",value:"graphLoading"}],portsOut:[{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"akh21qwm1",objOut:"u8n9vp0je"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"2zjx4ugg5",uiAttribs:{},portsIn:[{name:"Place Name",value:"graph"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 1",portOut:"Is Current Place",objIn:"welqwsf2k",objOut:"2zjx4ugg5"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"dgjhiqjrq",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"2zjx4ugg5",objOut:"dgjhiqjrq"}]}],objName:"Ops.Vars.VarGetString"},{id:"welqwsf2k",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"bool 1",portOut:"result",objIn:"ycycmshmo",objOut:"welqwsf2k"}]}],objName:"Ops.Boolean.And"},{id:"akh21qwm1",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"welqwsf2k",objOut:"akh21qwm1"}]}],objName:"Ops.Boolean.Not"},{id:"t6c89cn9q",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"entityClicked"}],portsOut:[{name:"Triggered",links:[{portIn:"True",portOut:"Triggered",objIn:"iye7dcny3",objOut:"t6c89cn9q"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"iye7dcny3",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"ycycmshmo",objOut:"iye7dcny3"}]}],objName:"Ops.Boolean.BoolByTrigger"},{id:"ycycmshmo",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"9ttjmbr7b",objOut:"ycycmshmo"}]}],objName:"Ops.Boolean.And"},{id:"yamjpm8cv",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"entityRelease"}],portsOut:[{name:"Triggered",links:[{portIn:"false",portOut:"Triggered",objIn:"iye7dcny3",objOut:"yamjpm8cv"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"v4d4rrva6",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"viewPosY"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"gl2yciyxw",objOut:"v4d4rrva6"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"tgaugqhdd",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"viewPosX"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"v4d4rrva6",objOut:"tgaugqhdd"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"gl2yciyxw",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"fwzfpmsbz",objOut:"gl2yciyxw"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"7thyqkhqy",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"resetView"}],objName:"Ops.Trigger.TriggerSend"},{id:"a2odpielm",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"resetView"}],portsOut:[{name:"Triggered",links:[{portIn:"Trigger",portOut:"Triggered",objIn:"tgaugqhdd",objOut:"a2odpielm"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"x1md9vgjz",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_colors"}],objName:"Ops.Trigger.TriggerSend"},{id:"uk5hepacz",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"2hgyr1opr",objOut:"uk5hepacz"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"cavup0bli",objOut:"uk5hepacz"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"vxjpv7g4z",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"uk5hepacz",objOut:"vxjpv7g4z"}]},{name:"trigger 10",links:[{portIn:"Trigger",portOut:"trigger 10",objIn:"cavup0bli",objOut:"vxjpv7g4z"}]},{name:"trigger 14",links:[{portIn:"Trigger",portOut:"trigger 14",objIn:"4yj1cljpr",objOut:"vxjpv7g4z"}]},{name:"trigger 15",links:[{portIn:"Trigger",portOut:"trigger 15",objIn:"x1md9vgjz",objOut:"vxjpv7g4z"}]}],objName:"Ops.Trigger.Sequence"},{id:"cavup0bli",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"fp7swsvep",objOut:"cavup0bli"}]}],objName:"Ops.Vars.VarTriggerArray"},{id:"2hgyr1opr",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Trigger",portOut:"trigger",objIn:"3blf1ljq5",objOut:"2hgyr1opr"}]},{name:"index",value:1321},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"3blf1ljq5",objOut:"2hgyr1opr"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"94pnw95re",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"2hgyr1opr",objOut:"94pnw95re"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"3blf1ljq5",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"},{name:"Number",value:0}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"k5l9cre5l",objOut:"3blf1ljq5"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"k5l9cre5l",objOut:"3blf1ljq5"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"k5l9cre5l",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"hxdv1a4nl",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"resetFilters"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"vxjpv7g4z",objOut:"hxdv1a4nl"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"fwzfpmsbz",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"resetFilters"}],objName:"Ops.Trigger.TriggerSend"},{id:"9pyhvu7e6",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"exe",portOut:"Event Trigger",objIn:"1lp7w1i47",objOut:"9pyhvu7e6"}]},{name:"Index",value:1},{name:"Event Element",links:[{portIn:"HTML Element",portOut:"Event Element",objIn:"bx8h1xvqv",objOut:"9pyhvu7e6"}]}],objName:"Ops.Html.Event.ElementsArrayEventHandler"},{id:"bx8h1xvqv",uiAttribs:{},portsOut:[{name:"Classes",links:[{portIn:"Array",portOut:"Classes",objIn:"hd4ukimtx",objOut:"bx8h1xvqv"}]}],objName:"Ops.Team.ACAR.ClassList"},{id:"hd4ukimtx",uiAttribs:{},portsIn:[{name:"SearchValue",value:"story-prev"}],portsOut:[{name:"Found",links:[{portIn:"boolean",portOut:"Found",objIn:"1lp7w1i47",objOut:"hd4ukimtx"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"1lp7w1i47",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Trigger",portOut:"then",objIn:"r7qplmutr",objOut:"1lp7w1i47"}]},{name:"else",links:[{portIn:"Trigger",portOut:"else",objIn:"16fnb1st2",objOut:"1lp7w1i47"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"yd20s8mxz",uiAttribs:{},portsIn:[{name:"Template",value:'<ul class="level_0">\n    <li class="selected {{status}} {{#if itemType}}{{itemType}}{{else}}main{{/if}}" data-path="{{id}}">\n        <div class="item">\n            <span class="title">{{title}}</span>\n        </div>\n        <ul class="level_1">\n            {{#each items}}\n                <li class="{{colors}} {{status}} {{#if itemType}}{{itemType}}{{else}}filter{{/if}}" data-path="{{id}}">\n                    <div class="item">\n                        <span class="title">{{title}}</span>\n                        {{#if activeFilters}}\n                            <span class="filterCount">{{activeFilters}}</span>\n                        {{/if}}\n                        <span class="filterInfo">{{#if numEntities}}\n                            [ {{#if filteredEntities}}{{filteredEntities}} / {{/if}}{{numEntities}}\n                            ]{{/if}}</span>\n                    </div>\n                    <ul class="level_2">\n                        {{#each items}}\n                            <li class="{{colors}} {{status}} filter_{{type}} {{#if itemType}}{{itemType}}{{else}}filter{{/if}}" data-path="{{id}}">\n                                <div class="item">\n                                    <span class="title">{{title}}</span>\n                                    {{#if activeFilters}}\n                                        <span class="filterCount">{{activeFilters}}</span>\n                                    {{/if}}\n                                    <span class="input">\n                                        {{#if textFilter}}\n                                            <div class="searchicon"><span class="icon icon-suchen"></span></div>\n                                            <input type="text"/>\n                                        {{/if}}\n                                    </span>\n                                </div>\n                                <ul class="level_3">\n                                    {{#each items}}\n                                        <li class="{{colors}} {{status}} {{#if itemType}}{{itemType}}{{else}}filter{{/if}}" {{#if filter}}data-filter="{{filter}}"{{/if}} data-path="{{id}}">\n                                            <div class="item">\n                                                <span class="title">{{title}}</span>\n                                                {{#if activeFilters}}\n                                                    <span class="filterCount">{{activeFilters}}</span>\n                                                {{/if}}\n                                            </div>\n                                        </li>\n                                    {{/each}}\n                                </ul>\n                            </li>\n                        {{/each}}\n                    </ul>\n                </li>\n            {{/each}}\n        </ul>\n    </li>\n</ul>\n'}],portsOut:[{name:"Result",links:[{portIn:"Text",portOut:"Result",objIn:"yi7divvoo",objOut:"yd20s8mxz"},{portIn:"String",portOut:"Result",objIn:"ipz65mlj7",objOut:"yd20s8mxz"}]},{name:"Errors",value:""}],objName:"Ops.String.HandleBarsHtml_v2"},{id:"ttnnhr9ai",uiAttribs:{},portsIn:[{name:"Template",value:'<div class="{{type}}">\n    <div class="header">\n        <h2>{{name}}</h2>\n        <div class="button ablage"><span class="icon icon-ablage-hinzufuegen"></span></div>\n        <div class="button primary close">x</div>\n    </div>\n    {{#if debug}}\n    <div class="debug" style="color: red";>\n        <br/>{{id}}\n    </div>\n    {{/if}}\n    <div class="data">\n        <ul class="tagcontainer">\n            {{#each data}}\n                {{#if .}}\n                    <li>\n                        <div class="item">\n                            <span class="title">{{@key}}</span>\n                            <ul class="tags">\n                                {{#each .}}\n                                    <li>\n                                        <div class="item"><span class="title">{{title}}</span></div>\n                                    </li>\n                                {{/each}}\n                            </ul>\n                        </div>\n                    </li>\n                {{/if}}\n            {{/each}}\n        </ul>\n    </div>\n    <div class="information">\n        {{#if text}}\n        <div class="header">\n            <span class="title">Informationen</span>\n            {{#if text.date}}<span class="date">Stand: {{text.date}}</span>{{/if}}\n        </div>\n        <div class="content">\n            {{#if text.content}}\n                <div class="text {{#if text.sources}}alsosources{{/if}}">{{text.content}}</div>\n            {{/if}}\n            {{#if text.sources}}\n            <div class="sources {{#if text.content}}alsocontent{{/if}}">\n                <div class="buttons">\n                    {{#each text.sources}}\n                        {{#if href}}\n                            <a href="{{href}}" target="_blank" class="button external">{{title}}<span class="icon icon-space-left icon-externer-link"></span></a>\n                        {{/if}}\n                        {{#if items}}\n                            <a class="button external" onclick="document.getElementById(\'referenzen\').classList.toggle(\'hidden\');">{{title}}<span class="icon icon-space-left icon-arrow"></a>\n                        {{/if}}\n                    {{/each}}\n                </div>\n                <div class="referenzen hidden" id="referenzen">\n                {{#each text.sources}}\n                    {{#if items}}\n                        <ul>\n                            {{#each items}}\n                            <li>{{.}}</li>\n                            {{/each}}\n                        </ul>\n                    {{/if}}\n                {{/each}}\n                </div>\n            </div>\n            {{/if}}\n        </div>\n        {{/if}}\n    </div>\n    <div class="graph">\n        <ul class="tagcontainer">\n            {{#each graph}}\n                {{#if .}}\n                    <li>\n                        <div class="item">\n                            <span class="title">{{@key}}</span>\n                            <ul class="tags">\n                                {{#each .}}\n                                    <li>\n                                        <div class="item {{type}}"><span class="title">{{title}}</span></div>\n                                    </li>\n                                {{/each}}\n                            </ul>\n                        </div>\n                    </li>\n                {{/if}}\n            {{/each}}\n        </ul>\n    </div>\n</div>\n'}],portsOut:[{name:"Result",links:[{portIn:"Text",portOut:"Result",objIn:"qf444jnra",objOut:"ttnnhr9ai"},{portIn:"String",portOut:"Result",objIn:"jize7jys9",objOut:"ttnnhr9ai"}]},{name:"Errors",value:""}],objName:"Ops.String.HandleBarsHtml_v2"},{id:"lkdgylmm9",uiAttribs:{},portsIn:[{name:"Template",value:'{{#each entries}}\n    <div class="entry">\n        <div class="content">\n            <div class="button ablage"><span class="icon icon-ablage-hinzufuegen"></span></div>\n            <div class="author">{{author}}, {{date}}</div>\n            <div class="title">{{title}}</div>\n            {{#if image}}\n                <div class="image">\n                    <img src="{{image.url}}">\n                    <div class="caption">{{#if image.caption}}{{image.caption}}{{/if}}</div>\n                </div>\n            {{/if}}\n            <div class="teaser">{{{teaser}}}</div>\n            <div class="text">{{{text}}}</div>\n        </div>\n        <ul class="tags">\n            {{#each tags}}\n                <li><div class="item {{type}}"><span class="title">{{title}}</span></div></li>\n            {{/each}}\n        </ul>\n    </div>\n{{/each}}'}],portsOut:[{name:"Result",links:[{portIn:"Text",portOut:"Result",objIn:"weq938i0u",objOut:"lkdgylmm9"}]},{name:"Errors",value:""}],objName:"Ops.String.HandleBarsHtml_v2"},{id:"7rfc95rsw",uiAttribs:{},portsIn:[{name:"Template",value:'{{#if stories}}\n    {{#each stories}}\n    <div class="story {{#if active}}active{{/if}}" data-index="{{@index}}">\n        <div class="title"><span class="index">{{position}}</span>{{title}}</div>\n        <div class="content {{#unless active}}hidden{{/unless}}">\n            <div class="progress">\n                <div class="steps">\n                    {{#each steps}}\n                        <div class="step">\n                            <svg width="13" height="13" viewBox="0 0 13 13" fill="none" xmlns="http://www.w3.org/2000/svg">\n                                {{#if active}}\n                                    <ellipse cx="6.375" cy="6.50001" rx="6.375" ry="6.37501" fill="#F1F1F1"/>\n                                {{else}}\n                                    <ellipse cx="7.125" cy="6.50001" rx="6.375" ry="6.37501" fill="#6F6F6F"/>\n                                {{/if}}\n                            </svg>\n                        </div>\n                    {{/each}}\n                </div>\n                <div class="controls">\n                    <div class="numbers">[{{../currentStep.position}}/{{steps.length}}]</div>\n                    <div class="button story-prev {{#if ../currentStep.isFirst}}inactive{{/if}}">&lt;</div>\n                    <div class="button story-next {{#if ../currentStep.isLast}}inactive{{/if}}">&gt;</div>\n                </div>\n            </div>\n            <div class="step">\n                <div class="text">\n                    <h3 class="headline">{{../currentStep.title}}</h3>\n                    <div class="content">{{../currentStep.text}}</div>\n                </div>\n            </div>\n        </div>\n    </div>\n    {{/each}}\n{{/if}}'}],portsOut:[{name:"Result",links:[{portIn:"Text",portOut:"Result",objIn:"mn3stc1sz",objOut:"7rfc95rsw"},{portIn:"String",portOut:"Result",objIn:"3w5fdywi7",objOut:"7rfc95rsw"}]},{name:"Errors",value:""}],objName:"Ops.String.HandleBarsHtml_v2"},{id:"y3hikxwcm",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStep"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"6qkdmxpbn",objOut:"y3hikxwcm"},{portIn:"number1",portOut:"Value",objIn:"va5x7j8ar",objOut:"y3hikxwcm"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"r7qplmutr",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStep"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"16fnb1st2",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStep"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"6qkdmxpbn",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"value",portOut:"result",objIn:"k49w5pcds",objOut:"6qkdmxpbn"}]}],objName:"Ops.Math.Subtract"},{id:"va5x7j8ar",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"Value 1",portOut:"result",objIn:"70lkkfjl5",objOut:"va5x7j8ar"}]}],objName:"Ops.Math.Sum"},{id:"3w5fdywi7",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"Update",portOut:"Changed",objIn:"eyi5rs8qg",objOut:"3w5fdywi7"},{portIn:"Update",portOut:"Changed",objIn:"8csan75gt",objOut:"3w5fdywi7"}]}],objName:"Ops.Trigger.TriggerOnChangeString_v2"},{id:"70lkkfjl5",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"16fnb1st2",objOut:"70lkkfjl5"}]}],objName:"Ops.Math.Min_v3"},{id:"9mmhspv6d",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"Value 2",portOut:"result",objIn:"70lkkfjl5",objOut:"9mmhspv6d"}]}],objName:"Ops.Math.Subtract"},{id:"k49w5pcds",uiAttribs:{},portsIn:[{name:"Maximum",value:0}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"r7qplmutr",objOut:"k49w5pcds"}]}],objName:"Ops.Math.Max"},{id:"fhh19ajpx",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStep"}],portsOut:[{name:"Value",links:[{portIn:"index",portOut:"Value",objIn:"3pgu1xcac",objOut:"fhh19ajpx"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"z3tnt5qjs",uiAttribs:{},portsIn:[{name:"Place Name",value:"magazin"}],portsOut:[{name:"Is Current Place",links:[{portIn:"Boolean",portOut:"Is Current Place",objIn:"zaprvg21c",objOut:"z3tnt5qjs"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"shw3bqsrr",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"z3tnt5qjs",objOut:"shw3bqsrr"}]}],objName:"Ops.Vars.VarGetString"},{id:"zaprvg21c",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Display index",portOut:"Result",objIn:"c1otsoqnf",objOut:"zaprvg21c"}]}],objName:"Ops.Boolean.Not"},{id:"l90n4lfl8",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesElementVisible"}],portsOut:[{name:"Value",links:[{portIn:"bool 1",portOut:"Value",objIn:"kgb9prh7g",objOut:"l90n4lfl8"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"rg8p9qn2z",uiAttribs:{},portsOut:[{name:"Parent Out",links:[{portIn:"Child 1",portOut:"Parent Out",objIn:"96hr2dawg",objOut:"rg8p9qn2z"}]}],objName:"Ops.Html.ElementChilds_v2"},{id:"2ki3vqm6l",uiAttribs:{},portsIn:[{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"storyselect"},{name:"Disable CSS Props",value:""},{name:"Display index",value:1},{name:"Display",value:"Block"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Child 1",portOut:"DOM Element",objIn:"rg8p9qn2z",objOut:"2ki3vqm6l"}]},{name:"Hovering",value:0},{name:"Clicked",links:[{portIn:"Trigger",portOut:"Clicked",objIn:"8xrlnrjih",objOut:"2ki3vqm6l"}]}],objName:"Ops.Html.Elements.Element_v2"},{id:"kivk6jc9u",uiAttribs:{},portsIn:[{name:"Template",value:'{{#if stories}}\n    <div class="controls {{#if active}}active{{/if}}">\n        <div class="icon icon-tour-zuklappen"></div>\n        <div class="select">Touren</div>\n        <div class="count">{{stories.length}}</div>\n    </div>\n{{/if}}'}],portsOut:[{name:"Result",links:[{portIn:"Text",portOut:"Result",objIn:"2ki3vqm6l",objOut:"kivk6jc9u"},{portIn:"String",portOut:"Result",objIn:"3w5fdywi7",objOut:"kivk6jc9u"}]},{name:"Errors",value:""}],objName:"Ops.String.HandleBarsHtml_v2"},{id:"vu38dklga",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"kan8aowqo",objOut:"vu38dklga"}]}],objName:"Ops.Json.Object"},{id:"ch7luaau7",uiAttribs:{},portsIn:[{name:"Text",value:""},{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"stories"},{name:"Disable CSS Props",value:""},{name:"Display index",value:1},{name:"Display",value:"Block"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Parent",portOut:"DOM Element",objIn:"rg8p9qn2z",objOut:"ch7luaau7"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"eyi5rs8qg",uiAttribs:{},portsIn:[{name:"Query",value:".progress .button"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Elements",portOut:"Elements",objIn:"9pyhvu7e6",objOut:"eyi5rs8qg"}]}],objName:"Ops.Patch.PaZfgnp.QuerySelectorAllElement"},{id:"ezwinn412",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"HTML Element",portOut:"Element",objIn:"rzob786h6",objOut:"ezwinn412"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"05om79faf",uiAttribs:{},portsIn:[{name:"Place Name",value:"stories"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 2",portOut:"Is Current Place",objIn:"kgb9prh7g",objOut:"05om79faf"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"eq3peebt7",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"05om79faf",objOut:"eq3peebt7"},{portIn:"Plan",portOut:"Value",objIn:"c3qa4ffqb",objOut:"eq3peebt7"},{portIn:"Plan",portOut:"Value",objIn:"ih3588wn9",objOut:"eq3peebt7"}]}],objName:"Ops.Vars.VarGetString"},{id:"kgb9prh7g",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Display index",portOut:"result",objIn:"mn3stc1sz",objOut:"kgb9prh7g"}]}],objName:"Ops.Boolean.And"},{id:"7kayqqtos",uiAttribs:{},portsIn:[{name:"Variable",value:"activeConnectionNodes"}],portsOut:[{name:"Value",links:[{portIn:"Active Nodes",portOut:"Value",objIn:"psxi24j9d",objOut:"7kayqqtos"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"0sx1hxgoi",uiAttribs:{},portsIn:[{name:"Key",value:"debug"},{name:"Number",value:0}],portsOut:[{name:"Result Object",links:[{portIn:"Data",portOut:"Result Object",objIn:"ttnnhr9ai",objOut:"0sx1hxgoi"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"l3hvns3zp",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"6ua0lmfvk",objOut:"l3hvns3zp"}]}],objName:"Ops.Data.Compose.Object.CompObjectSetString"},{id:"opvzh16ir",uiAttribs:{},portsIn:[{name:"Key",value:"ID"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"l3hvns3zp",objOut:"opvzh16ir"}]}],objName:"Ops.Json.ObjectGetString"},{id:"55pku98ln",uiAttribs:{},portsIn:[{name:"Key",value:"data"}],portsOut:[{name:"Result",links:[{portIn:"data",portOut:"Result",objIn:"opvzh16ir",objOut:"55pku98ln"}]}],objName:"Ops.Json.ObjectGetObject_v2"},{id:"4yj1cljpr",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"updateNav"}],objName:"Ops.Trigger.TriggerSend"},{id:"fp7swsvep",uiAttribs:{},portsIn:[{name:"Value"},{name:"Variable",value:"activeConnectionNodes"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"v6g7081lp",objOut:"fp7swsvep"}]}],objName:"Ops.Vars.VarTriggerArray"},{id:"v6g7081lp",uiAttribs:{},portsIn:[{name:"Value"},{name:"Variable",value:"activeFilters"}],objName:"Ops.Vars.VarTriggerArray"},{id:"aian2gumc",uiAttribs:{},portsIn:[{name:"Variable",value:"activeConnectionNodes"}],objName:"Ops.Vars.VarTriggerArray"},{id:"9lv2i5m7p",uiAttribs:{},portsIn:[{name:"Variable",value:"activeConnectionNodes"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"rzk1abtn5",objOut:"9lv2i5m7p"}]},{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"6t8ibxuax",objOut:"9lv2i5m7p"}]}],objName:"Ops.Vars.TriggerVarGetArray"},{id:"2yrxospuk",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"exe",portOut:"then",objIn:"w61hndht7",objOut:"2yrxospuk"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"z65xx679z",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"String 2",portOut:"Result",objIn:"p20nbkz10",objOut:"z65xx679z"}]}],objName:"Ops.Json.ObjectGetString"},{id:"0x0jliamo",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"boolean",portOut:"Result",objIn:"2yrxospuk",objOut:"0x0jliamo"}]}],objName:"Ops.Boolean.Not"},{id:"wmb25ibkw",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"String 1",portOut:"Result",objIn:"p20nbkz10",objOut:"wmb25ibkw"}]}],objName:"Ops.Json.ObjectGetString"},{id:"p20nbkz10",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Boolean",portOut:"Result",objIn:"0x0jliamo",objOut:"p20nbkz10"}]}],objName:"Ops.String.StringEquals"},{id:"bukcn8hrw",uiAttribs:{},portsIn:[{name:"Key",value:"stories"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"728ogjist",objOut:"bukcn8hrw"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"kan8aowqo",uiAttribs:{},portsIn:[{name:"Key",value:"active"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"7mvkv97ps",objOut:"kan8aowqo"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"i76pphqwc",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesElementVisible"}],portsOut:[{name:"Value",links:[{portIn:"Number",portOut:"Value",objIn:"kan8aowqo",objOut:"i76pphqwc"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"cc4nfgqx5",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"storiesCurrentStep"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"8xrlnrjih",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesElementVisible"}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"hdtt34cdk",objOut:"8xrlnrjih"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"b9ibc6i2o",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"resetFilters"}],objName:"Ops.Trigger.TriggerSend"},{id:"nx9yopn9h",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"8xrlnrjih",objOut:"nx9yopn9h"}]}],objName:"Ops.Boolean.Not"},{id:"c3r1u7gzd",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesElementVisible"}],portsOut:[{name:"Value",links:[{portIn:"Boolean",portOut:"Value",objIn:"nx9yopn9h",objOut:"c3r1u7gzd"},{portIn:"boolean",portOut:"Value",objIn:"hdtt34cdk",objOut:"c3r1u7gzd"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"c3qa4ffqb",uiAttribs:{},portsIn:[{name:"Go To Place",value:"stories"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"b9ibc6i2o",objOut:"c3qa4ffqb"}]}],objName:"Ops.Team.Plan.GotoPlace"},{id:"hdtt34cdk",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Execute",portOut:"then",objIn:"c3qa4ffqb",objOut:"hdtt34cdk"}]},{name:"else",links:[{portIn:"Execute",portOut:"else",objIn:"ih3588wn9",objOut:"hdtt34cdk"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"ih3588wn9",uiAttribs:{},portsIn:[{name:"Go To Place",value:"graph"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"9b9zjit2n",objOut:"ih3588wn9"}]}],objName:"Ops.Team.Plan.GotoPlace"},{id:"f1ipmrld7",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"storiesCurrentStoryIndex"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"8csan75gt",uiAttribs:{},portsIn:[{name:"Query",value:".story:not(.active)"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Elements",portOut:"Elements",objIn:"j2as940oc",objOut:"8csan75gt"}]}],objName:"Ops.Patch.PaZfgnp.QuerySelectorAllElement"},{id:"j2as940oc",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:0},{name:"Stop Propagation",value:0}],portsOut:[{name:"Event Trigger",links:[{portIn:"Trigger",portOut:"Event Trigger",objIn:"wdt2llsgg",objOut:"j2as940oc"}]},{name:"Index",value:0},{name:"Event Element",links:[{portIn:"HTML Element",portOut:"Event Element",objIn:"fjxum6p84",objOut:"j2as940oc"}]}],objName:"Ops.Html.Event.ElementsArrayEventHandler"},{id:"1swmv9zn7",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesAllStories"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"7mvkv97ps",objOut:"1swmv9zn7"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"l9mu1b9e5",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesAllStories"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"bukcn8hrw",objOut:"l9mu1b9e5"},{portIn:"array",portOut:"Value",objIn:"o777slpev",objOut:"l9mu1b9e5"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"38wmq6mkj",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesAllStories"}],portsOut:[{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"wa0035w6m",objOut:"38wmq6mkj"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"7wemw08r4",uiAttribs:{},portsIn:[{name:"file",value:"assets/66f3ce6623173e5d0f6832cc_stories.json",display:"file",title:"URL"},{name:"body",value:""},{name:"HTTP Method index",value:0},{name:"HTTP Method",value:"GET"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:1},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"Object",portOut:"Response Json Object",objIn:"0qt5d2ha3",objOut:"7wemw08r4"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:24},{name:"Status Code",value:200},{name:"Is Loading",value:0}],objName:"Ops.Json.HttpRequest_v3"},{id:"0qt5d2ha3",uiAttribs:{},portsOut:[{name:"Array",links:[{portIn:"Array",portOut:"Array",objIn:"8e9c3l2oa",objOut:"0qt5d2ha3"}]}],objName:"Ops.Json.ObjectToArray"},{id:"vngbkvky8",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"ek8uhypla",objOut:"vngbkvky8"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"7hrldz0lb",objOut:"vngbkvky8"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"8e9c3l2oa",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"Update",portOut:"Changed",objIn:"vngbkvky8",objOut:"8e9c3l2oa"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"ek8uhypla",objOut:"8e9c3l2oa"}]}],objName:"Ops.Trigger.TriggerOnChangeArray_v2"},{id:"ek8uhypla",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"h329ph7y9",objOut:"ek8uhypla"}]},{name:"index",links:[{portIn:"number1",portOut:"index",objIn:"3q9b9k4uh",objOut:"ek8uhypla"},{portIn:"number1",portOut:"index",objIn:"1addqqth8",objOut:"ek8uhypla"}]},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"5eoc3hwjd",objOut:"ek8uhypla"},{portIn:"data",portOut:"value",objIn:"7fn7rcrkx",objOut:"ek8uhypla"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"lcnfneh54",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"5eoc3hwjd",uiAttribs:{},portsIn:[{name:"Key",value:"position"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"w6omur7g7",objOut:"5eoc3hwjd"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"3q9b9k4uh",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"5eoc3hwjd",objOut:"3q9b9k4uh"}]}],objName:"Ops.Math.Sum"},{id:"knetr781f",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Update",portOut:"trigger",objIn:"0tttd42ft",objOut:"knetr781f"}]},{name:"index",links:[{portIn:"number1",portOut:"index",objIn:"4a6as5ben",objOut:"knetr781f"},{portIn:"number1",portOut:"index",objIn:"saad99yu5",objOut:"knetr781f"},{portIn:"number2",portOut:"index",objIn:"mvrlfrfdq",objOut:"knetr781f"}]},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"ab6z443un",objOut:"knetr781f"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"7fn7rcrkx",uiAttribs:{},portsIn:[{name:"key",value:"steps"}],portsOut:[{name:"result",links:[{portIn:"array",portOut:"result",objIn:"knetr781f",objOut:"7fn7rcrkx"}]},{name:"Length",links:[{portIn:"number1",portOut:"Length",objIn:"7shp1xjwz",objOut:"7fn7rcrkx"}]}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"ab6z443un",uiAttribs:{},portsIn:[{name:"Key",value:"position"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"uevvqf4kh",objOut:"ab6z443un"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"4a6as5ben",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"ab6z443un",objOut:"4a6as5ben"},{portIn:"number2",portOut:"result",objIn:"7shp1xjwz",objOut:"4a6as5ben"}]}],objName:"Ops.Math.Sum"},{id:"h329ph7y9",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"ph36zoxol",objOut:"h329ph7y9"}]},{name:"trigger 15",links:[{portIn:"Update",portOut:"trigger 15",objIn:"lcnfneh54",objOut:"h329ph7y9"}]}],objName:"Ops.Trigger.Sequence"},{id:"7hrldz0lb",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesAllStories"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"ph36zoxol",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"knetr781f",objOut:"ph36zoxol"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"w6omur7g7",objOut:"ph36zoxol"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"w6omur7g7",uiAttribs:{},portsIn:[{name:"Key",value:"steps"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"14esfaxyp",objOut:"w6omur7g7"}]}],objName:"Ops.Json.ObjectSetArray_v2"},{id:"uevvqf4kh",uiAttribs:{},portsIn:[{name:"Key",value:"isLast"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"gdws0ud6f",objOut:"uevvqf4kh"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"gdws0ud6f",uiAttribs:{},portsIn:[{name:"Key",value:"isFirst"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"1ze7f0p1j",objOut:"gdws0ud6f"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"0tttd42ft",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"7shp1xjwz",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"uevvqf4kh",objOut:"7shp1xjwz"}]}],objName:"Ops.Math.Compare.Equals"},{id:"saad99yu5",uiAttribs:{},portsIn:[{name:"number2",value:0}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"gdws0ud6f",objOut:"saad99yu5"}]}],objName:"Ops.Math.Compare.Equals"},{id:"ss8906pwt",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"0ctgyprgo",objOut:"ss8906pwt"}]}],objName:"Ops.Vars.VarGetString"},{id:"o777slpev",uiAttribs:{},portsOut:[{name:"value",links:[{portIn:"data",portOut:"value",objIn:"te1zlnzfs",objOut:"o777slpev"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"cfdchwj0b",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStoryIndex"}],portsOut:[{name:"Value",links:[{portIn:"index",portOut:"Value",objIn:"o777slpev",objOut:"cfdchwj0b"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"te1zlnzfs",uiAttribs:{},portsIn:[{name:"key",value:"steps"}],portsOut:[{name:"result",links:[{portIn:"array",portOut:"result",objIn:"oz5lb3jha",objOut:"te1zlnzfs"}]},{name:"Length",value:9}],objName:"Ops.Json.ObjectGetArray_v2"},{id:"oz5lb3jha",uiAttribs:{},portsOut:[{name:"value",links:[{portIn:"Object Value",portOut:"value",objIn:"728ogjist",objOut:"oz5lb3jha"}]}],objName:"Ops.Array.ArrayGetObject"},{id:"t1onlm4me",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStep"}],portsOut:[{name:"Value",links:[{portIn:"index",portOut:"Value",objIn:"oz5lb3jha",objOut:"t1onlm4me"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"728ogjist",uiAttribs:{},portsIn:[{name:"Key",value:"currentStep"}],portsOut:[{name:"Result Object",links:[{portIn:"Data",portOut:"Result Object",objIn:"7rfc95rsw",objOut:"728ogjist"}]}],objName:"Ops.Json.ObjectSetObject_v2"},{id:"14esfaxyp",uiAttribs:{},portsIn:[{name:"Key",value:"active"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"lcnfneh54",objOut:"14esfaxyp"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"ee5xd53yj",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStoryIndex"}],portsOut:[{name:"Value",links:[{portIn:"number2",portOut:"Value",objIn:"1addqqth8",objOut:"ee5xd53yj"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"1addqqth8",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"14esfaxyp",objOut:"1addqqth8"}]}],objName:"Ops.Math.Compare.Equals"},{id:"oqlu7hc3k",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"vngbkvky8",objOut:"oqlu7hc3k"}]},{name:"Number",value:0}],objName:"Ops.Number.TriggerOnChangeNumber_v2"},{id:"yd3yeu39e",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStoryIndex"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"oqlu7hc3k",objOut:"yd3yeu39e"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"6lzvp4jxi",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"storiesCurrentStep"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"wdt2llsgg",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStoryIndex"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"6lzvp4jxi",objOut:"wdt2llsgg"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"fjxum6p84",uiAttribs:{},portsOut:[{name:"Dataset",links:[{portIn:"Data",portOut:"Dataset",objIn:"gxki7oizt",objOut:"fjxum6p84"}]}],objName:"Ops.Team.ACAR.DataSet"},{id:"gxki7oizt",uiAttribs:{},portsIn:[{name:"Key",value:"index"}],portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"wdt2llsgg",objOut:"gxki7oizt"}]},{name:"Found",value:0}],objName:"Ops.Json.ObjectGetNumber_v2"},{id:"1ze7f0p1j",uiAttribs:{},portsIn:[{name:"Key",value:"active"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"0tttd42ft",objOut:"1ze7f0p1j"}]}],objName:"Ops.Json.ObjectSetNumber_v2"},{id:"mvrlfrfdq",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"1ze7f0p1j",objOut:"mvrlfrfdq"}]}],objName:"Ops.Math.Compare.Equals"},{id:"1gm9a2pzm",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStep"}],portsOut:[{name:"Value",links:[{portIn:"number1",portOut:"Value",objIn:"mvrlfrfdq",objOut:"1gm9a2pzm"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"p8faxqxqc",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStep"}],portsOut:[{name:"Value",links:[{portIn:"Value",portOut:"Value",objIn:"lyu2dd2yv",objOut:"p8faxqxqc"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"9b9zjit2n",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"resetView"}],objName:"Ops.Trigger.TriggerSend"},{id:"lyu2dd2yv",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"vngbkvky8",objOut:"lyu2dd2yv"}]},{name:"Number",value:0}],objName:"Ops.Number.TriggerOnChangeNumber_v2"},{id:"ybli54cn2",uiAttribs:{},portsIn:[{name:"Variable",value:"storiesCurrentStoryIndex"}],portsOut:[{name:"Value",links:[{portIn:"index",portOut:"Value",objIn:"wa0035w6m",objOut:"ybli54cn2"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"na922wgpx",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters li.cms .title"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Elements",portOut:"Elements",objIn:"v7574l3k3",objOut:"na922wgpx"},{portIn:"array",portOut:"Elements",objIn:"qgp9v3jxz",objOut:"na922wgpx"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"v7574l3k3",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"reload",portOut:"Event Trigger",objIn:"2jr8qkhil",objOut:"v7574l3k3"},{portIn:"exe",portOut:"Event Trigger",objIn:"qgp9v3jxz",objOut:"v7574l3k3"}]},{name:"Index",value:0},{name:"Event Element",links:[{portIn:"HTML Element",portOut:"Event Element",objIn:"jbsoouaz6",objOut:"v7574l3k3"},{portIn:"HTML Element",portOut:"Event Element",objIn:"w4bj77ps0",objOut:"v7574l3k3"}]}],objName:"Ops.Html.Event.ElementsArrayEventHandler"},{id:"2jr8qkhil",uiAttribs:{},portsIn:[{name:"file",value:"https://staging.aca-rh.net/api/query",display:"file",title:"URL"},{name:"HTTP Method index",value:1},{name:"HTTP Method",value:"POST"},{name:"Content-Type",value:"application/json"},{name:"Content index",value:0},{name:"Content",value:"JSON",title:"Response Content"},{name:"Auto request",value:0},{name:"Send Credentials",value:0}],portsOut:[{name:"Response Json Object",links:[{portIn:"Object",portOut:"Response Json Object",objIn:"7vpq1x7a8",objOut:"2jr8qkhil"}]},{name:"Response Data Url",value:""},{name:"Duration MS",value:112},{name:"Status Code",value:200},{name:"Is Loading",links:[{portIn:"Visible",portOut:"Is Loading",objIn:"pifqtw4i6",objOut:"2jr8qkhil"}]},{name:"Loaded",links:[{portIn:"Trigger",portOut:"Loaded",objIn:"89y9du92w",objOut:"2jr8qkhil"}]}],objName:"Ops.Json.HttpRequest_v3"},{id:"pifqtw4i6",uiAttribs:{},portsIn:[{name:"Style index",value:1},{name:"Style",value:"Ring"}],objName:"Ops.Html.Utils.LoadingIndicator"},{id:"jxcx9oekt",uiAttribs:{},portsIn:[{name:"JSON String",value:'{\n    "select": {\n        "title": true,\n        "text": "page.text.kirbytext"\n    }\n}'}],portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"424fgdvqn",objOut:"jxcx9oekt"}]},{name:"Valid",value:1}],objName:"Ops.Json.ParseObject_v2"},{id:"04i14wute",uiAttribs:{},portsIn:[{name:"Beautify",value:1}],portsOut:[{name:"Result",links:[{portIn:"body",portOut:"Result",objIn:"2jr8qkhil",objOut:"04i14wute"}]},{name:"Error",value:0}],objName:"Ops.Json.ObjectStringify_v2"},{id:"424fgdvqn",uiAttribs:{},portsIn:[{name:"Key",value:"query"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"04i14wute",objOut:"424fgdvqn"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"ek2srapcp",uiAttribs:{},portsIn:[{name:"Variable",value:"apiAuthHeaders"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"fdunefajo",uiAttribs:{},portsIn:[{name:"Variable",value:"apiAuthHeaders"}],portsOut:[{name:"Value",links:[{portIn:"headers",portOut:"Value",objIn:"l0sx8bzao",objOut:"fdunefajo"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"vfxyxbd9v",uiAttribs:{},portsIn:[{name:"Variable",value:"apiAuthHeaders"}],portsOut:[{name:"Value",links:[{portIn:"headers",portOut:"Value",objIn:"2jr8qkhil",objOut:"vfxyxbd9v"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"7vpq1x7a8",uiAttribs:{},portsIn:[{name:"Path",value:"result"}],portsOut:[{name:"Output",links:[{portIn:"data",portOut:"Output",objIn:"sk7l2xm0u",objOut:"7vpq1x7a8"},{portIn:"data",portOut:"Output",objIn:"guqicswjg",objOut:"7vpq1x7a8"}]},{name:"Found",value:0}],objName:"Ops.Data.JsonPath.ObjectGetObjectByPath"},{id:"jbsoouaz6",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"HTML Element",portOut:"Element",objIn:"1saykxaqa",objOut:"jbsoouaz6"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"1saykxaqa",uiAttribs:{},portsOut:[{name:"Dataset",links:[{portIn:"data",portOut:"Dataset",objIn:"ivp9cmmew",objOut:"1saykxaqa"}]}],objName:"Ops.Team.ACAR.DataSet"},{id:"ivp9cmmew",uiAttribs:{},portsIn:[{name:"Key",value:"path"}],portsOut:[{name:"Result",links:[{portIn:"string 1",portOut:"Result",objIn:"m3yp8h6gu",objOut:"ivp9cmmew"}]}],objName:"Ops.Json.ObjectGetString"},{id:"m3yp8h6gu",uiAttribs:{},portsIn:[{name:"string 0",value:"page('"},{name:"string 2",value:"')"},{name:"string 3",value:""},{name:"string 4",value:""},{name:"string 5",value:""},{name:"string 6",value:""},{name:"string 7",value:""},{name:"add spaces",value:0},{name:"new lines",value:0}],portsOut:[{name:"concat string",links:[{portIn:"Value",portOut:"concat string",objIn:"424fgdvqn",objOut:"m3yp8h6gu"}]}],objName:"Ops.String.ConcatMulti_v2"},{id:"ohbfp5uap",uiAttribs:{},portsIn:[{name:"Variable",value:"showGraph"}],portsOut:[{name:"Value",links:[{portIn:"boolean",portOut:"Value",objIn:"krdgvwmaw",objOut:"ohbfp5uap"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"89y9du92w",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"showGraph"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"9qlygzu1i",objOut:"89y9du92w"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"uaztww2y0",uiAttribs:{},portsIn:[{name:"Variable",value:"overlayElement"}],portsOut:[{name:"Value",links:[{portIn:"Child 8",portOut:"Value",objIn:"csoqaa4xh",objOut:"uaztww2y0"}]}],objName:"Ops.Vars.VarGetObject_v2"},{id:"vmoaqe60e",uiAttribs:{},portsIn:[{name:"Variable",value:"overlayElement"}],objName:"Ops.Vars.VarSetObject_v2"},{id:"dpxruwdrt",uiAttribs:{},portsIn:[{name:"Text",value:""},{name:"Position index",value:2},{name:"Position",value:"Relative"},{name:"Interactive index",value:2},{name:"Interactive",value:"No Pointer Events"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"overlay"},{name:"Disable CSS Props",value:""},{name:"Display",value:"None"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Parent",portOut:"DOM Element",objIn:"unx9fzsf3",objOut:"dpxruwdrt"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"sk7l2xm0u",uiAttribs:{},portsIn:[{name:"Key",value:"text"}],portsOut:[{name:"Result",links:[{portIn:"string 3",portOut:"Result",objIn:"5grq89htp",objOut:"sk7l2xm0u"}]}],objName:"Ops.Json.ObjectGetString"},{id:"unx9fzsf3",uiAttribs:{},portsOut:[{name:"Parent Out",links:[{portIn:"Value",portOut:"Parent Out",objIn:"vmoaqe60e",objOut:"unx9fzsf3"}]}],objName:"Ops.Html.ElementChilds_v2"},{id:"lsszpcmvn",uiAttribs:{},portsIn:[{name:"Position index",value:0},{name:"Position",value:"Absolute"},{name:"Interactive index",value:0},{name:"Interactive",value:"True"},{name:"Set Size",value:0},{name:"Width",value:100},{name:"Height",value:100},{name:"Size  Units index",value:0},{name:"Size  Units",value:"px"},{name:"Overflow index",value:1},{name:"Overflow",value:"Hidden"},{name:"Inline Style",value:""},{name:"CSS Class",value:"content"},{name:"Disable CSS Props",value:""},{name:"Display index",value:1},{name:"Display",value:"Block"},{name:"Tag Name",value:"div"},{name:"Opacity",value:1},{name:"Propagate Click-Events",value:1}],portsOut:[{name:"DOM Element",links:[{portIn:"Child 1",portOut:"DOM Element",objIn:"unx9fzsf3",objOut:"lsszpcmvn"}]},{name:"Hovering",value:0}],objName:"Ops.Html.Elements.Element_v2"},{id:"8d3ryskks",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"nru3uiev2",objOut:"8d3ryskks"},{portIn:"Plan",portOut:"Value",objIn:"reeyci43n",objOut:"8d3ryskks"}]}],objName:"Ops.Vars.VarGetString"},{id:"nru3uiev2",uiAttribs:{},portsIn:[{name:"Place Name",value:"graph"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 1",portOut:"Is Current Place",objIn:"erd0hbyvf",objOut:"nru3uiev2"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"kibd9f22e",uiAttribs:{},portsIn:[{name:"Variable",value:"showGraph"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"5grq89htp",uiAttribs:{},portsIn:[{name:"string 0",value:"<h1>"},{name:"string 2",value:"</h1>"},{name:"string 4",value:""},{name:"string 5",value:""},{name:"string 6",value:""},{name:"string 7",value:""},{name:"add spaces",value:0},{name:"new lines",value:0}],portsOut:[{name:"concat string",links:[{portIn:"Text",portOut:"concat string",objIn:"lsszpcmvn",objOut:"5grq89htp"}]}],objName:"Ops.String.ConcatMulti_v2"},{id:"guqicswjg",uiAttribs:{},portsIn:[{name:"Key",value:"title"}],portsOut:[{name:"Result",links:[{portIn:"string 1",portOut:"Result",objIn:"5grq89htp",objOut:"guqicswjg"}]}],objName:"Ops.Json.ObjectGetString"},{id:"czn2iaiou",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"showOverlay"}],objName:"Ops.Vars.VarSetNumber_v2"},{id:"yl5u3676j",uiAttribs:{},portsIn:[{name:"Variable",value:"showOverlay"}],portsOut:[{name:"Value",links:[{portIn:"Display index",portOut:"Value",objIn:"dpxruwdrt",objOut:"yl5u3676j"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"o55gm60uw",uiAttribs:{},portsIn:[{name:"Value",value:0},{name:"Variable",value:"showOverlay"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"houja88en",objOut:"o55gm60uw"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"houja88en",uiAttribs:{},portsIn:[{name:"Value",value:1},{name:"Variable",value:"showGraph"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"9qlygzu1i",uiAttribs:{},portsIn:[{name:"Value",value:1},{name:"Variable",value:"showOverlay"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"tetfqrgeg",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters li.cms:not(.selected)"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Array",portOut:"Elements",objIn:"fxm0o9idi",objOut:"tetfqrgeg"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"bnz2skw20",uiAttribs:{},portsOut:[{name:"index",value:0},{name:"value",links:[{portIn:"HTML Element",portOut:"value",objIn:"km97wzmk8",objOut:"bnz2skw20"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"fxm0o9idi",uiAttribs:{},portsOut:[{name:"Changed",links:[{portIn:"exe",portOut:"Changed",objIn:"bnz2skw20",objOut:"fxm0o9idi"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"bnz2skw20",objOut:"fxm0o9idi"}]}],objName:"Ops.Trigger.TriggerOnChangeArray"},{id:"km97wzmk8",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Patch.PaZfgnp.ElementArrayToggleClass"},{id:"qgp9v3jxz",uiAttribs:{},portsOut:[{name:"index",value:4},{name:"value",links:[{portIn:"HTML Element",portOut:"value",objIn:"z9qi52ssn",objOut:"qgp9v3jxz"},{portIn:"HTML Element 2",portOut:"value",objIn:"w4bj77ps0",objOut:"qgp9v3jxz"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"z9qi52ssn",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"Object in",portOut:"Element",objIn:"thmuwhq7v",objOut:"z9qi52ssn"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"w4bj77ps0",uiAttribs:{},portsOut:[{name:"Equal",links:[{portIn:"index",portOut:"Equal",objIn:"thmuwhq7v",objOut:"w4bj77ps0"}]}],objName:"Ops.Patch.PaZfgnp.ElementEquals"},{id:"thmuwhq7v",uiAttribs:{},portsOut:[{name:"Index 0 Object",links:[{portIn:"HTML Element",portOut:"Index 0 Object",objIn:"4ghyj75fn",objOut:"thmuwhq7v"}]},{name:"Index 1 Object",links:[{portIn:"HTML Element",portOut:"Index 1 Object",objIn:"g8zk5kwia",objOut:"thmuwhq7v"}]}],objName:"Ops.Json.RouteObject"},{id:"4ghyj75fn",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementRemoveClass"},{id:"v03l24icy",uiAttribs:{},objName:"Ops.Html.CSS.ElementAddClass"},{id:"rzob786h6",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementAddClass"},{id:"1qdd96xhc",uiAttribs:{},objName:"Ops.Html.CSS.ElementAddClass"},{id:"g8zk5kwia",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementAddClass"},{id:"7mlsjrzbs",uiAttribs:{},portsIn:[{name:"Variable",value:"activeFilters"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"n1trfggxo",uiAttribs:{},portsIn:[{name:"Array length",value:0},{name:"Mode select index",value:0},{name:"Mode select",value:"Number"},{name:"Default Value",value:0},{name:"Reverse",value:0}],portsOut:[{name:"Array",links:[{portIn:"Value",portOut:"Array",objIn:"7mlsjrzbs",objOut:"n1trfggxo"}]},{name:"Array length out",value:0}],objName:"Ops.Array.Array_v3"},{id:"qtou7bj6j",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementRemoveClass"},{id:"pmfjxo2gi",uiAttribs:{},portsOut:[{name:"index",value:3},{name:"value",links:[{portIn:"Number 0",portOut:"value",objIn:"hcm2ryxj2",objOut:"pmfjxo2gi"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"f4a60xckm",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"Object in",portOut:"Element",objIn:"ira8uecjd",objOut:"f4a60xckm"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"wvtwdol9g",uiAttribs:{},portsOut:[{name:"Equal",links:[{portIn:"bool 1",portOut:"Equal",objIn:"pramon1h5",objOut:"wvtwdol9g"}]}],objName:"Ops.Patch.PaZfgnp.ElementEquals"},{id:"ira8uecjd",uiAttribs:{},portsOut:[{name:"Index 0 Object",links:[{portIn:"HTML Element",portOut:"Index 0 Object",objIn:"vfvm4liq6",objOut:"ira8uecjd"}]},{name:"Index 1 Object",links:[{portIn:"HTML Element",portOut:"Index 1 Object",objIn:"ara5y3mje",objOut:"ira8uecjd"}]}],objName:"Ops.Json.RouteObject"},{id:"vfvm4liq6",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementRemoveClass"},{id:"ara5y3mje",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementAddClass"},{id:"c0jq4rzht",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters .level_2 > li.filter > .item > .title"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Elements",portOut:"Elements",objIn:"g2wjew6s8",objOut:"c0jq4rzht"},{portIn:"array",portOut:"Elements",objIn:"hjvj5fsbi",objOut:"c0jq4rzht"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"g2wjew6s8",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"exe",portOut:"Event Trigger",objIn:"hjvj5fsbi",objOut:"g2wjew6s8"}]},{name:"Index",value:4},{name:"Event Element",links:[{portIn:"HTML Element",portOut:"Event Element",objIn:"5c595b8qd",objOut:"g2wjew6s8"},{portIn:"HTML Element",portOut:"Event Element",objIn:"vnkxqe535",objOut:"g2wjew6s8"}]}],objName:"Ops.Html.Event.ElementsArrayEventHandler"},{id:"hjvj5fsbi",uiAttribs:{},portsOut:[{name:"index",value:14},{name:"value",links:[{portIn:"Number 0",portOut:"value",objIn:"0ld61yxfk",objOut:"hjvj5fsbi"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"5c595b8qd",uiAttribs:{},portsOut:[{name:"Equal",links:[{portIn:"bool 1",portOut:"Equal",objIn:"3n0w1i0zf",objOut:"5c595b8qd"}]}],objName:"Ops.Patch.PaZfgnp.ElementEquals"},{id:"xa0jkh73t",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"Object in",portOut:"Element",objIn:"1l2cmrsme",objOut:"xa0jkh73t"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"1l2cmrsme",uiAttribs:{},portsOut:[{name:"Index 0 Object",links:[{portIn:"HTML Element",portOut:"Index 0 Object",objIn:"jy967ceg8",objOut:"1l2cmrsme"}]},{name:"Index 1 Object",links:[{portIn:"HTML Element",portOut:"Index 1 Object",objIn:"nsv49z6ri",objOut:"1l2cmrsme"}]}],objName:"Ops.Json.RouteObject"},{id:"jy967ceg8",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementRemoveClass"},{id:"nsv49z6ri",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Html.CSS.ElementAddClass"},{id:"fpkedop4b",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters .level_3 > li.filter > .item > .title"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Elements",portOut:"Elements",objIn:"b19xvapn1",objOut:"fpkedop4b"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"b19xvapn1",uiAttribs:{},portsIn:[{name:"Event Name",value:"click"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"exe",portOut:"Event Trigger",objIn:"jgg0d7shq",objOut:"b19xvapn1"}]},{name:"Index",value:453},{name:"Event Element",links:[{portIn:"HTML Element",portOut:"Event Element",objIn:"9dmayqsfv",objOut:"b19xvapn1"}]}],objName:"Ops.Html.Event.ElementsArrayEventHandler"},{id:"hdyb7hjyy",uiAttribs:{},portsOut:[{name:"Classes",links:[{portIn:"Array",portOut:"Classes",objIn:"d2bow80pm",objOut:"hdyb7hjyy"}]}],objName:"Ops.Team.ACAR.ClassList"},{id:"d2bow80pm",uiAttribs:{},portsIn:[{name:"SearchValue",value:"selected"}],portsOut:[{name:"Found",links:[{portIn:"Boolean",portOut:"Found",objIn:"aqg9lu88u",objOut:"d2bow80pm"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"pramon1h5",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"index",portOut:"result",objIn:"ira8uecjd",objOut:"pramon1h5"}]}],objName:"Ops.Boolean.And"},{id:"aqg9lu88u",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"pramon1h5",objOut:"aqg9lu88u"}]}],objName:"Ops.Boolean.Not"},{id:"pnhp0985i",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"HTML Element",portOut:"Element",objIn:"hdyb7hjyy",objOut:"pnhp0985i"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"pq86b4hrv",uiAttribs:{},portsOut:[{name:"Classes",links:[{portIn:"Array",portOut:"Classes",objIn:"qrqnrkn1z",objOut:"pq86b4hrv"}]}],objName:"Ops.Team.ACAR.ClassList"},{id:"qrqnrkn1z",uiAttribs:{},portsIn:[{name:"SearchValue",value:"selected"}],portsOut:[{name:"Found",links:[{portIn:"Boolean",portOut:"Found",objIn:"g0f5tak3z",objOut:"qrqnrkn1z"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"g0f5tak3z",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"3n0w1i0zf",objOut:"g0f5tak3z"}]}],objName:"Ops.Boolean.Not"},{id:"vnkxqe535",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"HTML Element",portOut:"Element",objIn:"pq86b4hrv",objOut:"vnkxqe535"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"3n0w1i0zf",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"index",portOut:"result",objIn:"1l2cmrsme",objOut:"3n0w1i0zf"}]}],objName:"Ops.Boolean.And"},{id:"0ld61yxfk",uiAttribs:{},portsOut:[{name:"Output 0",links:[{portIn:"HTML Element",portOut:"Output 0",objIn:"xa0jkh73t",objOut:"0ld61yxfk"}]},{name:"Output 1",links:[{portIn:"HTML Element 2",portOut:"Output 1",objIn:"5c595b8qd",objOut:"0ld61yxfk"}]}],objName:"Ops.Json.SequenceObjects_v2"},{id:"hcm2ryxj2",uiAttribs:{},portsOut:[{name:"Output 0",links:[{portIn:"HTML Element",portOut:"Output 0",objIn:"f4a60xckm",objOut:"hcm2ryxj2"}]},{name:"Output 1",links:[{portIn:"HTML Element 2",portOut:"Output 1",objIn:"wvtwdol9g",objOut:"hcm2ryxj2"}]}],objName:"Ops.Json.SequenceObjects_v2"},{id:"9dmayqsfv",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"HTML Element",portOut:"Element",objIn:"fplcikqxa",objOut:"9dmayqsfv"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"fplcikqxa",uiAttribs:{},portsIn:[{name:"Classname",value:"selected"}],objName:"Ops.Patch.PaZfgnp.ElementArrayToggleClass"},{id:"dhjfapfaw",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters .filter.selected[data-filter]"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"array",portOut:"Elements",objIn:"ufahij8ty",objOut:"dhjfapfaw"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"eq24sq3qc",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"ufahij8ty",objOut:"eq24sq3qc"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"ks5z185av",objOut:"eq24sq3qc"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"jgg0d7shq",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"dhjfapfaw",objOut:"jgg0d7shq"}]},{name:"trigger 14",links:[{portIn:"Update",portOut:"trigger 14",objIn:"eq24sq3qc",objOut:"jgg0d7shq"}]},{name:"trigger 15",links:[{portIn:"Trigger",portOut:"trigger 15",objIn:"x7xzzzuk0",objOut:"jgg0d7shq"}]}],objName:"Ops.Trigger.Sequence"},{id:"ufahij8ty",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Update",portOut:"trigger",objIn:"mzkgli6x9",objOut:"ufahij8ty"}]},{name:"index",value:0},{name:"value",links:[{portIn:"HTML Element",portOut:"value",objIn:"smmo71xim",objOut:"ufahij8ty"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"smmo71xim",uiAttribs:{},portsOut:[{name:"Dataset",links:[{portIn:"data",portOut:"Dataset",objIn:"3omq1x4rj",objOut:"smmo71xim"}]}],objName:"Ops.Team.ACAR.DataSet"},{id:"3omq1x4rj",uiAttribs:{},portsIn:[{name:"Key",value:"filter"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"mzkgli6x9",objOut:"3omq1x4rj"}]}],objName:"Ops.Json.ObjectGetString"},{id:"mzkgli6x9",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushString"},{id:"x7xzzzuk0",uiAttribs:{},portsIn:[{name:"Variable",value:"activeFilters"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"sn2o87fvv",objOut:"x7xzzzuk0"}]}],objName:"Ops.Vars.VarTriggerArray"},{id:"sn2o87fvv",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_filters"}],objName:"Ops.Trigger.TriggerSend"},{id:"ks5z185av",uiAttribs:{},portsIn:[{name:"Format index",value:0},{name:"Format",value:"X"}],portsOut:[{name:"arrayOut",links:[{portIn:"Value",portOut:"arrayOut",objIn:"x7xzzzuk0",objOut:"ks5z185av"}]},{name:"Array Length Out",value:1}],objName:"Ops.Array.ArrayUnique"},{id:"1cvse9t9k",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_filters"}],portsOut:[{name:"Triggered",links:[{portIn:"exe",portOut:"Triggered",objIn:"yc337qaqp",objOut:"1cvse9t9k"}]}],objName:"Ops.Trigger.TriggerReceive"},{id:"b7fq0b8bx",uiAttribs:{},portsIn:[{name:"Variable",value:"activeFilters"}],portsOut:[{name:"Next",links:[{portIn:"Exe",portOut:"Next",objIn:"ec6mdspwm",objOut:"b7fq0b8bx"}]},{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"ec6mdspwm",objOut:"b7fq0b8bx"}]}],objName:"Ops.Vars.TriggerVarGetArray"},{id:"6irdo7b24",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"exe",portOut:"Trigger",objIn:"ckkdzhx93",objOut:"6irdo7b24"}]},{name:"Index",links:[{portIn:"index",portOut:"Index",objIn:"9q5dbqsvy",objOut:"6irdo7b24"}]},{name:"Value",links:[{portIn:"string2",portOut:"Value",objIn:"43kfvbbr8",objOut:"6irdo7b24"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"59mrr8jka",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"exe 11",portOut:"Next",objIn:"yc337qaqp",objOut:"59mrr8jka"}]}],objName:"Ops.Trigger.TriggerButton"},{id:"s7xagz31w",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"p66e3ld02",objOut:"s7xagz31w"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"snr3q5alk",objOut:"s7xagz31w"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"p66e3ld02",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"ncxdzvl49",objOut:"p66e3ld02"}]},{name:"index",value:1321},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"6piouzu7s",objOut:"p66e3ld02"},{portIn:"Object",portOut:"value",objIn:"e3blf6r59",objOut:"p66e3ld02"},{portIn:"Object",portOut:"value",objIn:"h8te0cy9g",objOut:"p66e3ld02"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"ncxdzvl49",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"reset",portOut:"trigger 0",objIn:"ojvyyv1cq",objOut:"ncxdzvl49"}]},{name:"trigger 3",links:[{portIn:"exe",portOut:"trigger 3",objIn:"w9w44f86w",objOut:"ncxdzvl49"}]},{name:"trigger 9",links:[{portIn:"exe",portOut:"trigger 9",objIn:"e4080ltwb",objOut:"ncxdzvl49"}]}],objName:"Ops.Trigger.Sequence"},{id:"ckkdzhx93",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"exe",portOut:"then",objIn:"ojvyyv1cq",objOut:"ckkdzhx93"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"ojvyyv1cq",uiAttribs:{},portsOut:[{name:"timesTriggered",links:[{portIn:"number1",portOut:"timesTriggered",objIn:"oh5phb2t3",objOut:"ojvyyv1cq"}]}],objName:"Ops.Trigger.TriggerCounter"},{id:"oh5phb2t3",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"e4080ltwb",objOut:"oh5phb2t3"}]}],objName:"Ops.Math.Compare.Equals"},{id:"43kfvbbr8",uiAttribs:{},portsIn:[{name:"string1",value:"data."},{name:"New Line",value:0},{name:"Active",value:1}],portsOut:[{name:"result",links:[{portIn:"Path",portOut:"result",objIn:"6piouzu7s",objOut:"43kfvbbr8"},{portIn:"Path",portOut:"result",objIn:"e3blf6r59",objOut:"43kfvbbr8"}]}],objName:"Ops.String.Concat_v2"},{id:"e3blf6r59",uiAttribs:{},portsIn:[{name:"Output path if missing",value:0}],portsOut:[{name:"Output",links:[{portIn:"text",portOut:"Output",objIn:"ibipfa0f1",objOut:"e3blf6r59"}]},{name:"Found",value:0}],objName:"Ops.Data.JsonPath.ObjectGetStringByPath"},{id:"6piouzu7s",uiAttribs:{},portsOut:[{name:"Output",links:[{portIn:"Array 1",portOut:"Output",objIn:"5dhl9bb7a",objOut:"6piouzu7s"}]},{name:"Found",links:[{portIn:"Index",portOut:"Found",objIn:"5dhl9bb7a",objOut:"6piouzu7s"}]}],objName:"Ops.Data.JsonPath.ObjectGetArrayByPath"},{id:"ibipfa0f1",uiAttribs:{},portsIn:[{name:"separator",value:"///"},{name:"Numbers",value:0},{name:"Trim",value:1},{name:"Split Lines",value:0}],portsOut:[{name:"array",links:[{portIn:"Array 0",portOut:"array",objIn:"5dhl9bb7a",objOut:"ibipfa0f1"}]},{name:"length",value:0}],objName:"Ops.Array.StringToArray_v2"},{id:"5dhl9bb7a",uiAttribs:{},portsIn:[{name:"Array 2",value:0},{name:"Array 3",value:0},{name:"Array 4",value:0},{name:"Array 5",value:0},{name:"Array 6",value:0},{name:"Array 7",value:0},{name:"Array 8",value:0},{name:"Array 9",value:0}],portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"ttzb7g005",objOut:"5dhl9bb7a"}]}],objName:"Ops.Array.SwitchArray"},{id:"ttzb7g005",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"boolean",portOut:"Found",objIn:"ckkdzhx93",objOut:"ttzb7g005"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"oh47npjm7",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"kyduviy36",objOut:"oh47npjm7"}]},{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"p66e3ld02",objOut:"oh47npjm7"},{portIn:"array",portOut:"Value",objIn:"2zk7t50wp",objOut:"oh47npjm7"},{portIn:"array",portOut:"Value",objIn:"fmdtgdghg",objOut:"oh47npjm7"}]}],objName:"Ops.Vars.TriggerVarGetArray"},{id:"yc337qaqp",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"zx5laqguz",objOut:"yc337qaqp"}]},{name:"trigger 4",links:[{portIn:"Update",portOut:"trigger 4",objIn:"oh47npjm7",objOut:"yc337qaqp"}]},{name:"trigger 15",links:[{portIn:"exe",portOut:"trigger 15",objIn:"fm25d0hmk",objOut:"yc337qaqp"}]}],objName:"Ops.Trigger.Sequence"},{id:"9ynd1mw6b",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"boolean",portOut:"length",objIn:"kyduviy36",objOut:"9ynd1mw6b"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"2zk7t50wp",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Trigger",portOut:"trigger",objIn:"lkepih7as",objOut:"2zk7t50wp"}]},{name:"index",value:1321},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"lkepih7as",objOut:"2zk7t50wp"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"tui8wlybk",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"lkepih7as",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"},{name:"Number",value:0}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"tui8wlybk",objOut:"lkepih7as"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"tui8wlybk",objOut:"lkepih7as"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"e4080ltwb",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"h8te0cy9g",objOut:"e4080ltwb"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"h8te0cy9g",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"zx5laqguz",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"b7fq0b8bx",objOut:"zx5laqguz"}]},{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"9ynd1mw6b",objOut:"zx5laqguz"},{portIn:"array",portOut:"Result",objIn:"w9w44f86w",objOut:"zx5laqguz"},{portIn:"Array",portOut:"Result",objIn:"xyueb3hut",objOut:"zx5laqguz"},{portIn:"array",portOut:"Result",objIn:"xcb6203o6",objOut:"zx5laqguz"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"ec6mdspwm",uiAttribs:{},portsOut:[{name:"Trigger",links:[{portIn:"Update",portOut:"Trigger",objIn:"sjtfxm2zn",objOut:"ec6mdspwm"}]},{name:"Index",value:0},{name:"Value",links:[{portIn:"text",portOut:"Value",objIn:"ur639z8s5",objOut:"ec6mdspwm"}]}],objName:"Ops.Array.ArrayIteratorStrings"},{id:"ur639z8s5",uiAttribs:{},portsIn:[{name:"separator",value:"//"},{name:"Numbers",value:0},{name:"Trim",value:1},{name:"Split Lines",value:0}],portsOut:[{name:"array",links:[{portIn:"array",portOut:"array",objIn:"6k0qqdwqg",objOut:"ur639z8s5"},{portIn:"array",portOut:"array",objIn:"rb51ifa22",objOut:"ur639z8s5"},{portIn:"array",portOut:"array",objIn:"e95ffl5yt",objOut:"ur639z8s5"}]},{name:"length",value:0}],objName:"Ops.Array.StringToArray_v2"},{id:"6k0qqdwqg",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"result",links:[{portIn:"String",portOut:"result",objIn:"gvx3zzghe",objOut:"6k0qqdwqg"}]}],objName:"Ops.Array.ArrayGetString"},{id:"rb51ifa22",uiAttribs:{},portsIn:[{name:"index",value:1}],portsOut:[{name:"result",links:[{portIn:"String",portOut:"result",objIn:"av9a795rn",objOut:"rb51ifa22"}]}],objName:"Ops.Array.ArrayGetString"},{id:"e95ffl5yt",uiAttribs:{},portsIn:[{name:"index",value:2}],portsOut:[{name:"result",links:[{portIn:"String",portOut:"result",objIn:"kbeadt3xh",objOut:"e95ffl5yt"}]}],objName:"Ops.Array.ArrayGetString"},{id:"gvx3zzghe",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"wownqoq0u",objOut:"gvx3zzghe"}]}],objName:"Ops.String.StringTrim_v2"},{id:"av9a795rn",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Key",portOut:"Result",objIn:"d10ivf52p",objOut:"av9a795rn"}]}],objName:"Ops.String.StringTrim_v2"},{id:"kbeadt3xh",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"d10ivf52p",objOut:"kbeadt3xh"}]}],objName:"Ops.String.StringTrim_v2"},{id:"sjtfxm2zn",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"gj5ew5mk7",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"wownqoq0u",objOut:"gj5ew5mk7"}]}],objName:"Ops.Json.Object"},{id:"wownqoq0u",uiAttribs:{},portsIn:[{name:"Key",value:"Entitt"}],portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"d10ivf52p",objOut:"wownqoq0u"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"d10ivf52p",uiAttribs:{},portsOut:[{name:"Result Object",links:[{portIn:"Object",portOut:"Result Object",objIn:"sjtfxm2zn",objOut:"d10ivf52p"}]}],objName:"Ops.Json.ObjectSetString_v2"},{id:"w9w44f86w",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Exe",portOut:"trigger",objIn:"6irdo7b24",objOut:"w9w44f86w"}]},{name:"index",value:0},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"22cwahpeg",objOut:"w9w44f86w"},{portIn:"Object",portOut:"value",objIn:"2f3gi95ph",objOut:"w9w44f86w"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"22cwahpeg",uiAttribs:{},portsOut:[{name:"Keys",links:[{portIn:"Array",portOut:"Keys",objIn:"6irdo7b24",objOut:"22cwahpeg"}]},{name:"Num Keys",links:[{portIn:"number1",portOut:"Num Keys",objIn:"ute4rf2ez",objOut:"22cwahpeg"}]}],objName:"Ops.Json.ObjectKeys"},{id:"2f3gi95ph",uiAttribs:{},portsOut:[{name:"Values",links:[{portIn:"array",portOut:"Values",objIn:"9q5dbqsvy",objOut:"2f3gi95ph"}]},{name:"Num values",value:0}],objName:"Ops.Json.ObjectValuesAsArray"},{id:"9q5dbqsvy",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"SearchValue",portOut:"result",objIn:"ttzb7g005",objOut:"9q5dbqsvy"}]}],objName:"Ops.Array.ArrayGetString"},{id:"eo8z4awub",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_links"}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"xkcivl8aj",objOut:"eo8z4awub"}]},{name:"Value",links:[{portIn:"array",portOut:"Value",objIn:"xkcivl8aj",objOut:"eo8z4awub"}]}],objName:"Ops.Vars.TriggerVarGetArray"},{id:"3vlmac8a5",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"vmp18rudg",objOut:"3vlmac8a5"}]},{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"ksvqnpkw8",objOut:"3vlmac8a5"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"xkcivl8aj",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"1lqrsfq6u",objOut:"xkcivl8aj"}]},{name:"index",value:2209},{name:"value",links:[{portIn:"data",portOut:"value",objIn:"j1fw60kwo",objOut:"xkcivl8aj"},{portIn:"data",portOut:"value",objIn:"cmj0pm3b2",objOut:"xkcivl8aj"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"j1fw60kwo",uiAttribs:{},portsIn:[{name:"Key",value:"source"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"5z8bea4d0",objOut:"j1fw60kwo"},{portIn:"String",portOut:"Result",objIn:"8yh8c0jpl",objOut:"j1fw60kwo"}]}],objName:"Ops.Json.ObjectGetString"},{id:"cmj0pm3b2",uiAttribs:{},portsIn:[{name:"Key",value:"target"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"zy27frnk5",objOut:"cmj0pm3b2"},{portIn:"String",portOut:"Result",objIn:"eck84dvcl",objOut:"cmj0pm3b2"}]}],objName:"Ops.Json.ObjectGetString"},{id:"snr3q5alk",uiAttribs:{},portsIn:[{name:"Key",value:"id"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:1}],portsOut:[{name:"Result",links:[{portIn:"Array",portOut:"Result",objIn:"5z8bea4d0",objOut:"snr3q5alk"},{portIn:"Array",portOut:"Result",objIn:"zy27frnk5",objOut:"snr3q5alk"},{portIn:"array",portOut:"Result",objIn:"rvi2mzbrr",objOut:"snr3q5alk"},{portIn:"array",portOut:"Result",objIn:"6bi98x8vt",objOut:"snr3q5alk"},{portIn:"Array",portOut:"Result",objIn:"4nlepnb0g",objOut:"snr3q5alk"}]}],objName:"Ops.Patch.PaZfgnp.GetValuesFromArrayOfObjects"},{id:"1lqrsfq6u",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"8yh8c0jpl",objOut:"1lqrsfq6u"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"8yh8c0jpl",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"eck84dvcl",objOut:"8yh8c0jpl"}]}],objName:"Ops.Data.Compose.Array.CompArrayPushString"},{id:"5z8bea4d0",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"bool 1",portOut:"Found",objIn:"oz8thi06a",objOut:"5z8bea4d0"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"zy27frnk5",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"bool 2",portOut:"Found",objIn:"oz8thi06a",objOut:"zy27frnk5"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"oz8thi06a",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"1lqrsfq6u",objOut:"oz8thi06a"}]}],objName:"Ops.Boolean.And"},{id:"eck84dvcl",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushString"},{id:"kyduviy36",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"exe",portOut:"then",objIn:"lx5t2rrpf",objOut:"kyduviy36"}]},{name:"else",links:[{portIn:"exe",portOut:"else",objIn:"pc91kq7mp",objOut:"kyduviy36"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"lx5t2rrpf",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"s7xagz31w",objOut:"lx5t2rrpf"}]},{name:"trigger 6",links:[{portIn:"Update",portOut:"trigger 6",objIn:"3vlmac8a5",objOut:"lx5t2rrpf"}]},{name:"trigger 12",links:[{portIn:"Update",portOut:"trigger 12",objIn:"mfwyc22al",objOut:"lx5t2rrpf"}]},{name:"trigger 15",links:[{portIn:"Trigger",portOut:"trigger 15",objIn:"eqsss8ii1",objOut:"lx5t2rrpf"}]}],objName:"Ops.Trigger.Sequence"},{id:"43p2nv07x",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"2zk7t50wp",objOut:"43p2nv07x"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"iwamx4e9e",objOut:"43p2nv07x"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"hzr1zzt5x",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_viewXYZ"}],objName:"Ops.Trigger.TriggerSend"},{id:"91j42y0gi",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"updateNav"}],objName:"Ops.Trigger.TriggerSend"},{id:"fm25d0hmk",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Trigger",portOut:"trigger 0",objIn:"37do86e4v",objOut:"fm25d0hmk"}]},{name:"trigger 8",links:[{portIn:"Trigger",portOut:"trigger 8",objIn:"hzr1zzt5x",objOut:"fm25d0hmk"}]},{name:"trigger 15",links:[{portIn:"Trigger",portOut:"trigger 15",objIn:"91j42y0gi",objOut:"fm25d0hmk"}]}],objName:"Ops.Trigger.Sequence"},{id:"37do86e4v",uiAttribs:{},portsIn:[{name:"Named Trigger",value:"update_colors"}],objName:"Ops.Trigger.TriggerSend"},{id:"mfwyc22al",uiAttribs:{},portsIn:[{name:"Active",value:1},{name:"Clear",value:1}],portsOut:[{name:"Next",links:[{portIn:"exe",portOut:"Next",objIn:"fmdtgdghg",objOut:"mfwyc22al"}]},{name:"Result",links:[{portIn:"Value",portOut:"Result",objIn:"eqsss8ii1",objOut:"mfwyc22al"}]}],objName:"Ops.Data.Compose.Array.CompArray"},{id:"fmdtgdghg",uiAttribs:{},portsOut:[{name:"trigger",links:[{portIn:"Trigger",portOut:"trigger",objIn:"e08sofg51",objOut:"fmdtgdghg"}]},{name:"index",value:1321},{name:"value",links:[{portIn:"Object",portOut:"value",objIn:"e08sofg51",objOut:"fmdtgdghg"},{portIn:"data",portOut:"value",objIn:"zadhva5c2",objOut:"fmdtgdghg"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"vco48dvhc",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushObject"},{id:"e08sofg51",uiAttribs:{},portsIn:[{name:"Key",value:"filtered"}],portsOut:[{name:"Next",links:[{portIn:"Update",portOut:"Next",objIn:"vco48dvhc",objOut:"e08sofg51"}]},{name:"Result",links:[{portIn:"Object",portOut:"Result",objIn:"vco48dvhc",objOut:"e08sofg51"}]}],objName:"Ops.Json.TriggerObjectSetNumber"},{id:"zadhva5c2",uiAttribs:{},portsIn:[{name:"Key",value:"id"}],portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"ksvqnpkw8",objOut:"zadhva5c2"},{portIn:"SearchValue",portOut:"Result",objIn:"2wfu9t0dq",objOut:"zadhva5c2"}]}],objName:"Ops.Json.ObjectGetString"},{id:"ksvqnpkw8",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"bool 1",portOut:"Found",objIn:"c5ogv6giq",objOut:"ksvqnpkw8"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"pc91kq7mp",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"43p2nv07x",objOut:"pc91kq7mp"}]},{name:"trigger 15",links:[{portIn:"Trigger",portOut:"trigger 15",objIn:"iwamx4e9e",objOut:"pc91kq7mp"}]}],objName:"Ops.Trigger.Sequence"},{id:"iwamx4e9e",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],objName:"Ops.Vars.VarTriggerArray"},{id:"eqsss8ii1",uiAttribs:{},portsIn:[{name:"Variable",value:"d3_nodes"}],objName:"Ops.Vars.VarTriggerArray"},{id:"vmp18rudg",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"exe",portOut:"then",objIn:"kvt81d0rw",objOut:"vmp18rudg"}]},{name:"else",links:[{portIn:"Update",portOut:"else",objIn:"or17k6p1c",objOut:"vmp18rudg"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"rvi2mzbrr",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"number1",portOut:"length",objIn:"er29e72mv",objOut:"rvi2mzbrr"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"er29e72mv",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"vmp18rudg",objOut:"er29e72mv"}]}],objName:"Ops.Math.Compare.GreaterThan"},{id:"c5ogv6giq",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0},{name:"bool 10",value:0}],portsOut:[{name:"result",links:[{portIn:"Number",portOut:"result",objIn:"e08sofg51",objOut:"c5ogv6giq"}]}],objName:"Ops.Boolean.Or"},{id:"2wfu9t0dq",uiAttribs:{},portsIn:[{name:"Array",value:0}],portsOut:[{name:"Found",links:[{portIn:"bool 2",portOut:"Found",objIn:"c5ogv6giq",objOut:"2wfu9t0dq"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"or17k6p1c",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushString"},{id:"6bi98x8vt",uiAttribs:{},portsIn:[{name:"index",value:0}],portsOut:[{name:"result",links:[{portIn:"String",portOut:"result",objIn:"or17k6p1c",objOut:"6bi98x8vt"}]}],objName:"Ops.Array.ArrayGetString"},{id:"xyueb3hut",uiAttribs:{},portsIn:[{name:"Key",value:"Entitt"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],portsOut:[{name:"Result",links:[{portIn:"array",portOut:"Result",objIn:"g9tzyyuqs",objOut:"xyueb3hut"}]}],objName:"Ops.Patch.PaZfgnp.GetValuesFromArrayOfObjects"},{id:"kvt81d0rw",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"eo8z4awub",objOut:"kvt81d0rw"}]},{name:"else",links:[{portIn:"Update",portOut:"else",objIn:"4nlepnb0g",objOut:"kvt81d0rw"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"kp1p5b1ug",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"number1",portOut:"length",objIn:"qwq6um0t2",objOut:"kp1p5b1ug"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"qwq6um0t2",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"boolean",portOut:"result",objIn:"kvt81d0rw",objOut:"qwq6um0t2"}]}],objName:"Ops.Math.Compare.GreaterThan"},{id:"4nlepnb0g",uiAttribs:{},objName:"Ops.Data.Compose.Array.CompArrayPushArrayItems"},{id:"g9tzyyuqs",uiAttribs:{},portsIn:[{name:"Format index",value:0},{name:"Format",value:"X"}],portsOut:[{name:"arrayOut",links:[{portIn:"array",portOut:"arrayOut",objIn:"kp1p5b1ug",objOut:"g9tzyyuqs"}]},{name:"Array Length Out",value:0}],objName:"Ops.Array.ArrayUnique"},{id:"ute4rf2ez",uiAttribs:{},portsOut:[{name:"result",links:[{portIn:"number2",portOut:"result",objIn:"oh5phb2t3",objOut:"ute4rf2ez"}]}],objName:"Ops.Math.Multiply"},{id:"xcb6203o6",uiAttribs:{},portsOut:[{name:"length",links:[{portIn:"number2",portOut:"length",objIn:"ute4rf2ez",objOut:"xcb6203o6"}]}],objName:"Ops.Array.ArrayLength_v2"},{id:"2gujk4wks",uiAttribs:{},portsIn:[{name:"Key",value:"id"},{name:"Numbers Only",value:0},{name:"Remove empty/invalid",value:0}],objName:"Ops.Array.GetValuesFromArrayOfObjects"},{id:"5dgwe7d5m",uiAttribs:{},portsIn:[{name:"min",value:0},{name:"max",value:5},{name:"ignore outside values",value:0}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"o4cv7er1n",objOut:"5dgwe7d5m"}]}],objName:"Ops.Math.Clamp"},{id:"4om106fcp",uiAttribs:{},portsIn:[{name:"Stride",value:0},{name:"Scroll",value:0}],objName:"Ops.Ui.VizArrayTable_v2"},{id:"0dcjsbb8e",uiAttribs:{},portsIn:[{name:"Stride",value:0},{name:"Scroll",value:0}],objName:"Ops.Ui.VizArrayTable_v2"},{id:"erd0hbyvf",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0},{name:"bool 10",value:0}],portsOut:[{name:"result",links:[{portIn:"Value",portOut:"result",objIn:"kibd9f22e",objOut:"erd0hbyvf"}]}],objName:"Ops.Boolean.Or"},{id:"reeyci43n",uiAttribs:{},portsIn:[{name:"Place Name",value:"stories"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 2",portOut:"Is Current Place",objIn:"erd0hbyvf",objOut:"reeyci43n"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"f6cztcqmz",uiAttribs:{},portsIn:[{name:"Place Name",value:"stories"}],portsOut:[{name:"Is Current Place",links:[{portIn:"bool 2",portOut:"Is Current Place",objIn:"b9gq223co",objOut:"f6cztcqmz"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"b9gq223co",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0},{name:"bool 10",value:0}],portsOut:[{name:"result",links:[{portIn:"Active",portOut:"result",objIn:"gwut853ol",objOut:"b9gq223co"}]}],objName:"Ops.Boolean.Or"},{id:"5v2pxav3a",uiAttribs:{},portsIn:[{name:"Variable",value:"viewMappedZoom"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"tim2ig8eb",uiAttribs:{},portsIn:[{name:"Place Name",value:"graph"}],portsOut:[{name:"Is Current Place",links:[{portIn:"Display index",portOut:"Is Current Place",objIn:"9l1t4934r",objOut:"tim2ig8eb"}]}],objName:"Ops.Team.Plan.PlaceEquals"},{id:"q6fzo1x5i",uiAttribs:{},portsIn:[{name:"Variable",value:"mainPlanName"}],portsOut:[{name:"Value",links:[{portIn:"Plan",portOut:"Value",objIn:"tim2ig8eb",objOut:"q6fzo1x5i"}]}],objName:"Ops.Vars.VarGetString"},{id:"w61hndht7",uiAttribs:{},portsOut:[{name:"then",links:[{portIn:"Update",portOut:"then",objIn:"gnjrpicd0",objOut:"w61hndht7"}]}],objName:"Ops.Boolean.IfTrueThen_v2"},{id:"qv0dqlx6r",uiAttribs:{},portsIn:[{name:"String 2",value:"person"}],portsOut:[{name:"Result",links:[{portIn:"Boolean",portOut:"Result",objIn:"osiuexyai",objOut:"qv0dqlx6r"}]}],objName:"Ops.String.StringEquals"},{id:"osiuexyai",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"boolean",portOut:"Result",objIn:"w61hndht7",objOut:"osiuexyai"}]}],objName:"Ops.Boolean.Not"},{id:"55r93vld5",uiAttribs:{},objName:"Ops.Trigger.TriggerButton"},{id:"1pws9qiho",uiAttribs:{},portsIn:[{name:"number2",value:1}],portsOut:[{name:"result",links:[{portIn:"val",portOut:"result",objIn:"5dgwe7d5m",objOut:"1pws9qiho"}]}],objName:"Ops.Math.Subtract"},{id:"vjdy3rgyc",uiAttribs:{},portsIn:[{name:"Variable",value:"currentZoomLevel"}],portsOut:[{name:"Value",links:[{portIn:"value",portOut:"Value",objIn:"feoj1lt3y",objOut:"vjdy3rgyc"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"2g80gonfy",uiAttribs:{},portsIn:[{name:"value",value:0},{name:"old min",value:-22},{name:"old max",value:-1},{name:"new min",value:1},{name:"new max",value:7},{name:"Easing index",value:1},{name:"Easing",value:"Smoothstep"},{name:"Clamp",value:1}],portsOut:[{name:"result",value:7}],objName:"Ops.Math.MapRange"},{id:"bb8ft3udy",uiAttribs:{},portsIn:[{name:"Variable",value:"activeSplinesIndexes"}],objName:"Ops.Vars.VarSetArray_v2"},{id:"vdtthqpco",uiAttribs:{},portsIn:[{name:"Variable",value:"infoElementVisible"}],objName:"Ops.Vars.VarTriggerNumber"},{id:"9ttjmbr7b",uiAttribs:{},portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"vdtthqpco",objOut:"9ttjmbr7b"}]},{name:"Number",links:[{portIn:"Value",portOut:"Number",objIn:"vdtthqpco",objOut:"9ttjmbr7b"}]}],objName:"Ops.Number.TriggerOnChangeNumber_v2"},{id:"yb9q2iapk",uiAttribs:{},portsIn:[{name:"Variable",value:"clickedPointIndex"}],portsOut:[{name:"Next",links:[{portIn:"Trigger",portOut:"Next",objIn:"fkezpet4i",objOut:"yb9q2iapk"}]}],objName:"Ops.Vars.VarTriggerNumber"},{id:"1vttast7m",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"Point sizes",portOut:"Result",objIn:"zvu4o6ow7",objOut:"1vttast7m"}]}],objName:"Ops.Array.ArraySetNumber_v3"},{id:"zf4n8045t",uiAttribs:{},portsIn:[{name:"Variable",value:"clickedPointIndex"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"1vttast7m",objOut:"zf4n8045t"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"z9pyqztoy",uiAttribs:{},portsIn:[{name:"radius",value:.05},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:0},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:0},{name:"Draw",value:1,title:"Render mesh"}],objName:"Ops.Gl.Meshes.Circle_v3"},{id:"rw3t3en26",uiAttribs:{},portsIn:[{name:"scale",value:1},{name:"rotX",value:0},{name:"rotY",value:0},{name:"rotZ",value:0}],portsOut:[{name:"trigger",links:[{portIn:"exe",portOut:"trigger",objIn:"ktd2454oa",objOut:"rw3t3en26"}]}],objName:"Ops.Gl.Matrix.Transform"},{id:"4fityxjhn",uiAttribs:{},portsOut:[{name:"X",links:[{portIn:"posX",portOut:"X",objIn:"rw3t3en26",objOut:"4fityxjhn"}]},{name:"Y",links:[{portIn:"posY",portOut:"Y",objIn:"rw3t3en26",objOut:"4fityxjhn"}]},{name:"Z",links:[{portIn:"posZ",portOut:"Z",objIn:"rw3t3en26",objOut:"4fityxjhn"}]}],objName:"Ops.Array.Array3GetNumbers"},{id:"b0vm98k13",uiAttribs:{},portsIn:[{name:"Variable",value:"clickedPointIndex"}],portsOut:[{name:"Value",links:[{portIn:"Index",portOut:"Value",objIn:"4fityxjhn",objOut:"b0vm98k13"},{portIn:"Index",portOut:"Value",objIn:"aohy3zx0g",objOut:"b0vm98k13"}]}],objName:"Ops.Vars.VarGetNumber_v2"},{id:"bwkc0uiay",uiAttribs:{},portsIn:[{name:"colorizeTexture",value:0},{name:"Vertex Colors",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:0},{name:"Discard Transparent Pixels",value:0},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:0},{name:"billboard",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"z9pyqztoy",objOut:"bwkc0uiay"}]}],objName:"Ops.Gl.Shader.BasicMaterial_v3"},{id:"l6f466kt6",uiAttribs:{},portsIn:[{name:"Variable",value:"pointColors"}],portsOut:[{name:"Value",links:[{portIn:"Array",portOut:"Value",objIn:"aohy3zx0g",objOut:"l6f466kt6"}]}],objName:"Ops.Vars.VarGetArray_v2"},{id:"aohy3zx0g",uiAttribs:{},portsOut:[{name:"X",links:[{portIn:"r",portOut:"X",objIn:"bwkc0uiay",objOut:"aohy3zx0g"},{portIn:"r",portOut:"X",objIn:"efa0zj00g",objOut:"aohy3zx0g"}]},{name:"Y",links:[{portIn:"g",portOut:"Y",objIn:"bwkc0uiay",objOut:"aohy3zx0g"},{portIn:"g",portOut:"Y",objIn:"efa0zj00g",objOut:"aohy3zx0g"}]},{name:"Z",links:[{portIn:"b",portOut:"Z",objIn:"bwkc0uiay",objOut:"aohy3zx0g"},{portIn:"b",portOut:"Z",objIn:"efa0zj00g",objOut:"aohy3zx0g"}]},{name:"W",links:[{portIn:"a",portOut:"W",objIn:"bwkc0uiay",objOut:"aohy3zx0g"}]}],objName:"Ops.Array.Array4GetNumbers"},{id:"low8ca673",uiAttribs:{},portsIn:[{name:"radius",value:.025},{name:"innerRadius",value:0},{name:"segments",value:40},{name:"percent",value:1},{name:"steps",value:0},{name:"invertSteps",value:0},{name:"mapping index",value:0},{name:"mapping",value:"flat"},{name:"Spline",value:0},{name:"Draw",value:1,title:"Render mesh"}],objName:"Ops.Gl.Meshes.Circle_v3"},{id:"efa0zj00g",uiAttribs:{},portsIn:[{name:"a",value:.6},{name:"colorizeTexture",value:0},{name:"Vertex Colors",value:0},{name:"Alpha Mask Source index",value:0},{name:"Alpha Mask Source",value:"Luminance"},{name:"Opacity TexCoords Transform",value:0},{name:"Discard Transparent Pixels",value:0},{name:"diffuseRepeatX",value:1},{name:"diffuseRepeatY",value:1},{name:"Tex Offset X",value:0},{name:"Tex Offset Y",value:0},{name:"Crop TexCoords",value:0},{name:"billboard",value:0}],portsOut:[{name:"trigger",links:[{portIn:"render",portOut:"trigger",objIn:"low8ca673",objOut:"efa0zj00g"}]}],objName:"Ops.Gl.Shader.BasicMaterial_v3"},{id:"b1yoxezti",uiAttribs:{},portsIn:[{name:"Blendmode index",value:4},{name:"Blendmode",value:"Multiply"},{name:"Premultiplied",value:0}],portsOut:[{name:"Next",links:[{portIn:"render",portOut:"Next",objIn:"efa0zj00g",objOut:"b1yoxezti"}]}],objName:"Ops.Gl.BlendMode"},{id:"9l196rys5",uiAttribs:{},portsIn:[{name:"Variable",value:"pointColors"}],objName:"Ops.Vars.VarGetArray_v2"},{id:"ktd2454oa",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"render",portOut:"trigger 0",objIn:"bwkc0uiay",objOut:"ktd2454oa"}]},{name:"trigger 15",links:[{portIn:"Render",portOut:"trigger 15",objIn:"b1yoxezti",objOut:"ktd2454oa"}]}],objName:"Ops.Trigger.Sequence"},{id:"psxi24j9d",uiAttribs:{},portsOut:[{name:"Nav Structure",links:[{portIn:"Data",portOut:"Nav Structure",objIn:"yd20s8mxz",objOut:"psxi24j9d"}]}],objName:"Ops.Team.ACAR.PrepareNav"},{id:"9fmiu2hhd",uiAttribs:{},portsIn:[{name:"Query",value:".acar .filters .item > .input input[type='text']"},{name:"Mode index",value:0},{name:"Mode",value:"document"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"Elements",portOut:"Elements",objIn:"meqid5a0t",objOut:"9fmiu2hhd"}]}],objName:"Ops.Html.QuerySelectorAll"},{id:"meqid5a0t",uiAttribs:{},portsIn:[{name:"Event Name",value:"input"},{name:"Use Capture",value:0},{name:"Prevent Default",value:1},{name:"Stop Propagation",value:1}],portsOut:[{name:"Event Trigger",links:[{portIn:"exe",portOut:"Event Trigger",objIn:"2c40iii4b",objOut:"meqid5a0t"}]},{name:"Index",value:1},{name:"Event Element",links:[{portIn:"HTML Element",portOut:"Event Element",objIn:"zi62pj89f",objOut:"meqid5a0t"},{portIn:"data",portOut:"Event Element",objIn:"5iqjk6qql",objOut:"meqid5a0t"}]}],objName:"Ops.Html.Event.ElementsArrayEventHandler"},{id:"7ciio4042",uiAttribs:{},portsIn:[{name:"Count Overlay",value:1}],portsOut:[{name:"Count",value:11}],objName:"Ops.Ui.VizTrigger"},{id:"ib42ruw5y",uiAttribs:{},portsIn:[{name:"Query",value:":scope ul li[data-path]"},{name:"Mode index",value:2},{name:"Mode",value:"element"},{name:"Type index",value:0},{name:"Type",value:"text/html"},{name:"Document",value:"xml"}],portsOut:[{name:"Elements",links:[{portIn:"array",portOut:"Elements",objIn:"i0fwmwvdr",objOut:"ib42ruw5y"}]}],objName:"Ops.Patch.PaZfgnp.QuerySelectorAllElement"},{id:"zi62pj89f",uiAttribs:{},portsIn:[{name:"Query",value:"li"}],portsOut:[{name:"Element",links:[{portIn:"Element",portOut:"Element",objIn:"ib42ruw5y",objOut:"zi62pj89f"}]}],objName:"Ops.Patch.PaZfgnp.Closest"},{id:"i0fwmwvdr",uiAttribs:{},portsOut:[{name:"index",value:1036},{name:"value",links:[{portIn:"Number 0",portOut:"value",objIn:"jpco6uutf",objOut:"i0fwmwvdr"}]}],objName:"Ops.Array.ArrayIteratorObjects"},{id:"2c40iii4b",uiAttribs:{},portsOut:[{name:"trigger 0",links:[{portIn:"Update",portOut:"trigger 0",objIn:"ib42ruw5y",objOut:"2c40iii4b"}]},{name:"trigger 1",links:[{portIn:"exe",portOut:"trigger 1",objIn:"i0fwmwvdr",objOut:"2c40iii4b"}]}],objName:"Ops.Trigger.Sequence"},{id:"5iqjk6qql",uiAttribs:{},portsIn:[{name:"Key",value:"value"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"d16djkg3c",objOut:"5iqjk6qql"},{portIn:"String",portOut:"Result",objIn:"mjc1n60j7",objOut:"5iqjk6qql"}]}],objName:"Ops.Json.ObjectGetString"},{id:"rcho8kvnt",uiAttribs:{},portsOut:[{name:"Dataset",links:[{portIn:"data",portOut:"Dataset",objIn:"t22iiy61b",objOut:"rcho8kvnt"}]}],objName:"Ops.Team.ACAR.DataSet"},{id:"t22iiy61b",uiAttribs:{},portsIn:[{name:"Key",value:"path"}],portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"9dcmvj1a2",objOut:"t22iiy61b"}]}],objName:"Ops.Json.ObjectGetString"},{id:"bldoqv27y",uiAttribs:{},portsOut:[{name:"Found",links:[{portIn:"bool 1",portOut:"Found",objIn:"y640lezyg",objOut:"bldoqv27y"}]},{name:"Index",value:-1}],objName:"Ops.String.StringContains_v2"},{id:"jpco6uutf",uiAttribs:{},portsOut:[{name:"Output 0",links:[{portIn:"HTML Element",portOut:"Output 0",objIn:"fgatt0ft4",objOut:"jpco6uutf"}]},{name:"Output 1",links:[{portIn:"HTML Element",portOut:"Output 1",objIn:"rcho8kvnt",objOut:"jpco6uutf"}]},{name:"Output 2",links:[{portIn:"Object in",portOut:"Output 2",objIn:"b30ojp9aj",objOut:"jpco6uutf"}]}],objName:"Ops.Json.SequenceObjects_v2"},{id:"b30ojp9aj",uiAttribs:{},portsOut:[{name:"Index 0 Object",links:[{portIn:"HTML Element",portOut:"Index 0 Object",objIn:"7hqes2257",objOut:"b30ojp9aj"}]},{name:"Index 1 Object",links:[{portIn:"HTML Element",portOut:"Index 1 Object",objIn:"5j47wwwot",objOut:"b30ojp9aj"}]}],objName:"Ops.Json.RouteObject"},{id:"5j47wwwot",uiAttribs:{},portsIn:[{name:"Classname",value:"hidden"}],objName:"Ops.Html.CSS.ElementRemoveClass"},{id:"7hqes2257",uiAttribs:{},portsIn:[{name:"Classname",value:"hidden"}],objName:"Ops.Html.CSS.ElementAddClass"},{id:"y640lezyg",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0}],portsOut:[{name:"result",links:[{portIn:"index",portOut:"result",objIn:"b30ojp9aj",objOut:"y640lezyg"}]}],objName:"Ops.Boolean.Or"},{id:"d16djkg3c",uiAttribs:{},portsIn:[{name:"Invalid if null",value:1},{name:"Invalid if undefined",value:1},{name:"Invalid if empty",value:1},{name:"Invalid if 0",value:1}],portsOut:[{name:"Last Valid String",value:"adold"},{name:"Is Valid",links:[{portIn:"Boolean",portOut:"Is Valid",objIn:"y0y9hghuv",objOut:"d16djkg3c"}]}],objName:"Ops.String.FilterValidString"},{id:"y0y9hghuv",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"bool 2",portOut:"Result",objIn:"y640lezyg",objOut:"y0y9hghuv"}]}],objName:"Ops.Boolean.Not"},{id:"mjc1n60j7",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"SearchValue",portOut:"Result",objIn:"bldoqv27y",objOut:"mjc1n60j7"}]}],objName:"Ops.String.Lowercase_v2"},{id:"9dcmvj1a2",uiAttribs:{},portsOut:[{name:"Result",links:[{portIn:"String",portOut:"Result",objIn:"bldoqv27y",objOut:"9dcmvj1a2"}]}],objName:"Ops.String.Lowercase_v2"},{id:"fgatt0ft4",uiAttribs:{},portsOut:[{name:"Classes",links:[{portIn:"Array",portOut:"Classes",objIn:"dkeacdmef",objOut:"fgatt0ft4"},{portIn:"Array",portOut:"Classes",objIn:"048kgc1ml",objOut:"fgatt0ft4"}]}],objName:"Ops.Team.ACAR.ClassList"},{id:"dkeacdmef",uiAttribs:{},portsIn:[{name:"SearchValue",value:"selected"}],portsOut:[{name:"Found",links:[{portIn:"bool 1",portOut:"Found",objIn:"ji8qradfn",objOut:"dkeacdmef"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"048kgc1ml",uiAttribs:{},portsIn:[{name:"SearchValue",value:"filtered"}],portsOut:[{name:"Found",links:[{portIn:"bool 2",portOut:"Found",objIn:"ji8qradfn",objOut:"048kgc1ml"}]},{name:"Index",value:-1}],objName:"Ops.String.ArrayContainsString"},{id:"ji8qradfn",uiAttribs:{},portsIn:[{name:"bool 3",value:0},{name:"bool 4",value:0},{name:"bool 5",value:0},{name:"bool 6",value:0},{name:"bool 7",value:0},{name:"bool 8",value:0},{name:"bool 9",value:0},{name:"bool 10",value:0}],portsOut:[{name:"result",links:[{portIn:"bool 10",portOut:"result",objIn:"y640lezyg",objOut:"ji8qradfn"}]}],objName:"Ops.Boolean.Or"}],export:{time:"2025-03-11 18:22",service:"github",exportNumber:272}};if(!CABLES.exportedPatch){CABLES.exportedPatch=CABLES.exportedPatches["aZfgnp"]}"use strict";var CABLES=CABLES||{};CABLES.OPS=CABLES.OPS||{};var Ops=Ops||{};Ops.Gl=Ops.Gl||{};Ops.Ui=Ops.Ui||{};Ops.Anim=Ops.Anim||{};Ops.Data=Ops.Data||{};Ops.Html=Ops.Html||{};Ops.Json=Ops.Json||{};Ops.Math=Ops.Math||{};Ops.Team=Ops.Team||{};Ops.Vars=Ops.Vars||{};Ops.Array=Ops.Array||{};Ops.Color=Ops.Color||{};Ops.Patch=Ops.Patch||{};Ops.Cables=Ops.Cables||{};Ops.Number=Ops.Number||{};Ops.String=Ops.String||{};Ops.Boolean=Ops.Boolean||{};Ops.Devices=Ops.Devices||{};Ops.Sidebar=Ops.Sidebar||{};Ops.Trigger=Ops.Trigger||{};Ops.Website=Ops.Website||{};Ops.Graphics=Ops.Graphics||{};Ops.Html.CSS=Ops.Html.CSS||{};Ops.Extension=Ops.Extension||{};Ops.Gl.Matrix=Ops.Gl.Matrix||{};Ops.Gl.Meshes=Ops.Gl.Meshes||{};Ops.Gl.Shader=Ops.Gl.Shader||{};Ops.Team.ACAR=Ops.Team.ACAR||{};Ops.Team.Plan=Ops.Team.Plan||{};Ops.Html.Event=Ops.Html.Event||{};Ops.Html.Utils=Ops.Html.Utils||{};Ops.String.File=Ops.String.File||{};Ops.Data.Compose=Ops.Data.Compose||{};Ops.Math.Compare=Ops.Math.Compare||{};Ops.Data.JsonPath=Ops.Data.JsonPath||{};Ops.Devices.Mouse=Ops.Devices.Mouse||{};Ops.Html.Elements=Ops.Html.Elements||{};Ops.Patch.PaZfgnp=Ops.Patch.PaZfgnp||{};Ops.String.Base64=Ops.String.Base64||{};Ops.Gl.ImageCompose=Ops.Gl.ImageCompose||{};Ops.Data.Compose.Array=Ops.Data.Compose.Array||{};Ops.Data.Compose.Object=Ops.Data.Compose.Object||{};Ops.Graphics.Intersection=Ops.Graphics.Intersection||{};Ops.Extension.HtmlElementArray=Ops.Extension.HtmlElementArray||{};Ops.Team.ACAR.Data=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const n=t.attachments={inc_gen_ports_js:'const port_730z43avr=op.inTrigger("730z43avr");\nport_730z43avr.setUiAttribs({title:"update",});\nport_730z43avr.setUiAttribs({"values":[""]});\n\nconst port_o23wa0mqe=op.inArray("o23wa0mqe");\nport_o23wa0mqe.setUiAttribs({title:"gruppen",});\nport_o23wa0mqe.setUiAttribs({"values":[""]});\n\nconst port_v05oytwcd=op.inArray("v05oytwcd");\nport_v05oytwcd.setUiAttribs({title:"personen",});\nport_v05oytwcd.setUiAttribs({"values":[""]});\n\nconst port_rto7lw458=op.inArray("rto7lw458");\nport_rto7lw458.setUiAttribs({title:"ausstellungen",});\nport_rto7lw458.setUiAttribs({"values":[""]});\n\nconst port_e30lutyuo=op.inArray("e30lutyuo");\nport_e30lutyuo.setUiAttribs({title:"publikationen",});\nport_e30lutyuo.setUiAttribs({"values":[""]});\n\nconst port_r7blsc36u=op.inObject("r7blsc36u");\nport_r7blsc36u.setUiAttribs({title:"filters",});\nport_r7blsc36u.setUiAttribs({"values":[""]});\n\nconst port_9mf4x6iay=op.outArray("9mf4x6iay");\nport_9mf4x6iay.setUiAttribs({title:"d3 nodes",});\nport_9mf4x6iay.setUiAttribs({"values":[""]});\n\nconst port_ncrwvgje9=op.outArray("ncrwvgje9");\nport_ncrwvgje9.setUiAttribs({title:"d3 links",});\nport_ncrwvgje9.setUiAttribs({"values":[""]});\n\nop.initInnerPorts=function(addedOps)\n{\n  for(let i=0;i<addedOps.length;i++)\n  {\n    if(addedOps[i].innerInput)\n    {\nconst innerOut_730z43avr = addedOps[i].outTrigger("innerOut_730z43avr");\ninnerOut_730z43avr.setUiAttribs({title:"update"});\nport_730z43avr.onTriggered = () => { innerOut_730z43avr.trigger(); };\n\nconst innerOut_o23wa0mqe = addedOps[i].outArray("innerOut_o23wa0mqe");\ninnerOut_o23wa0mqe.setUiAttribs({title:"gruppen"});\nport_o23wa0mqe.on("change", (a,v) => { innerOut_o23wa0mqe.setRef(a); });\n\nconst innerOut_v05oytwcd = addedOps[i].outArray("innerOut_v05oytwcd");\ninnerOut_v05oytwcd.setUiAttribs({title:"personen"});\nport_v05oytwcd.on("change", (a,v) => { innerOut_v05oytwcd.setRef(a); });\n\nconst innerOut_rto7lw458 = addedOps[i].outArray("innerOut_rto7lw458");\ninnerOut_rto7lw458.setUiAttribs({title:"ausstellungen"});\nport_rto7lw458.on("change", (a,v) => { innerOut_rto7lw458.setRef(a); });\n\nconst innerOut_e30lutyuo = addedOps[i].outArray("innerOut_e30lutyuo");\ninnerOut_e30lutyuo.setUiAttribs({title:"publikationen"});\nport_e30lutyuo.on("change", (a,v) => { innerOut_e30lutyuo.setRef(a); });\n\nconst innerOut_r7blsc36u = addedOps[i].outObject("innerOut_r7blsc36u");\ninnerOut_r7blsc36u.setUiAttribs({title:"filters"});\nport_r7blsc36u.on("change", (a,v) => { innerOut_r7blsc36u.setRef(a); });\n\n    }\nif(addedOps[i].innerOutput)\n{\nconst innerIn_9mf4x6iay = addedOps[i].inArray("innerIn_9mf4x6iay");\ninnerIn_9mf4x6iay.setUiAttribs({title:"d3 nodes"});\ninnerIn_9mf4x6iay.on("change", (a,v) => { port_9mf4x6iay.setRef(a); });\n\nconst innerIn_ncrwvgje9 = addedOps[i].inArray("innerIn_ncrwvgje9");\ninnerIn_ncrwvgje9.setUiAttribs({title:"d3 links"});\ninnerIn_ncrwvgje9.on("change", (a,v) => { port_ncrwvgje9.setRef(a); });\n\n}\n}\n};\n',subpatch_json:'{"ops":[{"id":"bp0-0","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"Changed","links":[{"portIn":"In Trigger","portOut":"Changed","objIn":"bp0-18","objOut":"bp0-0"}]},{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-9","objOut":"bp0-0"}]}],"objName":"Ops.Trigger.TriggerOnChangeArray"},{"id":"bp0-1","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"Changed","links":[{"portIn":"In Trigger","portOut":"Changed","objIn":"bp0-18","objOut":"bp0-1"}]},{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-10","objOut":"bp0-1"}]}],"objName":"Ops.Trigger.TriggerOnChangeArray"},{"id":"bp0-2","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 4","value":0},{"name":"Array 5","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-6","objOut":"bp0-2"},{"portIn":"Array","portOut":"Result","objIn":"bp0-33","objOut":"bp0-2"}]},{"name":"Array length","value":222}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-3","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"trigger 0","links":[{"portIn":"9izygoo74","portOut":"trigger 0","objIn":"bp0-85","objOut":"bp0-3"}]},{"name":"trigger 1","links":[{"portIn":"9izygoo74","portOut":"trigger 1","objIn":"bp0-86","objOut":"bp0-3"},{"portIn":"9izygoo74","portOut":"trigger 1","objIn":"bp0-87","objOut":"bp0-3"},{"portIn":"9izygoo74","portOut":"trigger 1","objIn":"bp0-88","objOut":"bp0-3"}]},{"name":"trigger 2","links":[{"portIn":"n7i7hux58","portOut":"trigger 2","objIn":"bp0-111","objOut":"bp0-3"}]},{"name":"trigger 3","links":[{"portIn":"n7i7hux58","portOut":"trigger 3","objIn":"bp0-121","objOut":"bp0-3"}]},{"name":"trigger 4","links":[{"portIn":"n7i7hux58","portOut":"trigger 4","objIn":"bp0-122","objOut":"bp0-3"}]},{"name":"trigger 5","links":[{"portIn":"n7i7hux58","portOut":"trigger 5","objIn":"bp0-112","objOut":"bp0-3"}]},{"name":"trigger 6","links":[{"portIn":"n7i7hux58","portOut":"trigger 6","objIn":"bp0-113","objOut":"bp0-3"}]},{"name":"trigger 7","links":[{"portIn":"n7i7hux58","portOut":"trigger 7","objIn":"bp0-114","objOut":"bp0-3"}]},{"name":"trigger 8","links":[{"portIn":"n7i7hux58","portOut":"trigger 8","objIn":"bp0-115","objOut":"bp0-3"}]},{"name":"trigger 9","links":[{"portIn":"n7i7hux58","portOut":"trigger 9","objIn":"bp0-116","objOut":"bp0-3"}]},{"name":"trigger 10","links":[{"portIn":"n7i7hux58","portOut":"trigger 10","objIn":"bp0-117","objOut":"bp0-3"}]},{"name":"trigger 11","links":[{"portIn":"n7i7hux58","portOut":"trigger 11","objIn":"bp0-118","objOut":"bp0-3"}]},{"name":"trigger 12","links":[{"portIn":"n7i7hux58","portOut":"trigger 12","objIn":"bp0-119","objOut":"bp0-3"}]},{"name":"trigger 13","links":[{"portIn":"n7i7hux58","portOut":"trigger 13","objIn":"bp0-120","objOut":"bp0-3"},{"portIn":"n7i7hux58","portOut":"trigger 13","objIn":"bp0-123","objOut":"bp0-3"},{"portIn":"n7i7hux58","portOut":"trigger 13","objIn":"bp0-128","objOut":"bp0-3"}]},{"name":"trigger 15","links":[{"portIn":"exe 1","portOut":"trigger 15","objIn":"bp0-62","objOut":"bp0-3"}]}],"objName":"Ops.Trigger.Sequence"},{"id":"bp0-4","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"innerOut_730z43avr","title":"update","links":[{"portIn":"In Trigger","portOut":"innerOut_730z43avr","objIn":"bp0-18","objOut":"bp0-4"}]},{"name":"innerOut_o23wa0mqe","title":"gruppen","links":[{"portIn":"Array","portOut":"innerOut_o23wa0mqe","objIn":"bp0-0","objOut":"bp0-4"}]},{"name":"innerOut_v05oytwcd","title":"personen","links":[{"portIn":"Array","portOut":"innerOut_v05oytwcd","objIn":"bp0-1","objOut":"bp0-4"}]},{"name":"innerOut_rto7lw458","title":"ausstellungen","links":[{"portIn":"Array","portOut":"innerOut_rto7lw458","objIn":"bp0-17","objOut":"bp0-4"}]},{"name":"innerOut_e30lutyuo","title":"publikationen","links":[{"portIn":"Array","portOut":"innerOut_e30lutyuo","objIn":"bp0-71","objOut":"bp0-4"}]},{"name":"innerOut_r7blsc36u","title":"filters"}],"objName":"Ops.Ui.SubPatchInput"},{"id":"bp0-5","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"innerIn_9mf4x6iay","title":"d3 nodes"},{"name":"innerIn_ncrwvgje9","title":"d3 links"}],"objName":"Ops.Ui.SubPatchOutput"},{"id":"bp0-6","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_nodes"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-7","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_nodes"}],"portsOut":[{"name":"Value","links":[{"portIn":"innerIn_9mf4x6iay","portOut":"Value","objIn":"bp0-5","objOut":"bp0-7"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-8","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_links"}],"portsOut":[{"name":"Value","links":[{"portIn":"innerIn_ncrwvgje9","portOut":"Value","objIn":"bp0-5","objOut":"bp0-8"},{"portIn":"Array","portOut":"Value","objIn":"bp0-124","objOut":"bp0-8"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-9","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_groups"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-10","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-11","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Named Trigger","value":"data_update"}],"objName":"Ops.Trigger.TriggerSend"},{"id":"bp0-12","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Named Trigger","value":"data_update"}],"portsOut":[{"name":"Triggered","links":[{"portIn":"exe","portOut":"Triggered","objIn":"bp0-64","objOut":"bp0-12"}]}],"objName":"Ops.Trigger.TriggerReceive"},{"id":"bp0-13","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"Changed","links":[{"portIn":"Trigger","portOut":"Changed","objIn":"bp0-11","objOut":"bp0-13"}]},{"name":"Result","links":[{"portIn":"Object","portOut":"Result","objIn":"bp0-77","objOut":"bp0-13"},{"portIn":"Object","portOut":"Result","objIn":"bp0-79","objOut":"bp0-13"},{"portIn":"Object","portOut":"Result","objIn":"bp0-81","objOut":"bp0-13"},{"portIn":"Object","portOut":"Result","objIn":"bp0-83","objOut":"bp0-13"}]}],"objName":"Ops.Trigger.TriggerOnChangeObject"},{"id":"bp0-14","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-112","objOut":"bp0-14"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-15","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_groups"}],"portsOut":[{"name":"Value","links":[{"portIn":"9h9xdpi46","portOut":"Value","objIn":"bp0-104","objOut":"bp0-15"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-16","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"0qjh9wa1n","portOut":"Value","objIn":"bp0-86","objOut":"bp0-16"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-17","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"Changed","links":[{"portIn":"In Trigger","portOut":"Changed","objIn":"bp0-18","objOut":"bp0-17"}]},{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-19","objOut":"bp0-17"}]}],"objName":"Ops.Trigger.TriggerOnChangeArray"},{"id":"bp0-18","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Milliseconds","value":500}],"portsOut":[{"name":"Out Trigger","links":[{"portIn":"Trigger","portOut":"Out Trigger","objIn":"bp0-11","objOut":"bp0-18"}]},{"name":"Progress","value":0.204}],"objName":"Ops.Trigger.TriggerLimiter"},{"id":"bp0-19","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_exhibitions"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-20","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_groups"}],"portsOut":[{"name":"Value","links":[{"portIn":"0qjh9wa1n","portOut":"Value","objIn":"bp0-85","objOut":"bp0-20"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-21","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_exhibitions"}],"portsOut":[{"name":"Value","links":[{"portIn":"0qjh9wa1n","portOut":"Value","objIn":"bp0-87","objOut":"bp0-21"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-22","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_groups"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-111","objOut":"bp0-22"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-23","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-111","objOut":"bp0-23"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-24","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-112","objOut":"bp0-24"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-25","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-113","objOut":"bp0-25"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-26","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-113","objOut":"bp0-26"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-27","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-114","objOut":"bp0-27"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-28","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-114","objOut":"bp0-28"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-29","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-115","objOut":"bp0-29"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-30","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-115","objOut":"bp0-30"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-31","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-116","objOut":"bp0-31"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-32","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_group_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-116","objOut":"bp0-32"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-33","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Path","value":"0.id"}],"portsOut":[{"name":"Output","links":[{"portIn":"Value","portOut":"Output","objIn":"bp0-34","objOut":"bp0-33"}]},{"name":"Found","value":true}],"objName":"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{"id":"bp0-34","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_nodes_ids"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-35","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 0","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"Array 1","portOut":"Result","objIn":"bp0-57","objOut":"bp0-35"}]},{"name":"Array length","value":0}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-36","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"trigger","links":[{"portIn":"exe","portOut":"trigger","objIn":"bp0-38","objOut":"bp0-36"}]},{"name":"index","value":2365},{"name":"value","links":[{"portIn":"data","portOut":"value","objIn":"bp0-40","objOut":"bp0-36"},{"portIn":"data","portOut":"value","objIn":"bp0-41","objOut":"bp0-36"},{"portIn":"Object","portOut":"value","objIn":"bp0-39","objOut":"bp0-36"}]}],"objName":"Ops.Array.ArrayIteratorObjects"},{"id":"bp0-37","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Active","value":1},{"name":"Clear","value":1}],"portsOut":[{"name":"Next","links":[{"portIn":"exe","portOut":"Next","objIn":"bp0-36","objOut":"bp0-37"}]},{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-46","objOut":"bp0-37"}]}],"objName":"Ops.Data.Compose.Array.CompArray"},{"id":"bp0-38","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"then","links":[{"portIn":"Update","portOut":"then","objIn":"bp0-39","objOut":"bp0-38"}]}],"objName":"Ops.Boolean.IfTrueThen_v2"},{"id":"bp0-39","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"objName":"Ops.Data.Compose.Array.CompArrayPushObject"},{"id":"bp0-40","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Key","value":"source"}],"portsOut":[{"name":"Result","links":[{"portIn":"SearchValue","portOut":"Result","objIn":"bp0-43","objOut":"bp0-40"}]}],"objName":"Ops.Json.ObjectGetString"},{"id":"bp0-41","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Key","value":"target"}],"portsOut":[{"name":"Result","links":[{"portIn":"SearchValue","portOut":"Result","objIn":"bp0-45","objOut":"bp0-41"}]}],"objName":"Ops.Json.ObjectGetString"},{"id":"bp0-42","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"result","links":[{"portIn":"boolean","portOut":"result","objIn":"bp0-38","objOut":"bp0-42"}]}],"objName":"Ops.Boolean.And"},{"id":"bp0-43","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"Found","links":[{"portIn":"bool 1","portOut":"Found","objIn":"bp0-42","objOut":"bp0-43"}]},{"name":"Index","value":219}],"objName":"Ops.String.ArrayContainsString"},{"id":"bp0-44","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_nodes_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"Array","portOut":"Value","objIn":"bp0-43","objOut":"bp0-44"},{"portIn":"Array","portOut":"Value","objIn":"bp0-45","objOut":"bp0-44"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-45","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"Found","links":[{"portIn":"bool 2","portOut":"Found","objIn":"bp0-42","objOut":"bp0-45"}]},{"name":"Index","value":-1}],"objName":"Ops.String.ArrayContainsString"},{"id":"bp0-46","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_links"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-47","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_exhibitions"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-117","objOut":"bp0-47"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-48","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-117","objOut":"bp0-48"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-49","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_exhibitions"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-118","objOut":"bp0-49"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-50","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-118","objOut":"bp0-50"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-51","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_exhibitions"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-119","objOut":"bp0-51"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-52","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-119","objOut":"bp0-52"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-53","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_exhibitions"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-120","objOut":"bp0-53"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-54","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_group_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-120","objOut":"bp0-54"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-55","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 4","value":0},{"name":"Array 5","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"Array 2","portOut":"Result","objIn":"bp0-57","objOut":"bp0-55"}]},{"name":"Array length","value":0}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-56","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 3","value":0},{"name":"Array 4","value":0},{"name":"Array 5","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"Array 0","portOut":"Result","objIn":"bp0-57","objOut":"bp0-56"}]},{"name":"Array length","value":2288}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-57","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 4","value":0},{"name":"Array 5","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"array","portOut":"Result","objIn":"bp0-36","objOut":"bp0-57"}]},{"name":"Array length","value":2366}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-58","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Path","value":"0.source"}],"portsOut":[{"name":"Output","links":[{"portIn":"Array 0","portOut":"Output","objIn":"bp0-60","objOut":"bp0-58"}]},{"name":"Found","value":false}],"objName":"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{"id":"bp0-59","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Path","value":"0.target"}],"portsOut":[{"name":"Output","links":[{"portIn":"Array 1","portOut":"Output","objIn":"bp0-60","objOut":"bp0-59"}]},{"name":"Found","value":false}],"objName":"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{"id":"bp0-60","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 2","value":0},{"name":"Array 3","value":0},{"name":"Array 4","value":0},{"name":"Array 5","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"array","portOut":"Result","objIn":"bp0-61","objOut":"bp0-60"}]},{"name":"Array length","value":0}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-61","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Format index","value":0},{"name":"Format","value":"X"}],"portsOut":[{"name":"arrayOut","links":[{"portIn":"Value","portOut":"arrayOut","objIn":"bp0-63","objOut":"bp0-61"}]},{"name":"Array Length Out","value":0}],"objName":"Ops.Array.ArrayUnique"},{"id":"bp0-62","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"trigger 0","links":[{"portIn":"Update","portOut":"trigger 0","objIn":"bp0-37","objOut":"bp0-62"}]}],"objName":"Ops.Trigger.Sequence"},{"id":"bp0-63","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_linked_node_ids"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-64","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"trigger 0","links":[{"portIn":"fwlh2wbfd","portOut":"trigger 0","objIn":"bp0-104","objOut":"bp0-64"}]},{"name":"trigger 1","links":[{"portIn":"fwlh2wbfd","portOut":"trigger 1","objIn":"bp0-107","objOut":"bp0-64"}]},{"name":"trigger 2","links":[{"portIn":"fwlh2wbfd","portOut":"trigger 2","objIn":"bp0-106","objOut":"bp0-64"}]},{"name":"trigger 3","links":[{"portIn":"fwlh2wbfd","portOut":"trigger 3","objIn":"bp0-105","objOut":"bp0-64"}]},{"name":"trigger 15","links":[{"portIn":"exe","portOut":"trigger 15","objIn":"bp0-3","objOut":"bp0-64"}]}],"objName":"Ops.Trigger.Sequence"},{"id":"bp0-65","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_all_filter_ids"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-66","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_groups"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-121","objOut":"bp0-66"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-67","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-121","objOut":"bp0-67"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-68","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_groups"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-122","objOut":"bp0-68"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-69","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-122","objOut":"bp0-69"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-70","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_publications"}],"portsOut":[{"name":"Value","links":[{"portIn":"0qjh9wa1n","portOut":"Value","objIn":"bp0-88","objOut":"bp0-70"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-71","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsOut":[{"name":"Changed","links":[{"portIn":"In Trigger","portOut":"Changed","objIn":"bp0-18","objOut":"bp0-71"}]},{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-72","objOut":"bp0-71"}]}],"objName":"Ops.Trigger.TriggerOnChangeArray"},{"id":"bp0-72","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_publications"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-73","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 2","value":0},{"name":"Array 3","value":0},{"name":"Array 4","value":0},{"name":"Array 5","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"Array 3","portOut":"Result","objIn":"bp0-57","objOut":"bp0-73"}]},{"name":"Array length","value":78}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-74","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_publications"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-123","objOut":"bp0-74"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-75","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-123","objOut":"bp0-75"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-76","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_groups"}],"objName":"Ops.Vars.VarSetObject_v2"},{"id":"bp0-77","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Key","value":"groups"}],"portsOut":[{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-76","objOut":"bp0-77"}]}],"objName":"Ops.Json.ObjectGetObject_v2"},{"id":"bp0-78","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_persons"}],"objName":"Ops.Vars.VarSetObject_v2"},{"id":"bp0-79","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Key","value":"persons"}],"portsOut":[{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-78","objOut":"bp0-79"}]}],"objName":"Ops.Json.ObjectGetObject_v2"},{"id":"bp0-80","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_exhibitions"}],"objName":"Ops.Vars.VarSetObject_v2"},{"id":"bp0-81","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Key","value":"exhibitions"}],"portsOut":[{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-80","objOut":"bp0-81"}]}],"objName":"Ops.Json.ObjectGetObject_v2"},{"id":"bp0-82","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_publications"}],"objName":"Ops.Vars.VarSetObject_v2"},{"id":"bp0-83","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Key","value":"publications"}],"portsOut":[{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-82","objOut":"bp0-83"}]}],"objName":"Ops.Json.ObjectGetObject_v2"},{"id":"bp0-84","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_groups"}],"portsOut":[{"name":"Value","links":[{"portIn":"wna5rvgax","portOut":"Value","objIn":"bp0-104","objOut":"bp0-84"}]}],"objName":"Ops.Vars.VarGetObject_v2"},{"id":"bp0-85","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"9izygoo74","title":"update"},{"name":"0qjh9wa1n","title":"data"},{"name":"amuu1ro3s","value":"ID","title":"id field"},{"name":"3x0y6h9tk","value":"Gruppenname","title":"name field"},{"name":"4az9a7m2p","value":"Entitt","title":"entity field"},{"name":"patchId","value":"v5nqd5724"}],"portsOut":[{"name":"3zn1xvhpd","title":"d3 nodes","links":[{"portIn":"Array 0","portOut":"3zn1xvhpd","objIn":"bp0-2","objOut":"bp0-85"}]}],"objName":"Ops.Team.ACAR.GetD3Nodes"},{"id":"bp0-86","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"9izygoo74","title":"update"},{"name":"0qjh9wa1n","title":"data"},{"name":"amuu1ro3s","value":"ID","title":"id field"},{"name":"3x0y6h9tk","value":"Name_str","title":"name field"},{"name":"4az9a7m2p","value":"Entitt","title":"entity field"},{"name":"patchId","value":"ksaqhnsa4"}],"portsOut":[{"name":"3zn1xvhpd","title":"d3 nodes","links":[{"portIn":"Array 1","portOut":"3zn1xvhpd","objIn":"bp0-2","objOut":"bp0-86"}]}],"objName":"Ops.Team.ACAR.GetD3Nodes"},{"id":"bp0-87","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"9izygoo74","title":"update"},{"name":"0qjh9wa1n","title":"data"},{"name":"amuu1ro3s","value":"ID","title":"id field"},{"name":"3x0y6h9tk","value":"Ausstellungsname","title":"name field"},{"name":"4az9a7m2p","value":"Entitt","title":"entity field"},{"name":"patchId","value":"syi1vn3j2"}],"portsOut":[{"name":"3zn1xvhpd","title":"d3 nodes","links":[{"portIn":"Array 2","portOut":"3zn1xvhpd","objIn":"bp0-2","objOut":"bp0-87"}]}],"objName":"Ops.Team.ACAR.GetD3Nodes"},{"id":"bp0-88","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"9izygoo74","title":"update"},{"name":"0qjh9wa1n","title":"data"},{"name":"amuu1ro3s","value":"ID","title":"id field"},{"name":"3x0y6h9tk","value":"Publikationsname","title":"name field"},{"name":"4az9a7m2p","value":"Entitt","title":"entity field"},{"name":"patchId","value":"g80fv8cst"}],"portsOut":[{"name":"3zn1xvhpd","title":"d3 nodes","links":[{"portIn":"Array 3","portOut":"3zn1xvhpd","objIn":"bp0-2","objOut":"bp0-88"}]}],"objName":"Ops.Team.ACAR.GetD3Nodes"},{"id":"bp0-89","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Path","value":"0.ID"}],"portsOut":[{"name":"Output","links":[{"portIn":"Value","portOut":"Output","objIn":"bp0-90","objOut":"bp0-89"},{"portIn":"Array 0","portOut":"Output","objIn":"bp0-103","objOut":"bp0-89"}]},{"name":"Found","value":true}],"objName":"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{"id":"bp0-90","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_group_ids"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-91","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"9h9xdpi46","portOut":"Value","objIn":"bp0-105","objOut":"bp0-91"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-92","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_persons"}],"portsOut":[{"name":"Value","links":[{"portIn":"wna5rvgax","portOut":"Value","objIn":"bp0-105","objOut":"bp0-92"}]}],"objName":"Ops.Vars.VarGetObject_v2"},{"id":"bp0-93","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Path","value":"0.ID"}],"portsOut":[{"name":"Output","links":[{"portIn":"Value","portOut":"Output","objIn":"bp0-94","objOut":"bp0-93"},{"portIn":"Array 1","portOut":"Output","objIn":"bp0-103","objOut":"bp0-93"}]},{"name":"Found","value":false}],"objName":"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{"id":"bp0-94","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-95","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_exhibitions"}],"portsOut":[{"name":"Value","links":[{"portIn":"9h9xdpi46","portOut":"Value","objIn":"bp0-106","objOut":"bp0-95"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-96","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_exhibitions"}],"portsOut":[{"name":"Value","links":[{"portIn":"wna5rvgax","portOut":"Value","objIn":"bp0-106","objOut":"bp0-96"}]}],"objName":"Ops.Vars.VarGetObject_v2"},{"id":"bp0-97","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Path","value":"0.ID"}],"portsOut":[{"name":"Output","links":[{"portIn":"Value","portOut":"Output","objIn":"bp0-98","objOut":"bp0-97"},{"portIn":"Array 2","portOut":"Output","objIn":"bp0-103","objOut":"bp0-97"}]},{"name":"Found","value":false}],"objName":"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{"id":"bp0-98","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_exhibition_ids"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-99","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_source_publications"}],"portsOut":[{"name":"Value","links":[{"portIn":"9h9xdpi46","portOut":"Value","objIn":"bp0-107","objOut":"bp0-99"}]}],"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-100","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_publications"}],"portsOut":[{"name":"Value","links":[{"portIn":"wna5rvgax","portOut":"Value","objIn":"bp0-107","objOut":"bp0-100"}]}],"objName":"Ops.Vars.VarGetObject_v2"},{"id":"bp0-101","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Path","value":"0.ID"}],"portsOut":[{"name":"Output","links":[{"portIn":"Value","portOut":"Output","objIn":"bp0-102","objOut":"bp0-101"},{"portIn":"Array 3","portOut":"Output","objIn":"bp0-103","objOut":"bp0-101"}]},{"name":"Found","value":true}],"objName":"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"},{"id":"bp0-102","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filtered_publication_ids"}],"objName":"Ops.Vars.VarSetArray_v2"},{"id":"bp0-103","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Array 4","value":0},{"name":"Array 5","value":0},{"name":"Array 6","value":0},{"name":"Array 7","value":0}],"portsOut":[{"name":"Result","links":[{"portIn":"Value","portOut":"Result","objIn":"bp0-65","objOut":"bp0-103"}]},{"name":"Array length","value":222}],"objName":"Ops.Array.ArrayMerge_v3"},{"id":"bp0-104","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"fwlh2wbfd","title":"Trigger"},{"name":"9h9xdpi46","title":"Array"},{"name":"wna5rvgax","title":"Object"},{"name":"patchId","value":"rlzax3gwg"}],"portsOut":[{"name":"0mljgk9kq","title":"Result","links":[{"portIn":"Array","portOut":"0mljgk9kq","objIn":"bp0-89","objOut":"bp0-104"}]},{"name":"8cnw4y493","title":"length","links":[{"portIn":"bool 1","portOut":"8cnw4y493","objIn":"bp0-108","objOut":"bp0-104"}]}],"objName":"Ops.Team.ACAR.FilterData"},{"id":"bp0-105","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"fwlh2wbfd","title":"Trigger"},{"name":"9h9xdpi46","title":"Array"},{"name":"wna5rvgax","title":"Object"},{"name":"patchId","value":"c3v9snqpx"}],"portsOut":[{"name":"0mljgk9kq","title":"Result","links":[{"portIn":"Array","portOut":"0mljgk9kq","objIn":"bp0-93","objOut":"bp0-105"}]},{"name":"8cnw4y493","title":"length","links":[{"portIn":"bool 2","portOut":"8cnw4y493","objIn":"bp0-108","objOut":"bp0-105"}]}],"objName":"Ops.Team.ACAR.FilterData"},{"id":"bp0-106","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"fwlh2wbfd","title":"Trigger"},{"name":"9h9xdpi46","title":"Array"},{"name":"wna5rvgax","title":"Object"},{"name":"patchId","value":"ipahx6rn6"}],"portsOut":[{"name":"0mljgk9kq","title":"Result","links":[{"portIn":"Array","portOut":"0mljgk9kq","objIn":"bp0-97","objOut":"bp0-106"}]},{"name":"8cnw4y493","title":"length","links":[{"portIn":"bool 3","portOut":"8cnw4y493","objIn":"bp0-108","objOut":"bp0-106"}]}],"objName":"Ops.Team.ACAR.FilterData"},{"id":"bp0-107","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"fwlh2wbfd","title":"Trigger"},{"name":"9h9xdpi46","title":"Array"},{"name":"wna5rvgax","title":"Object"},{"name":"patchId","value":"t8f6iwzv7"}],"portsOut":[{"name":"0mljgk9kq","title":"Result","links":[{"portIn":"Array","portOut":"0mljgk9kq","objIn":"bp0-101","objOut":"bp0-107"}]},{"name":"8cnw4y493","title":"length","links":[{"portIn":"bool 4","portOut":"8cnw4y493","objIn":"bp0-108","objOut":"bp0-107"}]}],"objName":"Ops.Team.ACAR.FilterData"},{"id":"bp0-108","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"bool 5","value":0},{"name":"bool 6","value":0},{"name":"bool 7","value":0},{"name":"bool 8","value":0},{"name":"bool 9","value":0},{"name":"bool 10","value":0}],"portsOut":[{"name":"result","links":[{"portIn":"Value","portOut":"result","objIn":"bp0-109","objOut":"bp0-108"}]}],"objName":"Ops.Boolean.Or"},{"id":"bp0-109","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Variable","value":"data_filter_enabled"}],"objName":"Ops.Vars.VarSetNumber_v2"},{"id":"bp0-110","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"objName":"Ops.Array.ArrayLength_v2"},{"id":"bp0-111","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Mitglieder","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"12i38zw1n"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 0","portOut":"j609dr0b8","objIn":"bp0-56","objOut":"bp0-111"},{"portIn":"Array","portOut":"j609dr0b8","objIn":"bp0-125","objOut":"bp0-111"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-112","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Freund","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"jt2bfd6pi"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 1","portOut":"j609dr0b8","objIn":"bp0-35","objOut":"bp0-112"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-113","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Untersttzer","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"tg6i0ai0x"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 2","portOut":"j609dr0b8","objIn":"bp0-35","objOut":"bp0-113"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-114","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Personen","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"s5nz209ww"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 3","portOut":"j609dr0b8","objIn":"bp0-35","objOut":"bp0-114"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-115","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Familie","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"j1cbwnoys"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 4","portOut":"j609dr0b8","objIn":"bp0-35","objOut":"bp0-115"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-116","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Mitglied","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"zzsnhqb7m"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 5","portOut":"j609dr0b8","objIn":"bp0-35","objOut":"bp0-116"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-117","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Kurator","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"v1o8c7fzy"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 0","portOut":"j609dr0b8","objIn":"bp0-55","objOut":"bp0-117"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-118","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Veranstalter","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"xkipbwzo1"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 1","portOut":"j609dr0b8","objIn":"bp0-55","objOut":"bp0-118"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-119","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Besucher","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"1vjpfne6d"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 2","portOut":"j609dr0b8","objIn":"bp0-55","objOut":"bp0-119"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-120","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Gruppen","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"3g1qvvbb1"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 3","portOut":"j609dr0b8","objIn":"bp0-55","objOut":"bp0-120"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-121","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Freunde","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"j8ya7rwbx"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 1","portOut":"j609dr0b8","objIn":"bp0-56","objOut":"bp0-121"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-122","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Frderer","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"8xu29ss68"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 2","portOut":"j609dr0b8","objIn":"bp0-56","objOut":"bp0-122"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-123","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Personen/Mitarbeiterinnen","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"5rv5wurb5"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 0","portOut":"j609dr0b8","objIn":"bp0-73","objOut":"bp0-123"}]}],"objName":"Ops.Team.ACAR.GetD3Links"},{"id":"bp0-124","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Filter Key","value":"hidden"},{"name":"Filter Value","value":"0"},{"name":"Invert Filter","value":0}],"portsOut":[{"name":"arrayOut","links":[{"portIn":"Array","portOut":"arrayOut","objIn":"bp0-58","objOut":"bp0-124"},{"portIn":"Array","portOut":"arrayOut","objIn":"bp0-59","objOut":"bp0-124"}]}],"objName":"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{"id":"bp0-125","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{},"portsIn":[{"name":"Filter Key","value":"hidden"},{"name":"Filter Value","value":"0"},{"name":"Invert Filter","value":0}],"portsOut":[{"name":"arrayOut","links":[{"portIn":"array","portOut":"arrayOut","objIn":"bp0-110","objOut":"bp0-125"}]}],"objName":"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"},{"id":"bp0-126","uiAttribs":{"subPatch":"lzfgfenv1"},"portsIn":[{"name":"Variable","value":"data_source_publications"}],"portsOut":[{"name":"Value","links":[{"portIn":"5ydf4tifk","portOut":"Value","objIn":"bp0-128","objOut":"bp0-126"}]}],"storage":{"ref":"bp0-126"},"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-127","uiAttribs":{"subPatch":"lzfgfenv1"},"portsIn":[{"name":"Variable","value":"data_filtered_person_ids"}],"portsOut":[{"name":"Value","links":[{"portIn":"ul0a4ym88","portOut":"Value","objIn":"bp0-128","objOut":"bp0-127"}]}],"storage":{"ref":"bp0-127"},"objName":"Ops.Vars.VarGetArray_v2"},{"id":"bp0-128","uiAttribs":{"subPatch":"lzfgfenv1"},"storage":{"blueprintVer":2,"subPatchVer":2,"ref":"bp0-128"},"portsIn":[{"name":"n7i7hux58","title":"Update"},{"name":"5ydf4tifk","title":"left objects"},{"name":"ul0a4ym88","title":"right ids"},{"name":"bpkzafijw","value":"Personen/Beitragende","title":"left array fieldname"},{"name":"3aw49ekwu","value":"ID","title":"source id fieldname"},{"name":"patchId","value":"h2vprdsdt"}],"portsOut":[{"name":"j609dr0b8","title":"links","links":[{"portIn":"Array 1","portOut":"j609dr0b8","objIn":"bp0-73","objOut":"bp0-128"}]}],"objName":"Ops.Team.ACAR.GetD3Links"}]}'};const p=t.inTrigger("730z43avr");p.setUiAttribs({title:"update"});p.setUiAttribs({values:[""]});const c=t.inArray("o23wa0mqe");c.setUiAttribs({title:"gruppen"});c.setUiAttribs({values:[""]});const b=t.inArray("v05oytwcd");b.setUiAttribs({title:"personen"});b.setUiAttribs({values:[""]});const m=t.inArray("rto7lw458");m.setUiAttribs({title:"ausstellungen"});m.setUiAttribs({values:[""]});const d=t.inArray("e30lutyuo");d.setUiAttribs({title:"publikationen"});d.setUiAttribs({values:[""]});const f=t.inObject("r7blsc36u");f.setUiAttribs({title:"filters"});f.setUiAttribs({values:[""]});const g=t.outArray("9mf4x6iay");g.setUiAttribs({title:"d3 nodes"});g.setUiAttribs({values:[""]});const h=t.outArray("ncrwvgje9");h.setUiAttribs({title:"d3 links"});h.setUiAttribs({values:[""]});t.initInnerPorts=function(e){for(let t=0;t<e.length;t++){if(e[t].innerInput){const n=e[t].outTrigger("innerOut_730z43avr");n.setUiAttribs({title:"update"});p.onTriggered=()=>{n.trigger()};const r=e[t].outArray("innerOut_o23wa0mqe");r.setUiAttribs({title:"gruppen"});c.on("change",(t,e)=>{r.setRef(t)});const a=e[t].outArray("innerOut_v05oytwcd");a.setUiAttribs({title:"personen"});b.on("change",(t,e)=>{a.setRef(t)});const o=e[t].outArray("innerOut_rto7lw458");o.setUiAttribs({title:"ausstellungen"});m.on("change",(t,e)=>{o.setRef(t)});const i=e[t].outArray("innerOut_e30lutyuo");i.setUiAttribs({title:"publikationen"});d.on("change",(t,e)=>{i.setRef(t)});const s=e[t].outObject("innerOut_r7blsc36u");s.setUiAttribs({title:"filters"});f.on("change",(t,e)=>{s.setRef(t)})}if(e[t].innerOutput){const u=e[t].inArray("innerIn_9mf4x6iay");u.setUiAttribs({title:"d3 nodes"});u.on("change",(t,e)=>{g.setRef(t)});const l=e[t].inArray("innerIn_ncrwvgje9");l.setUiAttribs({title:"d3 links"});l.on("change",(t,e)=>{h.setRef(t)})}}};const r="bp2sub_"+t.id;new CABLES.SubPatchOp(t,{subId:r});e();function e(){if(!n||!n.subpatch_json)return;const e=JSON.parse(n.subpatch_json);CABLES.Patch.replaceOpIds(e,{parentSubPatchId:r,prefixHash:r,oldIdAsRef:true,doNotUnlinkLostLinks:true});for(let t=0;t<e.ops.length;t++){e.ops[t].uiAttribs.blueprintSubpatch2=true}t.loadDependencies(e,()=>{t.patch.deSerialize(e,{opsCreated:t.initInnerPorts});if(CABLES.UI)gui.savedState.setSaved("blueprintloaded",r);t.patch.emitEvent("subpatchExpose",r);t.setStorage({blueprintVer:2});t.patch.emitEvent("subpatchExpose",r)})}}};CABLES.OPS["7d2926cc-5634-438a-9a1a-da7abb8119ed"]={f:Ops.Team.ACAR.Data,objName:"Ops.Team.ACAR.Data"};Ops.Trigger.TriggerOnChangeArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array"),r=t.outTrigger("Changed"),a=t.outArray("Result");n.onChange=function(){a.set(n.get());r.trigger()}}};CABLES.OPS["e4ddec93-4dee-422b-a402-6a0f6e469ce6"]={f:Ops.Trigger.TriggerOnChangeArray,objName:"Ops.Trigger.TriggerOnChangeArray"};Ops.Array.ArrayMerge_v3=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=8;const r=[];for(let t=0;t<n;t++){r[t]=e.inArray("Array "+t);r[t].onChange=function(){s()}}const a=e.outArray("Result"),o=e.outNumber("Array length");let i=[];function s(){i.length=0;for(let t=0;t<n;t++){const e=r[t].get();if(e)i=i.concat(e)}a.setRef(i);o.set(i.length)}}};CABLES.OPS["753d053a-04a3-44c7-abf0-ae2676ced13e"]={f:Ops.Array.ArrayMerge_v3,objName:"Ops.Array.ArrayMerge_v3"};Ops.Trigger.Sequence=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const e=o.inTrigger("exe"),n=o.inTriggerButton("Clean up connections");o.setUiAttrib({resizable:true,resizableY:false,stretchPorts:true});const r=[],i=[],a=16;let s=null,u=[];e.onTriggered=c;n.onTriggered=b;n.setUiAttribs({hideParam:true,hidePort:true});for(let e=0;e<a;e++){const m=o.outTrigger("trigger "+e);i.push(m);m.onLinkChanged=p;if(e<a-1){let t=o.inTrigger("exe "+e);t.onTriggered=c;r.push(t)}}l();function l(){u.length=0;for(let t=0;t<i.length;t++)if(i[t].links.length>0)u.push(i[t])}function p(){l();clearTimeout(s);s=setTimeout(()=>{let e=false;for(let t=0;t<i.length;t++)if(i[t].links.length>1)e=true;n.setUiAttribs({hideParam:!e});if(o.isCurrentUiOp())o.refreshParams()},60)}function c(){for(let t=0;t<u.length;t++)u[t].trigger()}function b(){let r=0;for(let n=0;n<i.length;n++){let e=[];if(i[n].links.length>1)for(let t=1;t<i[n].links.length;t++){while(i[r].links.length>0)r++;e.push(i[n].links[t]);const a=i[n].links[t].getOtherPort(i[n]);o.patch.link(o,"trigger "+r,a.op,a.name);r++}for(let t=0;t<e.length;t++)e[t].remove()}p();l()}}};CABLES.OPS["a466bc1f-06e9-4595-8849-bffb9fe22f99"]={f:Ops.Trigger.Sequence,objName:"Ops.Trigger.Sequence"};Ops.Ui.SubPatchInput=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};e.innerInput=true;const n=e.inTriggerButton("Goto SubPatchOp");n.setUiAttribs({hidePort:true});n.onTriggered=()=>{const t=e.patch.getSubPatchOuterOp(e.uiAttribs.subPatch);gui.patchView.centerSelectOp(t.id)}}};CABLES.OPS["c4e4e933-136e-479e-8de8-0b35b75d9217"]={f:Ops.Ui.SubPatchInput,objName:"Ops.Ui.SubPatchInput"};Ops.Ui.SubPatchOutput=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};t.innerOutput=true}};CABLES.OPS["02d45073-7936-4830-81ad-59a162febf1f"]={f:Ops.Ui.SubPatchOutput,objName:"Ops.Ui.SubPatchOutput"};Ops.Vars.VarSetArray_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Value",null);t.varName=t.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(t,"array",n,t.varName)}};CABLES.OPS["8088290f-45d4-4312-b4ca-184d34ca4667"]={f:Ops.Vars.VarSetArray_v2,objName:"Ops.Vars.VarSetArray_v2"};Ops.Vars.VarGetArray_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.outArray("Value");t.varName=t.inValueSelect("Variable",[],"",true);new CABLES.VarGetOpWrapper(t,"array",t.varName,n)}};CABLES.OPS["afa79294-aa9c-43bc-a49a-cade000a1de5"]={f:Ops.Vars.VarGetArray_v2,objName:"Ops.Vars.VarGetArray_v2"};Ops.Trigger.TriggerSend=class extends CABLES.Op{constructor(){super(...arguments);const r=this;const t=r.attachments={};const e=r.inTriggerButton("Trigger"),n=r.outTrigger("Next");r.varName=r.inValueSelect("Named Trigger",[],"",true);r.varName.onChange=o;e.onTriggered=i;r.patch.addEventListener("namedTriggersChanged",a);a();r.varName.setUiAttribs({_triggerSelect:true});function a(){if(CABLES.UI){let t=[];const e=r.patch.namedTriggers;t.push("+ create new one");for(const n in e)t.push(n);t=t.sort();r.varName.uiAttribs.values=t}}function o(){if(CABLES.UI){if(r.varName.get()=="+ create new one"){new CABLES.UI.ModalDialog({prompt:true,title:"New Trigger",text:"Enter a name for the new trigger",promptValue:"",promptOk:t=>{r.varName.set(t);r.patch.namedTriggers[t]=r.patch.namedTriggers[t]||[];a()}});return}r.refreshParams()}if(!r.patch.namedTriggers[r.varName.get()]){r.patch.namedTriggers[r.varName.get()]=r.patch.namedTriggers[r.varName.get()]||[];r.patch.emitEvent("namedTriggersChanged")}r.setTitle(">"+r.varName.get());r.refreshParams();r.patch.emitEvent("opTriggerNameChanged",r,r.varName.get())}function i(){const e=r.patch.namedTriggers[r.varName.get()];r.patch.emitEvent("namedTriggerSent",r.varName.get());if(!e){r.setUiError("unknowntrigger","unknown trigger");return}else r.setUiError("unknowntrigger",null);for(let t=0;t<e.length;t++){e[t]()}n.trigger()}}};CABLES.OPS["ce1eaf2b-943b-4dc0-ab5e-ee11b63c9ed0"]={f:Ops.Trigger.TriggerSend,objName:"Ops.Trigger.TriggerSend"};Ops.Trigger.TriggerReceive=class extends CABLES.Op{constructor(){super(...arguments);const r=this;const t=r.attachments={};const e=r.outTrigger("Triggered");r.varName=r.inValueSelect("Named Trigger",[],"",true);r.varName.setUiAttribs({_triggerSelect:true});o();r.patch.addEventListener("namedTriggersChanged",o);let n=null;function a(){e.trigger()}function o(){if(CABLES.UI){let e=[];let n=r.patch.namedTriggers;for(let t in n)e.push(t);e=e.sort();r.varName.uiAttribs.values=e}}r.varName.onChange=function(){if(n){let t=r.patch.namedTriggers[n];let e=t.indexOf(a);if(e!=-1)t.splice(e,1)}r.setTitle(">"+r.varName.get());r.patch.namedTriggers[r.varName.get()]=r.patch.namedTriggers[r.varName.get()]||[];let t=r.patch.namedTriggers[r.varName.get()];t.push(a);n=r.varName.get();i();r.patch.emitEvent("opTriggerNameChanged",r,r.varName.get())};r.on("uiParamPanel",i);function i(){if(!r.varName.get()){r.setUiError("unknowntrigger","unknown trigger")}else r.setUiError("unknowntrigger",null)}}};CABLES.OPS["0816c999-f2db-466b-9777-2814573574c5"]={f:Ops.Trigger.TriggerReceive,objName:"Ops.Trigger.TriggerReceive"};Ops.Trigger.TriggerOnChangeObject=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object"),r=t.outTrigger("Changed"),a=t.outObject("Result");a.ignoreValueSerialize=true;n.onChange=function(){a.setRef(n.get());r.trigger()}}};CABLES.OPS["c7e3fa27-21e8-44ef-b176-e0e596837abb"]={f:Ops.Trigger.TriggerOnChangeObject,objName:"Ops.Trigger.TriggerOnChangeObject"};Ops.Trigger.TriggerLimiter=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("In Trigger"),r=t.inValue("Milliseconds",300),a=t.outTrigger("Out Trigger"),o=t.outNumber("Progress");let i=0;n.onTriggered=function(){const t=CABLES.now();let e=(t-i)/r.get();if(e>1)e=1;if(e<0)e=0;o.set(e);if(t>=i+r.get()){i=t;a.trigger()}}}};CABLES.OPS["47641d85-9f81-4287-8aa2-35753b0727e0"]={f:Ops.Trigger.TriggerLimiter,objName:"Ops.Trigger.TriggerLimiter"};Ops.Data.JsonPath.ArrayGetArrayValuesByPath=class extends CABLES.Op{constructor(){super(...arguments);const u=this;const t=u.attachments={};const l=u.inArray("Array");const p=u.inString("Path");const c=u.outArray("Output");const b=u.outBoolNum("Found");l.onChange=e;p.onChange=e;p.setUiAttribs({stringTrim:true});function e(){const e=l.get();let n=[];const t=p.get();u.setUiError("path",null);if(e&&t){if(!Array.isArray(e)){b.set(false);u.setUiError("notiterable","input of type "+typeof e+" is not an array")}else{u.setUiError("notiterable",null);const r=t.split(".");b.set(false);const a=r.slice(1).join(".");for(let t=0;t<e.length;t++){const i=t+"."+a;const s=m(i,e);if(typeof s!=="undefined"){b.set(true)}n.push(s)}const o=p.get().split(".");u.setUiAttrib({extendTitle:o[o.length-1]+""});if(b.get()){c.set(n)}else{u.setUiError("path","given path seems to be invalid!",1);c.set([])}}}else{b.set(false)}}function m(t,e=self,n="."){const r=Array.isArray(t)?t:t.split(n);return r.reduce((t,e)=>{return t&&t[e]},e)}}};CABLES.OPS["f4aa5756-c681-47ac-a997-b4f91760db96"]={f:Ops.Data.JsonPath.ArrayGetArrayValuesByPath,objName:"Ops.Data.JsonPath.ArrayGetArrayValuesByPath"};Ops.Array.ArrayIteratorObjects=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("exe"),r=t.inArray("array"),a=t.outTrigger("trigger"),o=t.outTrigger("finished"),i=t.outNumber("index"),s=t.outObject("value");n.onTriggered=function(){const e=r.get();if(!e)return;for(let t=0;t<e.length;t++){s.setRef(e[t]);i.set(t);a.trigger()}o.trigger()}}};CABLES.OPS["481d2d8f-b9ee-42a0-a905-caf9dc23a63f"]={f:Ops.Array.ArrayIteratorObjects,objName:"Ops.Array.ArrayIteratorObjects"};Ops.Data.Compose.Array.CompArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Update"),r=t.inBool("Active",true),a=t.inBool("Clear",true),o=t.inTriggerButton("Reset"),i=t.outTrigger("Next"),s=t.outArray("Result");o.onTriggered=()=>{u=[];s.setRef([])};let u=[];n.onTriggered=()=>{if(!r.get())return i.trigger();t.patch.tempData.compArray=t.patch.tempData.compArray||[];if(a.get()){u=[]}t.patch.tempData.compArray.push(u);i.trigger();s.setRef(t.patch.tempData.compArray.pop())}}};CABLES.OPS["16f1ce37-9e0d-4632-a9ba-dfd42c4eb254"]={f:Ops.Data.Compose.Array.CompArray,objName:"Ops.Data.Compose.Array.CompArray"};Ops.Boolean.IfTrueThen_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("exe"),r=t.inValueBool("boolean",false),a=t.outTrigger("then"),o=t.outTrigger("else");n.onTriggered=i;function i(){if(r.get())a.trigger();else o.trigger()}}};CABLES.OPS["9549e2ed-a544-4d33-a672-05c7854ccf5d"]={f:Ops.Boolean.IfTrueThen_v2,objName:"Ops.Boolean.IfTrueThen_v2"};Ops.Data.Compose.Array.CompArrayPushObject=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Update"),r=e.inObject("Object"),a=e.outTrigger("Next");n.onTriggered=()=>{if(e.patch.tempData.compArray&&e.patch.tempData.compArray.length>0){let t=e.patch.tempData.compArray[e.patch.tempData.compArray.length-1];try{t.push(JSON.parse(JSON.stringify(r.get())))}catch(t){e.log("error comparraupusharray")}}a.trigger()}}};CABLES.OPS["761d75d3-aaae-49ba-8df1-20d8012fb70a"]={f:Ops.Data.Compose.Array.CompArrayPushObject,objName:"Ops.Data.Compose.Array.CompArrayPushObject"};Ops.Json.ObjectGetString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("data"),r=t.inString("Key"),a=t.outString("Result");a.ignoreValueSerialize=true;n.ignoreValueSerialize=true;t.toWorkPortsNeedsString(r);t.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true});r.onChange=n.onChange=o;function o(){if(n.get()){const t=n.get()[r.get()];const e=t===undefined||t===null;if(e){a.setRef(null)}else{a.set(String(t))}}else{a.setRef(null)}}}};CABLES.OPS["7d86cd28-f7d8-44a1-a4da-466c4782aaec"]={f:Ops.Json.ObjectGetString,objName:"Ops.Json.ObjectGetString"};Ops.Boolean.And=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueBool("bool 1"),r=t.inValueBool("bool 2"),a=t.outBoolNum("result");n.onChange=r.onChange=o;function o(){a.set(r.get()&&n.get())}}};CABLES.OPS["c26e6ce0-8047-44bb-9bc8-5a4f911ed8ad"]={f:Ops.Boolean.And,objName:"Ops.Boolean.And"};Ops.String.ArrayContainsString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array"),r=t.inString("SearchValue"),a=t.outBoolNum("Found",false),o=t.outNumber("Index",-1);r.onChange=()=>{if(!r.isLinked())t.setUiAttrib({extendTitle:r.get()});i()};n.onChange=i;function i(){let t=n.get();if(t){if(!Array.isArray(t))t=Array.from(t);const e=t.indexOf(r.get());o.set(e);a.set(e>-1)}}}};CABLES.OPS["bace9c9b-5e96-4a82-9bcd-02e316afb9de"]={f:Ops.String.ArrayContainsString,objName:"Ops.String.ArrayContainsString"};Ops.Array.ArrayUnique=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inArray("array");const a=t.inSwitch("Format",["X","XY","XYZ"],"X");const o=t.outArray("arrayOut");const i=t.outNumber("Array Length Out");r.onChange=a.onChange=()=>{if(!r.get()){o.set(null);i.set(0);return}const t=a.get();const e=s[t];const n=e(r.get());o.set(null);o.set(n);i.set(n.length)};function n(e){const n=e.length;const r={};const a=[];for(let t=0;t<n;t++){if(!r[e[t]]){a.push(e[t]);r[e[t]]=true}}return a}const s={X:n,XY:u,XYZ:l};function u(e){const n=Math.floor(e.length/2);const r={};const a=[];for(let t=0;t<n;t+=1){const o=[e[t*2],e[t*2+1]].join();if(!r[o]){a.push(e[t*2],e[t*2+1]);r[o]=true}}return a}function l(e){const n=Math.floor(e.length/3);const r={};const a=[];for(let t=0;t<n;t+=1){const o=[e[t*3],e[t*3+1],e[t*3+2]].join();if(!r[o]){a.push(e[t*3],e[t*3+1],e[t*3+2]);r[o]=true}}return a}}};CABLES.OPS["81204fcc-c416-4948-9cba-2218763db4fc"]={f:Ops.Array.ArrayUnique,objName:"Ops.Array.ArrayUnique"};Ops.Vars.VarSetObject_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Value",null);t.varName=t.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(t,"object",n,t.varName)}};CABLES.OPS["c7608375-5b45-4bca-87ef-d0c5e970779a"]={f:Ops.Vars.VarSetObject_v2,objName:"Ops.Vars.VarSetObject_v2"};Ops.Json.ObjectGetObject_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object"),r=t.inString("Key"),a=t.outObject("Result");a.ignoreValueSerialize=true;n.ignoreValueSerialize=true;t.toWorkPortsNeedsString(r);t.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true});r.onChange=n.onChange=o;function o(){if(n.get()){a.setRef(n.get()[r.get()])}else{a.set(null)}}}};CABLES.OPS["d1dfa305-89db-4ca1-b0ac-2d6321d76ae8"]={f:Ops.Json.ObjectGetObject_v2,objName:"Ops.Json.ObjectGetObject_v2"};Ops.Vars.VarGetObject_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.outObject("Value");t.varName=t.inValueSelect("Variable",[],"",true);new CABLES.VarGetOpWrapper(t,"object",t.varName,n)}};CABLES.OPS["321419d9-69c7-4310-a327-93d310bc2b8e"]={f:Ops.Vars.VarGetObject_v2,objName:"Ops.Vars.VarGetObject_v2"};Ops.Team.ACAR.GetD3Nodes=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const n=t.attachments={inc_gen_ports_js:'const port_9izygoo74=op.inTrigger("9izygoo74");\nport_9izygoo74.setUiAttribs({title:"update",});\nport_9izygoo74.setUiAttribs({"values":[""]});\n\nconst port_0qjh9wa1n=op.inArray("0qjh9wa1n");\nport_0qjh9wa1n.setUiAttribs({title:"data",});\nport_0qjh9wa1n.setUiAttribs({"values":[""]});\n\nconst port_amuu1ro3s=op.inString("amuu1ro3s","");\nport_amuu1ro3s.setUiAttribs({title:"id field",});\nport_amuu1ro3s.setUiAttribs({"values":[""]});\n\nconst port_3x0y6h9tk=op.inString("3x0y6h9tk","");\nport_3x0y6h9tk.setUiAttribs({title:"name field",});\nport_3x0y6h9tk.setUiAttribs({"values":[""]});\n\nconst port_4az9a7m2p=op.inString("4az9a7m2p","");\nport_4az9a7m2p.setUiAttribs({title:"entity field",});\nport_4az9a7m2p.setUiAttribs({"values":[""]});\n\nconst port_3zn1xvhpd=op.outArray("3zn1xvhpd");\nport_3zn1xvhpd.setUiAttribs({title:"d3 nodes",});\nport_3zn1xvhpd.setUiAttribs({"values":[""]});\n\nop.initInnerPorts=function(addedOps)\n{\n  for(let i=0;i<addedOps.length;i++)\n  {\n    if(addedOps[i].innerInput)\n    {\nconst innerOut_9izygoo74 = addedOps[i].outTrigger("innerOut_9izygoo74");\ninnerOut_9izygoo74.setUiAttribs({title:"update"});\nport_9izygoo74.onTriggered = () => { innerOut_9izygoo74.trigger(); };\n\nconst innerOut_0qjh9wa1n = addedOps[i].outArray("innerOut_0qjh9wa1n");\ninnerOut_0qjh9wa1n.setUiAttribs({title:"data"});\nport_0qjh9wa1n.on("change", (a,v) => { innerOut_0qjh9wa1n.setRef(a); });\n\nconst innerOut_amuu1ro3s = addedOps[i].outString("innerOut_amuu1ro3s");\ninnerOut_amuu1ro3s.set(port_amuu1ro3s.get() );\ninnerOut_amuu1ro3s.setUiAttribs({title:"id field"});\nport_amuu1ro3s.on("change", (a,v) => { innerOut_amuu1ro3s.set(a); });\n\nconst innerOut_3x0y6h9tk = addedOps[i].outString("innerOut_3x0y6h9tk");\ninnerOut_3x0y6h9tk.set(port_3x0y6h9tk.get() );\ninnerOut_3x0y6h9tk.setUiAttribs({title:"name field"});\nport_3x0y6h9tk.on("change", (a,v) => { innerOut_3x0y6h9tk.set(a); });\n\nconst innerOut_4az9a7m2p = addedOps[i].outString("innerOut_4az9a7m2p");\ninnerOut_4az9a7m2p.set(port_4az9a7m2p.get() );\ninnerOut_4az9a7m2p.setUiAttribs({title:"entity field"});\nport_4az9a7m2p.on("change", (a,v) => { innerOut_4az9a7m2p.set(a); });\n\n    }\nif(addedOps[i].innerOutput)\n{\nconst innerIn_3zn1xvhpd = addedOps[i].inArray("innerIn_3zn1xvhpd");\ninnerIn_3zn1xvhpd.setUiAttribs({title:"d3 nodes"});\ninnerIn_3zn1xvhpd.on("change", (a,v) => { port_3zn1xvhpd.setRef(a); });\n\n}\n}\n};\n',subpatch_json:'{"ops":[{"id":"bp24-0","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsOut":[{"name":"innerOut_0qjh9wa1n","title":"data"},{"name":"innerOut_amuu1ro3s","value":"ID","title":"id field"},{"name":"innerOut_3x0y6h9tk","value":"Name_str","title":"name field"},{"name":"innerOut_4az9a7m2p","value":"Entitt","title":"entity field"}],"objName":"Ops.Ui.SubPatchInput"},{"id":"bp24-1","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"innerIn_3zn1xvhpd","value":0,"title":"d3 nodes"}],"objName":"Ops.Ui.SubPatchOutput"},{"id":"bp24-2","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsOut":[{"name":"trigger","links":[{"portIn":"exe 0","portOut":"trigger","objIn":"bp24-6","objOut":"bp24-2"}]},{"name":"index","value":29},{"name":"value","links":[{"portIn":"data","portOut":"value","objIn":"bp24-9","objOut":"bp24-2"},{"portIn":"data","portOut":"value","objIn":"bp24-12","objOut":"bp24-2"},{"portIn":"data","portOut":"value","objIn":"bp24-11","objOut":"bp24-2"},{"portIn":"Object","portOut":"value","objIn":"bp24-16","objOut":"bp24-2"}]}],"objName":"Ops.Array.ArrayIteratorObjects"},{"id":"bp24-3","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"Active","value":1},{"name":"Clear","value":1}],"portsOut":[{"name":"Next","links":[{"portIn":"exe","portOut":"Next","objIn":"bp24-2","objOut":"bp24-3"}]},{"name":"Result","links":[{"portIn":"innerIn_3zn1xvhpd","portOut":"Result","objIn":"bp24-14","objOut":"bp24-3"}]}],"objName":"Ops.Data.Compose.Array.CompArray"},{"id":"bp24-4","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"objName":"Ops.Data.Compose.Array.CompArrayPushObject"},{"id":"bp24-5","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"Clear","value":1}],"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp24-7","objOut":"bp24-5"}]},{"name":"Result","links":[{"portIn":"Object","portOut":"Result","objIn":"bp24-4","objOut":"bp24-5"}]}],"objName":"Ops.Data.Compose.Object.CompObject"},{"id":"bp24-6","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsOut":[{"name":"trigger 0","links":[{"portIn":"Update","portOut":"trigger 0","objIn":"bp24-5","objOut":"bp24-6"}]},{"name":"trigger 15","links":[{"portIn":"Update","portOut":"trigger 15","objIn":"bp24-4","objOut":"bp24-6"}]}],"objName":"Ops.Trigger.Sequence"},{"id":"bp24-7","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"Key","value":"id"}],"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp24-8","objOut":"bp24-7"}]}],"objName":"Ops.Data.Compose.Object.CompObjectSetString"},{"id":"bp24-8","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"Key","value":"name"}],"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp24-10","objOut":"bp24-8"}]}],"objName":"Ops.Data.Compose.Object.CompObjectSetString"},{"id":"bp24-9","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsOut":[{"name":"Result","links":[{"portIn":"String","portOut":"Result","objIn":"bp24-7","objOut":"bp24-9"}]}],"objName":"Ops.Json.ObjectGetString"},{"id":"bp24-10","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"Key","value":"entity"}],"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp24-15","objOut":"bp24-10"}]}],"objName":"Ops.Data.Compose.Object.CompObjectSetString"},{"id":"bp24-11","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsOut":[{"name":"Result","links":[{"portIn":"String","portOut":"Result","objIn":"bp24-10","objOut":"bp24-11"}]}],"objName":"Ops.Json.ObjectGetString"},{"id":"bp24-12","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsOut":[{"name":"Result","links":[{"portIn":"String","portOut":"Result","objIn":"bp24-8","objOut":"bp24-12"}]}],"objName":"Ops.Json.ObjectGetString"},{"id":"bp24-13","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsOut":[{"name":"innerOut_9izygoo74","title":"update","links":[{"portIn":"Update","portOut":"innerOut_9izygoo74","objIn":"bp24-3","objOut":"bp24-13"}]},{"name":"innerOut_0qjh9wa1n","title":"data","links":[{"portIn":"array","portOut":"innerOut_0qjh9wa1n","objIn":"bp24-2","objOut":"bp24-13"}]},{"name":"innerOut_amuu1ro3s","title":"id field","links":[{"portIn":"Key","portOut":"innerOut_amuu1ro3s","objIn":"bp24-9","objOut":"bp24-13"}]},{"name":"innerOut_3x0y6h9tk","title":"name field","links":[{"portIn":"Key","portOut":"innerOut_3x0y6h9tk","objIn":"bp24-12","objOut":"bp24-13"}]},{"name":"innerOut_4az9a7m2p","title":"entity field","links":[{"portIn":"Key","portOut":"innerOut_4az9a7m2p","objIn":"bp24-11","objOut":"bp24-13"}]}],"objName":"Ops.Ui.SubPatchInput"},{"id":"bp24-14","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"innerIn_3zn1xvhpd","title":"d3 nodes"}],"objName":"Ops.Ui.SubPatchOutput"},{"id":"bp24-15","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"Key","value":"hidden"},{"name":"Number","value":0}],"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp24-16","objOut":"bp24-15"}]}],"objName":"Ops.Data.Compose.Object.CompObjectSetNumber"},{"id":"bp24-16","uiAttribs":{"subPatch":"717i39f3z"},"storage":{},"portsIn":[{"name":"Key","value":"data"}],"objName":"Ops.Data.Compose.Object.CompObjectSetObject"}]}'};const u=t.inTrigger("9izygoo74");u.setUiAttribs({title:"update"});u.setUiAttribs({values:[""]});const l=t.inArray("0qjh9wa1n");l.setUiAttribs({title:"data"});l.setUiAttribs({values:[""]});const p=t.inString("amuu1ro3s","");p.setUiAttribs({title:"id field"});p.setUiAttribs({values:[""]});const c=t.inString("3x0y6h9tk","");c.setUiAttribs({title:"name field"});c.setUiAttribs({values:[""]});const b=t.inString("4az9a7m2p","");b.setUiAttribs({title:"entity field"});b.setUiAttribs({values:[""]});const m=t.outArray("3zn1xvhpd");m.setUiAttribs({title:"d3 nodes"});m.setUiAttribs({values:[""]});t.initInnerPorts=function(e){for(let t=0;t<e.length;t++){if(e[t].innerInput){const n=e[t].outTrigger("innerOut_9izygoo74");n.setUiAttribs({title:"update"});u.onTriggered=()=>{n.trigger()};const r=e[t].outArray("innerOut_0qjh9wa1n");r.setUiAttribs({title:"data"});l.on("change",(t,e)=>{r.setRef(t)});const a=e[t].outString("innerOut_amuu1ro3s");a.set(p.get());a.setUiAttribs({title:"id field"});p.on("change",(t,e)=>{a.set(t)});const o=e[t].outString("innerOut_3x0y6h9tk");o.set(c.get());o.setUiAttribs({title:"name field"});c.on("change",(t,e)=>{o.set(t)});const i=e[t].outString("innerOut_4az9a7m2p");i.set(b.get());i.setUiAttribs({title:"entity field"});b.on("change",(t,e)=>{i.set(t)})}if(e[t].innerOutput){const s=e[t].inArray("innerIn_3zn1xvhpd");s.setUiAttribs({title:"d3 nodes"});s.on("change",(t,e)=>{m.setRef(t)})}}};const r="bp2sub_"+t.id;new CABLES.SubPatchOp(t,{subId:r});e();function e(){if(!n||!n.subpatch_json)return;const e=JSON.parse(n.subpatch_json);CABLES.Patch.replaceOpIds(e,{parentSubPatchId:r,prefixHash:r,oldIdAsRef:true,doNotUnlinkLostLinks:true});for(let t=0;t<e.ops.length;t++){e.ops[t].uiAttribs.blueprintSubpatch2=true}t.loadDependencies(e,()=>{t.patch.deSerialize(e,{opsCreated:t.initInnerPorts});if(CABLES.UI)gui.savedState.setSaved("blueprintloaded",r);t.patch.emitEvent("subpatchExpose",r);t.setStorage({blueprintVer:2});t.patch.emitEvent("subpatchExpose",r)})}}};CABLES.OPS["b9e01b7a-a57c-4d52-b162-b3b154046a87"]={f:Ops.Team.ACAR.GetD3Nodes,objName:"Ops.Team.ACAR.GetD3Nodes"};Ops.Team.ACAR.FilterData=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const n=t.attachments={inc_gen_ports_js:'const port_fwlh2wbfd=op.inTrigger("fwlh2wbfd");\nport_fwlh2wbfd.setUiAttribs({title:"Trigger",display:"button",});\n\nconst port_9h9xdpi46=op.inArray("9h9xdpi46");\nport_9h9xdpi46.setUiAttribs({title:"Array",});\n\nconst port_wna5rvgax=op.inObject("wna5rvgax");\nport_wna5rvgax.setUiAttribs({title:"Object",});\n\nconst port_0mljgk9kq=op.outArray("0mljgk9kq");\nport_0mljgk9kq.setUiAttribs({title:"Result",});\n\nconst port_8cnw4y493=op.outNumber("8cnw4y493");\nport_8cnw4y493.setUiAttribs({title:"length",});\n\nop.initInnerPorts=function(addedOps)\n{\n  for(let i=0;i<addedOps.length;i++)\n  {\n    if(addedOps[i].innerInput)\n    {\nconst innerOut_fwlh2wbfd = addedOps[i].outTrigger("innerOut_fwlh2wbfd");\ninnerOut_fwlh2wbfd.setUiAttribs({title:"Trigger"});\nport_fwlh2wbfd.onTriggered = () => { innerOut_fwlh2wbfd.trigger(); };\n\nconst innerOut_9h9xdpi46 = addedOps[i].outArray("innerOut_9h9xdpi46");\ninnerOut_9h9xdpi46.setUiAttribs({title:"Array"});\nport_9h9xdpi46.on("change", (a,v) => { innerOut_9h9xdpi46.setRef(a); });\n\nconst innerOut_wna5rvgax = addedOps[i].outObject("innerOut_wna5rvgax");\ninnerOut_wna5rvgax.setUiAttribs({title:"Object"});\nport_wna5rvgax.on("change", (a,v) => { innerOut_wna5rvgax.setRef(a); });\n\n    }\nif(addedOps[i].innerOutput)\n{\nconst innerIn_0mljgk9kq = addedOps[i].inArray("innerIn_0mljgk9kq");\ninnerIn_0mljgk9kq.setUiAttribs({title:"Result"});\ninnerIn_0mljgk9kq.on("change", (a,v) => { port_0mljgk9kq.setRef(a); });\n\nconst innerIn_8cnw4y493 = addedOps[i].inFloat("innerIn_8cnw4y493");\ninnerIn_8cnw4y493.setUiAttribs({title:"length"});\ninnerIn_8cnw4y493.on("change", (a,v) => { port_8cnw4y493.set(a); });\n\n}\n}\n};\n',subpatch_json:'{"ops":[{"id":"bp25-0","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsIn":[{"name":"Active","value":1}],"portsOut":[{"name":"Next","links":[{"portIn":"exe","portOut":"Next","objIn":"bp25-1","objOut":"bp25-0"}]},{"name":"Result","links":[{"portIn":"innerIn_0mljgk9kq","portOut":"Result","objIn":"bp25-12","objOut":"bp25-0"},{"portIn":"Array","portOut":"Result","objIn":"bp25-17","objOut":"bp25-0"}]}],"objName":"Ops.Data.Compose.Array.CompArray"},{"id":"bp25-1","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"then","links":[{"portIn":"exe","portOut":"then","objIn":"bp25-3","objOut":"bp25-1"}]},{"name":"else","links":[{"portIn":"Update","portOut":"else","objIn":"bp25-2","objOut":"bp25-1"}]}],"objName":"Ops.Boolean.IfTrueThen_v2"},{"id":"bp25-2","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"objName":"Ops.Data.Compose.Array.CompArrayPushArrayItems"},{"id":"bp25-3","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"trigger","links":[{"portIn":"Exe","portOut":"trigger","objIn":"bp25-5","objOut":"bp25-3"}]},{"name":"index","value":29},{"name":"value","links":[{"portIn":"data","portOut":"value","objIn":"bp25-7","objOut":"bp25-3"},{"portIn":"Object","portOut":"value","objIn":"bp25-10","objOut":"bp25-3"}]}],"objName":"Ops.Array.ArrayIteratorObjects"},{"id":"bp25-4","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"Num Keys","value":4},{"name":"Keys","links":[{"portIn":"Array","portOut":"Keys","objIn":"bp25-5","objOut":"bp25-4"},{"portIn":"Array","portOut":"Keys","objIn":"bp25-14","objOut":"bp25-4"}]}],"objName":"Ops.Json.ObjectKeys"},{"id":"bp25-5","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"Trigger","links":[{"portIn":"Exe","portOut":"Trigger","objIn":"bp25-16","objOut":"bp25-5"}]},{"name":"Index","value":3},{"name":"Value","links":[{"portIn":"Key","portOut":"Value","objIn":"bp25-7","objOut":"bp25-5"},{"portIn":"key","portOut":"Value","objIn":"bp25-18","objOut":"bp25-5"}]}],"objName":"Ops.Array.ArrayIteratorStrings"},{"id":"bp25-6","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"Trigger","links":[{"portIn":"exe","portOut":"Trigger","objIn":"bp25-8","objOut":"bp25-6"}]},{"name":"Index","value":0},{"name":"Value","links":[{"portIn":"SearchValue","portOut":"Value","objIn":"bp25-9","objOut":"bp25-6"}]}],"objName":"Ops.Array.ArrayIteratorStrings"},{"id":"bp25-7","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"Result","links":[{"portIn":"String","portOut":"Result","objIn":"bp25-9","objOut":"bp25-7"}]}],"objName":"Ops.Json.ObjectGetString"},{"id":"bp25-8","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"then","links":[{"portIn":"Update","portOut":"then","objIn":"bp25-10","objOut":"bp25-8"}]}],"objName":"Ops.Boolean.IfTrueThen_v2"},{"id":"bp25-9","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"Found","links":[{"portIn":"boolean","portOut":"Found","objIn":"bp25-8","objOut":"bp25-9"}]},{"name":"Index","value":-1}],"objName":"Ops.String.StringContains_v2"},{"id":"bp25-10","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"objName":"Ops.Data.Compose.Array.CompArrayPushObject"},{"id":"bp25-11","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"innerOut_fwlh2wbfd","title":"Trigger","links":[{"portIn":"Update","portOut":"innerOut_fwlh2wbfd","objIn":"bp25-0","objOut":"bp25-11"}]},{"name":"innerOut_9h9xdpi46","title":"Array","links":[{"portIn":"Array","portOut":"innerOut_9h9xdpi46","objIn":"bp25-2","objOut":"bp25-11"},{"portIn":"array","portOut":"innerOut_9h9xdpi46","objIn":"bp25-3","objOut":"bp25-11"},{"portIn":"Array","portOut":"innerOut_9h9xdpi46","objIn":"bp25-13","objOut":"bp25-11"}]},{"name":"innerOut_wna5rvgax","title":"Object","links":[{"portIn":"Object","portOut":"innerOut_wna5rvgax","objIn":"bp25-4","objOut":"bp25-11"},{"portIn":"data","portOut":"innerOut_wna5rvgax","objIn":"bp25-18","objOut":"bp25-11"},{"portIn":"Object","portOut":"innerOut_wna5rvgax","objIn":"bp25-19","objOut":"bp25-11"}]}],"objName":"Ops.Ui.SubPatchInput"},{"id":"bp25-12","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsIn":[{"name":"innerIn_0mljgk9kq","title":"Result"},{"name":"innerIn_8cnw4y493","title":"length"}],"objName":"Ops.Ui.SubPatchOutput"},{"id":"bp25-13","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsIn":[{"name":"Stride","value":0},{"name":"Scroll","value":0}],"objName":"Ops.Ui.VizArrayTable_v2"},{"id":"bp25-14","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsIn":[{"name":"Stride","value":0},{"name":"Scroll","value":0}],"objName":"Ops.Ui.VizArrayTable_v2"},{"id":"bp25-15","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsIn":[{"name":"Stride","value":0},{"name":"Scroll","value":0}],"objName":"Ops.Ui.VizArrayTable_v2"},{"id":"bp25-16","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"else","links":[{"portIn":"Exe","portOut":"else","objIn":"bp25-6","objOut":"bp25-16"}]}],"objName":"Ops.Boolean.IfFalseThen"},{"id":"bp25-17","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsIn":[{"name":"Stride","value":0},{"name":"Scroll","value":0}],"objName":"Ops.Ui.VizArrayTable_v2"},{"id":"bp25-18","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"result","links":[{"portIn":"Array","portOut":"result","objIn":"bp25-6","objOut":"bp25-18"},{"portIn":"Array","portOut":"result","objIn":"bp25-15","objOut":"bp25-18"}]},{"name":"Length","links":[{"portIn":"Boolean","portOut":"Length","objIn":"bp25-16","objOut":"bp25-18"}]}],"objName":"Ops.Json.ObjectGetArray_v2"},{"id":"bp25-19","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"Values","links":[{"portIn":"Array","portOut":"Values","objIn":"bp25-20","objOut":"bp25-19"}]},{"name":"Num values","value":4}],"objName":"Ops.Json.ObjectValuesAsArray"},{"id":"bp25-20","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"Result","links":[{"portIn":"array","portOut":"Result","objIn":"bp25-21","objOut":"bp25-20"}]}],"objName":"Ops.Array.FlattenArray"},{"id":"bp25-21","uiAttribs":{"subPatch":"g7gx6suem"},"storage":{},"portsOut":[{"name":"length","links":[{"portIn":"boolean","portOut":"length","objIn":"bp25-1","objOut":"bp25-21"},{"portIn":"innerIn_8cnw4y493","portOut":"length","objIn":"bp25-12","objOut":"bp25-21"}]}],"objName":"Ops.Array.ArrayLength_v2"}]}'};const s=t.inTrigger("fwlh2wbfd");s.setUiAttribs({title:"Trigger",display:"button"});const u=t.inArray("9h9xdpi46");u.setUiAttribs({title:"Array"});const l=t.inObject("wna5rvgax");l.setUiAttribs({title:"Object"});const p=t.outArray("0mljgk9kq");p.setUiAttribs({title:"Result"});const c=t.outNumber("8cnw4y493");c.setUiAttribs({title:"length"});t.initInnerPorts=function(e){for(let t=0;t<e.length;t++){if(e[t].innerInput){const n=e[t].outTrigger("innerOut_fwlh2wbfd");n.setUiAttribs({title:"Trigger"});s.onTriggered=()=>{n.trigger()};const r=e[t].outArray("innerOut_9h9xdpi46");r.setUiAttribs({title:"Array"});u.on("change",(t,e)=>{r.setRef(t)});const a=e[t].outObject("innerOut_wna5rvgax");a.setUiAttribs({title:"Object"});l.on("change",(t,e)=>{a.setRef(t)})}if(e[t].innerOutput){const o=e[t].inArray("innerIn_0mljgk9kq");o.setUiAttribs({title:"Result"});o.on("change",(t,e)=>{p.setRef(t)});const i=e[t].inFloat("innerIn_8cnw4y493");i.setUiAttribs({title:"length"});i.on("change",(t,e)=>{c.set(t)})}}};const r="bp2sub_"+t.id;new CABLES.SubPatchOp(t,{subId:r});e();function e(){if(!n||!n.subpatch_json)return;const e=JSON.parse(n.subpatch_json);CABLES.Patch.replaceOpIds(e,{parentSubPatchId:r,prefixHash:r,oldIdAsRef:true,doNotUnlinkLostLinks:true});for(let t=0;t<e.ops.length;t++){e.ops[t].uiAttribs.blueprintSubpatch2=true}t.loadDependencies(e,()=>{t.patch.deSerialize(e,{opsCreated:t.initInnerPorts});if(CABLES.UI)gui.savedState.setSaved("blueprintloaded",r);t.patch.emitEvent("subpatchExpose",r);t.setStorage({blueprintVer:2});t.patch.emitEvent("subpatchExpose",r)})}}};CABLES.OPS["6026a90b-e5de-40ef-90de-cffc142e0f1e"]={f:Ops.Team.ACAR.FilterData,objName:"Ops.Team.ACAR.FilterData"};Ops.Boolean.Or=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueBool("bool 1"),r=t.inValueBool("bool 2"),a=t.inValueBool("bool 3"),o=t.inValueBool("bool 4"),i=t.inValueBool("bool 5"),s=t.inValueBool("bool 6"),u=t.inValueBool("bool 7"),l=t.inValueBool("bool 8"),p=t.inValueBool("bool 9"),c=t.inValueBool("bool 10"),b=t.outBoolNum("result");n.onChange=r.onChange=a.onChange=o.onChange=i.onChange=s.onChange=u.onChange=l.onChange=p.onChange=c.onChange=m;function m(){b.set(n.get()||r.get()||a.get()||o.get()||i.get()||s.get()||u.get()||l.get()||p.get()||c.get())}}};CABLES.OPS["b3b36238-4592-4e11-afe3-8361c4fd6be5"]={f:Ops.Boolean.Or,objName:"Ops.Boolean.Or"};Ops.Vars.VarSetNumber_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("Value",0);t.varName=t.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(t,"number",n,t.varName)}};CABLES.OPS["b5249226-6095-4828-8a1c-080654e192fa"]={f:Ops.Vars.VarSetNumber_v2,objName:"Ops.Vars.VarSetNumber_v2"};Ops.Array.ArrayLength_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("array"),r=t.outNumber("length");r.ignoreValueSerialize=true;function a(){let t=0;if(n.get())t=n.get().length;r.set(t)}n.onChange=a}};CABLES.OPS["6f665caa-96ed-45d8-8620-e34f0f8e062c"]={f:Ops.Array.ArrayLength_v2,objName:"Ops.Array.ArrayLength_v2"};Ops.Team.ACAR.GetD3Links=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const n=t.attachments={inc_gen_ports_js:'const port_n7i7hux58=op.inTrigger("n7i7hux58");\nport_n7i7hux58.setUiAttribs({title:"Update",});\n\nconst port_5ydf4tifk=op.inArray("5ydf4tifk");\nport_5ydf4tifk.setUiAttribs({title:"left objects",});\nport_5ydf4tifk.setUiAttribs({"values":[""]});\n\nconst port_ul0a4ym88=op.inArray("ul0a4ym88");\nport_ul0a4ym88.setUiAttribs({title:"right ids",});\nport_ul0a4ym88.setUiAttribs({"values":[""]});\n\nconst port_bpkzafijw=op.inString("bpkzafijw","");\nport_bpkzafijw.setUiAttribs({title:"left array fieldname",});\nport_bpkzafijw.setUiAttribs({"values":[""]});\n\nconst port_3aw49ekwu=op.inString("3aw49ekwu","");\nport_3aw49ekwu.setUiAttribs({title:"source id fieldname",});\nport_3aw49ekwu.setUiAttribs({"values":[""]});\n\nconst port_j609dr0b8=op.outArray("j609dr0b8");\nport_j609dr0b8.setUiAttribs({title:"links",});\nport_j609dr0b8.setUiAttribs({"values":[""]});\n\nop.initInnerPorts=function(addedOps)\n{\n  for(let i=0;i<addedOps.length;i++)\n  {\n    if(addedOps[i].innerInput)\n    {\nconst innerOut_n7i7hux58 = addedOps[i].outTrigger("innerOut_n7i7hux58");\ninnerOut_n7i7hux58.setUiAttribs({title:"Update"});\nport_n7i7hux58.onTriggered = () => { innerOut_n7i7hux58.trigger(); };\n\nconst innerOut_5ydf4tifk = addedOps[i].outArray("innerOut_5ydf4tifk");\ninnerOut_5ydf4tifk.setUiAttribs({title:"left objects"});\nport_5ydf4tifk.on("change", (a,v) => { innerOut_5ydf4tifk.setRef(a); });\n\nconst innerOut_ul0a4ym88 = addedOps[i].outArray("innerOut_ul0a4ym88");\ninnerOut_ul0a4ym88.setUiAttribs({title:"right ids"});\nport_ul0a4ym88.on("change", (a,v) => { innerOut_ul0a4ym88.setRef(a); });\n\nconst innerOut_bpkzafijw = addedOps[i].outString("innerOut_bpkzafijw");\ninnerOut_bpkzafijw.set(port_bpkzafijw.get() );\ninnerOut_bpkzafijw.setUiAttribs({title:"left array fieldname"});\nport_bpkzafijw.on("change", (a,v) => { innerOut_bpkzafijw.set(a); });\n\nconst innerOut_3aw49ekwu = addedOps[i].outString("innerOut_3aw49ekwu");\ninnerOut_3aw49ekwu.set(port_3aw49ekwu.get() );\ninnerOut_3aw49ekwu.setUiAttribs({title:"source id fieldname"});\nport_3aw49ekwu.on("change", (a,v) => { innerOut_3aw49ekwu.set(a); });\n\n    }\nif(addedOps[i].innerOutput)\n{\nconst innerIn_j609dr0b8 = addedOps[i].inArray("innerIn_j609dr0b8");\ninnerIn_j609dr0b8.setUiAttribs({title:"links"});\ninnerIn_j609dr0b8.on("change", (a,v) => { port_j609dr0b8.setRef(a); });\n\n}\n}\n};\n',subpatch_json:'{"ops":[{"id":"bp29-0","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsIn":[{"name":"Active","value":1}],"portsOut":[{"name":"Next","links":[{"portIn":"exe","portOut":"Next","objIn":"bp29-1","objOut":"bp29-0"}]},{"name":"Result","links":[{"portIn":"innerIn_j609dr0b8","portOut":"Result","objIn":"bp29-12","objOut":"bp29-0"}]}],"objName":"Ops.Data.Compose.Array.CompArray"},{"id":"bp29-1","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"trigger","links":[{"portIn":"Exe","portOut":"trigger","objIn":"bp29-8","objOut":"bp29-1"}]},{"name":"index","value":29},{"name":"value","links":[{"portIn":"data","portOut":"value","objIn":"bp29-2","objOut":"bp29-1"},{"portIn":"data","portOut":"value","objIn":"bp29-3","objOut":"bp29-1"}]}],"objName":"Ops.Array.ArrayIteratorObjects"},{"id":"bp29-2","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"result","links":[{"portIn":"Array","portOut":"result","objIn":"bp29-8","objOut":"bp29-2"}]},{"name":"Length","value":4}],"objName":"Ops.Json.ObjectGetArray_v2"},{"id":"bp29-3","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"Result","links":[{"portIn":"String","portOut":"Result","objIn":"bp29-7","objOut":"bp29-3"}]}],"objName":"Ops.Json.ObjectGetString"},{"id":"bp29-4","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp29-13","objOut":"bp29-4"}]},{"name":"Result","links":[{"portIn":"Object","portOut":"Result","objIn":"bp29-6","objOut":"bp29-4"}]}],"objName":"Ops.Data.Compose.Object.CompObject"},{"id":"bp29-5","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"trigger 0","links":[{"portIn":"Update","portOut":"trigger 0","objIn":"bp29-4","objOut":"bp29-5"}]},{"name":"trigger 15","links":[{"portIn":"Update","portOut":"trigger 15","objIn":"bp29-6","objOut":"bp29-5"}]}],"objName":"Ops.Trigger.Sequence"},{"id":"bp29-6","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"objName":"Ops.Data.Compose.Array.CompArrayPushObject"},{"id":"bp29-7","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsIn":[{"name":"Key","value":"source"}],"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp29-9","objOut":"bp29-7"}]}],"objName":"Ops.Data.Compose.Object.CompObjectSetString"},{"id":"bp29-8","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"Trigger","links":[{"portIn":"exe","portOut":"Trigger","objIn":"bp29-5","objOut":"bp29-8"}]},{"name":"Index","value":3},{"name":"Value","links":[{"portIn":"String","portOut":"Value","objIn":"bp29-9","objOut":"bp29-8"},{"portIn":"SearchValue","portOut":"Value","objIn":"bp29-10","objOut":"bp29-8"}]}],"objName":"Ops.Array.ArrayIteratorStrings"},{"id":"bp29-9","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsIn":[{"name":"Key","value":"target"}],"objName":"Ops.Data.Compose.Object.CompObjectSetString"},{"id":"bp29-10","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"Found","links":[{"portIn":"Boolean","portOut":"Found","objIn":"bp29-14","objOut":"bp29-10"}]},{"name":"Index","value":-1}],"objName":"Ops.String.ArrayContainsString"},{"id":"bp29-11","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"innerOut_n7i7hux58","title":"Update","links":[{"portIn":"Update","portOut":"innerOut_n7i7hux58","objIn":"bp29-0","objOut":"bp29-11"}]},{"name":"innerOut_5ydf4tifk","title":"left objects","links":[{"portIn":"array","portOut":"innerOut_5ydf4tifk","objIn":"bp29-1","objOut":"bp29-11"}]},{"name":"innerOut_ul0a4ym88","title":"right ids","links":[{"portIn":"Array","portOut":"innerOut_ul0a4ym88","objIn":"bp29-10","objOut":"bp29-11"}]},{"name":"innerOut_bpkzafijw","title":"left array fieldname","links":[{"portIn":"key","portOut":"innerOut_bpkzafijw","objIn":"bp29-2","objOut":"bp29-11"}]},{"name":"innerOut_3aw49ekwu","title":"source id fieldname","links":[{"portIn":"Key","portOut":"innerOut_3aw49ekwu","objIn":"bp29-3","objOut":"bp29-11"}]}],"objName":"Ops.Ui.SubPatchInput"},{"id":"bp29-12","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsIn":[{"name":"innerIn_j609dr0b8","title":"links"}],"objName":"Ops.Ui.SubPatchOutput"},{"id":"bp29-13","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsIn":[{"name":"Key","value":"hidden"},{"name":"Number","value":0}],"portsOut":[{"name":"Next","links":[{"portIn":"Update","portOut":"Next","objIn":"bp29-7","objOut":"bp29-13"}]}],"objName":"Ops.Data.Compose.Object.CompObjectSetNumber"},{"id":"bp29-14","uiAttribs":{"subPatch":"qxtwmd6gb"},"storage":{},"portsOut":[{"name":"Result","value":1}],"objName":"Ops.Boolean.Not"}]}'};const u=t.inTrigger("n7i7hux58");u.setUiAttribs({title:"Update"});const l=t.inArray("5ydf4tifk");l.setUiAttribs({title:"left objects"});l.setUiAttribs({values:[""]});const p=t.inArray("ul0a4ym88");p.setUiAttribs({title:"right ids"});p.setUiAttribs({values:[""]});const c=t.inString("bpkzafijw","");c.setUiAttribs({title:"left array fieldname"});c.setUiAttribs({values:[""]});const b=t.inString("3aw49ekwu","");b.setUiAttribs({title:"source id fieldname"});b.setUiAttribs({values:[""]});const m=t.outArray("j609dr0b8");m.setUiAttribs({title:"links"});m.setUiAttribs({values:[""]});t.initInnerPorts=function(e){for(let t=0;t<e.length;t++){if(e[t].innerInput){const n=e[t].outTrigger("innerOut_n7i7hux58");n.setUiAttribs({title:"Update"});u.onTriggered=()=>{n.trigger()};const r=e[t].outArray("innerOut_5ydf4tifk");r.setUiAttribs({title:"left objects"});l.on("change",(t,e)=>{r.setRef(t)});const a=e[t].outArray("innerOut_ul0a4ym88");a.setUiAttribs({title:"right ids"});p.on("change",(t,e)=>{a.setRef(t)});const o=e[t].outString("innerOut_bpkzafijw");o.set(c.get());o.setUiAttribs({title:"left array fieldname"});c.on("change",(t,e)=>{o.set(t)});const i=e[t].outString("innerOut_3aw49ekwu");i.set(b.get());i.setUiAttribs({title:"source id fieldname"});b.on("change",(t,e)=>{i.set(t)})}if(e[t].innerOutput){const s=e[t].inArray("innerIn_j609dr0b8");s.setUiAttribs({title:"links"});s.on("change",(t,e)=>{m.setRef(t)})}}};const r="bp2sub_"+t.id;new CABLES.SubPatchOp(t,{subId:r});e();function e(){if(!n||!n.subpatch_json)return;const e=JSON.parse(n.subpatch_json);CABLES.Patch.replaceOpIds(e,{parentSubPatchId:r,prefixHash:r,oldIdAsRef:true,doNotUnlinkLostLinks:true});for(let t=0;t<e.ops.length;t++){e.ops[t].uiAttribs.blueprintSubpatch2=true}t.loadDependencies(e,()=>{t.patch.deSerialize(e,{opsCreated:t.initInnerPorts});if(CABLES.UI)gui.savedState.setSaved("blueprintloaded",r);t.patch.emitEvent("subpatchExpose",r);t.setStorage({blueprintVer:2});t.patch.emitEvent("subpatchExpose",r)})}}};CABLES.OPS["ac232c29-0f7f-4ca8-9d0a-24b87630e550"]={f:Ops.Team.ACAR.GetD3Links,objName:"Ops.Team.ACAR.GetD3Links"};Ops.Array.ArrayOfObjectsFilterByKeyValue_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const u=t.inArray("Array");const l=t.inString("Filter Key","");const p=t.inString("Filter Value","");const c=t.inBool("Invert Filter",false);const b=t.outArray("arrayOut");const m=(t,e,n)=>{return t&&t[n]==e};const d=(t,e,n)=>{return t&&t[n]!=e};u.onChange=c.onChange=l.onChange=p.onChange=function(){const n=u.get();if(!n){return}if(Array.isArray(n)){const r=l.get();const a=!c.get()?m:d;const o=[];const i=p.get();for(let t=0,e=n.length;t<e;t+=1){const s=n[t];if(a(s,i,r)){o.push(s)}}b.setRef(o)}else{b.set(null)}}}};CABLES.OPS["60f77ab9-b6a5-441f-89e1-03e39ab1a958"]={f:Ops.Array.ArrayOfObjectsFilterByKeyValue_v2,objName:"Ops.Array.ArrayOfObjectsFilterByKeyValue_v2"};Ops.Data.Compose.Object.CompObject=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Update"),r=t.inBool("Clear",true),a=t.inTriggerButton("Reset"),o=t.outTrigger("Next"),i=t.outObject("Result");let s={};a.onTriggered=()=>{s={};i.setRef(s)};n.onTriggered=()=>{t.patch.tempData.compObject=t.patch.tempData.compObject||[];if(r.get())s={};t.patch.tempData.compObject.push(s);o.trigger();i.setRef(t.patch.tempData.compObject.pop())}}};CABLES.OPS["c85b449b-fb4e-40b3-928e-5eea6a5d0ebc"]={f:Ops.Data.Compose.Object.CompObject,objName:"Ops.Data.Compose.Object.CompObject"};Ops.Data.Compose.Object.CompObjectSetString=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Update"),r=e.inString("Key",""),a=e.inString("String",""),o=e.outTrigger("Next");e.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true,minLength:1});n.onTriggered=()=>{if(e.patch.tempData.compObject&&e.patch.tempData.compObject.length>0){let t=e.patch.tempData.compObject[e.patch.tempData.compObject.length-1];t[r.get()]=a.get()}o.trigger()}}};CABLES.OPS["b5a24d4c-4b1d-44c7-b6ef-a38cc71b9ad1"]={f:Ops.Data.Compose.Object.CompObjectSetString,objName:"Ops.Data.Compose.Object.CompObjectSetString"};Ops.Data.Compose.Object.CompObjectSetNumber=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Update"),r=e.inString("Key",""),a=e.inFloat("Number",0),o=e.outTrigger("Next");e.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true,minLength:1});n.onTriggered=()=>{if(e.patch.tempData.compObject&&e.patch.tempData.compObject.length>0){let t=e.patch.tempData.compObject[e.patch.tempData.compObject.length-1];t[r.get()]=a.get()}o.trigger()}}};CABLES.OPS["58a75bf7-6828-4190-a205-3b8037bc24d4"]={f:Ops.Data.Compose.Object.CompObjectSetNumber,objName:"Ops.Data.Compose.Object.CompObjectSetNumber"};Ops.Data.Compose.Object.CompObjectSetObject=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Update"),r=e.inString("Key",""),a=e.inObject("Object"),o=e.outTrigger("Next");e.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true,minLength:1});n.onTriggered=()=>{if(e.patch.tempData.compObject&&e.patch.tempData.compObject.length>0){let t=e.patch.tempData.compObject[e.patch.tempData.compObject.length-1];t[r.get()]=a.get()}o.trigger()}}};CABLES.OPS["1c6974a0-3f70-4a64-8bb6-3d8ac99beab4"]={f:Ops.Data.Compose.Object.CompObjectSetObject,objName:"Ops.Data.Compose.Object.CompObjectSetObject"};Ops.Data.Compose.Array.CompArrayPushArrayItems=class extends CABLES.Op{constructor(){super(...arguments);const r=this;const t=r.attachments={};const e=r.inTrigger("Update"),a=r.inArray("Array"),o=r.outTrigger("Next");e.onTriggered=()=>{if(r.patch.tempData.compArray&&r.patch.tempData.compArray.length>0){let e=r.patch.tempData.compArray[r.patch.tempData.compArray.length-1];try{const n=a.get()||[];for(let t=0;t<n.length;t++){e.push(n[t])}}catch(t){r.log("error comparraupusharray")}}o.trigger()}}};CABLES.OPS["4107c3c2-40ad-4bee-b809-022377bf5601"]={f:Ops.Data.Compose.Array.CompArrayPushArrayItems,objName:"Ops.Data.Compose.Array.CompArrayPushArrayItems"};Ops.Json.ObjectKeys=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object"),r=t.outArray("Keys"),a=t.outNumber("Num Keys");n.onChange=function(){let t=n.get();if(!t){a.set(0);r.set([]);return}let e=Object.keys(t);a.set(e.length);r.set(e)}}};CABLES.OPS["83b4d148-8cb3-4a45-8824-957eeaf02e22"]={f:Ops.Json.ObjectKeys,objName:"Ops.Json.ObjectKeys"};Ops.Array.ArrayIteratorStrings=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Exe"),r=t.inArray("Array"),a=t.outTrigger("Trigger"),o=t.outNumber("Index"),i=t.outString("Value");n.onTriggered=function(){if(!r.get())return;for(let e=0;e<r.get().length;e++){o.set(e);let t=null;if(r.get()[e]){t=String(r.get()[e])}i.set(t);a.trigger()}}}};CABLES.OPS["0f8ee026-e094-484d-8403-547c92293be9"]={f:Ops.Array.ArrayIteratorStrings,objName:"Ops.Array.ArrayIteratorStrings"};Ops.String.StringContains_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String"),r=t.inString("SearchValue"),a=t.outBoolNum("Found",false),o=t.outNumber("Index",-1);r.onChange=n.onChange=i;i();function i(){if(n.get()&&r.get()&&r.get().length>0){const t=n.get().indexOf(r.get());o.set(t);a.set(t>-1)}else{o.set(-1);a.set(false)}}}};CABLES.OPS["2ca3e5d7-e6b4-46a7-8381-3fe1ad8b6879"]={f:Ops.String.StringContains_v2,objName:"Ops.String.StringContains_v2"};Ops.Ui.VizArrayTable_v2=class extends CABLES.Op{constructor(){super(...arguments);const d=this;const t=d.attachments={};const f=d.inArray("Array"),g=d.inInt("Stride",0),h=d.inFloatSlider("Scroll",0);d.setUiAttrib({height:200,width:400,resizable:true,vizLayerMaxZoom:2500});function O(e){let n="";if(typeof e=="string"){n='"'+e+'"'}else if(CABLES.isNumeric(e))n=String(Math.round(e*1e4)/1e4);else if(Array.isArray(e)){let t="...";if(e.length==0)t="";n="["+t+"] ("+e.length+")"}else if(typeof e=="object"){try{n=JSON.stringify(e,true,1)}catch(t){n="{???}"}}else if(e!=e||e===undefined){n+=String(e)}else{n+=String(e)}return n}d.renderVizLayer=(r,a)=>{r.fillStyle="#222";r.fillRect(a.x,a.y,a.width,a.height);r.save();r.scale(a.scale,a.scale);r.font="normal 10px sourceCodePro";r.fillStyle="#ccc";const o=f.get()||[];let i=g.get()||1;if(f.get()===null)d.setUiAttrib({extendTitle:"null"});else if(f.get()===undefined)d.setUiAttrib({extendTitle:"undefined"});else d.setUiAttrib({extendTitle:"length: "+o.length});if(f.links.length>0&&f.links[0].getOtherPort(f))i=f.links[0].getOtherPort(f).uiAttribs.stride||g.get()||1;if(o.length%i!=0)d.setUiError("stride","stride does not fit length of array. some values may not be shown",1);else d.setUiError("stride",null);let s=Math.floor(a.height/a.scale/10-1);let u=4;let l=Math.floor(h.get()*o.length/i);l=Math.max(0,l);if(s*i>o.length)l=0;else l=Math.min(o.length-s*i,l*i);let n=[];for(let t=0;t<i;t++)n[t]=0;for(let e=l;e<l+s*i;e+=i){for(let t=0;t<i;t++){const c=o[e+t];n[t]=Math.max(n[t],O(c).length)}}let p=[];let e=30;for(let t=0;t<i;t++){p[t]=e;e+=(n[t]+1)*7}for(let n=l;n<l+s*i;n+=i){if(n<0)continue;if(n+i>o.length)continue;r.fillStyle="#666";const b=n/i;if(b>=0)r.fillText(b,a.x/a.scale+u,a.y/a.scale+10+(n-l)/i*10+u);for(let t=0;t<i;t++){const c=o[n+t];let e=O(c);r.fillStyle="#ccc";if(typeof c=="string"){e=c}else if(CABLES.isNumeric(c))e=String(Math.round(c*1e4)/1e4);else if(Array.isArray(c)){e=JSON.stringify(c)}else if(typeof c=="object"){try{e=JSON.stringify(c)}catch(t){e="{Object}"}}else if(c!=c){r.fillStyle="#f00";e="Nan"}else if(c===undefined){r.fillStyle="#f00";e="undefined"}r.fillText(e,a.x/a.scale+p[t],a.y/a.scale+10+(n-l)/i*10+u)}}if(f.get()===null)r.fillText("null",a.x/a.scale+10,a.y/a.scale+10+u);else if(f.get()===undefined)r.fillText("undefined",a.x/a.scale+10,a.y/a.scale+10+u);const t=30;if(a.scale<=0)return;if(l>0){const m=r.createLinearGradient(0,a.y/a.scale+5,0,a.y/a.scale+t);m.addColorStop(0,"#222");m.addColorStop(1,"rgba(34,34,34,0.0)");r.fillStyle=m;r.fillRect(a.x/a.scale,a.y/a.scale,2e5,t)}if(l+s*i<o.length){const m=r.createLinearGradient(0,a.y/a.scale+a.height/a.scale-t+5,0,a.y/a.scale+a.height/a.scale-t+t);m.addColorStop(1,"#222");m.addColorStop(0,"rgba(34,34,34,0.0)");r.fillStyle=m;r.fillRect(a.x/a.scale,a.y/a.scale+a.height/a.scale-t,2e5,t)}if(s*i/o.length<1){let t=a.height-20;let e=l/o.length;e*=t;r.fillStyle="#000";r.fillRect((a.x+a.width-15)/a.scale,(a.y+10)/a.scale,5/a.scale,t/a.scale);t*=s*i/o.length;r.fillStyle="#555";r.fillRect((a.x+a.width-15)/a.scale,(a.y+10+e)/a.scale,5/a.scale,t/a.scale)}r.restore()}}};CABLES.OPS["6c3bf614-a734-4539-98cd-7a7d5bfc38c9"]={f:Ops.Ui.VizArrayTable_v2,objName:"Ops.Ui.VizArrayTable_v2"};Ops.Boolean.IfFalseThen=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Exe"),r=t.inValueBool("Boolean",false),a=t.outTrigger("then"),o=t.outTrigger("else");r.onChange=i;n.onTriggered=s;function i(){if(n.isLinked())return;s()}function s(){if(!r.get())a.trigger();else o.trigger()}}};CABLES.OPS["91cf65f1-94ac-423f-a536-af71eed08440"]={f:Ops.Boolean.IfFalseThen,objName:"Ops.Boolean.IfFalseThen"};Ops.Json.ObjectGetArray_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("data"),r=t.inString("key"),a=t.outArray("result"),o=t.outNumber("Length");a.ignoreValueSerialize=true;n.ignoreValueSerialize=true;t.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true});t.toWorkPortsNeedsString(r);n.onChange=r.onChange=s;r.on("change",i);i();function i(){if(!r.get())t.setUiError("nokey","Missing Key Value",1);else t.setUiError("nokey",null)}function s(){const t=n.get();const e=r.get();if(t&&(t.hasOwnProperty(e)||t[e])){a.setRef(t[e]);if(!a.get()){o.setRef(0)}else{o.setRef(a.get().length)}}else{o.set(0)}}}};CABLES.OPS["7c06a818-9c07-493a-8c4f-04eb2c7796f5"]={f:Ops.Json.ObjectGetArray_v2,objName:"Ops.Json.ObjectGetArray_v2"};Ops.Json.ObjectValuesAsArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object"),r=t.outArray("Values"),a=t.outNumber("Num values");n.onChange=()=>{const t=n.get();if(!t){a.set(0);r.set([]);return}const e=Object.values(t);a.set(e.length);r.set(e)}}};CABLES.OPS["32ff73f5-7947-42b0-83fa-e079af7beb5c"]={f:Ops.Json.ObjectValuesAsArray,objName:"Ops.Json.ObjectValuesAsArray"};Ops.Array.FlattenArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array"),r=t.outArray("Result");n.onChange=function(){var t=n.get();r.set(null);if(!t){return}var e=t.slice(0);e=e.flat(Infinity);r.set(e)}}};CABLES.OPS["bd5f43cf-7a69-4bff-85b3-08df62b899b4"]={f:Ops.Array.FlattenArray,objName:"Ops.Array.FlattenArray"};Ops.Boolean.Not=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueBool("Boolean"),r=t.outBoolNum("Result");n.changeAlways=true;n.onChange=function(){r.set(!n.get())}}};CABLES.OPS["6d123c9f-7485-4fd9-a5c2-76e59dcbeb34"]={f:Ops.Boolean.Not,objName:"Ops.Boolean.Not"};Ops.Json.HttpRequest_v3=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const r=o.inUrl("file"),i=o.inObject("headers",{}),s=o.inStringEditor("body",""),u=o.inDropDown("HTTP Method",["GET","POST","PUT","DELETE","PATCH","HEAD","CONNECT","OPTIONS","TRACE"],"GET"),l=o.inString("Content-Type","application/json"),p=o.inSwitch("Content",["JSON","String","Binary","Binary Base64"],"JSON"),c=o.inBool("Auto request",true),b=o.inBool("Send Credentials",false),e=o.inTriggerButton("reload"),m=o.outObject("Response Json Object"),d=o.outString("Response String"),f=o.outString("Response Data Url"),g=o.outNumber("Duration MS",0),h=o.outNumber("Status Code",0),O=o.outBoolNum("Is Loading",false),v=o.outTrigger("Loaded");p.setUiAttribs({title:"Response Content"});r.setUiAttribs({title:"URL"});e.setUiAttribs({buttonTitle:"trigger request"});m.ignoreValueSerialize=true;d.ignoreValueSerialize=true;d.onLinkChanged=f.onLinkChanged=m.onLinkChanged=j;p.onChange=()=>{const t=p.get()==="Binary";u.setUiAttribs({greyout:t});a(false)};c.onChange=r.onChange=i.onChange=u.onChange=()=>{a(false)};e.onTriggered=()=>{a(true)};let n=0;function a(t=false){clearTimeout(n);n=setTimeout(()=>{y(null,t)},100)}o.onFileChanged=t=>{if(r.get()&&r.get().indexOf(t)>-1)y(true)};function j(){if(!r.get())o.setUiError("nourl","URL is empty",1);else o.setUiError("nourl",null)}function y(t,e=false){if(!c.get()&&!e)return;j();if(!r.get()){return}const a=o.patch.loading.start(o.objName,""+r.get(),o);O.set(true);o.setUiAttrib({extendTitle:CABLES.basename(r.get())});o.setUiError("jsonerr",null);o.setUiError("jsonParse",null);let n=o.patch.getFilePath(r.get());if(t)n+="?rnd="+CABLES.generateUUID();o.patch.loading.addAssetLoadingTask(()=>{const t=s.get();const r=performance.now();const e={};if(b.get())e.credentials="include";if(p.get().includes("Binary")){fetch(n,e).then(t=>{g.set(Math.round(performance.now()-r));h.set(t.status);t.blob().then(t=>{f.set(URL.createObjectURL(t));if(p.get().includes("Base64")){const e=new FileReader;e.onloadend=function(){const t=e.result;f.set(t);O.set(false);v.trigger();o.patch.loading.finished(a)};e.readAsDataURL(t)}else{O.set(false);v.trigger();o.patch.loading.finished(a)}}).catch(t=>{o.logError(t);o.setUiError("jsonerr","Problem while loading data:<br/>"+t,1);O.set(false);m.setRef(null);d.set("");v.trigger();o.patch.loading.finished(a)})}).catch(t=>{o.logError(t);o.setUiError("jsonerr","Problem while loading data:<br/>"+t,1);O.set(false);m.setRef(null);d.set("");v.trigger();o.patch.loading.finished(a)})}else{CABLES.ajax(n,(t,e,n)=>{g.set(Math.round(performance.now()-r));h.set(n.status);try{let t=e;if(typeof t==="string"&&p.get()==="JSON"){try{t=JSON.parse(e);m.setRef(t)}catch(t){o.setUiError("jsonParse","could not parse json"+t.message,1);m.setRef({})}}d.set(e);o.uiAttr({error:null});v.trigger();O.set(false);o.patch.loading.finished(a)}catch(t){o.logError(t);o.setUiError("jsonerr","Problem while loading data:<br/>"+t,1);O.set(false);m.setRef(null);d.set("");o.patch.loading.finished(a)}},u.get(),t&&t.length>0?t:null,l.get(),null,i.get()||{},e)}})}}};CABLES.OPS["ba2131a6-782d-40fe-9710-57a8e57051bb"]={f:Ops.Json.HttpRequest_v3,objName:"Ops.Json.HttpRequest_v3"};Ops.Gl.MainLoop_v2=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};const e=n.inFloat("Max Pixel Density (DPR)",2),r=n.inValue("FPS Limit",0),a=n.inValueBool("Reduce FPS unfocussed",false),o=n.inValueBool("Transparent",false),i=n.inValueBool("Active",1),s=n.outTrigger("trigger"),u=n.outNumber("width"),l=n.outNumber("height"),p=n.outNumber("Pixel Density");n.onAnimFrame=x;e.onChange=y;const c=n.patch.cg=n.patch.cgl;let b=0;let m=0;let d=null;let f=false;if(!n.patch.cgl)n.uiAttr({error:"No webgl cgl context"});const g=vec3.create();vec3.set(g,0,0,0);const h=vec3.create();vec3.set(h,0,0,-2);let O=null;let v=true;let j=true;window.addEventListener("blur",()=>{v=false});window.addEventListener("focus",()=>{v=true});document.addEventListener("visibilitychange",()=>{j=!document.hidden});k();n.patch.tempData.mainloopOp=this;function y(){A();if(CABLES.UI){if(e.get()<1)n.patch.cgl.canvas.style.imageRendering="pixelated"}n.patch.cgl.updateSize();if(CABLES.UI)gui.setLayout()}i.onChange=function(){n.patch.removeOnAnimFrame(n);if(i.get()){n.setUiAttrib({extendTitle:""});n.onAnimFrame=x;n.patch.addOnAnimFrame(n);n.log("adding again!")}else{n.setUiAttrib({extendTitle:"Inactive"})}};function I(){if(a.get()){if(!j)return 10;if(!v)return 30}return r.get()}n.onDelete=function(){c.gl.clearColor(0,0,0,0);c.gl.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT)};function A(){if(e.get()!=0)n.patch.cgl.pixelDensity=Math.min(e.get(),window.devicePixelRatio);else n.patch.cgl.pixelDensity=window.devicePixelRatio}function x(t){if(!i.get())return;if(c.aborted||c.canvas.clientWidth===0||c.canvas.clientHeight===0)return;n.patch.cg=c;A();const e=performance.now();n.patch.config.fpsLimit=I();if(c.canvasWidth==-1){c.setCanvas(n.patch.config.glCanvasId);return}if(c.canvasWidth!=u.get()||c.canvasHeight!=l.get()){u.set(c.canvasWidth/1);l.set(c.canvasHeight/1)}if(CABLES.now()-m>1e3){CGL.fpsReport=CGL.fpsReport||[];if(n.patch.loading.getProgress()>=1&&m!==0)CGL.fpsReport.push(b);b=0;m=CABLES.now()}CGL.MESH.lastShader=null;CGL.MESH.lastMesh=null;c.renderStart(c,g,h);if(!o.get())c.gl.clearColor(0,0,0,1);else c.gl.clearColor(0,0,0,0);c.gl.clear(c.gl.COLOR_BUFFER_BIT|c.gl.DEPTH_BUFFER_BIT);s.trigger();if(CGL.MESH.lastMesh)CGL.MESH.lastMesh.unBind();if(CGL.Texture.previewTexture){if(!CGL.Texture.texturePreviewer)CGL.Texture.texturePreviewer=new CGL.Texture.texturePreview(c);CGL.Texture.texturePreviewer.render(CGL.Texture.previewTexture)}c.renderEnd(c);n.patch.cg=null;if(!o.get()){c.gl.clearColor(1,1,1,1);c.gl.colorMask(false,false,false,true);c.gl.clear(c.gl.COLOR_BUFFER_BIT);c.gl.colorMask(true,true,true,true)}if(!c.tempData.phong)c.tempData.phong={};b++;p.set(n.patch.cgl.pixelDensity);n.patch.cgl.profileData.profileMainloopMs=performance.now()-e}function k(){clearTimeout(d);d=setTimeout(()=>{if(n.patch.getOpsByObjName(n.name).length>1){n.setUiError("multimainloop","there should only be one mainloop op!");if(!f)f=n.patch.addEventListener("onOpDelete",k)}else n.setUiError("multimainloop",null,1)},500)}}};CABLES.OPS["f1029550-d877-42da-9b1e-63a5163a0350"]={f:Ops.Gl.MainLoop_v2,objName:"Ops.Gl.MainLoop_v2"};Ops.Sidebar.Sidebar=class extends CABLES.Op{constructor(){super(...arguments);const i=this;const n=i.attachments={style_css:" /*\n * SIDEBAR\n  http://danielstern.ca/range.css/#/\n  https://developer.mozilla.org/en-US/docs/Web/CSS/::-webkit-progress-value\n */\n\n.sidebar-icon-undo\n{\n    width:10px;\n    height:10px;\n    background-image: url(\"data:image/svg+xml;charset=utf8, %3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' fill='none' stroke='grey' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M3 7v6h6'/%3E%3Cpath d='M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13'/%3E%3C/svg%3E\");\n    background-size: 19px;\n    background-repeat: no-repeat;\n    top: -19px;\n    margin-top: -7px;\n}\n\n.icon-chevron-down {\n    top: 2px;\n    right: 9px;\n}\n\n.iconsidebar-chevron-up,.sidebar__close-button {\n\tbackground-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tdXAiPjxwb2x5bGluZSBwb2ludHM9IjE4IDE1IDEyIDkgNiAxNSI+PC9wb2x5bGluZT48L3N2Zz4=);\n}\n\n.iconsidebar-minimizebutton {\n    background-position: 98% center;\n    background-repeat: no-repeat;\n}\n\n.sidebar-cables-right\n{\n    right: 15px;\n    left: initial !important;\n}\n\n.sidebar-cables *\n{\n    color: #BBBBBB !important;\n    font-family: Arial;\n}\n\n.sidebar-cables {\n    --sidebar-color: #07f78c;\n    --sidebar-width: 220px;\n    --sidebar-border-radius: 10px;\n    --sidebar-monospace-font-stack: \"SFMono-Regular\", Consolas, \"Liberation Mono\", Menlo, Courier, monospace;\n    --sidebar-hover-transition-time: .2s;\n\n    position: absolute;\n    top: 15px;\n    left: 15px;\n    border-radius: var(--sidebar-border-radius);\n    z-index: 100000;\n    width: var(--sidebar-width);\n    max-height: 100%;\n    box-sizing: border-box;\n    overflow-y: auto;\n    overflow-x: hidden;\n    font-size: 13px;\n    line-height: 1em; /* prevent emojis from breaking height of the title */\n}\n\n.sidebar-cables::selection {\n    background-color: var(--sidebar-color);\n    color: #EEEEEE;\n}\n\n.sidebar-cables::-webkit-scrollbar {\n    background-color: transparent;\n    --cables-scrollbar-width: 8px;\n    width: var(--cables-scrollbar-width);\n}\n\n.sidebar-cables::-webkit-scrollbar-track {\n    background-color: transparent;\n    width: var(--cables-scrollbar-width);\n}\n\n.sidebar-cables::-webkit-scrollbar-thumb {\n    background-color: #333333;\n    border-radius: 4px;\n    width: var(--cables-scrollbar-width);\n}\n\n.sidebar-cables--closed {\n    width: auto;\n}\n\n.sidebar__close-button {\n    background-color: #222;\n    /*-webkit-user-select: none;  */\n    /*-moz-user-select: none;     */\n    /*-ms-user-select: none;      */\n    /*user-select: none;          */\n    /*transition: background-color var(--sidebar-hover-transition-time);*/\n    /*color: #CCCCCC;*/\n    height: 2px;\n    /*border-bottom:20px solid #222;*/\n\n    /*box-sizing: border-box;*/\n    /*padding-top: 2px;*/\n    /*text-align: center;*/\n    /*cursor: pointer;*/\n    /*border-radius: 0 0 var(--sidebar-border-radius) var(--sidebar-border-radius);*/\n    /*opacity: 1.0;*/\n    /*transition: opacity 0.3s;*/\n    /*overflow: hidden;*/\n}\n\n.sidebar__close-button-icon {\n    display: inline-block;\n    /*opacity: 0;*/\n    width: 20px;\n    height: 20px;\n    /*position: relative;*/\n    /*top: -1px;*/\n\n\n}\n\n.sidebar--closed {\n    width: auto;\n    margin-right: 20px;\n}\n\n.sidebar--closed .sidebar__close-button {\n    margin-top: 8px;\n    margin-left: 8px;\n    padding:10px;\n\n    height: 25px;\n    width:25px;\n    border-radius: 50%;\n    cursor: pointer;\n    opacity: 0.3;\n    background-repeat: no-repeat;\n    background-position: center center;\n    transform:rotate(180deg);\n}\n\n.sidebar--closed .sidebar__group\n{\n    display:none;\n\n}\n.sidebar--closed .sidebar__close-button-icon {\n    background-position: 0px 0px;\n}\n\n.sidebar__close-button:hover {\n    background-color: #111111;\n    opacity: 1.0 !important;\n}\n\n/*\n * SIDEBAR ITEMS\n */\n\n.sidebar__items {\n    /* max-height: 1000px; */\n    /* transition: max-height 0.5;*/\n    background-color: #222;\n    padding-bottom: 20px;\n}\n\n.sidebar--closed .sidebar__items {\n    /* max-height: 0; */\n    height: 0;\n    display: none;\n    pointer-interactions: none;\n}\n\n.sidebar__item__right {\n    float: right;\n}\n\n/*\n * SIDEBAR GROUP\n */\n\n.sidebar__group {\n    /*background-color: #1A1A1A;*/\n    overflow: hidden;\n    box-sizing: border-box;\n    animate: height;\n    /*background-color: #151515;*/\n    /* max-height: 1000px; */\n    /* transition: max-height 0.5s; */\n--sidebar-group-header-height: 33px;\n}\n\n.sidebar__group-items\n{\n    padding-top: 15px;\n    padding-bottom: 15px;\n}\n\n.sidebar__group--closed {\n    /* max-height: 13px; */\n    height: var(--sidebar-group-header-height);\n}\n\n.sidebar__group-header {\n    box-sizing: border-box;\n    color: #EEEEEE;\n    background-color: #151515;\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n\n    /*height: 100%;//var(--sidebar-group-header-height);*/\n\n    padding-top: 7px;\n    text-transform: uppercase;\n    letter-spacing: 0.08em;\n    cursor: pointer;\n    /*transition: background-color var(--sidebar-hover-transition-time);*/\n    position: relative;\n}\n\n.sidebar__group-header:hover {\n  background-color: #111111;\n}\n\n.sidebar__group-header-title {\n  /*float: left;*/\n  overflow: hidden;\n  padding: 0 15px;\n  padding-top:5px;\n  padding-bottom:10px;\n  font-weight:bold;\n}\n\n.sidebar__group-header-undo {\n    float: right;\n    overflow: hidden;\n    padding-right: 15px;\n    padding-top:5px;\n    font-weight:bold;\n  }\n\n.sidebar__group-header-icon {\n    width: 17px;\n    height: 14px;\n    background-repeat: no-repeat;\n    display: inline-block;\n    position: absolute;\n    background-size: cover;\n\n    /* icon open */\n    /* feather icon: chevron up */\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tdXAiPjxwb2x5bGluZSBwb2ludHM9IjE4IDE1IDEyIDkgNiAxNSI+PC9wb2x5bGluZT48L3N2Zz4=);\n    top: 4px;\n    right: 5px;\n    opacity: 0.0;\n    transition: opacity 0.3;\n}\n\n.sidebar__group-header:hover .sidebar__group-header-icon {\n    opacity: 1.0;\n}\n\n/* icon closed */\n.sidebar__group--closed .sidebar__group-header-icon {\n    /* feather icon: chevron down */\n    background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tZG93biI+PHBvbHlsaW5lIHBvaW50cz0iNiA5IDEyIDE1IDE4IDkiPjwvcG9seWxpbmU+PC9zdmc+);\n    top: 4px;\n    right: 5px;\n}\n\n/*\n * SIDEBAR ITEM\n */\n\n.sidebar__item\n{\n    box-sizing: border-box;\n    padding: 7px;\n    padding-left:15px;\n    padding-right:15px;\n\n    overflow: hidden;\n    position: relative;\n}\n\n.sidebar__item-label {\n    display: inline-block;\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n    width: calc(50% - 7px);\n    margin-right: 7px;\n    margin-top: 2px;\n    text-overflow: ellipsis;\n    /* overflow: hidden; */\n}\n\n.sidebar__item-value-label {\n    font-family: var(--sidebar-monospace-font-stack);\n    display: inline-block;\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n    max-width: 60%;\n}\n\n.sidebar__item-value-label::selection {\n    background-color: var(--sidebar-color);\n    color: #EEEEEE;\n}\n\n.sidebar__item + .sidebar__item,\n.sidebar__item + .sidebar__group,\n.sidebar__group + .sidebar__item,\n.sidebar__group + .sidebar__group {\n    /*border-top: 1px solid #272727;*/\n}\n\n/*\n * SIDEBAR ITEM TOGGLE\n */\n\n/*.sidebar__toggle */\n.icon_toggle{\n    cursor: pointer;\n}\n\n.sidebar__toggle-input {\n    --sidebar-toggle-input-color: #CCCCCC;\n    --sidebar-toggle-input-color-hover: #EEEEEE;\n    --sidebar-toggle-input-border-size: 2px;\n    display: inline;\n    float: right;\n    box-sizing: border-box;\n    border-radius: 50%;\n    /*outline-style: solid;*/\n    /*outline-color:red;*/\n    cursor: pointer;\n    --toggle-size: 11px;\n    margin-top: 2px;\n    background-color: transparent !important;\n    border: var(--sidebar-toggle-input-border-size) solid var(--sidebar-toggle-input-color);\n    width: var(--toggle-size);\n    height: var(--toggle-size);\n    transition: background-color var(--sidebar-hover-transition-time);\n    transition: border-color var(--sidebar-hover-transition-time);\n}\n.sidebar__toggle:hover .sidebar__toggle-input {\n    border-color: var(--sidebar-toggle-input-color-hover);\n}\n\n.sidebar__toggle .sidebar__item-value-label {\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n    max-width: calc(50% - 12px);\n}\n.sidebar__toggle-input::after { clear: both; }\n\n.sidebar__toggle--active .icon_toggle\n{\n\n    background-image: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE1cHgiIHdpZHRoPSIzMHB4IiBmaWxsPSIjMDZmNzhiIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iIzA2Zjc4YiIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCBjMTIuNjUsMCwyMy0xMC4zNSwyMy0yM2wwLDBjMC0xMi42NS0xMC4zNS0yMy0yMy0yM0gzMHogTTcwLDY3Yy05LjM4OSwwLTE3LTcuNjEtMTctMTdzNy42MTEtMTcsMTctMTdzMTcsNy42MSwxNywxNyAgICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PC9nPjwvZz48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMweiBNNzAsNjdjLTkuMzg5LDAtMTctNy42MS0xNy0xN3M3LjYxMS0xNywxNy0xN3MxNyw3LjYxLDE3LDE3ICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48cGF0aCBmaWxsPSIjMDZmNzhiIiBzdHJva2U9IiMwNmY3OGIiIHN0cm9rZS13aWR0aD0iNCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNNyw1MGMwLDEyLjY1LDEwLjM1LDIzLDIzLDIzaDQwICAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMwQzE3LjM1LDI3LDcsMzcuMzUsNyw1MEw3LDUweiI+PC9wYXRoPjwvZz48Y2lyY2xlIGRpc3BsYXk9ImlubGluZSIgZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiMwNmY3OGIiIHN0cm9rZT0iIzA2Zjc4YiIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGN4PSI3MCIgY3k9IjUwIiByPSIxNyI+PC9jaXJjbGU+PC9nPjxnIGRpc3BsYXk9Im5vbmUiPjxwYXRoIGRpc3BsYXk9ImlubGluZSIgZD0iTTcwLDI1SDMwQzE2LjIxNSwyNSw1LDM2LjIxNSw1LDUwczExLjIxNSwyNSwyNSwyNWg0MGMxMy43ODUsMCwyNS0xMS4yMTUsMjUtMjVTODMuNzg1LDI1LDcwLDI1eiBNNzAsNzEgICBIMzBDMTguNDIxLDcxLDksNjEuNTc5LDksNTBzOS40MjEtMjEsMjEtMjFoNDBjMTEuNTc5LDAsMjEsOS40MjEsMjEsMjFTODEuNTc5LDcxLDcwLDcxeiBNNzAsMzFjLTEwLjQ3NywwLTE5LDguNTIzLTE5LDE5ICAgczguNTIzLDE5LDE5LDE5czE5LTguNTIzLDE5LTE5UzgwLjQ3NywzMSw3MCwzMXogTTcwLDY1Yy04LjI3MSwwLTE1LTYuNzI5LTE1LTE1czYuNzI5LTE1LDE1LTE1czE1LDYuNzI5LDE1LDE1Uzc4LjI3MSw2NSw3MCw2NXoiPjwvcGF0aD48L2c+PC9zdmc+);\n    opacity: 1;\n    transform: rotate(0deg);\n    background-position: -4px -9px;\n}\n\n\n.icon_toggle\n{\n    float: right;\n    width:40px;\n    height:18px;\n    background-image: url(data:image/svg+xml;base64,PHN2ZyBoZWlnaHQ9IjE1cHgiIHdpZHRoPSIzMHB4IiBmaWxsPSIjYWFhYWFhIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjEiIHg9IjBweCIgeT0iMHB4IiB2aWV3Qm94PSIwIDAgMTAwIDEwMCIgZW5hYmxlLWJhY2tncm91bmQ9Im5ldyAwIDAgMTAwIDEwMCIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZmlsbD0iI2FhYWFhYSIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCBjMTIuNjUsMCwyMy0xMC4zNSwyMy0yM2wwLDBjMC0xMi42NS0xMC4zNS0yMy0yMy0yM0gzMHogTTcwLDY3Yy05LjM4OSwwLTE3LTcuNjEtMTctMTdzNy42MTEtMTcsMTctMTdzMTcsNy42MSwxNywxNyAgICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PC9nPjwvZz48Zz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTMwLDI3QzE3LjM1LDI3LDcsMzcuMzUsNyw1MGwwLDBjMCwxMi42NSwxMC4zNSwyMywyMywyM2g0MCAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMweiBNNzAsNjdjLTkuMzg5LDAtMTctNy42MS0xNy0xN3M3LjYxMS0xNywxNy0xN3MxNyw3LjYxLDE3LDE3ICAgUzc5LjM4OSw2Nyw3MCw2N3oiPjwvcGF0aD48L2c+PGcgZGlzcGxheT0ibm9uZSI+PGcgZGlzcGxheT0iaW5saW5lIj48cGF0aCBmaWxsPSIjYWFhYWFhIiBzdHJva2U9IiNhYWFhYWEiIHN0cm9rZS13aWR0aD0iNCIgc3Ryb2tlLW1pdGVybGltaXQ9IjEwIiBkPSJNNyw1MGMwLDEyLjY1LDEwLjM1LDIzLDIzLDIzaDQwICAgIGMxMi42NSwwLDIzLTEwLjM1LDIzLTIzbDAsMGMwLTEyLjY1LTEwLjM1LTIzLTIzLTIzSDMwQzE3LjM1LDI3LDcsMzcuMzUsNyw1MEw3LDUweiI+PC9wYXRoPjwvZz48Y2lyY2xlIGRpc3BsYXk9ImlubGluZSIgZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGZpbGw9IiNhYWFhYWEiIHN0cm9rZT0iI2FhYWFhYSIgc3Ryb2tlLXdpZHRoPSI0IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGN4PSI3MCIgY3k9IjUwIiByPSIxNyI+PC9jaXJjbGU+PC9nPjxnIGRpc3BsYXk9Im5vbmUiPjxwYXRoIGRpc3BsYXk9ImlubGluZSIgZD0iTTcwLDI1SDMwQzE2LjIxNSwyNSw1LDM2LjIxNSw1LDUwczExLjIxNSwyNSwyNSwyNWg0MGMxMy43ODUsMCwyNS0xMS4yMTUsMjUtMjVTODMuNzg1LDI1LDcwLDI1eiBNNzAsNzEgICBIMzBDMTguNDIxLDcxLDksNjEuNTc5LDksNTBzOS40MjEtMjEsMjEtMjFoNDBjMTEuNTc5LDAsMjEsOS40MjEsMjEsMjFTODEuNTc5LDcxLDcwLDcxeiBNNzAsMzFjLTEwLjQ3NywwLTE5LDguNTIzLTE5LDE5ICAgczguNTIzLDE5LDE5LDE5czE5LTguNTIzLDE5LTE5UzgwLjQ3NywzMSw3MCwzMXogTTcwLDY1Yy04LjI3MSwwLTE1LTYuNzI5LTE1LTE1czYuNzI5LTE1LDE1LTE1czE1LDYuNzI5LDE1LDE1Uzc4LjI3MSw2NSw3MCw2NXoiPjwvcGF0aD48L2c+PC9zdmc+);\n    background-size: 50px 37px;\n    background-position: -6px -10px;\n    transform: rotate(180deg);\n    opacity: 0.4;\n}\n\n\n\n/*.sidebar__toggle--active .sidebar__toggle-input {*/\n/*    transition: background-color var(--sidebar-hover-transition-time);*/\n/*    background-color: var(--sidebar-toggle-input-color);*/\n/*}*/\n/*.sidebar__toggle--active .sidebar__toggle-input:hover*/\n/*{*/\n/*    background-color: var(--sidebar-toggle-input-color-hover);*/\n/*    border-color: var(--sidebar-toggle-input-color-hover);*/\n/*    transition: background-color var(--sidebar-hover-transition-time);*/\n/*    transition: border-color var(--sidebar-hover-transition-time);*/\n/*}*/\n\n/*\n * SIDEBAR ITEM BUTTON\n */\n\n.sidebar__button {}\n\n.sidebar__button-input:active\n{\n    background-color: #555 !important;\n}\n\n.sidebar__button-input {\n    -webkit-user-select: none;  /* Chrome all / Safari all */\n    -moz-user-select: none;     /* Firefox all */\n    -ms-user-select: none;      /* IE 10+ */\n    user-select: none;          /* Likely future */\n    min-height: 24px;\n    background-color: transparent;\n    color: #CCCCCC;\n    box-sizing: border-box;\n    padding-top: 3px;\n    text-align: center;\n    border-radius: 125px;\n    border:2px solid #555;\n    cursor: pointer;\n    padding-bottom: 3px;\n    display:block;\n}\n\n.sidebar__button-input.plus, .sidebar__button-input.minus {\n    display: inline-block;\n    min-width: 20px;\n}\n\n.sidebar__button-input:hover {\n  background-color: #333;\n  border:2px solid var(--sidebar-color);\n}\n\n/*\n * VALUE DISPLAY (shows a value)\n */\n\n.sidebar__value-display {}\n\n/*\n * SLIDER\n */\n\n.sidebar__slider {\n    --sidebar-slider-input-height: 3px;\n}\n\n.sidebar__slider-input-wrapper {\n    width: 100%;\n\n    margin-top: 8px;\n    position: relative;\n}\n\n.sidebar__slider-input {\n    -webkit-appearance: none;\n    appearance: none;\n    margin: 0;\n    width: 100%;\n    height: var(--sidebar-slider-input-height);\n    background: #555;\n    cursor: pointer;\n    /*outline: 0;*/\n\n    -webkit-transition: .2s;\n    transition: background-color .2s;\n    border: none;\n}\n\n.sidebar__slider-input:focus, .sidebar__slider-input:hover {\n    border: none;\n}\n\n.sidebar__slider-input-active-track {\n    user-select: none;\n    position: absolute;\n    z-index: 11;\n    top: 0;\n    left: 0;\n    background-color: var(--sidebar-color);\n    pointer-events: none;\n    height: var(--sidebar-slider-input-height);\n    max-width: 100%;\n}\n\n/* Mouse-over effects */\n.sidebar__slider-input:hover {\n    /*background-color: #444444;*/\n}\n\n/*.sidebar__slider-input::-webkit-progress-value {*/\n/*    background-color: green;*/\n/*    color:green;*/\n\n/*    }*/\n\n/* The slider handle (use -webkit- (Chrome, Opera, Safari, Edge) and -moz- (Firefox) to override default look) */\n\n.sidebar__slider-input::-moz-range-thumb\n{\n    position: absolute;\n    height: 15px;\n    width: 15px;\n    z-index: 900 !important;\n    border-radius: 20px !important;\n    cursor: pointer;\n    background: var(--sidebar-color) !important;\n    user-select: none;\n\n}\n\n.sidebar__slider-input::-webkit-slider-thumb\n{\n    position: relative;\n    appearance: none;\n    -webkit-appearance: none;\n    user-select: none;\n    height: 15px;\n    width: 15px;\n    display: block;\n    z-index: 900 !important;\n    border: 0;\n    border-radius: 20px !important;\n    cursor: pointer;\n    background: #777 !important;\n}\n\n.sidebar__slider-input:hover ::-webkit-slider-thumb {\n    background-color: #EEEEEE !important;\n}\n\n/*.sidebar__slider-input::-moz-range-thumb {*/\n\n/*    width: 0 !important;*/\n/*    height: var(--sidebar-slider-input-height);*/\n/*    background: #EEEEEE;*/\n/*    cursor: pointer;*/\n/*    border-radius: 0 !important;*/\n/*    border: none;*/\n/*    outline: 0;*/\n/*    z-index: 100 !important;*/\n/*}*/\n\n.sidebar__slider-input::-moz-range-track {\n    background-color: transparent;\n    z-index: 11;\n}\n\n.sidebar__slider input[type=text],\n.sidebar__slider input[type=paddword]\n{\n    box-sizing: border-box;\n    /*background-color: #333333;*/\n    text-align: right;\n    color: #BBBBBB;\n    display: inline-block;\n    background-color: transparent !important;\n\n    width: 40%;\n    height: 18px;\n    /*outline: none;*/\n    border: none;\n    border-radius: 0;\n    padding: 0 0 0 4px !important;\n    margin: 0;\n}\n\n.sidebar__slider input[type=text]:active,\n.sidebar__slider input[type=text]:focus,\n.sidebar__slider input[type=text]:hover\n.sidebar__slider input[type=password]:active,\n.sidebar__slider input[type=password]:focus,\n.sidebar__slider input[type=password]:hover\n{\n\n    color: #EEEEEE;\n}\n\n/*\n * TEXT / DESCRIPTION\n */\n\n.sidebar__text .sidebar__item-label {\n    width: auto;\n    display: block;\n    max-height: none;\n    margin-right: 0;\n    line-height: 1.1em;\n}\n\n/*\n * SIDEBAR INPUT\n */\n.sidebar__text-input textarea,\n.sidebar__text-input input[type=date],\n.sidebar__text-input input[type=datetime-local],\n.sidebar__text-input input[type=text],\n.sidebar__text-input input[type=password] {\n    box-sizing: border-box;\n    background-color: #333333;\n    color: #BBBBBB;\n    display: inline-block;\n    width: 50%;\n    height: 18px;\n\n\n    border: none;\n    border-radius: 0;\n    border:1px solid #666;\n    padding: 0 0 0 4px !important;\n    margin: 0;\n    color-scheme: dark;\n}\n\n.sidebar__text-input textarea:focus::placeholder {\n  color: transparent;\n}\n\n\n\n\n\n.sidebar__color-picker .sidebar__item-label\n{\n    width:45%;\n}\n\n.sidebar__text-input textarea,\n.sidebar__text-input input[type=text]:active,\n.sidebar__text-input input[type=text]:focus,\n.sidebar__text-input input[type=text]:hover,\n.sidebar__text-input input[type=password]:active,\n.sidebar__text-input input[type=password]:focus,\n.sidebar__text-input input[type=password]:hover {\n    background-color: transparent;\n    color: #EEEEEE;\n\n}\n\n.sidebar__text-input textarea\n{\n    margin-top:10px;\n    height:60px;\n    width:100%;\n}\n\n/*\n * SIDEBAR SELECT\n */\n\n\n\n .sidebar__select {}\n .sidebar__select-select {\n    color: #BBBBBB;\n    /*-webkit-appearance: none;*/\n    /*-moz-appearance: none;*/\n    appearance: none;\n    /*box-sizing: border-box;*/\n    width: 50%;\n    /*height: 20px;*/\n    background-color: #333333;\n    /*background-image: url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyNCIgaGVpZ2h0PSIyNCIgdmlld0JveD0iMCAwIDI0IDI0IiBmaWxsPSJub25lIiBzdHJva2U9IiM4ODg4ODgiIHN0cm9rZS13aWR0aD0iMiIgc3Ryb2tlLWxpbmVjYXA9InJvdW5kIiBzdHJva2UtbGluZWpvaW49InJvdW5kIiBjbGFzcz0iZmVhdGhlciBmZWF0aGVyLWNoZXZyb24tZG93biI+PHBvbHlsaW5lIHBvaW50cz0iNiA5IDEyIDE1IDE4IDkiPjwvcG9seWxpbmU+PC9zdmc+);*/\n    background-repeat: no-repeat;\n    background-position: right center;\n    background-size: 16px 16px;\n    margin: 0;\n    /*padding: 0 2 2 6px;*/\n    border-radius: 5px;\n    border: 1px solid #777;\n    background-color: #444;\n    cursor: pointer;\n    /*outline: none;*/\n    padding-left: 5px;\n\n }\n\n.sidebar__select-select:hover,\n.sidebar__select-select:active,\n.sidebar__select-select:inactive {\n    background-color: #444444;\n    color: #EEEEEE;\n}\n\n/*.sidebar__select-select option*/\n/*{*/\n/*    background-color: #444444;*/\n/*    color: #bbb;*/\n/*}*/\n\n.sidebar__select-select option:checked\n{\n    background-color: #000;\n    color: #FFF;\n}\n\n\n/*\n * COLOR PICKER\n */\n\n\n .sidebar__color-picker input[type=text] {\n    box-sizing: border-box;\n    background-color: #333333;\n    color: #BBBBBB;\n    display: inline-block;\n    width: calc(50% - 21px); /* 50% minus space of picker circle */\n    height: 18px;\n    /*outline: none;*/\n    border: none;\n    border-radius: 0;\n    padding: 0 0 0 4px !important;\n    margin: 0;\n    margin-right: 7px;\n}\n\n.sidebar__color-picker input[type=text]:active,\n.sidebar__color-picker input[type=text]:focus,\n.sidebar__color-picker input[type=text]:hover {\n    background-color: #444444;\n    color: #EEEEEE;\n}\n\ndiv.sidebar__color-picker-color-input,\n.sidebar__color-picker input[type=color],\n.sidebar__palette-picker input[type=color] {\n    display: inline-block;\n    border-radius: 100%;\n    height: 14px;\n    width: 14px;\n\n    padding: 0;\n    border: none;\n    /*border:2px solid red;*/\n    border-color: transparent;\n    outline: none;\n    background: none;\n    appearance: none;\n    -moz-appearance: none;\n    -webkit-appearance: none;\n    cursor: pointer;\n    position: relative;\n    top: 3px;\n}\n.sidebar__color-picker input[type=color]:focus,\n.sidebar__palette-picker input[type=color]:focus {\n    outline: none;\n}\n.sidebar__color-picker input[type=color]::-moz-color-swatch,\n.sidebar__palette-picker input[type=color]::-moz-color-swatch {\n    border: none;\n}\n.sidebar__color-picker input[type=color]::-webkit-color-swatch-wrapper,\n.sidebar__palette-picker input[type=color]::-webkit-color-swatch-wrapper {\n    padding: 0;\n}\n.sidebar__color-picker input[type=color]::-webkit-color-swatch,\n.sidebar__palette-picker input[type=color]::-webkit-color-swatch {\n    border: none;\n    border-radius: 100%;\n}\n\n/*\n * Palette Picker\n */\n.sidebar__palette-picker .sidebar__palette-picker-color-input.first {\n    margin-left: 0;\n}\n.sidebar__palette-picker .sidebar__palette-picker-color-input.last {\n    margin-right: 0;\n}\n.sidebar__palette-picker .sidebar__palette-picker-color-input {\n    margin: 0 4px;\n}\n\n.sidebar__palette-picker .circlebutton {\n    width: 14px;\n    height: 14px;\n    border-radius: 1em;\n    display: inline-block;\n    top: 3px;\n    position: relative;\n}\n\n/*\n * Preset\n */\n.sidebar__item-presets-preset\n{\n    padding:4px;\n    cursor:pointer;\n    padding-left:8px;\n    padding-right:8px;\n    margin-right:4px;\n    background-color:#444;\n}\n\n.sidebar__item-presets-preset:hover\n{\n    background-color:#666;\n}\n\n.sidebar__greyout\n{\n    background: #222;\n    opacity: 0.8;\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    z-index: 1000;\n    right: 0;\n    top: 0;\n}\n\n.sidebar_tabs\n{\n    background-color: #151515;\n    padding-bottom: 0px;\n}\n\n.sidebar_switchs\n{\n    float: right;\n}\n\n.sidebar_tab\n{\n    float:left;\n    background-color: #151515;\n    border-bottom:1px solid transparent;\n    padding-right:7px;\n    padding-left:7px;\n    padding-bottom: 5px;\n    padding-top: 5px;\n    cursor:pointer;\n}\n\n.sidebar_tab_active\n{\n    background-color: #272727;\n    color:white;\n}\n\n.sidebar_tab:hover\n{\n    border-bottom:1px solid #777;\n    color:white;\n}\n\n\n.sidebar_switch\n{\n    float:left;\n    background-color: #444;\n    padding-right:7px;\n    padding-left:7px;\n    padding-bottom: 5px;\n    padding-top: 5px;\n    cursor:pointer;\n}\n\n.sidebar_switch:last-child\n{\n    border-top-right-radius: 7px;\n    border-bottom-right-radius: 7px;\n}\n\n.sidebar_switch:first-child\n{\n    border-top-left-radius: 7px;\n    border-bottom-left-radius: 7px;\n}\n\n\n.sidebar_switch_active\n{\n    background-color: #999;\n    color:white;\n}\n\n.sidebar_switch:hover\n{\n    color:white;\n}\n\n.sidebar__text-input-input::focus-visible,\n/*.sidebar__text-input-input:active,*/\n.sidebar__button-input:focus-visible,\n.sidebar__text-input:focus-visible\n/*.sidebar__text-input:active*/\n{\n    outline-style: solid;\n    outline-color:white;\n    outline-width: 1px;\n\n}\n\n"};const r="cables-sidebar-style";const a="cables-sidebar-dynamic-style";const s="sidebar-cables";const u="sidebar"+CABLES.uuid();const l="sidebar__items";const p="sidebar__close-button";const o="";const c="";let b=null;let z=null;let m=null;const t=i.inValueBool("Visible",true);const e=i.inValueSlider("Opacity",1);const d=i.inValueBool("Default Minimized");const f=i.inValueSlider("Minimized Opacity",.5);const g=i.inValueBool("Show undo button",false);const h=i.inValueBool("Show Minimize",false);const O=i.inString("Title","");const v=i.inValueBool("Side");const j=i.inValueBool("Default CSS",true);let y=i.patch.cgl.canvas.ownerDocument;const I=i.outObject("childs");I.setUiAttribs({title:"Children"});const A=i.outBool("Opfened");A.setUiAttribs({title:"Opened"});let x=y.querySelector("."+u);if(!x)x=L();const k=x.querySelector("."+l);I.set({parentElement:k,parentOp:i});w();P();E();j.onChange=()=>{P();E()};t.onChange=R;e.onChange=T;d.onChange=w;f.onChange=S;g.onChange=N;i.onDelete=q;function S(){E()}h.onChange=_;function _(t){if(!t||t.uiAttribs)t=y.querySelector(".sidebar-cables .sidebar__group-header");if(!t)return;const e=y.querySelector(".sidebar-cables .sidebar__group-header .sidebar__group-header-undo");if(h.get()){t.classList.add("iconsidebar-chevron-up");t.classList.add("iconsidebar-minimizebutton");if(e)e.style.marginRight="20px"}else{t.classList.remove("iconsidebar-chevron-up");t.classList.remove("iconsidebar-minimizebutton");if(e)e.style.marginRight="initial"}}v.onChange=function(){if(!x)return;if(v.get())x.classList.add("sidebar-cables-right");else x.classList.remove("sidebar-cables-right")};function N(){const t=y.querySelector(".sidebar-cables .sidebar__group-header");if(t){C(t)}}function C(t){if(t){const e=y.querySelector(".sidebar-cables .sidebar__group-header .sidebar__group-header-undo");if(e){if(!g.get()){e.remove()}}else{if(g.get()){const n=y.createElement("span");n.classList.add("sidebar__group-header-undo");n.classList.add("sidebar-icon-undo");n.addEventListener("click",function(t){t.stopPropagation();const e=y.querySelectorAll(".sidebar-cables .sidebar__reloadable");const n=y.createEvent("MouseEvents");n.initEvent("dblclick",true,true);e.forEach(t=>{t.dispatchEvent(n)})});t.appendChild(n)}}}_(t)}function w(){if(!b){return}if(d.get()){x.classList.add("sidebar--closed");if(t.get())A.set(false)}else{x.classList.remove("sidebar--closed");if(t.get())A.set(true)}}function T(){const t=e.get();x.style.opacity=t}function R(){if(!x)return;if(t.get()){x.style.display="block";if(!x.classList.contains("sidebar--closed"))A.set(true)}else{x.style.display="none";A.set(false)}}v.onChanged=function(){};function E(){const t=y.querySelectorAll("."+a);if(t){t.forEach(function(t){t.parentNode.removeChild(t)})}if(!j.get())return;const e=y.createElement("style");e.classList.add("cablesEle");e.classList.add(a);let n=".sidebar--closed .sidebar__close-button { ";n+="opacity: "+f.get();n+="}";const r=y.createTextNode(n);e.appendChild(r);y.body.appendChild(e)}function L(){const t=y.createElement("div");t.classList.add(s);t.classList.add(u);const e=i.patch.cgl.canvas.parentElement;const n=y.createElement("div");n.classList.add("sidebar__group");t.appendChild(n);const r=y.createElement("div");r.classList.add("sidebar__group-header");t.appendChild(r);const a=y.createElement("span");a.classList.add("sidebar__group-header-title");m=y.createElement("span");m.classList.add("sidebar__group-header-title-text");m.innerHTML=O.get();a.appendChild(m);r.appendChild(a);C(r);_(r);n.appendChild(r);t.appendChild(n);n.addEventListener("click",V);if(!e){i.warn("[sidebar] no canvas parentelement found...");return}e.appendChild(t);const o=y.createElement("div");o.classList.add(l);t.appendChild(o);b=y.createElement("div");b.classList.add(p);b.addEventListener("click",V);t.appendChild(b);return t}O.onChange=function(){if(m)m.innerHTML=O.get()};function M(t){}function V(t){t.stopPropagation();if(!x){i.logError("Sidebar could not be closed...");return}x.classList.toggle("sidebar--closed");const e=t.target;let n=o;if(x.classList.contains("sidebar--closed")){n=c;A.set(false)}else{A.set(true)}}function P(){const t=y.querySelectorAll("."+r);if(t){t.forEach(t=>{t.parentNode.removeChild(t)})}if(!j.get())return;const e=y.createElement("style");e.innerHTML=n.style_css;e.classList.add(r);e.classList.add("cablesEle");y.body.appendChild(e)}function q(){B(x)}function B(t){if(t&&t.parentNode&&t.parentNode.removeChild)t.parentNode.removeChild(t)}}};CABLES.OPS["5a681c35-78ce-4cb3-9858-bc79c34c6819"]={f:Ops.Sidebar.Sidebar,objName:"Ops.Sidebar.Sidebar"};Ops.Gl.ClearColor=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("render"),r=t.outTrigger("trigger"),a=t.inFloatSlider("r",.1),o=t.inFloatSlider("g",.1),i=t.inFloatSlider("b",.1),s=t.inFloatSlider("a",1);a.setUiAttribs({colorPick:true});const u=t.patch.cgl;n.onTriggered=function(){u.gl.clearColor(a.get(),o.get(),i.get(),s.get());u.gl.clear(u.gl.COLOR_BUFFER_BIT|u.gl.DEPTH_BUFFER_BIT);r.trigger()}}};CABLES.OPS["19b441eb-9f63-4f35-ba08-b87841517c4d"]={f:Ops.Gl.ClearColor,objName:"Ops.Gl.ClearColor"};Ops.Html.FontFile_v2=class extends CABLES.Op{constructor(){super(...arguments);const a=this;const t=a.attachments={};const o=a.inUrl("file",[".otf",".ttf",".woff",".woff2"]),i=a.inString("family"),s=a.inBool("Active",true),u=a.outBoolNum("Loaded"),l=a.outTrigger("Loaded Trigger");let p=null;let c;let b=null;let e=null;let m=null;let d="";o.onChange=function(){u.set(false);r(null)};s.onChange=i.onChange=()=>{n()};function n(){clearTimeout(e);e=setTimeout(()=>{r(null)},50)}a.patch.on("windowChanged",t=>{c=null;r(t.document)});function r(t){if(m)m.remove();if(c){const e=b.fonts.delete(c);c=null;setTimeout(()=>{a.patch.emitEvent("fontLoaded",d)},100)}if(!s.get())return;b=t||b||a.patch.cgl.canvas.ownerDocument||document;if(p)p=a.patch.cgl.patch.loading.finished(p);a.setUiError("loadingerror",null);d=i.get();if(o.get()&&i.get()){if(b.fonts){let t='url("'+a.patch.getFilePath(String(o.get()))+'")';c=new FontFace(i.get(),t);p=a.patch.cgl.patch.loading.start("FontFile",o.get(),a);b.fonts.add(c);c.loaded.then(t=>{u.set(true);l.trigger();p=a.patch.cgl.patch.loading.finished(p);a.patch.emitEvent("fontLoaded",i.get())},t=>{a.setUiError("loadingerror","Font loading error: "+c.status+"("+o.get()+")");p=a.patch.cgl.patch.loading.finished(p);u.set(true)}).catch(t=>{p=a.patch.cgl.patch.loading.finished(p);console.error("catch ",t)});c.load()}else{const n=a.patch.getFilePath(String(o.get()));const r="".endl()+"@font-face".endl()+"{".endl()+'  font-family: "'+i.get()+'";'.endl()+'  src: url("'+n+'") format("truetype");'.endl()+"}";m=document.createElement("style");m.classList.add("cablesEle");m.type="text/css";m.innerHTML=r;document.getElementsByTagName("head")[document.getElementsByTagName("head").length-1].appendChild(m)}}}}};CABLES.OPS["68177370-116e-4c76-aef3-3b10d68e7227"]={f:Ops.Html.FontFile_v2,objName:"Ops.Html.FontFile_v2"};Ops.Json.ObjectToArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object");const r=t.outArray("Array");n.onChange=function(){r.set(n.get())}}};CABLES.OPS["f8ac4574-ffe3-4618-a27f-30d190308e2c"]={f:Ops.Json.ObjectToArray,objName:"Ops.Json.ObjectToArray"};Ops.Json.ObjectSetNumber_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object"),r=t.outObject("Result Object"),a=t.inString("Key"),o=t.inFloat("Number");n.onChange=o.onChange=i;a.setUiAttribs({stringTrim:true,minLength:1});r.ignoreValueSerialize=true;t.toWorkPortsNeedsString(a);function i(){let t=n.get();if(!t)t={};const e=JSON.parse(JSON.stringify(t));e[a.get()]=o.get();r.setRef(e)}a.onChange=()=>{t.setUiAttrib({extendTitle:a.get()});i()}}};CABLES.OPS["20f7bcab-ed71-45d1-9fae-d89aacf3961b"]={f:Ops.Json.ObjectSetNumber_v2,objName:"Ops.Json.ObjectSetNumber_v2"};Ops.Json.ParseObject_v2=class extends CABLES.Op{constructor(){super(...arguments);const s=this;const t=s.attachments={};const u=s.inStringEditor("JSON String","{}","json"),e=s.outObject("Result"),l=s.outBoolNum("Valid");u.onChange=n;n();function n(){if(!u.get()){e.set(null);l.set(false);return}try{const t=JSON.parse(u.get());e.setRef(t);l.set(true);s.setUiError("invalidjson",null)}catch(t){s.logWarn(t);l.set(false);let e="";const n=t.message.split(" ");for(let t=0;t<n.length-1;t++){const r=parseFloat(n[t+1]);if(r&&n[t]=="position"){const a=u.get().substring(r-15,r);const o=u.get().substring(r,r+1);const i=u.get().substring(r+1,r+15);e='<span style="font-family:monospace;background-color:black;">'+a+'<span style="font-weight:bold;background-color:red;">'+o+"</span>"+i+" </span>"}}s.setUiError("invalidjson","INVALID JSON<br/>can not parse string to object:<br/><b> "+t.message+"</b><br/>"+e)}}}};CABLES.OPS["2ce8a4d3-37d3-4cdc-abd1-a560fbe841ee"]={f:Ops.Json.ParseObject_v2,objName:"Ops.Json.ParseObject_v2"};Ops.Sidebar.Group=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};let n=e.inObject("link");let r=e.inString("Text","Group");const a=e.inBool("Show Title",true);let o=e.inValueBool("Default Minimized");const i=e.inBool("Visible",true);let s=e.outObject("next");let u=e.outObject("childs");i.onChange=function(){l.style.display=i.get()?"block":"none"};let l=document.createElement("div");l.dataset.op=e.id;l.classList.add("sidebar__group");f();let p=document.createElement("div");p.classList.add("sidebar__group-header");p.classList.add("cablesEle");l.appendChild(p);p.addEventListener("click",g);let c=document.createElement("div");c.classList.add("sidebar__group-header-title");p.appendChild(c);let b=document.createElement("span");b.textContent=r.get();b.classList.add("sidebar__group-header-title-text");c.appendChild(b);let m=document.createElement("span");m.classList.add("sidebar__group-header-icon");m.classList.add("iconsidebar-chevron-up");c.appendChild(m);let d=document.createElement("div");d.classList.add("sidebar__group-items");l.appendChild(d);e.toWorkPortsNeedToBeLinked(n);n.onChange=O;r.onChange=h;o.onChange=f;e.onDelete=y;a.onChange=()=>{if(a.get())p.style.display="block";else p.style.display="none"};function f(){if(o.get()){l.classList.add("sidebar__group--closed")}else{l.classList.remove("sidebar__group--closed")}}function g(t){t.stopPropagation();l.classList.toggle("sidebar__group--closed")}function h(){let t=r.get();b.textContent=t;if(CABLES.UI)e.setUiAttrib({extendTitle:t})}function O(){u.set(null);let t=n.get();if(t&&t.parentElement){t.parentElement.appendChild(l);u.set({parentElement:d,parentOp:e});s.set(t)}else{if(l.parentElement){l.parentElement.removeChild(l)}}}function v(t){if(t){t.style.display="block"}}function j(t){if(t){t.style.display="none"}}function y(){I(l)}function I(t){if(t&&t.parentNode&&t.parentNode.removeChild){t.parentNode.removeChild(t)}}}};CABLES.OPS["86ea2333-b51c-48ed-94c2-8b7b6e9ff34c"]={f:Ops.Sidebar.Group,objName:"Ops.Sidebar.Group"};Ops.Sidebar.Toggle_v4=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("link"),r=e.inString("Text","Toggle"),a=e.inBool("Input",true),o=e.inTriggerButton("Set Default"),i=e.inBool("Default"),s=e.inBool("Grey Out",false),u=e.inBool("Visible",true),l=e.outObject("childs"),p=e.outBoolNum("Value",i.get()),c=e.outTrigger("Toggled");i.setUiAttribs({hidePort:true,greyout:true});const b="sidebar__toggle--active";const m=document.createElement("div");m.dataset.op=e.id;m.classList.add("cablesEle");m.classList.add("sidebar__item");m.classList.add("sidebar__toggle");m.classList.add("sidebar__reloadable");m.classList.add(b);const d=document.createTextNode(r.get());const f=document.createElement("div");f.classList.add("sidebar__item-label");f.appendChild(d);const g=document.createElement("a");p.set(i.get());g.classList.add("icon_toggle");g.addEventListener("click",I);g.addEventListener("keypress",y);g.setAttribute("tabindex",0);g.setAttribute("aria-label","toggle "+r.get());const h=document.createElement("div");h.classList.add("sidebar__greyout");h.style.display="none";m.appendChild(h);m.appendChild(g);m.appendChild(f);m.addEventListener("dblclick",O);e.init=()=>{O();j()};e.onDelete=N;n.onChange=k;r.onChange=x;a.onChange=A;o.onTriggered=v;function O(){p.set(i.get());a.set(i.get());c.trigger()}function v(){const t=a.get();i.set(t);p.set(t);c.trigger();e.refreshParams()}function j(){const t=p.get();if(t){g.classList.add("icon_toggle_true");g.classList.remove("icon_toggle_false")}else{g.classList.remove("icon_toggle_true");g.classList.add("icon_toggle_false")}}function y(t){if(t.code==="Enter")I()}function I(){m.classList.toggle(b);const t=m.classList.contains(b);p.set(t);a.set(t);j();c.trigger();e.refreshParams()}function A(){if(a.get())m.classList.add(b);else m.classList.remove(b);p.set(a.get());c.trigger()}function x(){const t=r.get();f.textContent=t;g.setAttribute("aria-label","toggle "+r.get());if(CABLES.UI)e.setUiAttrib({extendTitle:t})}function k(){l.set(null);const t=n.get();if(t&&t.parentElement){t.parentElement.appendChild(m);l.set(t)}else if(m.parentElement)m.parentElement.removeChild(m)}function S(t){if(t)t.style.display="block"}function _(t){if(t)t.style.display="none"}function N(){if(m&&m.parentNode&&m.parentNode.removeChild)m.parentNode.removeChild(m)}s.onChange=function(){h.style.display=s.get()?"block":"none"};u.onChange=function(){m.style.display=u.get()?"block":"none"}}};CABLES.OPS["247f5aaf-6438-4a37-9649-4c0fe9cc78c9"]={f:Ops.Sidebar.Toggle_v4,objName:"Ops.Sidebar.Toggle_v4"};Ops.Sidebar.Slider_v3=class extends CABLES.Op{constructor(){super(...arguments);const a=this;const z=a.attachments={};const t=1e-5;const e=a.inObject("link");const n=a.inString("Text","Slider");const o=a.inValue("Min",0);const i=a.inValue("Max",1);const r=a.inValue("Step",t);const s=a.inString("Suffix","");const u=a.inBool("Grey Out",false);const l=a.inBool("Visible",true);const p=a.inValue("Input",.5);const c=a.inTriggerButton("Set Default");const b=a.inTriggerButton("Reset");let m=null;const d=a.inValue("Default",.5);d.setUiAttribs({hidePort:true,greyout:true});const f=a.outObject("childs");const g=a.outNumber("Result",d.get());a.toWorkNeedsParent("Ops.Sidebar.Sidebar");a.setPortGroup("Range",[o,i,r]);a.setPortGroup("Display",[u,l]);const h=document.createElement("div");h.addEventListener("dblclick",function(){g.set(parseFloat(d.get()));p.set(parseFloat(d.get()));V(d.get())});h.dataset.op=a.id;h.classList.add("cablesEle");h.classList.add("sidebar__item");h.classList.add("sidebar__slider");h.classList.add("sidebar__reloadable");a.patch.on("sidebarStylesChanged",()=>{w()});const O=document.createElement("div");O.classList.add("sidebar__item-label");const v=document.createElement("div");v.classList.add("sidebar__greyout");h.appendChild(v);v.style.display="none";const j=document.createTextNode(n.get());O.appendChild(j);h.appendChild(O);const y=document.createElement("input");y.value=d.get();y.classList.add("sidebar__text-input-input");y.setAttribute("type","text");y.oninput=S;h.appendChild(y);const I=document.createElement("span");h.appendChild(I);s.onChange=()=>{I.innerHTML=s.get()};const A=document.createElement("div");A.classList.add("sidebar__slider-input-wrapper");h.appendChild(A);const x=document.createElement("div");x.classList.add("sidebar__slider-input-active-track");A.appendChild(x);const k=document.createElement("input");k.classList.add("sidebar__slider-input");k.setAttribute("min",o.get());k.setAttribute("max",i.get());k.setAttribute("type","range");k.setAttribute("step",r.get());k.setAttribute("value",d.get());k.style.display="block";A.appendChild(k);w();k.addEventListener("input",C);e.onChange=q;n.onChange=M;p.onChange=_;d.onChange=L;c.onTriggered=N;o.onChange=T;i.onChange=E;r.onChange=R;a.onDelete=U;a.onLoaded=a.onInit=function(){if(a.patch.config.sidebar){a.patch.config.sidebar[n.get()];g.set(a.patch.config.sidebar[n.get()])}else{g.set(parseFloat(d.get()));p.set(parseFloat(d.get()))}};b.onTriggered=function(){const t=parseFloat(d.get());g.set(t);V(t);P(t);p.set(t);w()};u.onChange=function(){v.style.display=u.get()?"block":"none"};l.onChange=function(){h.style.display=l.get()?"block":"none"};function S(t){let e=parseFloat(t.target.value);if(isNaN(e))e=0;const n=o.get();const r=i.get();if(e<n){e=n}else if(e>r){e=r}g.set(e);w();p.set(e);a.refreshParams()}function _(){let t=parseFloat(p.get());const e=o.get();const n=i.get();if(t>n){t=n}else if(t<e){t=e}P(t);g.set(t);w()}function N(){let t=parseFloat(p.get());const e=o.get();const n=i.get();if(t>n){t=n}else if(t<e){t=e}V(t);P(t);g.set(t);d.set(t);a.refreshParams();w()}function C(t){t.preventDefault();t.stopPropagation();V(t.target.value);const e=parseFloat(t.target.value);g.set(e);p.set(e);a.refreshParams();w();return false}function R(){const t=r.get();k.setAttribute("step",t);w()}function w(t){let e=parseFloat(k.value);if(typeof t!=="undefined")e=t;let n=x.parentElement.getBoundingClientRect().width||220;if(m)n=parseInt(getComputedStyle(m.parentElement).getPropertyValue("--sidebar-width"))-20;const r=CABLES.map(e,parseFloat(k.min),parseFloat(k.max),0,n-16);x.style.width=r+"px"}function T(){const t=o.get();k.setAttribute("min",t);w()}function E(){const t=i.get();k.setAttribute("max",t);w()}function L(){const t=d.get();g.set(parseFloat(t));T();E();P(t);V(t);w(t)}function M(){const t=n.get();O.textContent=t;if(CABLES.UI)a.setUiAttrib({extendTitle:t});y.setAttribute("aria-label","slider "+n.get());k.setAttribute("aria-label","slider "+n.get())}function q(){f.set(null);m=e.get();if(m&&m.parentElement){m.parentElement.appendChild(h);f.set(m)}else if(h.parentElement)h.parentElement.removeChild(h);w()}function V(t){y.value=t}function P(t){k.value=t}function B(t){if(t)t.style.display="block"}function D(t){if(t)t.style.display="none"}function U(){G(h)}function G(t){if(t&&t.parentNode&&t.parentNode.removeChild)t.parentNode.removeChild(t)}}};CABLES.OPS["74730122-5cba-4d0d-b610-df334ec6220a"]={f:Ops.Sidebar.Slider_v3,objName:"Ops.Sidebar.Slider_v3"};Ops.Json.ObjectSetObject_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object"),r=t.inString("Key"),a=t.inObject("Object Value"),o=t.outObject("Result Object");n.onLinkChanged=a.onChange=o.onLinkChanged=n.onChange=i;r.setUiAttribs({stringTrim:true,minLength:1});function i(){const t=n.get()||{};let e=t;e[r.get()]=a.get();o.setRef(e)}r.onChange=()=>{t.setUiAttrib({extendTitle:r.get()});i()}}};CABLES.OPS["84283526-5687-4bdc-92aa-22c81972a3a7"]={f:Ops.Json.ObjectSetObject_v2,objName:"Ops.Json.ObjectSetObject_v2"};Ops.Trigger.DelayedTrigger=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("exe"),r=t.inValueFloat("delay",1),a=t.inTriggerButton("Cancel"),o=t.outTrigger("next"),i=t.outBool("Delaying");let s=null;a.onTriggered=function(){if(s)clearTimeout(s);s=null};n.onTriggered=function(){i.set(true);if(s)clearTimeout(s);s=setTimeout(function(){i.set(false);s=null;o.trigger()},r.get()*1e3)}}};CABLES.OPS["f4ff66b0-8500-46f7-9117-832aea0c2750"]={f:Ops.Trigger.DelayedTrigger,objName:"Ops.Trigger.DelayedTrigger"};Ops.String.File.SwitchFile_v2=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};let e=n.inValueInt("Index");let r=[];let a=n.outString("Result");e.onChange=o;for(let e=0;e<16;e++){let t=n.inUrl("File "+e);r.push(t);t.onChange=o}function o(){const t=e.get();if(t>=0&&r[t]){a.set(r[t].get())}}}};CABLES.OPS["250c8d79-2b83-419f-8c23-910d95936f2c"]={f:Ops.String.File.SwitchFile_v2,objName:"Ops.String.File.SwitchFile_v2"};Ops.Vars.VarGetNumber_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.outNumber("Value");t.varName=t.inValueSelect("Variable",[],"",true);new CABLES.VarGetOpWrapper(t,"number",t.varName,n)}};CABLES.OPS["421f5b52-c0fa-47c4-8b7a-012b9e1c864a"]={f:Ops.Vars.VarGetNumber_v2,objName:"Ops.Vars.VarGetNumber_v2"};Ops.Color.HexToRGB_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const a=t.inString("Hex","#ff0000"),o=t.inValueBool("Bytes"),i=t.outNumber("R"),s=t.outNumber("G"),u=t.outNumber("B");function l(t){return parseInt(n(t).substring(0,2),16)||0}function p(t){return parseInt(n(t).substring(2,4),16)||0}function c(t){return parseInt(n(t).substring(4,6),16)||0}function n(t=""){return t.charAt(0)=="#"?t.substring(1,7):t}a.onChange=r;o.onChange=r;function r(){let t=a.get()||"";let e=l(t);let n=p(t);let r=c(t);if(!o.get()){e/=255;n/=255;r/=255}i.set(e);u.set(r);s.set(n)}}};CABLES.OPS["9877f198-8dac-48e5-9310-244ef1a8dec5"]={f:Ops.Color.HexToRGB_v2,objName:"Ops.Color.HexToRGB_v2"};Ops.Array.Array3Iterator=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Execute"),r=t.inArray("Array"),a=t.inValue("Step"),o=t.outTrigger("Trigger"),i=t.outNumber("Index"),s=t.outNumber("Value 1"),u=t.outNumber("Value 2"),l=t.outNumber("Value 3");let p=r.get()||[];let c=1;a.onChange=d;d();let b=0;let m=0;r.onChange=function(){p=r.get()||[]};function d(){c=a.get()||1;if(c<1)c=1;c=3*c}n.onTriggered=function(){m=0;for(let t=0,e=p.length;t<e;t+=c){i.set(m);s.set(p[t+0]);u.set(p[t+1]);l.set(p[t+2]);o.trigger();m++}}}};CABLES.OPS["3f7db864-7409-418f-8c03-b2c966c050b3"]={f:Ops.Array.Array3Iterator,objName:"Ops.Array.Array3Iterator"};Ops.Data.Compose.Array.CompArrayPushNumbers=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Update"),r=e.inFloat("X",0),a=e.inFloat("Y",0),o=e.inFloat("Z",0),i=e.inFloat("W",1),s=e.inSwitch("Num",["1","2","3","4"],"4"),u=e.outTrigger("Next");let l=4;s.onChange=()=>{l=parseInt(s.get());a.setUiAttribs({greyout:l<2});o.setUiAttribs({greyout:l<3});i.setUiAttribs({greyout:l<4})};function p(){inDivisorDown.setUiAttribs({greyout:false})}n.onTriggered=()=>{if(e.patch.tempData.compArray&&e.patch.tempData.compArray.length>0){let t=e.patch.tempData.compArray[e.patch.tempData.compArray.length-1];if(t){if(l==4)t.push(r.get(),a.get(),o.get(),i.get());else if(l==3)t.push(r.get(),a.get(),o.get());else if(l==2)t.push(r.get(),a.get());else if(l==1)t.push(r.get())}}u.trigger()}}};CABLES.OPS["d356385a-ad48-4d74-8952-eeaf136b0c8c"]={f:Ops.Data.Compose.Array.CompArrayPushNumbers,objName:"Ops.Data.Compose.Array.CompArrayPushNumbers"};Ops.Gl.Meshes.PointCloudFromArray_v2=class extends CABLES.Op{constructor(){super(...arguments);const a=this;const t=a.attachments={};const e=a.inTrigger("exe"),o=a.inArray("Array",3),n=a.inValueInt("Num Points"),r=a.outTrigger("Trigger out"),i=a.outObject("Geometry"),s=a.inValueBool("Scramble Texcoords",true),u=a.inValue("Seed",1),l=a.inArray("Coordinates",2),p=a.inArray("Point sizes",1),c=a.inArray("Vertex Colors",4);a.toWorkPortsNeedToBeLinked(o,e);a.setPortGroup("Texture Coordinates",[s,u,l]);const b=a.patch.cgl;const m=new CGL.Geometry("pointcloudfromarray");let d=false;let f=null;let g=[];let h=true;let O=false;o.setUiAttribs({title:"Positions"});l.setUiAttribs({title:"Texture Coordinates"});a.onDelete=k;l.onChange=s.onChange=y;c.onChange=A;n.onChange=x;p.onChange=I;u.onChange=o.onChange=c.onLinkChanged=p.onLinkChanged=j;e.onTriggered=v;function v(){let t=b.getShader();if(CABLES.UI&&t){if(t.glPrimitive!=b.gl.POINTS)a.setUiError("nopointmat","Using a Material not made for point rendering. Try to use PointMaterial.");else a.setUiError("nopointmat",null)}if(h||!f)S();if(!d&&f)f.render(t);r.trigger()}function j(){d=o.get()==null;if(!d)h=true;else h=false}function y(){if(l.isLinked()){u.setUiAttribs({greyout:true});s.setUiAttribs({greyout:true})}else{s.setUiAttribs({greyout:false});if(!s.get())u.setUiAttribs({greyout:true});else u.setUiAttribs({greyout:false})}k();h=true}function I(){if(!p.get())return;if(!m.getAttribute("attrPointSize"))j();if(f)f.setAttribute("attrPointSize",p.get(),1)}function A(){h=true}function x(){if(f){f.setNumIndices(Math.min(m.vertices.length/3,n.get()));if(n.get()==0)f.setNumIndices(m.vertices.length/3)}}function k(){if(f)f.dispose();f=null}function S(){let e=o.get()||[];if(e.length%3!==0){a.setUiError("div3","Array length not multiple of 3");return}else a.setUiError("div3",null);if(m.vertices.length==e.length&&f&&!l.isLinked()&&!c.isLinked()&&!m.getAttribute("attrPointSize")){f.setAttribute(CGL.SHADERVAR_VERTEX_POSITION,e,3);m.vertices=e;h=false;return}m.clear();let n=e.length/3;n=Math.abs(Math.floor(n));if(n==0)return;if(!g||g.length!=n*2)g=new Float32Array(n*2);let r=s.get();if(!l.isLinked()){Math.randomSeed=u.get();g=[];for(let t=0;t<n;t++){if(m.vertices[t*3]!=e[t*3]||m.vertices[t*3+1]!=e[t*3+1]||m.vertices[t*3+2]!=e[t*3+2]){if(r){g[t*2]=Math.seededRandom();g[t*2+1]=Math.seededRandom()}else{g[t*2]=t/n;g[t*2+1]=t/n}}}}if(c.get()){if(c.get().length!=n*4){a.setUiError("vertColWrongLength","Color array does not have the correct length! (should be "+n*4+")");k();return}else a.setUiError("vertColWrongLength",null);m.vertexColors=c.get()}else{a.setUiError("vertColWrongLength",null);m.vertexColors=[]}if(p.get()){if(p.get().length!=n){a.setUiError("pointsizeWrongLength","Color array does not have the correct length! (should be "+n+")");k();return}else a.setUiError("pointsizeWrongLength",null);m.setAttribute("attrPointSize",p.get(),1)}else{a.setUiError("pointsizeWrongLength",null);m.setAttribute("attrPointSize",[],1)}if(l.isLinked())g=l.get();m.setPointVertices(e);m.setTexCoords(g);if(!f)f=new CGL.Mesh(b,m,{glPrimitive:b.gl.POINTS});f.addVertexNumbers=true;f.setGeom(m);i.setRef(m);x();h=false}}};CABLES.OPS["53bc6de5-8d22-4687-9f03-ccfd3e50d106"]={f:Ops.Gl.Meshes.PointCloudFromArray_v2,objName:"Ops.Gl.Meshes.PointCloudFromArray_v2"};Ops.Gl.Shader.PointMaterial_v6=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={pointmat_frag:"\n{{MODULES_HEAD}}\n\nUNI vec4 color;\nUNI float atlasNumX;\n\n// IN vec2 pointCoord;\nIN float ps;\nIN vec2 texCoord;\n\n#ifdef HAS_TEXTURE_DIFFUSE\n    UNI sampler2D diffTex;\n#endif\n#ifdef HAS_TEXTURE_MASK\n    UNI sampler2D texMask;\n#endif\n#ifdef HAS_TEXTURE_COLORIZE\n    IN vec4 colorize;\n#endif\n#ifdef HAS_TEXTURE_OPACITY\n    IN float opacity;\n#endif\n\n#ifdef HAS_TEXTURE_ROT\n    UNI sampler2D texRot;\n#endif\n\n\n#ifdef USE_ATLAS\n    IN float randAtlas;\n    #ifdef HAS_TEXTURE_ATLASLOOKUP\n        UNI sampler2D texAtlasLookup;\n    #endif\n#endif\n\n\n#ifdef VERTEX_COLORS\n    IN vec4 vertexColor;\n#endif\n\nvec3 lumcoeff = vec3(0.299,0.587,0.114);\n\n#define PI 3.14159265\n#define TAU (2.0*PI)\n\nvoid pR(inout vec2 p, float a)\n{\n\tp = cos(a)*p + sin(a)*vec2(p.y, -p.x);\n}\n\n\nvoid main()\n{\n    #ifdef FLIP_TEX\n        vec2 pointCoord=vec2(gl_PointCoord.x,(1.0-gl_PointCoord.y));\n    #endif\n    #ifndef FLIP_TEX\n        vec2 pointCoord=gl_PointCoord;\n    #endif\n\n    #ifdef HAS_TEXTURE_ROT\n        float r=texture(texRot,texCoord).r;\n        pointCoord-=vec2(0.5);\n        pR(pointCoord,r*TAU);\n        pointCoord+=vec2(0.5);\n    #endif\n\n    vec2 origPointCoord=pointCoord;\n\n\n    #ifdef USE_ATLAS\n\n        float atlasIdx=randAtlas;\n\n        #ifdef HAS_TEXTURE_ATLASLOOKUP\n            atlasIdx=texture(texAtlasLookup,texCoord).r;\n        #endif\n\n        #ifdef ATLAS_XFADE\n            vec2 pointCoord2=vec2(origPointCoord);\n            pointCoord2.x=origPointCoord.x/atlasNumX+ceil(atlasIdx)*(1.0/atlasNumX);\n        #endif\n\n        pointCoord.x=origPointCoord.x/atlasNumX+floor(atlasIdx)*(1.0/atlasNumX);\n\n\n    #endif\n\n    {{MODULE_BEGIN_FRAG}}\n\n    if(ps<1.0)discard;\n\n    vec4 col=color;\n\n    #ifdef HAS_TEXTURE_MASK\n        float mask;\n        #ifdef TEXTURE_MASK_R\n            mask=texture(texMask,pointCoord).r;\n        #endif\n        #ifdef TEXTURE_MASK_A\n            mask=texture(texMask,pointCoord).a;\n        #endif\n        #ifdef TEXTURE_MASK_LUMI\n        \tmask = dot(texture(texMask,pointCoord).rgb, lumcoeff);\n        #endif\n\n        #ifdef ATLAS_XFADE\n            float mask2=texture(texMask,pointCoord2).r;\n\n            #ifdef TEXTURE_MASK_A\n                mask2=texture(texMask,pointCoord2).a;\n            #endif\n            #ifdef TEXTURE_MASK_LUMI\n            \tmask2 = dot(texture(texMask,pointCoord2).rgb, lumcoeff);\n            #endif\n\n            mask=mix(mask,mask2,fract(atlasIdx));\n        #endif\n    #endif\n\n    #ifdef HAS_TEXTURE_DIFFUSE\n\n        col=texture(diffTex,pointCoord);\n\n        #ifdef ATLAS_XFADE\n            vec4 col2=texture(diffTex,pointCoord2);\n            col=mix(col,col2,fract(atlasIdx));\n        #endif\n\n        #ifdef COLORIZE_TEXTURE\n            col.rgb*=color.rgb;\n        #endif\n    #endif\n\n    col.a*=color.a;\n\n\n    #ifdef MAKE_ROUND\n\n        #ifndef MAKE_ROUNDAA\n            if ((gl_PointCoord.x-0.5)*(gl_PointCoord.x-0.5) + (gl_PointCoord.y-0.5)*(gl_PointCoord.y-0.5) > 0.25) discard; //col.a=0.0;\n        #endif\n\n        #ifdef MAKE_ROUNDAA\n            float circ=(gl_PointCoord.x-0.5)*(gl_PointCoord.x-0.5) + (gl_PointCoord.y-0.5)*(gl_PointCoord.y-0.5);\n\n            float a=smoothstep(0.25,0.25-fwidth(gl_PointCoord.x),circ);\n            if(a==0.0)discard;\n            col.a=a*color.a;\n        #endif\n    #endif\n\n    #ifdef HAS_TEXTURE_COLORIZE\n        col*=colorize;\n    #endif\n\n    #ifdef TEXTURE_COLORIZE_MUL\n        col*=color;\n    #endif\n\n    #ifdef HAS_TEXTURE_MASK\n        col.a*=mask;\n    #endif\n\n    #ifdef HAS_TEXTURE_OPACITY\n        col.a*=opacity;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        col.rgb = vertexColor.rgb;\n        col.a *= vertexColor.a;\n    #endif\n\n    if (col.a <= 0.0) discard;\n\n    #ifdef HAS_TEXTURE_COLORIZE\n        col*=colorize;\n    #endif\n\n    {{MODULE_COLOR}}\n\n\n    outColor = col;\n}\n",pointmat_vert:"{{MODULES_HEAD}}\n\n\n\nIN vec3 vPosition;\nIN vec2 attrTexCoord;\nIN vec3 attrVertNormal;\nIN vec3 attrTangent;\nIN vec3 attrBiTangent;\nIN float attrPointSize;\n\n#ifdef VERTEX_COLORS\n    IN vec4 attrVertColor;\n    OUT vec4 vertexColor;\n#endif\n\nOUT vec3 norm;\nOUT float ps;\n\nOUT vec2 texCoord;\n\n\n#ifdef HAS_TEXTURES\n#endif\n\n#ifdef HAS_TEXTURE_COLORIZE\n   UNI sampler2D texColorize;\n   OUT vec4 colorize;\n#endif\n#ifdef HAS_TEXTURE_OPACITY\n    UNI sampler2D texOpacity;\n    OUT float opacity;\n#endif\n\n#ifdef HAS_TEXTURE_POINTSIZE\n   UNI sampler2D texPointSize;\n   UNI float texPointSizeMul;\n#endif\n\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\nUNI float pointSize;\nUNI vec3 camPos;\n\nUNI float canvasWidth;\nUNI float canvasHeight;\nUNI float camDistMul;\nUNI float randomSize;\nUNI float minPointSize;\nUNI float pixelRatio;\n\nIN float attrVertIndex;\n\nUNI float atlasNumX;\n\n#ifdef USE_ATLAS\n    OUT float randAtlas;\n#endif\n\nfloat rand(float n){return fract(sin(n) * 5711.5711123);}\n\n#define POINTMATERIAL\n\nvoid main()\n{\n    norm=attrVertNormal;\n    #ifdef PIXELSIZE\n        float psMul=1.0;\n    #endif\n\n    #ifndef PIXELSIZE\n        float psMul=sqrt(canvasWidth/canvasHeight)+0.00000000001;\n    #endif\n\n    #ifdef USE_ATLAS\n        randAtlas=atlasNumX*rand(attrVertIndex+vPosition.x);\n    #endif\n\n    vec3 tangent=attrTangent;\n    vec3 bitangent=attrBiTangent;\n\n\n    #ifdef VERTEX_COLORS\n        vertexColor=attrVertColor;\n    #endif\n\n    // #ifdef HAS_TEXTURES\n        texCoord=attrTexCoord;\n    // #endif\n\n    #ifdef HAS_TEXTURE_OPACITY\n        // opacity=texture(texOpacity,vec2(rand(attrVertIndex+texCoord.x*texCoord.y+texCoord.y+texCoord.x),rand(texCoord.y*texCoord.x-texCoord.x-texCoord.y-attrVertIndex))).r;\n        opacity=texture(texOpacity,texCoord).r;\n    #endif\n\n\n    #ifdef HAS_TEXTURE_COLORIZE\n        #ifdef RANDOM_COLORIZE\n            colorize=texture(texColorize,vec2(rand(attrVertIndex+texCoord.x*texCoord.y+texCoord.y+texCoord.x),rand(texCoord.y*texCoord.x-texCoord.x-texCoord.y-attrVertIndex)));\n        #endif\n        #ifndef RANDOM_COLORIZE\n            colorize=texture(texColorize,texCoord);\n        #endif\n    #endif\n\n\n\n\n\n    mat4 mMatrix=modelMatrix;\n    vec4 pos = vec4( vPosition, 1. );\n\n    gl_PointSize=0.0;\n\n    {{MODULE_VERTEX_POSITION}}\n\n    vec4 model=mMatrix * pos;\n\n    psMul+=rand(texCoord.x*texCoord.y+texCoord.y*3.0+texCoord.x*2.0+attrVertIndex)*randomSize;\n\n    float addPointSize=0.0;\n    #ifdef HAS_TEXTURE_POINTSIZE\n\n        #ifdef POINTSIZE_CHAN_R\n            addPointSize=texture(texPointSize,texCoord).r;\n        #endif\n        #ifdef POINTSIZE_CHAN_G\n            addPointSize=texture(texPointSize,texCoord).g;\n        #endif\n        #ifdef POINTSIZE_CHAN_B\n            addPointSize=texture(texPointSize,texCoord).b;\n        #endif\n\n        #ifdef DOTSIZEREMAPABS\n            addPointSize=1.0-(distance(addPointSize,0.5)*2.0);\n            addPointSize=addPointSize*addPointSize*addPointSize*2.0;\n        #endif\n\n        addPointSize*=texPointSizeMul;\n\n    #endif\n\n    ps=0.0;\n    #ifndef SCALE_BY_DISTANCE\n        ps = (pointSize+addPointSize+attrPointSize) * psMul;\n    #endif\n    #ifdef SCALE_BY_DISTANCE\n        float cameraDist = distance(model.xyz, camPos);\n        ps = ( (pointSize+addPointSize+attrPointSize) / cameraDist) * psMul;\n    #endif\n    ps=max(minPointSize,ps);\n    ps*=pixelRatio;\n\n    gl_PointSize += ps;\n\n\n    gl_Position = projMatrix * viewMatrix * model;\n}\n"};const n=t.patch.cgl;const r=t.inTrigger("render"),a=t.inValueFloat("PointSize",3),o=t.inBool("Size in Pixels",false),i=t.inValue("Random Size",0),s=t.inValueBool("Round",true),u=t.inValueBool("Round Antialias",false),l=t.inValueBool("Scale by Distance",false),p=t.inValueSlider("r",Math.random()),c=t.inValueSlider("g",Math.random()),b=t.inValueSlider("b",Math.random()),m=t.inValueSlider("a",1),d=t.inBool("Vertex Colors",false),f=t.inTexture("texture"),g=t.inBool("Colorize Texture"),h=t.inTexture("Texture Mask"),O=t.inSwitch("Mask Channel",["R","A","Luminance"],"R"),v=t.inTexture("Texture Colorize"),j=t.inValueBool("Colorize Randomize",false),y=t.inTexture("Texture Opacity"),I=t.inTexture("Texture Point Size"),A=t.inSwitch("Point Size Channel",["R","G","B"],"R"),x=t.inFloat("Texture Point Size Mul",1),k=t.inSwitch("Map Size 0",["Black","Grey"],"Black"),S=t.inValueBool("Flip Texture",false),_=t.inBool("Atlas Cross Fade",false),N=t.inFloat("Atlas Repeat X ",1),C=t.inTexture("Atlas Lookup"),w=t.inTexture("Rotate Texture"),R=t.inValueFloat("Min Point Size",0),L=t.outTrigger("trigger"),T=t.outObject("shader",null,"shader");t.setPortGroup("Texture",[f,g,h,O,v,y,j]);t.setPortGroup("Color",[p,c,b,m,d]);t.setPortGroup("Size",[a,i,s,u,l,o,I,x,A,k]);t.setPortGroup("Atlas",[N,C,_]);p.setUiAttribs({colorPick:true});const E=new CGL.Shader(n,"PointMaterial",this);E.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);E.define("MAKE_ROUND");t.toWorkPortsNeedToBeLinked(r);const M=new CGL.Uniform(E,"f","pointSize",a),q=new CGL.Uniform(E,"f","texPointSizeMul",x),B=new CGL.Uniform(E,"f","randomSize",i),D=new CGL.Uniform(E,"f","minPointSize",R),U=new CGL.Uniform(E,"4f","color",p,c,b,m),G=new CGL.Uniform(E,"f","atlasNumX",N),F=new CGL.Uniform(E,"f","pixelRatio",1),H=new CGL.Uniform(E,"f","canvasWidth",n.canvasWidth),J=new CGL.Uniform(E,"f","canvasHeight",n.canvasHeight),K=new CGL.Uniform(E,"t","diffTex"),X=new CGL.Uniform(E,"t","texColorize"),Z=new CGL.Uniform(E,"t","texOpacity"),W=new CGL.Uniform(E,"t","texPointSize"),Y=new CGL.Uniform(E,"t","texPointSize"),$=new CGL.Uniform(E,"t","texMask"),Q=new CGL.Uniform(E,"t","texAtlasLookup"),tt=new CGL.Uniform(E,"t","texRot");E.setSource(e.pointmat_vert,e.pointmat_frag);E.glPrimitive=n.gl.POINTS;T.set(E);T.ignoreValueSerialize=true;l.onChange=N.onChange=s.onChange=u.onChange=f.onChange=v.onChange=h.onChange=j.onChange=S.onChange=O.onChange=o.onChange=y.onChange=I.onChange=k.onChange=A.onChange=g.onChange=C.onLinkChanged=w.onLinkChanged=d.onChange=et;r.onTriggered=V;z();t.preRender=function(){if(E)E.bind();V()};function V(){H.setValue(n.canvasWidth);J.setValue(n.canvasHeight);n.pushShader(E);E.popTextures();if(f.get()&&!f.get().deleted)E.pushTexture(K,f.get());if(h.get())E.pushTexture($,h.get());if(v.get())E.pushTexture(X,v.get());if(y.get())E.pushTexture(Z,y.get());if(I.get())E.pushTexture(Y,I.get());if(C.get())E.pushTexture(Q,C.get());if(w.get())E.pushTexture(tt,w.get());F.set(n.pixelDensity);L.trigger();n.popShader()}function P(){return N.get()>0||C.isLinked()}function z(){N.setUiAttribs({greyout:!P()});O.setUiAttribs({greyout:!h.isLinked()});A.setUiAttribs({greyout:!I.isLinked()});x.setUiAttribs({greyout:!I.isLinked()});k.setUiAttribs({greyout:!I.isLinked()})}function et(){E.toggleDefine("USE_ATLAS",P());E.toggleDefine("SCALE_BY_DISTANCE",l.get());E.toggleDefine("MAKE_ROUND",s.get());E.toggleDefine("MAKE_ROUNDAA",u.get());E.toggleDefine("ATLAS_XFADE",_.get());E.toggleDefine("VERTEX_COLORS",d.get());E.toggleDefine("RANDOM_COLORIZE",j.get());E.toggleDefine("HAS_TEXTURE_DIFFUSE",f.get());E.toggleDefine("HAS_TEXTURE_MASK",h.isLinked());E.toggleDefine("HAS_TEXTURE_COLORIZE",v.isLinked());E.toggleDefine("HAS_TEXTURE_OPACITY",y.isLinked());E.toggleDefine("HAS_TEXTURE_POINTSIZE",I.isLinked());E.toggleDefine("HAS_TEXTURE_ATLASLOOKUP",C.isLinked());E.toggleDefine("HAS_TEXTURE_ROT",w.isLinked());E.toggleDefine("TEXTURE_COLORIZE_MUL",g.get());E.toggleDefine("FLIP_TEX",S.get());E.toggleDefine("TEXTURE_MASK_R",O.get()=="R");E.toggleDefine("TEXTURE_MASK_A",O.get()=="A");E.toggleDefine("TEXTURE_MASK_LUMI",O.get()=="Luminance");E.toggleDefine("PIXELSIZE",o.get());E.toggleDefine("POINTSIZE_CHAN_R",A.get()=="R");E.toggleDefine("POINTSIZE_CHAN_G",A.get()=="G");E.toggleDefine("POINTSIZE_CHAN_B",A.get()=="B");E.toggleDefine("DOTSIZEREMAPABS",k.get()=="Grey");z()}}};CABLES.OPS["e44df958-00c7-46e4-95bb-3e6ac6c4188f"]={f:Ops.Gl.Shader.PointMaterial_v6,objName:"Ops.Gl.Shader.PointMaterial_v6"};Ops.Graphics.Intersection.IntersectWorld=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Trigger"),r=t.inBool("Check Body Collisions",false),a=t.outTrigger("Next"),o=t.outNumber("Total Bodies"),i=t.outArray("Collisions",[]);n.onTriggered=c;const u=1;const l=2;const p=3;const s=t.patch.cgl;function c(){s.tempData.collisionWorld={bodies:[],testCollision:b};a.trigger();o.set(s.tempData.collisionWorld.bodies.length);if(r.get())m()}function b(o,i){if(o.type===u&&i.type===u){const n=vec3.distance(o.pos,i.pos);if(n<o.radius+i.radius){return{body0:o,name0:o.name,body1:i,name1:i.name}}}else if(o.type===p&&i.type===p){if(o.pos[0]===i.pos[0]&&o.pos[1]===i.pos[1]&&o.pos[2]===i.pos[2]){return{body0:o,name0:o.name,body1:i,name1:i.name}}}else if(i.type===u&&o.type===p||o.type===u&&i.type===p){let t=o;let e=i;if(o.type===u){t=i;e=o}const r=Math.abs(t.pos[0]-e.pos[0]);const a=Math.abs(t.pos[1]-e.pos[1]);const s=Math.abs(t.pos[2]-e.pos[2]);const n=Math.sqrt(r*r+a*a+s*s);if(n<e.radius){return{body0:o,name0:o.name,body1:i,name1:i.name}}}else if(i.type===l&&o.type===p||o.type===l&&i.type===p){let t=o;let e=i;if(o.type===l){t=i;e=o}if(t.pos[0]>e.minX&&t.pos[0]<e.maxX&&(t.pos[1]>e.minY&&t.pos[1]<e.maxY)&&(t.pos[2]>e.minZ&&t.pos[2]<e.maxZ)){return{body0:o,name0:o.name,body1:i,name1:i.name}}}else if(o.type===u&&i.type===l||o.type===l&&i.type===u){let t=o;let e=i;if(i.type===l){t=i;e=o}let n=e.radius*e.radius;let r=0;let a=e.radius*e.radius;if(e.pos[0]<t.minX)a-=(e.pos[0]-t.minX)**2;else if(e.pos[0]>t.maxX)a-=(e.pos[0]-t.maxX)**2;if(e.pos[1]<t.minY)a-=(e.pos[1]-t.minY)**2;else if(e.pos[1]>t.maxY)a-=(e.pos[1]-t.maxY)**2;if(e.pos[2]<t.minZ)a-=(e.pos[2]-t.minZ)**2;else if(e.pos[2]>t.maxZ)a-=(e.pos[2]-t.maxZ)**2;if(a>0){return{body0:o,name0:o.name,body1:i,name1:i.name}}}else{console.warn("unknown collision pair...",o.type,i.type)}}function m(){const n=[];const r=s.tempData.collisionWorld.bodies;for(let e=0;e<r.length;e++){for(let t=e+1;t<r.length;t++){if(t!=e){const a=b(r[t],r[e]);if(a)n.push(a)}}}i.setRef(n,[])}}};CABLES.OPS["6ebdec23-6e10-48c9-87cf-43d488e4290f"]={f:Ops.Graphics.Intersection.IntersectWorld,objName:"Ops.Graphics.Intersection.IntersectWorld"};Ops.Graphics.Intersection.IntersectTestRaycast=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Trigger"),v=t.inSwitch("Coordinate Format",["-1 to 1","XYZ-XYZ"],"-1 to 1"),j=t.inValueFloat("X"),y=t.inValueFloat("Y"),I=t.inValueFloat("Z"),A=t.inValueFloat("To X"),x=t.inValueFloat("To Y"),k=t.inValueFloat("To Z"),r=t.inBool("Active",true),a=t.inBool("Change Cursor",true),S=t.outTrigger("Next"),_=t.outBoolNum("Has Hit",false),N=t.outString("Hit Body Name",""),C=t.outNumber("Hit X"),w=t.outNumber("Hit Y"),T=t.outNumber("Hit Z");const E=t.patch.cgl;const V=vec3.create();const P=mat4.create();const z=vec3.create();let o=false;let i=true;t.toWorkPortsNeedToBeLinked(n);n.onTriggered=u;v.onChange=s;s();function s(){I.setUiAttribs({greyout:v.get()!="XYZ-XYZ"});A.setUiAttribs({greyout:v.get()!="XYZ-XYZ"});x.setUiAttribs({greyout:v.get()!="XYZ-XYZ"});k.setUiAttribs({greyout:v.get()!="XYZ-XYZ"})}function u(){S.trigger();if(E.tempData.collisionWorld){let e=vec3.create();if(v.get()=="-1 to 1"){e=vec3.fromValues(j.get(),y.get(),-1);mat4.mul(P,E.pMatrix,E.vMatrix);mat4.invert(P,P);vec3.transformMat4(e,e,P)}if(v.get()=="XYZ-XYZ"){e=vec3.fromValues(j.get(),y.get(),I.get())}let t=vec3.create();if(v.get()=="-1 to 1"){t=vec3.fromValues(j.get(),y.get(),1);mat4.mul(P,E.pMatrix,E.vMatrix);mat4.invert(P,P);vec3.transformMat4(t,t,P)}if(v.get()=="XYZ-XYZ"){t=vec3.fromValues(A.get(),x.get(),k.get())}vec3.sub(z,t,e);vec3.normalize(z,z);const a=vec3.dot(z,z);let n=9999999;let r=false;const o=E.tempData.collisionWorld.bodies;for(let t=0;t<o.length;t++){const i=o[t];if(i.type==1){vec3.sub(V,e,i.pos);const s=2*vec3.dot(V,z);const u=vec3.dot(V,V)-i.radius*i.radius;const l=s*s-4*a*u;if(l>0){const p=(-s-Math.sqrt(l))/(2+a);if(p<n){r=true;N.set(i.name);_.set(true);n=p;vec3.mul(V,z,[p,p,p]);vec3.add(V,V,e);C.set(V[0]);w.set(V[1]);T.set(V[2])}}}else if(i.type==2){const c=(i.minX-e[0])/z[0];const b=(i.maxX-e[0])/z[0];const m=(i.minY-e[1])/z[1];const d=(i.maxY-e[1])/z[1];const f=(i.minZ-e[2])/z[2];const g=(i.maxZ-e[2])/z[2];const h=Math.max(Math.max(Math.min(c,b),Math.min(m,d)),Math.min(f,g));const O=Math.min(Math.min(Math.max(c,b),Math.max(m,d)),Math.max(f,g));if(O<0)continue;if(h>O)continue;r=true;N.set(i.name);_.set(true);vec3.mul(V,z,[h,h,h]);vec3.add(V,V,e);C.set(V[0]);w.set(V[1]);T.set(V[2])}}if(!r){N.set("");_.set(false);C.set(0);w.set(0);T.set(0)}}}}};CABLES.OPS["dd5d9b39-75c2-40b1-98a4-7a0fdafdb5cb"]={f:Ops.Graphics.Intersection.IntersectTestRaycast,objName:"Ops.Graphics.Intersection.IntersectTestRaycast"};Ops.Devices.Mouse.Mouse_v3=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const z=e.attachments={};const t=e.inSwitch("Coordinates",["-1 to 1","Pixel Display","Pixel","0 to 1"],"-1 to 1"),a=e.inValueSelect("Area",["Canvas","Document","Parent Element","Canvas Area"],"Canvas"),o=e.inValueBool("flip y",true),n=e.inBool("right click prevent default",true),r=e.inValueBool("Touch support",true),i=e.inValueBool("Passive Events",false),s=e.inValueBool("Active",true),u=e.outNumber("x",0),l=e.outNumber("y",0),p=e.outTrigger("click"),c=e.outTrigger("click right"),b=e.outBoolNum("Button is down"),m=e.outBoolNum("Mouse is hovering"),d=e.outNumber("Movement X",0),f=e.outNumber("Movement Y",0);const g=e.patch.cgl;let h=1;let O=null;let v=null;i.onChange=a.onChange=P;t.onChange=L;e.onDelete=V;P();e.on("loadedValueSet",j);function j(){if(h==0){if(v.clientWidth===0)setTimeout(j,50);u.set(v.clientWidth/2);l.set(v.clientHeight/2)}else if(h==1){u.set(0);l.set(0)}else if(h==2){u.set(.5);l.set(.5)}else if(h==3){if(v.clientWidth===0){setTimeout(j,50)}u.set(v.clientWidth/2/g.pixelDensity);l.set(v.clientHeight/2/g.pixelDensity)}else console.error("unknown normalize mouse",h)}function R(a,o){a=a||0;o=o||0;if(h==0){u.set(a);l.set(o)}else if(h==3){u.set(a*g.pixelDensity);l.set(o*g.pixelDensity)}else{let n=v.clientWidth/g.pixelDensity;let r=v.clientHeight/g.pixelDensity;n=n||1;r=r||1;if(h==1){let t=a/n*2-1;let e=o/r*2-1;t=CABLES.clamp(t,-1,1);e=CABLES.clamp(e,-1,1);u.set(t);l.set(e)}else if(h==2){let t=a/n;let e=o/r;t=CABLES.clamp(t,0,1);e=CABLES.clamp(e,0,1);u.set(t);l.set(e)}}}function y(t){if(!v)return;const e=v.getBoundingClientRect();return t.clientX>e.left&&t.clientX<e.left+e.width&&t.clientY>e.top&&t.clientY<e.top+e.height}r.onChange=function(){V();P()};s.onChange=function(){if(O)V();if(s.get())P()};function L(){if(t.get()=="Pixel")h=0;else if(t.get()=="-1 to 1")h=1;else if(t.get()=="0 to 1")h=2;else if(t.get()=="Pixel Display")h=3}function I(t){b.set(false);m.set(y(t))}function A(t){if(!y(t))return;b.set(true)}function x(t){b.set(false)}function k(t){if(!y(t))return;c.trigger();if(n.get())t.preventDefault()}function S(t){if(!y(t))return;p.trigger()}function _(t){b.set(false);m.set(y(t))}function N(t){let e=t.clientX;let n=t.clientY;if(a.get()!="Document"){e=t.offsetX;n=t.offsetY}if(a.get()==="Canvas Area"){const r=v.getBoundingClientRect();e=t.clientX-r.left;n=t.clientY-r.top;if(e<0||e>r.width||n>r.height||n<0)return;e=CABLES.clamp(e,0,r.width);n=CABLES.clamp(n,0,r.height)}if(o.get())n=v.clientHeight-n;R(e/g.pixelDensity,n/g.pixelDensity)}function C(t){m.set(y(t));if(a.get()==="Canvas Area"){const e=v.getBoundingClientRect();const n=t.clientX-e.left;const r=t.clientY-e.top;if(n<0||n>e.width||r>e.height||r<0)return}N(t);d.set(t.movementX/g.pixelDensity);f.set(t.movementY/g.pixelDensity)}function w(t){if(event.touches&&event.touches.length>0)N(t.touches[0])}function T(t){b.set(true);if(t.touches&&t.touches.length>0)A(t.touches[0])}function E(t){b.set(false);x()}function V(){if(!O)return;O.removeEventListener("touchend",E);O.removeEventListener("touchstart",T);O.removeEventListener("touchmove",w);O.removeEventListener("click",S);O.removeEventListener("mousemove",C);O.removeEventListener("mouseleave",_);O.removeEventListener("mousedown",A);O.removeEventListener("mouseup",x);O.removeEventListener("mouseenter",I);O.removeEventListener("contextmenu",k);O=null}function P(){if(O||!s.get())V();if(!s.get())return;O=v=g.canvas;if(a.get()=="Canvas Area"){v=g.canvas.parentElement;O=document.body}if(a.get()=="Document")v=O=document.body;if(a.get()=="Parent Element")O=v=g.canvas.parentElement;if(!v){e.setUiError("noarea","could not find area element for mouse",2);return}e.setUiError("noarea",null);let t=false;if(i.get())t={passive:true};if(r.get()){O.addEventListener("touchend",E,t);O.addEventListener("touchstart",T,t);O.addEventListener("touchmove",w,t)}O.addEventListener("mousemove",C,t);O.addEventListener("mouseleave",_,t);O.addEventListener("mousedown",A,t);O.addEventListener("mouseup",x,t);O.addEventListener("mouseenter",I,t);O.addEventListener("contextmenu",k,t);O.addEventListener("click",S,t)}}};CABLES.OPS["6d1edbc0-088a-43d7-9156-918fb3d7f24b"]={f:Ops.Devices.Mouse.Mouse_v3,objName:"Ops.Devices.Mouse.Mouse_v3"};Ops.Array.ArrayGetObject=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("array"),r=t.inValueInt("index"),a=t.outObject("value");let o=null;n.ignoreValueSerialize=true;a.ignoreValueSerialize=true;r.onChange=i;n.onChange=i;t.toWorkPortsNeedToBeLinked(n);function i(){if(r.get()<0){a.set(null);return}const t=n.get();if(!t){a.set(null);return}const e=r.get();if(e>=t.length){a.set(null);return}if(t[e]){a.setRef(t[e]);o=t[e]}}}};CABLES.OPS["44d34542-174c-47c6-b9c6-adde6fc371ac"]={f:Ops.Array.ArrayGetObject,objName:"Ops.Array.ArrayGetObject"};Ops.Array.StringToArray_v2=class extends CABLES.Op{constructor(){super(...arguments);const r=this;const t=r.attachments={};const a=r.inStringEditor("text","1,2,3"),o=r.inString("separator",","),i=r.inValueBool("Numbers",true),s=r.inValueBool("Trim",true),u=r.inBool("Split Lines",false),l=r.outArray("array"),p=r.outTrigger("Parsed"),c=r.outNumber("length");a.setUiAttribs({ignoreBigPort:true});a.onChange=o.onChange=i.onChange=s.onChange=e;u.onChange=()=>{o.setUiAttribs({greyout:u.get()});e()};e();function e(){if(!a.get()){l.set(null);l.set([]);c.set(0);return}let t=a.get();if(s.get()&&t){t=t.replace(/^\s+|\s+$/g,"");t=t.trim()}let n;let e=o.get();if(o.get()==="\\n")e="\n";if(u.get())n=t.split("\n");else n=t.split(e);if(n[n.length-1]==="")n.length-=1;c.set(n.length);if(s.get()){for(let t=0;t<n.length;t++){n[t]=n[t].replace(/^\s+|\s+$/g,"");n[t]=n[t].trim()}}r.setUiError("notnum",null);if(i.get()){let e=false;for(let t=0;t<n.length;t++){n[t]=Number(n[t]);if(!CABLES.isNumeric(n[t])){e=true}}if(e){r.setUiError("notnum","Parse Error / Not all values numerical!",1)}}l.setRef(n);p.trigger()}}};CABLES.OPS["c974de41-4ce4-4432-b94d-724741109c71"]={f:Ops.Array.StringToArray_v2,objName:"Ops.Array.StringToArray_v2"};Ops.Array.ArrayGetNumber=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("array"),r=t.inValueInt("index"),a=t.inFloat("Value Invalid Index",0),o=t.outNumber("value"),i=t.outBoolNum("Valid Index",true);n.ignoreValueSerialize=true;r.onChange=n.onChange=s;function s(){if(n.get()){const t=n.get()[r.get()];if(isNaN(t)){o.set(a.get());i.set(false)}else{i.set(true);o.set(parseFloat(t))}}}}};CABLES.OPS["d1189078-70cf-437d-9a37-b2ebe89acdaf"]={f:Ops.Array.ArrayGetNumber,objName:"Ops.Array.ArrayGetNumber"};Ops.Array.Array3GetNumbers=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array",3),r=t.inValueInt("Index"),a=t.outNumber("X"),o=t.outNumber("Y"),i=t.outNumber("Z");n.onChange=r.onChange=s;function s(){let t=n.get();if(!t){a.set(0);o.set(0);i.set(0);return}let e=Math.min(t.length-3,r.get()*3);if(t){a.set(t[e+0]);o.set(t[e+1]);i.set(t[e+2])}}}};CABLES.OPS["56882cc4-c40d-4dc0-bf7c-db1b5a7acad0"]={f:Ops.Array.Array3GetNumbers,objName:"Ops.Array.Array3GetNumbers"};Ops.Gl.Matrix.Transform=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};const e=n.inTrigger("render"),r=n.inValue("posX",0),a=n.inValue("posY",0),o=n.inValue("posZ",0),i=n.inValue("scale",1),s=n.inValue("rotX",0),u=n.inValue("rotY",0),l=n.inValue("rotZ",0),p=n.outTrigger("trigger");n.setPortGroup("Rotation",[s,u,l]);n.setPortGroup("Position",[r,a,o]);n.setPortGroup("Scale",[i]);n.setUiAxisPorts(r,a,o);n.toWorkPortsNeedToBeLinked(e,p);const c=vec3.create();const b=vec3.create();const m=mat4.create();mat4.identity(m);let d=false,f=false,g=true,h=true,O=true;s.onChange=u.onChange=l.onChange=x;r.onChange=a.onChange=o.onChange=I;i.onChange=A;e.onTriggered=function(){let t=false;if(g){j();t=true}if(h){y();t=true}if(O)t=true;if(t)v();const e=n.patch.cg||n.patch.cgl;e.pushModelMatrix();mat4.multiply(e.mMatrix,e.mMatrix,m);p.trigger();e.popModelMatrix();if(CABLES.UI){if(!r.isLinked()&&!a.isLinked()&&!o.isLinked()){gui.setTransform(n.id,r.get(),a.get(),o.get());if(n.isCurrentUiOp())gui.setTransformGizmo({posX:r,posY:a,posZ:o})}}};function v(){mat4.identity(m);if(f)mat4.translate(m,m,c);if(s.get()!==0)mat4.rotateX(m,m,s.get()*CGL.DEG2RAD);if(u.get()!==0)mat4.rotateY(m,m,u.get()*CGL.DEG2RAD);if(l.get()!==0)mat4.rotateZ(m,m,l.get()*CGL.DEG2RAD);if(d)mat4.scale(m,m,b);O=false}function j(){f=false;if(r.get()!==0||a.get()!==0||o.get()!==0)f=true;vec3.set(c,r.get(),a.get(),o.get());g=false}function y(){d=true;vec3.set(b,i.get(),i.get(),i.get());h=false}function I(){g=true}function A(){h=true}function x(){O=true}v()}};CABLES.OPS["650baeb1-db2d-4781-9af6-ab4e9d4277be"]={f:Ops.Gl.Matrix.Transform,objName:"Ops.Gl.Matrix.Transform"};Ops.Html.CSS.TransformElement=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Exec"),a=t.inObject("Element"),r=t.inFloat("Scale",1),o=t.inBool("Orthogonal",false),i=t.inFloat("Rotate",0),s=t.inBool("Hide out of view",false),u=t.inSwitch("Align Vertical",["Left","Center","Right"],"Left"),l=t.inSwitch("Align Horizontal",["Top","Center","Bottom"],"Top"),p=t.inBool("Active",true),c=t.outTrigger("Next"),b=t.outObject("HTML Element",null,"element");const m=t.patch.cgl;let d=0;let f=0;let g=0;const h=mat4.create();const O=vec3.create();const v=vec3.create();let j=-1;let y=-1;let I=0;n.onTriggered=()=>{if(!p.get())return c.trigger();S();c.trigger()};t.onDelete=_;let A=null;l.onChange=u.onChange=i.onChange=r.onChange=x;function x(){const t=a.get();if(!t){A=null;return}let e="";if(u.get()=="Left")e="0%";if(u.get()=="Center")e="-50%";if(u.get()=="Right")e="-100%";e+=", ";if(l.get()=="Top")e+="0%";if(l.get()=="Center")e+="-50%";if(l.get()=="Bottom")e+="-100%";const n="translate("+e+") scale("+r.get()+") rotate("+i.get()+"deg)";if(t.style.transform!=n){I=n;t.style.transform=n;b.setRef(t)}}a.onChange=function(){const t=a.get();if(!t){_(A);A=null;return}x();S()};a.onLinkChanged=function(){y=-1;j=-1;if(!a.isLinked()){if(A){_(A)}}else{A=a.get()}x()};function k(){mat4.multiply(h,m.vMatrix,m.mMatrix);vec3.transformMat4(O,[0,0,0],h);vec3.transformMat4(v,O,m.pMatrix);const t=m.getViewPort();const e=m.canvasWidth/m.pixelDensity;const n=m.canvasHeight/m.pixelDensity;if(o.get()){d=e*.5+v[0]*e*.5/1;f=n*.5-v[1]*n*.5/1}else{d=e-(e*.5-v[0]*e*.5);f=n-(n*.5+v[1]*n*.5)}g=O[2]<0&&d>0&&d<t[2]&&f>0&&f<t[3]}function S(){const t=a.get();A=t;if(t&&t.style){k();const e=m.canvas.offsetTop+f;const n=m.canvas.styleMarginTop||0;if(e+n!=j){t.style.top=e+n+"px";b.setRef(t);j=e}const r=m.canvas.styleMarginLeft||0;if(d+r!=y){t.style.left=d+r+"px";b.setRef(t);y=d}if(s.get()){if(g)t.style.display="initial";else t.style.display="none"}}}function _(t){y=-1;j=-1;if(!t)t=a.get();if(t&&t.style){t.style.top="initial";t.style.left="initial";t.style.transform="initial"}}t.addEventListener("onEnabledChange",function(t){if(t)S();else _()})}};CABLES.OPS["caca0307-d460-47df-8674-b7d2601239ab"]={f:Ops.Html.CSS.TransformElement,objName:"Ops.Html.CSS.TransformElement"};Ops.Gl.ResetTransform=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("exe"),r=t.outTrigger("trigger"),a=t.inBool("Reset Model Transform",true),o=t.inBool("Reset View Transform",true),i=t.inBool("Default View",true),s=t.patch.cgl;let u=false,l=false,p=false;const c=vec3.create();vec3.set(c,0,0,-2);n.onTriggered=m;a.onChange=i.onChange=o.onChange=b;b();function b(){u=o.get();l=a.get();p=i.get();i.setUiAttribs({greyout:!u})}function m(){if(u){s.pushViewMatrix();mat4.identity(s.vMatrix);if(p){mat4.translate(s.vMatrix,s.vMatrix,c)}}if(l){s.pushModelMatrix();mat4.identity(s.mMatrix)}r.trigger();if(u)s.popViewMatrix();if(l)s.popModelMatrix()}}};CABLES.OPS["1bf7c63e-e2c2-42e2-abb3-42235e7e24f0"]={f:Ops.Gl.ResetTransform,objName:"Ops.Gl.ResetTransform"};Ops.Trigger.TriggerString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.inString("String",""),a=t.outTrigger("Next"),o=t.outString("Result");o.changeAlways=true;n.onTriggered=function(){o.set(r.get());a.trigger()}}};CABLES.OPS["217482b8-2ee6-4609-b7ad-4550e6aaa371"]={f:Ops.Trigger.TriggerString,objName:"Ops.Trigger.TriggerString"};Ops.Cables.UploadAsset=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("Filename","file.bin"),r=t.inString("Base64 String",""),a=t.inTriggerButton("Upload"),o=t.outString("Result"),i=t.outBoolNum("Error"),s=t.outTrigger("Finished");a.onTriggered=()=>{i.set(false);let t=r.get();if(t.indexOf("data")!=0)t="data:;base64,"+t;if(CABLES.UI)gui.getFileManager().uploadFile(n.get(),t,(t,e)=>{if(t){o.set(t.msg);i.set(true)}s.trigger()})}}};CABLES.OPS["97d1b76e-6fbd-44c6-a1bb-e88e823c7916"]={f:Ops.Cables.UploadAsset,objName:"Ops.Cables.UploadAsset"};Ops.Json.ObjectSetArray_v2=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};const r=n.inObject("Object"),a=n.outObject("Result Object"),o=n.inString("Key"),i=n.inArray("Value");r.onChange=i.onChange=e;o.setUiAttribs({stringTrim:true,minLength:1});function e(){const t=r.get()||{};n.setUiError("id",null);if(o.get()=="")n.setUiError("id","Key needs value");const e=JSON.parse(JSON.stringify(t));if(o.get())e[o.get()]=i.get();a.setRef(e)}o.onChange=()=>{n.setUiAttrib({extendTitle:o.get()});e()}}};CABLES.OPS["47dfdb45-3364-451a-a288-acfa02510990"]={f:Ops.Json.ObjectSetArray_v2,objName:"Ops.Json.ObjectSetArray_v2"};Ops.String.Base64.Base64Encode_v3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String"),r=t.inString("MimeType","text/plain"),a=t.outString("Result");r.onChange=n.onChange=function(){let t="";if(r.get())t+="data:"+r.get()+";base64,";t+=o(n.get());a.set(t)};function o(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function t(e,n){return String.fromCharCode("0x"+n)}))}}};CABLES.OPS["4b30d030-68ec-4baa-bbdd-8fd4479b396c"]={f:Ops.String.Base64.Base64Encode_v3,objName:"Ops.String.Base64.Base64Encode_v3"};Ops.Json.ObjectStringify_v2=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("Object"),r=e.inValueBool("Beautify",true),a=e.outString("Result"),o=e.outBoolNum("Error");r.onChange=n.onChange=i;function i(){try{if(!r.get())a.set(JSON.stringify(n.get()));else a.set(JSON.stringify(n.get(),false,4));o.set(0)}catch(t){e.error(t);a.set("error");o.set(1)}}}};CABLES.OPS["89fc70ea-2350-4a0e-9a24-4efca10cced6"]={f:Ops.Json.ObjectStringify_v2,objName:"Ops.Json.ObjectStringify_v2"};Ops.Sidebar.Button_v2=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("link");const r=e.inString("Text","Button");const a=e.outObject("childs");const o=e.outTrigger("Pressed Trigger");const i=e.inBool("Grey Out",false);const s=e.inBool("Visible",true);const u=document.createElement("div");u.dataset.op=e.id;u.classList.add("cablesEle");u.classList.add("sidebar__item");u.classList.add("sidebar--button");const l=document.createElement("button");l.classList.add("sidebar__button-input");u.appendChild(l);l.addEventListener("click",b);l.style.width="100%";const p=document.createTextNode(r.get());l.appendChild(p);e.toWorkNeedsParent("Ops.Sidebar.Sidebar");n.onChange=d;r.onChange=m;e.onDelete=h;const c=document.createElement("div");c.classList.add("sidebar__greyout");u.appendChild(c);c.style.display="none";i.onChange=function(){c.style.display=i.get()?"block":"none"};s.onChange=function(){u.style.display=s.get()?"block":"none"};function b(){o.trigger()}function m(){const t=r.get();l.textContent=t;l.setAttribute("aria-label","button "+r.get());if(CABLES.UI)e.setUiAttrib({extendTitle:t})}function d(){a.set(null);const t=n.get();if(t&&t.parentElement){t.parentElement.appendChild(u);a.set(t)}else{if(u.parentElement){u.parentElement.removeChild(u)}}}function f(t){if(t){t.style.display="block"}}function g(t){if(t){t.style.display="none"}}function h(){O(u)}function O(t){if(t&&t.parentNode&&t.parentNode.removeChild){t.parentNode.removeChild(t)}}}};CABLES.OPS["5e9c6933-0605-4bf7-8671-a016d917f327"]={f:Ops.Sidebar.Button_v2,objName:"Ops.Sidebar.Button_v2"};Ops.Cables.UIMode=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.outBoolNum("UI",t.patch.isEditorMode()),r=t.outBoolNum("Overlay Mode",false),a=t.outBoolNum("Remote Viewer",window.gui?window.gui.isRemoteClient:false),o=t.outBoolNum("Is Standalone",CABLES.platform&&CABLES.platform.frontendOptions.isElectron),i=t.outNumber("Canvas Mode"),s=t.outBoolNum("Patch Field Visible");if(CABLES.UI){r.set(gui.shouldDrawOverlay);gui.on("overlaysChanged",t=>{r.set(t)});gui.on("canvasModeChange",()=>{i.set(gui.canvasManager.mode);s.set(gui.patchView.element.classList.contains("hidden"))})}}};CABLES.OPS["7c110d60-829f-4b06-b3e4-0af911550570"]={f:Ops.Cables.UIMode,objName:"Ops.Cables.UIMode"};Ops.Html.CSS.CssFile=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};const r=n.inUrl("CSS File"),e=n.inString("Media","all"),a=n.inBool("Active",true);let o=null;n.onDelete=u;e.onChange=s;r.onChange=i;n.onFileChanged=t=>{if(r.get()&&r.get().indexOf(t)>-1)i(true)};a.onChange=()=>{if(!a.get())u();else i(true)};function i(t){if(!a.get())return;u();o=n.patch.getDocument().createElement("link");n.patch.getDocument().head.appendChild(o);s();let e=r.get();if(n.patch.isEditorMode()&&t)e=CABLES.cacheBust(e);o.setAttribute("href",e)}function s(){if(!o)i();if(o){o.setAttribute("rel","stylesheet");o.setAttribute("type","text/css");o.setAttribute("media",e.get())}}function u(){if(o)o.remove();o=null}}};CABLES.OPS["baae1ab2-116c-4c18-ad93-37ced0aafdd6"]={f:Ops.Html.CSS.CssFile,objName:"Ops.Html.CSS.CssFile"};Ops.String.SwitchString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueInt("Index"),r=t.outString("Result");const a=[];n.onChange=s;for(var o=0;o<10;o++){var i=t.inString("String "+o);a.push(i);i.onChange=s}function s(){if(n.get()>=0&&a[n.get()]){r.set(a[n.get()].get())}}}};CABLES.OPS["2a7a0c68-f7c9-4249-b19a-d2de5cb4862c"]={f:Ops.String.SwitchString,objName:"Ops.String.SwitchString"};Ops.Cables.AssetPathURL=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};const r=n.inString("Filename",""),a=n.outString("Path");r.onChange=e;e();function e(){let t=r.get();if(!r.get()){a.set("");return}t=n.patch.getAssetPath()+t;let e=n.patch.getFilePath(t);a.set(e)}}};CABLES.OPS["e502ae39-c87e-4516-9e78-cb71333bcfff"]={f:Ops.Cables.AssetPathURL,objName:"Ops.Cables.AssetPathURL"};Ops.Trigger.TriggerOnChangeString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String"),r=t.outTrigger("Changed"),a=t.outString("Result");a.ignoreValueSerialize=true;n.onChange=function(){a.set(n.get());r.trigger()}}};CABLES.OPS["319d07e0-5cbe-4bc1-89fb-a934fd41b0c4"]={f:Ops.Trigger.TriggerOnChangeString,objName:"Ops.Trigger.TriggerOnChangeString"};Ops.Html.QuerySelectorAll=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const e=o.inTriggerButton("Update"),i=o.inString("Query"),s=o.inValueSelect("Mode",["document","string input"],"document"),u=o.inValueSelect("Type",["text/html","text/xml"],"text/html"),l=o.inStringEditor("Document","xml"),p=o.outArray("Elements");if(s.get()==="document"){l.setUiAttribs({greyout:true});u.set("text/html");u.setUiAttribs({greyout:true})}e.onTriggered=i.onChange=u.onChange=l.onChange=n;s.onChange=r;function n(){o.setUiError("exc",null);const n=i.get();const r=l.get();const t=s.get();if(t==="string input"&&r){let t=new DOMParser;let e=null;try{e=t.parseFromString(r,u.get());const a=Array.from(e.querySelectorAll(n));p.set(a)}catch(t){o.setUiError("exc",t.message,1);o.logWarn(t)}}else{try{const a=Array.from(document.querySelectorAll(n));p.set(a)}catch(t){o.setUiError("exc",t.message,1);o.logWarn(t)}}}function r(){if(s.get()==="document"){l.setUiAttribs({greyout:true});u.set("text/html");u.setUiAttribs({greyout:true})}else{l.setUiAttribs({greyout:false});u.setUiAttribs({greyout:false})}}}};CABLES.OPS["001799c7-9ddf-4f3e-b260-e865f0ed2c0e"]={f:Ops.Html.QuerySelectorAll,objName:"Ops.Html.QuerySelectorAll"};Ops.Graphics.Intersection.IntersectBody=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const e=["Sphere","BoxAA","Point"],n=o.inTrigger("Trigger"),r=o.inSwitch("Shape",e,"Sphere"),i=o.inString("Name",""),s=o.inFloat("Radius",.5),u=o.inFloat("Size X",1),l=o.inFloat("Size Y",1),p=o.inFloat("Size Z",1),c=o.inArray("Positions",null,3),b=o.inBool("Append Index to name",true),m=o.outTrigger("Next");o.setPortGroup("Array",[c,b]);const d=o.patch.cgl;const a=vec3.create();const f=vec3.create();v();let g=[];let h={name:"???",type:1};n.onTriggered=k;function O(){return{name:h.name,type:h.type}}r.onChange=()=>{h.type=e.indexOf(r.get())+1;v()};function v(){s.setUiAttribs({greyout:r.get()!="Sphere"});u.setUiAttribs({greyout:r.get()!="BoxAA"});l.setUiAttribs({greyout:r.get()!="BoxAA"});p.setUiAttribs({greyout:r.get()!="BoxAA"})}function j(t){t.minX=t.pos[0]-t.size[0]/2;t.maxX=t.pos[0]+t.size[0]/2;t.minY=t.pos[1]-t.size[1]/2;t.maxY=t.pos[1]+t.size[1]/2;t.minZ=t.pos[2]-t.size[2]/2;t.maxZ=t.pos[2]+t.size[2]/2}const y=1;const I=2;const A=3;function x(t){if(!CABLES.UI)return;if(!d.shouldDrawHelpers(o))return;if(t.type===y){d.pushModelMatrix();CABLES.UI.OverlayMeshes.drawSphere(o,t.radius,true);d.popModelMatrix()}else if(t.type===I){d.pushModelMatrix();CABLES.UI.OverlayMeshes.drawCube(o,t.size[0]/2,t.size[1]/2,t.size[2]/2);d.popModelMatrix()}else if(t.type===A){d.pushModelMatrix();CABLES.UI.OverlayMeshes.drawAxisMarker(o,.05);d.popModelMatrix()}else console.warn("[intersectWorld] unknown col shape")}function k(){if(!d.tempData||!d.tempData.collisionWorld)return;const e=o.patch.cgl;const n=c.get();const r=s.get();if(n&&n.length>0&&n.length%3==0){g.length=n.length/3;for(let t=0;t<n.length;t+=3){const a=g[t/3]||{};if(b.get())a.name=i.get()+"."+t/3;else a.name=i.get();a.pos=[n[t+0],n[t+1],n[t+2]];vec3.transformMat4(a.pos,a.pos,e.mMatrix);a.type=h.type;a.size=[u.get(),l.get(),p.get()];if(a.type==2)j(a);if(a.type==1)a.radius=r;d.tempData.collisionWorld.bodies.push(a);x(a)}}else{const t=O();d.tempData.collisionWorld.bodies.push(t);t.name=i.get();t.pos=[0,0,0];vec3.transformMat4(t.pos,t.pos,e.mMatrix);t.size=[u.get(),l.get(),p.get()];if(t.type==2)j(t);if(t.type==1)t.radius=r;x(t)}m.trigger()}}};CABLES.OPS["b2e39096-8a02-4a50-b2f5-3e68f2c16ad7"]={f:Ops.Graphics.Intersection.IntersectBody,objName:"Ops.Graphics.Intersection.IntersectBody"};Ops.Math.Compare.Equals=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValue("number1",1),r=t.inValue("number2",1),a=t.outBoolNum("result");n.onChange=r.onChange=o;o();function o(){a.set(n.get()==r.get())}}};CABLES.OPS["4dd3cc55-eebc-4187-9d4e-2e053a956fab"]={f:Ops.Math.Compare.Equals,objName:"Ops.Math.Compare.Equals"};Ops.Trigger.GateTrigger=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Execute"),r=t.inValueBool("Pass Through",true),a=t.outTrigger("Trigger out");n.onTriggered=function(){if(r.get())a.trigger()}}};CABLES.OPS["65e8b8a2-ba13-485f-883a-2bcf377989da"]={f:Ops.Trigger.GateTrigger,objName:"Ops.Trigger.GateTrigger"};Ops.Html.CSS.GetCssVariable=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Update"),r=t.inString("Var Name"),a=t.outString("Result");const o=document.documentElement;n.onTriggered=function(){let t=o.style.getPropertyValue("--"+r.get());if(!t)t=getComputedStyle(o).getPropertyValue("--"+r.get());a.set(t)}}};CABLES.OPS["ef03f407-e365-47c7-9829-be54ba53c54d"]={f:Ops.Html.CSS.GetCssVariable,objName:"Ops.Html.CSS.GetCssVariable"};Ops.Trigger.TriggerOnce=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Exec"),r=t.inTriggerButton("Reset"),a=t.outTrigger("Next"),o=t.outBoolNum("Was Triggered");let i=false;t.toWorkPortsNeedToBeLinked(n);r.onTriggered=function(){i=false;o.set(i)};n.onTriggered=function(){if(i)return;i=true;a.trigger();o.set(i)}}};CABLES.OPS["cf3544e4-e392-432b-89fd-fcfb5c974388"]={f:Ops.Trigger.TriggerOnce,objName:"Ops.Trigger.TriggerOnce"};Ops.Html.CSS.CSSPropertyString=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("Element"),r=e.inString("Property"),a=e.inString("Value"),o=e.inBool("Active",true),i=e.outObject("HTML Element");e.setPortGroup("Element",[n]);e.setPortGroup("Attributes",[r,a]);r.onChange=l;a.onChange=p;let s=null;n.onChange=i.onLinkChanged=n.onLinkChanged=u;o.onChange=()=>{if(!o.get())u();else p()};function u(){if(s&&s.style)s.style[r.get()]="initial";p()}function l(){p();e.setUiAttrib({extendTitle:r.get()+""})}function p(){if(!o.get())return;s=n.get();if(s&&s.style){const t=a.get();try{s.style[r.get()]=t}catch(t){e.logError(t)}}i.setRef(n.get())}}};CABLES.OPS["a7abdfb9-4c2a-4ddb-8fc6-55b3fdfbdaf3"]={f:Ops.Html.CSS.CSSPropertyString,objName:"Ops.Html.CSS.CSSPropertyString"};Ops.Gl.Matrix.TransformView=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};const e=n.inTrigger("render"),r=n.inValueFloat("posX"),a=n.inValueFloat("posY"),o=n.inValueFloat("posZ"),i=n.inValueFloat("scale"),s=n.inValueFloat("rotX"),u=n.inValueFloat("rotY"),l=n.inValueFloat("rotZ"),p=n.outTrigger("trigger");n.setPortGroup("Position",[r,a,o]);n.setPortGroup("Scale",[i]);n.setPortGroup("Rotation",[s,l,u]);const c=vec3.create();const b=vec3.create();const m=mat4.create();mat4.identity(m);let d=false;let f=false;let g=true;let h=true;let O=true;e.onTriggered=function(){const t=n.patch.cg||n.patch.cgl;let e=false;if(g){j();e=true}if(h){y();e=true}if(O){e=true}if(e)v();t.pushViewMatrix();mat4.multiply(t.vMatrix,t.vMatrix,m);p.trigger();t.popViewMatrix();if(n.isCurrentUiOp())gui.setTransformGizmo({posX:r,posY:a,posZ:o})};n.transform3d=function(){return{pos:[r,a,o]}};function v(){mat4.identity(m);if(f)mat4.translate(m,m,c);if(s.get()!==0)mat4.rotateX(m,m,s.get()*CGL.DEG2RAD);if(u.get()!==0)mat4.rotateY(m,m,u.get()*CGL.DEG2RAD);if(l.get()!==0)mat4.rotateZ(m,m,l.get()*CGL.DEG2RAD);if(d)mat4.scale(m,m,b);x=false}function j(){f=false;if(r.get()!==0||a.get()!==0||o.get()!==0)f=true;vec3.set(c,r.get(),a.get(),o.get());g=false}function y(){d=false;if(i.get()!==0)d=true;vec3.set(b,i.get(),i.get(),i.get());A=false}function I(){g=true}function A(){h=true}function x(){O=true}s.onChange=u.onChange=l.onChange=x;i.onChange=A;r.onChange=a.onChange=o.onChange=I;s.set(0);u.set(0);l.set(0);i.set(1);r.set(0);a.set(0);o.set(0);v()}};CABLES.OPS["0b3e04f7-323e-4ac8-8a22-a21e2f36e0e9"]={f:Ops.Gl.Matrix.TransformView,objName:"Ops.Gl.Matrix.TransformView"};Ops.Vars.VarTriggerObject=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.inObject("Value",null),a=t.outTrigger("Next");t.varName=t.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(t,"object",r,t.varName,n,a)}};CABLES.OPS["93939bed-e43c-48e1-aa45-0a73534bd5d6"]={f:Ops.Vars.VarTriggerObject,objName:"Ops.Vars.VarTriggerObject"};Ops.Gl.Meshes.SimpleSpline_v2=class extends CABLES.Op{constructor(){super(...arguments);const s=this;const t=s.attachments={};const e=s.inTrigger("Render"),u=s.inArray("Points"),n=s.inValueInt("Num Points"),r=s.inBool("Line Strip",true),a=s.outObject("Geometry"),l=s.inSwitch("TexCoords",["0","0-1","Random","Fill"],"0"),p=s.inArray("TexCoords Array"),c=s.inArray("Vertex Colors"),o=s.outTrigger("Next");const i=s.patch.cgl;const b=new CGL.Geometry("simplespline");a.set(b);b.vertices=[0,0,0,0,0,0,0,0,0];let m=new CGL.Mesh(i,b);let d=new Float32Array;let f=new Float32Array;let g=new Float32Array;let h=true;let O;let v="";c.onChange=p.onChange=l.onChange=n.onChange=u.onChange=function(){h=true};s.toWorkPortsNeedToBeLinked(u);s.onDelete=function(){if(m)m.dispose()};function j(){const t=u.get()||[];const e=t.length;if(!(t instanceof Float32Array)){if(e!=d.length){d=new Float32Array(e);g=new Float32Array(e);m.setAttribute(CGL.SHADERVAR_VERTEX_NORMAL,g,3);d.set(t)}else{d.set(t)}}else{d=t}O=m.setAttribute(CGL.SHADERVAR_VERTEX_POSITION,d,3);s.setUiError("wrongvcnum",null);if(c.get()){if(c.get().length/4!=d.length/3)s.setUiError("wrongvcnum","vertex color array length is wrong. should be "+d.length/3*4);const n=m.setAttribute(CGL.SHADERVAR_VERTEX_COLOR,c.get(),4)}const r=e/3*2;s.setUiError("wrongtcnum",null);if(p.get()){const a=p.get();if(a.length/2!=d.length/3)s.setUiError("wrongtcnum","texcoord array length is wrong. should be "+d.length/3*2);const o=m.setAttribute(CGL.SHADERVAR_VERTEX_TEXCOORD,a,2)}else if(v!=l.get()||m.getAttribute(CGL.SHADERVAR_VERTEX_TEXCOORD).numItems!=r/2){v=l.get();if(f.length!=r)f=new Float32Array(r);if(l.get()=="0-1"){for(let t=0;t<r;t+=2){f[t]=t/r;f[t+1]=.5}}else if(l.get()=="Fill"){const i=Math.sqrt(r/2);let n=0;for(let e=0;e<i;e++){for(let t=0;t<i;t++){n++;f[n*2+0]=t/i;f[n*2+1]=e/i}}}else if(l.get()=="Random"){for(let t=0;t<r;t+=2){f[t]=Math.random();f[t+1]=Math.random()}}else{for(let t=0;t<r;t+=2){f[t]=0;f[t+1]=0}}const o=m.setAttribute(CGL.SHADERVAR_VERTEX_TEXCOORD,f,2)}h=false}e.onTriggered=function(){if(!u.get())return;if(h)j();const t=i.getShader();if(!t)return;const e=t.glPrimitive;if(r.get())t.glPrimitive=i.gl.LINE_STRIP;else t.glPrimitive=i.gl.LINES;if(O)if(n.get()<=0)O.numItems=d.length/3;else O.numItems=Math.min(n.get(),d.length/3);if(m&&d.length!==0)m.render(t);t.glPrimitive=e;o.trigger()}}};CABLES.OPS["b9cca0c1-17ac-466a-96ed-bb3916433e6f"]={f:Ops.Gl.Meshes.SimpleSpline_v2,objName:"Ops.Gl.Meshes.SimpleSpline_v2"};Ops.Gl.Shader.BasicMaterial_v3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={basicmaterial_frag:"{{MODULES_HEAD}}\n\nIN vec2 texCoord;\n\n#ifdef VERTEX_COLORS\nIN vec4 vertCol;\n#endif\n\n#ifdef HAS_TEXTURES\n    IN vec2 texCoordOrig;\n    #ifdef HAS_TEXTURE_DIFFUSE\n        UNI sampler2D tex;\n    #endif\n    #ifdef HAS_TEXTURE_OPACITY\n        UNI sampler2D texOpacity;\n   #endif\n#endif\n\n\n\nvoid main()\n{\n    {{MODULE_BEGIN_FRAG}}\n    vec4 col=color;\n\n\n    #ifdef HAS_TEXTURES\n        vec2 uv=texCoord;\n\n        #ifdef CROP_TEXCOORDS\n            if(uv.x<0.0 || uv.x>1.0 || uv.y<0.0 || uv.y>1.0) discard;\n        #endif\n\n        #ifdef HAS_TEXTURE_DIFFUSE\n            col=texture(tex,uv);\n\n            #ifdef COLORIZE_TEXTURE\n                col.r*=color.r;\n                col.g*=color.g;\n                col.b*=color.b;\n            #endif\n        #endif\n        col.a*=color.a;\n        #ifdef HAS_TEXTURE_OPACITY\n            #ifdef TRANSFORMALPHATEXCOORDS\n                uv=texCoordOrig;\n            #endif\n            #ifdef ALPHA_MASK_IR\n                col.a*=1.0-texture(texOpacity,uv).r;\n            #endif\n            #ifdef ALPHA_MASK_IALPHA\n                col.a*=1.0-texture(texOpacity,uv).a;\n            #endif\n            #ifdef ALPHA_MASK_ALPHA\n                col.a*=texture(texOpacity,uv).a;\n            #endif\n            #ifdef ALPHA_MASK_LUMI\n                col.a*=dot(vec3(0.2126,0.7152,0.0722), texture(texOpacity,uv).rgb);\n            #endif\n            #ifdef ALPHA_MASK_R\n                col.a*=texture(texOpacity,uv).r;\n            #endif\n            #ifdef ALPHA_MASK_G\n                col.a*=texture(texOpacity,uv).g;\n            #endif\n            #ifdef ALPHA_MASK_B\n                col.a*=texture(texOpacity,uv).b;\n            #endif\n            // #endif\n        #endif\n    #endif\n\n    {{MODULE_COLOR}}\n\n    #ifdef DISCARDTRANS\n        if(col.a<0.2) discard;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        col*=vertCol;\n    #endif\n\n    outColor = col;\n}\n",basicmaterial_vert:"\n{{MODULES_HEAD}}\n\nOUT vec2 texCoord;\nOUT vec2 texCoordOrig;\n\nUNI mat4 projMatrix;\nUNI mat4 modelMatrix;\nUNI mat4 viewMatrix;\n\n#ifdef HAS_TEXTURES\n    UNI float diffuseRepeatX;\n    UNI float diffuseRepeatY;\n    UNI float texOffsetX;\n    UNI float texOffsetY;\n#endif\n\n#ifdef VERTEX_COLORS\n    in vec4 attrVertColor;\n    out vec4 vertCol;\n\n#endif\n\n\nvoid main()\n{\n    mat4 mMatrix=modelMatrix;\n    mat4 modelViewMatrix;\n\n    norm=attrVertNormal;\n    texCoordOrig=attrTexCoord;\n    texCoord=attrTexCoord;\n    #ifdef HAS_TEXTURES\n        texCoord.x=texCoord.x*diffuseRepeatX+texOffsetX;\n        texCoord.y=(1.0-texCoord.y)*diffuseRepeatY+texOffsetY;\n    #endif\n\n    #ifdef VERTEX_COLORS\n        vertCol=attrVertColor;\n    #endif\n\n    vec4 pos = vec4(vPosition, 1.0);\n\n    #ifdef BILLBOARD\n       vec3 position=vPosition;\n       modelViewMatrix=viewMatrix*modelMatrix;\n\n       gl_Position = projMatrix * modelViewMatrix * vec4((\n           position.x * vec3(\n               modelViewMatrix[0][0],\n               modelViewMatrix[1][0],\n               modelViewMatrix[2][0] ) +\n           position.y * vec3(\n               modelViewMatrix[0][1],\n               modelViewMatrix[1][1],\n               modelViewMatrix[2][1]) ), 1.0);\n    #endif\n\n    {{MODULE_VERTEX_POSITION}}\n\n    #ifndef BILLBOARD\n        modelViewMatrix=viewMatrix * mMatrix;\n\n        {{MODULE_VERTEX_MODELVIEW}}\n\n    #endif\n\n    // mat4 modelViewMatrix=viewMatrix*mMatrix;\n\n    #ifndef BILLBOARD\n        // gl_Position = projMatrix * viewMatrix * modelMatrix * pos;\n        gl_Position = projMatrix * modelViewMatrix * pos;\n    #endif\n}\n"};const n=t.inTrigger("render");const r=t.outTrigger("trigger");const a=t.outObject("shader",null,"shader");a.ignoreValueSerialize=true;t.toWorkPortsNeedToBeLinked(n);t.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION);const o=t.patch.cgl;const i=new CGL.Shader(o,"basicmaterial",this);i.addAttribute({type:"vec3",name:"vPosition"});i.addAttribute({type:"vec2",name:"attrTexCoord"});i.addAttribute({type:"vec3",name:"attrVertNormal",nameFrag:"norm"});i.addAttribute({type:"float",name:"attrVertIndex"});i.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG","MODULE_VERTEX_MODELVIEW"]);i.setSource(e.basicmaterial_vert,e.basicmaterial_frag);a.setRef(i);n.onTriggered=_;const s=t.inValueSlider("r",Math.random());const u=t.inValueSlider("g",Math.random());const l=t.inValueSlider("b",Math.random());const p=t.inValueSlider("a",1);s.setUiAttribs({colorPick:true});const c=i.addUniformFrag("4f","color",s,u,l,p);i.uniformColorDiffuse=c;const b=t.inTexture("texture");let m=null;b.onChange=C;const d=t.inValueBool("colorizeTexture",false);const f=t.inValueBool("Vertex Colors",false);const g=t.inTexture("textureOpacity");let h=null;const O=t.inSwitch("Alpha Mask Source",["Luminance","R","G","B","A","1-A","1-R"],"Luminance");O.setUiAttribs({greyout:true});g.onChange=N;const v=t.inValueBool("Opacity TexCoords Transform",false);const j=t.inValueBool("Discard Transparent Pixels");const y=t.inValue("diffuseRepeatX",1),I=t.inValue("diffuseRepeatY",1),A=t.inValue("Tex Offset X",0),x=t.inValue("Tex Offset Y",0),k=t.inBool("Crop TexCoords",false);i.addUniformFrag("f","diffuseRepeatX",y);i.addUniformFrag("f","diffuseRepeatY",I);i.addUniformFrag("f","texOffsetX",A);i.addUniformFrag("f","texOffsetY",x);const S=t.inValueBool("billboard",false);O.onChange=S.onChange=j.onChange=v.onChange=k.onChange=f.onChange=d.onChange=T;t.setPortGroup("Color",[s,u,l,p]);t.setPortGroup("Color Texture",[b,f,d]);t.setPortGroup("Opacity",[g,O,j,v]);t.setPortGroup("Texture Transform",[y,I,A,x,k]);N();C();t.preRender=function(){i.bind();_()};function _(){if(!i)return;o.pushShader(i);i.popTextures();if(m&&b.get())i.pushTexture(m,b.get());if(h&&g.get())i.pushTexture(h,g.get());r.trigger();o.popShader()}function N(){if(g.get()){if(h!==null)return;i.removeUniform("texOpacity");i.define("HAS_TEXTURE_OPACITY");if(!h)h=new CGL.Uniform(i,"t","texOpacity")}else{i.removeUniform("texOpacity");i.removeDefine("HAS_TEXTURE_OPACITY");h=null}T()}function C(){if(b.get()){if(!i.hasDefine("HAS_TEXTURE_DIFFUSE"))i.define("HAS_TEXTURE_DIFFUSE");if(!m)m=new CGL.Uniform(i,"t","texDiffuse")}else{i.removeUniform("texDiffuse");i.removeDefine("HAS_TEXTURE_DIFFUSE");m=null}w()}function w(){const t=b.isLinked()||g.isLinked();y.setUiAttribs({greyout:!t});I.setUiAttribs({greyout:!t});A.setUiAttribs({greyout:!t});x.setUiAttribs({greyout:!t});d.setUiAttribs({greyout:!t});O.setUiAttribs({greyout:!g.get()});v.setUiAttribs({greyout:!g.get()});let e=true;e=b.get()&&!d.get();s.setUiAttribs({greyout:e});u.setUiAttribs({greyout:e});l.setUiAttribs({greyout:e})}function T(){i.toggleDefine("VERTEX_COLORS",f.get());i.toggleDefine("CROP_TEXCOORDS",k.get());i.toggleDefine("COLORIZE_TEXTURE",d.get());i.toggleDefine("TRANSFORMALPHATEXCOORDS",v.get());i.toggleDefine("DISCARDTRANS",j.get());i.toggleDefine("BILLBOARD",S.get());i.toggleDefine("ALPHA_MASK_ALPHA",O.get()=="A");i.toggleDefine("ALPHA_MASK_IALPHA",O.get()=="1-A");i.toggleDefine("ALPHA_MASK_IR",O.get()=="1-R");i.toggleDefine("ALPHA_MASK_LUMI",O.get()=="Luminance");i.toggleDefine("ALPHA_MASK_R",O.get()=="R");i.toggleDefine("ALPHA_MASK_G",O.get()=="G");i.toggleDefine("ALPHA_MASK_B",O.get()=="B");w()}}};CABLES.OPS["ec55d252-3843-41b1-b731-0482dbd9e72b"]={f:Ops.Gl.Shader.BasicMaterial_v3,objName:"Ops.Gl.Shader.BasicMaterial_v3"};Ops.Array.WeaveArrays=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};let i=t.inArray("Array 1");let s=t.inArray("Array 2");let u=t.inValue("Chunk Size",1);let l=t.outArray("Combined Array");i.onChange=n;s.onChange=n;u.onChange=n;function n(){let n=[];let r=i.get();let a=s.get();let o=u.get();if(o<1){o=1}if(r&&!a){n=r.slice(0)}if(!r&&a){n=a.slice(0)}else if(r&&a){for(let e=0;e<Math.max(r.length,a.length);e+=o){for(let t=0;t<o&&t+e<r.length;t++){n.push(r[e+t])}for(let t=0;t<o&&t+e<a.length;t++){n.push(a[e+t])}}}l.set(null);l.set(n)}}};CABLES.OPS["ad6d77b7-d81d-4115-a2f2-5160adaaef3a"]={f:Ops.Array.WeaveArrays,objName:"Ops.Array.WeaveArrays"};Ops.Math.Multiply=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("number1",1),r=t.inValueFloat("number2",1),a=t.outNumber("result");t.setUiAttribs({mathTitle:true});n.onChange=r.onChange=o;o();function o(){const t=n.get();const e=r.get();a.set(t*e)}}};CABLES.OPS["1bbdae06-fbb2-489b-9bcc-36c9d65bd441"]={f:Ops.Math.Multiply,objName:"Ops.Math.Multiply"};Ops.Number.Number=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("value"),r=t.outNumber("result");n.onChange=a;function a(){if(CABLES.UI)t.setUiAttribs({extendTitle:n.get()});r.set(Number(n.get()))}}};CABLES.OPS["8fb2bb5d-665a-4d0a-8079-12710ae453be"]={f:Ops.Number.Number,objName:"Ops.Number.Number"};Ops.Html.ElementChilds_v2=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const i=o.inObject("Parent",null,"element"),s=o.outObject("Parent Out",null,"element");const r=o.patch.cgl.canvas.parentElement;o.toWorkPortsNeedToBeLinked(i);const u=[];for(let n=0;n<10;n++){const l=o.inObject("Child "+(n+1),null,"element");u.push(l);l.onChange=()=>{a();if(!l.get()){const t="[data-cables-child-id='"+o.id+"_"+n+"']";const e=r.querySelector(t);if(e)delete e.dataset.cablesChildId}};l.onLinkChanged=()=>{if(!l.isLinked()){const t="[data-cables-child-id='"+o.id+"_"+n+"']";const e=r.querySelector(t);if(e)e.remove()}}}i.onLinkChanged=()=>{if(!i.isLinked()){e()}else{a()}};s.onLinkChanged=()=>{if(!s.isLinked()){const t=i.get();if(t&&t.dataset.op){const e=r.querySelector("[data-op=' "+t.dataset.op+" ']");if(!e){r.appendChild(t)}}}};i.onChange=()=>{if(!i.get()){e()}a()};function e(){for(let t=0;t<u.length;t++){const e="[data-cables-child-id='"+o.id+"_"+t+"']";const n=r.querySelector(e);if(n&&n.parentNode){n.remove()}}s.set(null)}function a(){const n=i.get();if(!n){s.set(null);return}if(!n.querySelector){s.set(null);return}o.setUiError("id",null);try{o.setUiError("multilinks",null);for(let e=0;e<u.length;e++){const r="[data-cables-child-id='"+o.id+"_"+e+"']";const a=n.querySelector(r);if(a){a.remove()}const t=u[e].get();if(u[e].links.length>1){o.setUiError("multilinks","Every port should only have not more then one connection")}if(t&&n){if(!t.dataset)console.warn("[elementChilds] p no dataset ?!");else t.dataset.cablesChildId=o.id+"_"+e;n.appendChild(t)}}}catch(t){o.setUiError("id",t.message)}s.setRef(n)}}};CABLES.OPS["ad7eea9a-f4af-4ab7-bb70-922242529681"]={f:Ops.Html.ElementChilds_v2,objName:"Ops.Html.ElementChilds_v2"};Ops.Team.Plan.Place=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("Entrance",null,"Route"),r=e.inString("Name",""),a=e.inTriggerButton("Force Active"),o=e.outMultiPort("Exit",CABLES.OP_PORT_TYPE_OBJECT,{});a.setUiAttribs({hidePort:true});r.setUiAttribs({hidePort:true});let i=null;r.onChange=()=>{e.setUiAttrib({extendTitle:r.get()});if(i)i.update()};o.on("onLinkChanged",()=>{if(i)i.update()});function s(){let t=r.get();if(i.currentPlaceName==r.get())t+=" - CURRENT";e.setUiAttrib({extendTitle:t})}e.setPlan=t=>{if(i==t)return;i=t;i.on("stateChanged",()=>{s()})};a.onTriggered=()=>{if(i)i.setCurrentPlaceName(r.get());else console.warn("has no plan")}}};CABLES.OPS["fb8b1616-430c-4e40-89fc-823de752ed84"]={f:Ops.Team.Plan.Place,objName:"Ops.Team.Plan.Place"};Ops.Team.Plan.Plan=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const u=new CABLES.Anim;const l=new CABLES.Anim;const n=e.inString("Title",""),p=e.inString("Default Place",""),c=e.inString("Root Place",""),b=e.inFloat("Duration Enter",.5),r=u.createPort(e,"Easing Enter"),m=e.inFloat("Duration Exit",.25),a=l.createPort(e,"Easing Exit"),d=e.inString("Data"),o=e.outString("Current Place"),f=e.outObject("Structure");d.setUiAttribs({hidePort:true,hideParam:true});n.setUiAttribs({hidePort:true});e.setPortGroup("Anim Transition",[m,b]);e.setUiAttrib({hasArea:true});e.init=b.onChange=m.onChange=n.onChange=c.onChange=e.onLoaded=i;u.on("onChangeDefaultEasing",s);l.on("onChangeDefaultEasing",s);const g=new CABLES.Plan(e);i();g.on("stateChanged",()=>{o.set(g.currentPlaceName)});p.onChange=()=>{if(!g)s();if(g)g.setCurrentPlaceName(p.get())};function i(){g.setName(n.get());if(CABLES.UI){gui.savedState.setUnSaved("areaOp");e.setUiAttrib({extendTitle:": "+n.get()})}s()}function h(t){return t.getPort&&t.getPort("Name")&&t.setPlan}function O(){let t=[];if(e.uiAttribs&&e.uiAttribs.translate)t=e.patch.getOpsInRect(e.uiAttribs.translate.x,e.uiAttribs.translate.y,e.uiAttribs.translate.x+e.uiAttribs.area.w,e.uiAttribs.translate.y+e.uiAttribs.area.h);t=t.filter(t=>{return h(t)});return t}function v(t){const e=t.links[0].getOtherPort(t);return e.op}function j(e,n,r){n.level=r;for(const a in n.exits){for(let t=0;t<e.length;t++){if(e[t].name==n.exits[a].place){if(e[t].hasOwnProperty("level"))continue;j(e,e[t],r+1)}}}}function s(){let t=null;if(!CABLES.UI){if(d.get()){t=JSON.parse(d.get())}else return}if(!t){const n=O();for(let e=0;e<n.length;e++){const t=n[e];t.setPlan(g);if(t.getPort("Name").get()==p.get())g.setCurrentPlaceName(p.get())}const r=[];const a=O();for(let t=0;t<a.length;t++){const e=a[t];const o={name:e.getPort("Name").get(),exits:{}};r.push(o);for(let t=0;t<e.portsOut.length;t++){const i=e.portsOut[t];if(i.isLinked()){const s=v(i);if(h(s)){o.exits[i.name]={place:s.getPort("Name").get()}}}}}if(c.get()!=""){for(let t=0;t<r.length;t++){if(r[t].name==c.get()){j(r,r[t],0)}}}g.durationIn=b.get();g.durationOut=m.get();g.setEasing(u.defaultEasing,l.defaultEasing);t={places:r};d.set(JSON.stringify(t))}g.setData(t);f.setRef(t)}e.updatePlan=s}};CABLES.OPS["2e23b236-c8fc-47db-acd2-22277d555477"]={f:Ops.Team.Plan.Plan,objName:"Ops.Team.Plan.Plan"};Ops.Website.LocationHashRoute=class extends CABLES.Op{constructor(){super(...arguments);const l=this;const t=l.attachments={};const p=l.inString("Route");const r=l.outObject("Values",{});const c=l.outTrigger("Changed");const b=l.outBool("Matching");let m=null;let e=null;function n(){if("onhashchange"in window){const t=t=>{t.internal=true;o(t)};if(e){l.patch.removeEventListener(e);e=null}e=l.patch.addEventListener("LocationHashChange",t);window.removeEventListener("hashchange",a);window.addEventListener("hashchange",a);o({newURL:window.location.href})}else{l.setUiError("unsupported","Your browser does not support listening to hashchanges!")}}n();function a(t){o(t)}l.onDelete=function(){if(e){l.patch.removeEventListener(e);e=null}window.removeEventListener("hashchange",a)};p.onChange=function(){o({newURL:window.location.href},true)};function o(t,e){let a="";if(!e&&t.newURL===m){return}m=t.newURL;l.setUiError("unsupported",null);let o={};const i=t.newURL.split("#");let s=false;if(p.get()){if(i.length>1){s=false;for(let r=1;r<i.length;r++){let t=p.get();let e=i[r];a+="#"+i[r];let n=false;l.setUiError("regex",null);try{n=g(t,e)}catch(t){l.setUiError("regex","Failed to parse route string, check documentation. <br>- "+t.message)}if(n){if(n.data){const u=Object.keys(n.data);u.forEach(t=>{n.data[t]=d(n.data[t])});o=Object.assign(o,n.data)}if(n.params){const u=Object.keys(n.params);u.forEach(t=>{n.params[t]=d(n.params[t])});o=Object.assign(o,n.params)}s=true}}}}else{const n=t.newURL.split("#",2);a=n[1]||"";s=true}if(s){let t=a.split("?",2);let e=f(t[1]);let n=Object.keys(e);n.forEach(t=>{if(!o.hasOwnProperty(t))o[t]=e[t]})}b.set(s);if(!(r.get().length===0&&o.length===0)){r.set(o)}if(s&&!t.silent){c.trigger()}}function d(t){let e=decodeURIComponent(t||"");if(e!==""){switch(e){case"true":e=true;break;case"false":e=false;break;default:if(!isNaN(e)){e=Number(e)}}}return e}function f(t){if(typeof t!="string"||t.length==0)return{};let e=t.split("&");let n=e.length;let r,a={},o,i;for(let t=0;t<n;t++){r=e[t].split("=");o=decodeURIComponent(r[0]);if(o.length==0)continue;i=decodeURIComponent(r[1]);if(typeof a[o]=="undefined")a[o]=i;else if(a[o]instanceof Array)a[o].push(i);else a[o]=[a[o],i]}return a}function g(t,e){if(typeof e!=="undefined"){e="/"+h(e)}let n={to:e,currentLocationPath:e};if(typeof n.currentLocationPath==="undefined"){let t="/";if(typeof window!=="undefined"){t=location.pathname+location.search+location.hash}n.currentLocationPath=n.to=t}if(n.currentLocationPath.indexOf("#")>=0){n.currentLocationPath=n.currentLocationPath.split("#")[1]||"/"}if(typeof t==="string"){t="/"+h(t)}let r=i(n,{name:String(t),path:t,handler:function t(){},hooks:{}});return r||false}function h(t){return t.replace(/\/+$/,"").replace(/^\/+/,"")}function i(n,r){let t=h(n.currentLocationPath).split(/\?(.*)?$/);let e=[h(t[0]),t.slice(1).join("")];let a=e[0],o=e[1];let i=o===""?null:f(o);let s=[];let u;if(typeof r.path==="string"){u="(?:/^|^)"+h(r.path).replace(/([:*])(\w+)/g,function(t,e,n){s.push(n);return"([^/]+)"}).replace(/\*/g,"?(?:.*)").replace(/\/\?/g,"/?([^/]+|)")+"$";if(h(r.path)===""){if(h(a)===""){let t="";if(n.to&&n.to.indexOf("#")>=0){t=n.to.split("#").pop()||""}return{url:a,queryString:o,hashString:t,route:r,data:null,params:i}}}}else{u=r.path}let l=new RegExp(u,"");let p=a.match(l);if(p){let t=null;if(typeof r.path==="string"){if(s.length===0){t=null}else{t=p.slice(1,p.length).reduce(function(t,e,n){if(t===null)t={};t[s[n]]=decodeURIComponent(e);return t},null)}}else if(p.groups){t=p.groups}if(!t)t=p.slice(1);let e="";if(n.to&&n.to.indexOf("#")>=0){e=n.to.split("#").pop()||""}return{url:h(a.replace(new RegExp("^/"),"")),queryString:o,hashString:e,route:r,data:t,params:i}}return false}}};CABLES.OPS["1e76f92b-1eed-4575-96e1-fcff6ed08c04"]={f:Ops.Website.LocationHashRoute,objName:"Ops.Website.LocationHashRoute"};Ops.Team.Plan.GotoPlace=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Execute"),r=t.inString("Plan",""),a=t.inString("Go To Place",""),o=t.outTrigger("Next");let i=null;a.onChange=s;t.setUiError("noplan","plan not found");function s(){t.setUiAttrib({extendTitle:a.get()})}t.patch.on("plansChanged",u);r.onChange=u;function u(){if(!t.patch.plans)return;i=t.patch.plans[r.get()];t.setUiError("noplan",null);if(!i||!r.get()){t.setUiError("noplan","plan not found");return}}n.onTriggered=()=>{if(!i)return;t.setUiError("exitempty",null);if(!a.get()){t.setUiError("exitempty","exit name empty");return}i.gotoPlace(a.get());o.trigger()}}};CABLES.OPS["48872b9e-a6a2-49c0-88bb-d9473f82cbab"]={f:Ops.Team.Plan.GotoPlace,objName:"Ops.Team.Plan.GotoPlace"};Ops.Vars.VarSetString_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("Value","New String");t.varName=t.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(t,"string",n,t.varName)}};CABLES.OPS["0b4d9229-8024-4a30-9cc0-f6653942c2e4"]={f:Ops.Vars.VarSetString_v2,objName:"Ops.Vars.VarSetString_v2"};Ops.Vars.VarGetString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};var n=t.outString("Value");t.varName=t.inValueSelect("Variable",[],"",true);new CABLES.VarGetOpWrapper(t,"string",t.varName,n)}};CABLES.OPS["3ad08cfc-bce6-4175-9746-fef2817a3b12"]={f:Ops.Vars.VarGetString,objName:"Ops.Vars.VarGetString"};Ops.Array.Array_v3=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const r=e.inValueInt("Array length",10),n=e.inSwitch("Mode select",["Number","1,2,3,4","0-1"],"Number"),a=e.inValueFloat("Default Value"),o=e.inBool("Reverse",false),i=e.outArray("Array"),s=e.outNumber("Array length out");let u=[];let l=0;const p=0;const c=1;const b=2;n.onChange=m;o.onChange=a.onChange=r.onChange=d;m();d();function m(){let t=n.get();if(t==="Number")l=p;else if(t==="1,2,3,4")l=c;else if(t==="0-1")l=b;a.setUiAttribs({greyout:l!==p});e.setUiAttrib({extendTitle:n.get()});d()}function d(){u.length=0;let t=r.get();let e=a.get();let n;if(l===p){for(n=0;n<t;n++){u[n]=e}}else if(l===c){for(n=0;n<t;n++){u[n]=n}}else if(l===b){if(t>1){for(n=0;n<t;n++){u[n]=n/(t-1)}}else{u=[0]}}if(o.get())u=u.reverse();i.setRef(u);s.set(u.length)}}};CABLES.OPS["e4d31a46-bf64-42a8-be34-4cbb2bbc2600"]={f:Ops.Array.Array_v3,objName:"Ops.Array.Array_v3"};Ops.Math.Divide=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("number1",1),r=t.inValueFloat("number2",2),a=t.outNumber("result");t.setUiAttribs({mathTitle:true});n.onChange=r.onChange=o;o();function o(){a.set(n.get()/r.get())}}};CABLES.OPS["86fcfd8c-038d-4b91-9820-a08114f6b7eb"]={f:Ops.Math.Divide,objName:"Ops.Math.Divide"};Ops.Array.ArraySetNumber_v3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inArray("Array"),a=t.inInt("Index",0),o=t.inFloat("Number",1),i=t.outArray("Result");let s=[];t.toWorkPortsNeedToBeLinked(r);r.onChange=a.onChange=o.onChange=n;function n(){const e=r.get();if(!e){i.set(null);return}s.length=e.length;const n=a.get();for(let t=0;t<e.length;t++){if(n===t)s[t]=o.get();else s[t]=e[t]}i.setRef(s)}}};CABLES.OPS["1a71327d-fe88-4796-9ebd-5a1c1cd083af"]={f:Ops.Array.ArraySetNumber_v3,objName:"Ops.Array.ArraySetNumber_v3"};Ops.Vars.VarTriggerNumber=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.inValueFloat("Value",0),a=t.outTrigger("Next");t.varName=t.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(t,"number",r,t.varName,n,a)}};CABLES.OPS["2c29baf0-2af2-486d-9218-4299594ee9c1"]={f:Ops.Vars.VarTriggerNumber,objName:"Ops.Vars.VarTriggerNumber"};Ops.Math.MapRange=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const b=t.inValueFloat("value",0),m=t.inValueFloat("old min",0),d=t.inValueFloat("old max",1),f=t.inValueFloat("new min",0),g=t.inValueFloat("new max",1),n=t.inValueSelect("Easing",["Linear","Smoothstep","Smootherstep"],"Linear"),r=t.inBool("Clamp",true),h=t.outNumber("result",0);t.setPortGroup("Input Range",[m,d]);t.setPortGroup("Output Range",[f,g]);let O=true;let v=0;let j=0;b.onChange=m.onChange=d.onChange=f.onChange=g.onChange=a;a();r.onChange=()=>{O=r.get();a()};n.onChange=function(){if(n.get()=="Smoothstep")v=1;else if(n.get()=="Smootherstep")v=2;else v=0};function a(){const t=f.get();const e=g.get();const n=m.get();const r=d.get();let a=b.get();if(O){if(a>=Math.max(r,n)){h.set(e);return}else if(a<=Math.min(r,n)){h.set(t);return}}let o=false;const i=Math.min(n,r);const s=Math.max(n,r);if(i!=n)o=true;let u=false;const l=Math.min(t,e);const p=Math.max(t,e);if(l!=t)u=true;let c=0;if(o)c=(s-a)*(p-l)/(s-i);else c=(a-i)*(p-l)/(s-i);if(u)j=p-c;else j=c+l;if(v===0){h.set(j)}else if(v==1){a=Math.max(0,Math.min(1,(j-t)/(e-t)));h.set(t+a*a*(3-2*a)*(e-t))}else if(v==2){a=Math.max(0,Math.min(1,(j-t)/(e-t)));h.set(t+a*a*a*(a*(a*6-15)+10)*(e-t))}}}};CABLES.OPS["2617b407-60a0-4ff6-b4a7-18136cfa7817"]={f:Ops.Math.MapRange,objName:"Ops.Math.MapRange"};Ops.Gl.RenderToTexture_v3=class extends CABLES.Op{constructor(){super(...arguments);const a=this;const t=a.attachments={};const e=a.inTrigger("render"),n=a.inSwitch("Size",["Canvas","Manual"],"Canvas"),r=a.inValueInt("texture width",512),o=a.inValueInt("texture height",512),i=a.inBool("Auto Aspect",true),s=a.inSwitch("filter",["nearest","linear","mipmap"],"linear"),u=a.inSwitch("Wrap",["Clamp","Repeat","Mirror"],"Repeat"),l=a.inSwitch("MSAA",["none","2x","4x","8x"],"none"),p=a.outTrigger("trigger"),c=a.outTexture("texture"),b=a.outTexture("textureDepth"),m=a.inDropDown("Pixel Format",CGL.Texture.PIXELFORMATS,CGL.Texture.PFORMATSTR_RGBA8UB),d=a.inValueBool("Depth",true),f=a.inValueBool("Clear",true);const g=a.patch.cgl;let h=null;let O=true;a.setPortGroup("Size",[n,r,o,i]);m.onChange=d.onChange=f.onChange=s.onChange=u.onChange=l.onChange=j;n.onChange=v;e.onTriggered=a.preRender=y;v();function v(){r.setUiAttribs({greyout:n.get()!="Manual"});o.setUiAttribs({greyout:n.get()!="Manual"});i.setUiAttribs({greyout:n.get()!="Manual"})}function j(){O=true}function y(){CGL.TextureEffect.checkOpNotInTextureEffect(a);if(!h||O){if(h)h.delete();let n=CGL.Texture.WRAP_REPEAT;if(u.get()=="Clamp")n=CGL.Texture.WRAP_CLAMP_TO_EDGE;else if(u.get()=="Mirror")n=CGL.Texture.WRAP_MIRRORED_REPEAT;let r=CGL.Texture.FILTER_NEAREST;if(s.get()=="nearest")r=CGL.Texture.FILTER_NEAREST;else if(s.get()=="linear")r=CGL.Texture.FILTER_LINEAR;else if(s.get()=="mipmap")r=CGL.Texture.FILTER_MIPMAP;if(m.get().indexOf("loat")&&s.get()=="mipmap")a.setUiError("fpmipmap","Can't use mipmap and float texture at the same time");else a.setUiError("fpmipmap",null);if(g.glVersion>=2){let t=true;let e=4;if(l.get()=="none"){e=0;t=false}if(l.get()=="2x")e=2;if(l.get()=="4x")e=4;if(l.get()=="8x")e=8;h=new CGL.Framebuffer2(g,8,8,{name:"render2texture "+a.id,pixelFormat:m.get(),multisampling:t,multisamplingSamples:e,wrap:n,filter:r,depth:d.get(),clear:f.get()})}else{h=new CGL.Framebuffer(g,8,8,{isFloatingPointTexture:false,clear:f.get()})}if(h&&h.valid){b.setRef(h.getTextureDepth());O=false}else{h=null;O=true}}let t=i.get();if(n.get()=="Canvas"){t=true;r.set(a.patch.cgl.checkTextureSize(g.canvasWidth));o.set(a.patch.cgl.checkTextureSize(g.canvasHeight))}if(h.getWidth()!=a.patch.cgl.checkTextureSize(r.get())||h.getHeight()!=a.patch.cgl.checkTextureSize(o.get())){h.setSize(a.patch.cgl.checkTextureSize(r.get()),a.patch.cgl.checkTextureSize(o.get()))}h.renderStart(g);g.pushViewPort(0,0,r.get(),o.get());if(t)mat4.perspective(g.pMatrix,45,r.get()/o.get(),.1,1e3);p.trigger();h.renderEnd(g);g.popViewPort();b.setRef(h.getTextureDepth());c.setRef(h.getTextureColor())}}};CABLES.OPS["41eec5c7-c480-477a-be81-04c3efac8357"]={f:Ops.Gl.RenderToTexture_v3,objName:"Ops.Gl.RenderToTexture_v3"};Ops.Gl.Meshes.FullscreenRectangle_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={shader_frag:"UNI sampler2D tex;\nIN vec2 texCoord;\n\nvoid main()\n{\n    outColor= texture(tex,texCoord);\n}\n\n",shader_vert:"{{MODULES_HEAD}}\n\nIN vec3 vPosition;\nUNI mat4 projMatrix;\nUNI mat4 mvMatrix;\n\nOUT vec2 texCoord;\nIN vec2 attrTexCoord;\n\nvoid main()\n{\n   vec4 pos=vec4(vPosition,  1.0);\n\n   texCoord=vec2(attrTexCoord.x,(1.0-attrTexCoord.y));\n\n   gl_Position = projMatrix * mvMatrix * pos;\n}\n"};const n=t.inTrigger("render"),r=t.inSwitch("Scale",["Stretch","Fit"],"Fit"),a=t.inValueBool("Flip Y"),o=t.inValueBool("Flip X"),i=t.inTexture("Texture"),s=t.outTrigger("trigger");const u=t.patch.cgl;let l=null;let p=new CGL.Geometry("fullscreen rectangle");let c=0,b=0,m=0,d=0;t.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION);t.toWorkPortsNeedToBeLinked(n);o.onChange=A;a.onChange=A;n.onTriggered=I;i.onLinkChanged=v;r.onChange=y;const f=new CGL.Shader(u,"fullscreenrectangle",this);f.setModules(["MODULE_VERTEX_POSITION","MODULE_COLOR","MODULE_BEGIN_FRAG"]);f.setSource(e.shader_vert,e.shader_frag);f.fullscreenRectUniform=new CGL.Uniform(f,"t","tex",0);f.aspectUni=new CGL.Uniform(f,"f","aspectTex",0);let g=false;let h=true;let O=false;v();y();i.onChange=function(){h=true};function v(){if(!CABLES.UI)return;a.setUiAttribs({greyout:!i.isLinked()});o.setUiAttribs({greyout:!i.isLinked()});r.setUiAttribs({greyout:!i.isLinked()})}function j(){let t=i.get();if(t)g=true;else g=false}t.preRender=function(){j();f.bind();if(l)l.render(f);I()};function y(){O=r.get()=="Fit"}function I(){if(u.viewPort[2]!=m||u.viewPort[3]!=d||!l)x();if(h)j();u.pushPMatrix();mat4.identity(u.pMatrix);mat4.ortho(u.pMatrix,0,m,d,0,-10,1e3);u.pushModelMatrix();mat4.identity(u.mMatrix);u.pushViewMatrix();mat4.identity(u.vMatrix);if(O&&i.get()){const n=i.get().width/i.get().height;let t=d;let e=d*n;if(e>m){t=m*1/n;e=m}u.pushViewPort((m-e)/2,(d-t)/2,e,t)}if(g){if(i.get())u.setTexture(0,i.get().tex);l.render(f)}else{l.render(u.getShader())}u.gl.clear(u.gl.DEPTH_BUFFER_BIT);u.popPMatrix();u.popModelMatrix();u.popViewMatrix();if(O&&i.get())u.popViewPort();s.trigger()}function A(){l=null}function x(){if(u.viewPort[2]==m&&u.viewPort[3]==d&&l)return;let t=0,e=0;m=u.viewPort[2];d=u.viewPort[3];p.vertices=new Float32Array([t+m,e+d,0,t,e+d,0,t+m,e,0,t,e,0]);let n=null;if(a.get())n=new Float32Array([1,0,0,0,1,1,0,1]);else n=new Float32Array([1,1,0,1,1,0,0,0]);if(o.get()){n[0]=0;n[2]=1;n[4]=0;n[6]=1}p.setTexCoords(n);p.verticesIndices=new Uint16Array([2,1,0,3,1,2]);p.vertexNormals=new Float32Array([0,0,1,0,0,1,0,0,1,0,0,1]);p.tangents=new Float32Array([-1,0,0,-1,0,0,-1,0,0,-1,0,0]);p.biTangents==new Float32Array([0,-1,0,0,-1,0,0,-1,0,0,-1,0]);if(!l)l=new CGL.Mesh(u,p);else l.setGeom(p)}}};CABLES.OPS["fb70721a-eac2-4ff5-a5a2-5c59e2393972"]={f:Ops.Gl.Meshes.FullscreenRectangle_v2,objName:"Ops.Gl.Meshes.FullscreenRectangle_v2"};Ops.Gl.ImageCompose.ImageCompose_v4=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={imgcomp_frag:"IN vec2 texCoord;\nUNI vec4 bgColor;\nUNI sampler2D tex;\n#ifdef USE_UVTEX\nUNI sampler2D UVTex;\n#endif\n\nvoid main()\n{\n\n    #ifndef USE_TEX\n        outColor=bgColor;\n    #endif\n    #ifdef USE_TEX\n        #ifndef USE_UVTEX\n        outColor=texture(tex,texCoord);\n        #else\n        outColor=texture(tex,texture(UVTex,texCoord).xy);\n        #endif\n    #endif\n\n\n\n}\n"};const e=n.patch.cgl,r=n.inTrigger("Render"),a=n.inTexture("Base Texture"),o=n.inTexture("UV Texture"),i=n.inSwitch("Size",["Auto","Canvas","Manual"],"Auto"),s=n.inValueInt("Width",640),u=n.inValueInt("Height",480),l=n.inSwitch("Filter",["nearest","linear","mipmap"],"linear"),p=n.inValueSelect("Wrap",["clamp to edge","repeat","mirrored repeat"],"repeat"),c=n.inSwitch("Anisotropic",["0","1","2","4","8","16"],"0"),b=n.inDropDown("Pixel Format",CGL.Texture.PIXELFORMATS,CGL.Texture.PFORMATSTR_RGBA8UB),m=n.inBool("Clear",true),d=n.inValueSlider("R",0),f=n.inValueSlider("G",0),g=n.inValueSlider("B",0),h=n.inValueSlider("A",0),O=n.outTrigger("Next"),v=n.outTexture("texture_out",CGL.Texture.getEmptyTexture(e)),j=n.outNumber("Aspect Ratio"),z=n.outNumber("Texture Width"),R=n.outNumber("Texture Height");n.setPortGroup("Texture Size",[i,s,u]);n.setPortGroup("Texture Parameters",[p,c,l,b]);d.setUiAttribs({colorPick:true});n.setPortGroup("Color",[d,f,g,h,m]);n.toWorkPortsNeedToBeLinked(r);const L=[0,0,0,0];let y=null;let I=null;let A=true;let M=false;let x=null;let q=null;let B=null;let D=null;p.onChange=l.onChange=c.onChange=b.onChange=U;a.onLinkChanged=m.onChange=i.onChange=o.onChange=E;r.onTriggered=n.preRender=P;E();function k(){if(y)y.delete();if(I)I.delete();I=null;y=new CGL.TextureEffect(e,{isFloatingPointTexture:CGL.Texture.isPixelFormatFloat(b.get()),name:n.name});const t=Math.min(e.maxAnisotropic,parseFloat(c.get()));I=new CGL.Texture(e,{anisotropic:t,name:"image_compose_v2_"+n.id,pixelFormat:b.get(),filter:S(),wrap:_(),width:N(),height:C()});y.setSourceTexture(I);z.set(N());R.set(C());j.set(N()/C());v.set(CGL.Texture.getEmptyTexture(e));A=false;E()}function S(){if(l.get()=="nearest")return CGL.Texture.FILTER_NEAREST;else if(l.get()=="linear")return CGL.Texture.FILTER_LINEAR;else if(l.get()=="mipmap")return CGL.Texture.FILTER_MIPMAP}function _(){if(p.get()=="repeat")return CGL.Texture.WRAP_REPEAT;else if(p.get()=="mirrored repeat")return CGL.Texture.WRAP_MIRRORED_REPEAT;else if(p.get()=="clamp to edge")return CGL.Texture.WRAP_CLAMP_TO_EDGE}function N(){let t=0;if(a.get()&&i.get()=="Auto")t=a.get().width;else if(i.get()=="Auto"||i.get()=="Canvas")t=e.canvasWidth;else if(i.get()=="ViewPort")t=e.getViewPort()[2];else t=Math.ceil(s.get());return n.patch.cgl.checkTextureSize(t)}function C(){let t=0;if(a.get()&&i.get()=="Auto")t=a.get().height;else if(i.get()=="Auto"||i.get()=="Canvas")t=e.canvasHeight;else if(i.get()=="ViewPort")t=e.getViewPort()[3];else t=Math.ceil(u.get());return n.patch.cgl.checkTextureSize(t)}function U(){A=true}function G(){if((N()!=I.width||C()!=I.height||I.pixelFormat!=b.get()||I.filter!=S()||I.wrap!=_())&&(N()!==0&&C()!==0)){k();y.setSourceTexture(I);v.set(CGL.Texture.getEmptyTexture(e));v.set(I);w();V()}}function w(){let t=null;if(i.get()=="Manual"){t=null}else if(i.get()=="Auto"){if(a.get())t="Input Texture";else t="Canvas Size";t+=": "+N()+" x "+C()}let e=false;e=i.uiAttribs.info!=t;i.setUiAttribs({info:t});if(e)n.refreshParams()}function T(){if(x)x.toggleDefine("USE_TEX",a.isLinked()||!m.get());if(x)x.toggleDefine("USE_UVTEX",o.isLinked())}function E(){c.setUiAttribs({greyout:S()!=CGL.Texture.FILTER_MIPMAP});d.setUiAttribs({greyout:a.isLinked()});g.setUiAttribs({greyout:a.isLinked()});f.setUiAttribs({greyout:a.isLinked()});h.setUiAttribs({greyout:a.isLinked()});m.setUiAttribs({greyout:a.isLinked()});s.setUiAttribs({greyout:i.get()!="Manual"});u.setUiAttribs({greyout:i.get()!="Manual"});if(I)if(CGL.Texture.isPixelFormatFloat(b.get())&&S()==CGL.Texture.FILTER_MIPMAP)n.setUiError("fpmipmap","Don't use mipmap and 32bit at the same time, many systems do not support this.");else n.setUiError("fpmipmap",null);w();T();V()}function V(){if(I)if(a.isLinked()&&a.get()&&I.isFloatingPoint()<a.get().isFloatingPoint())n.setUiError("textypediff","Warning: Mixing floating point and non floating point texture can result in data/precision loss",1);else n.setUiError("textypediff",null)}n.preRender=()=>{P()};function F(){if(!x){x=new CGL.Shader(e,"copytextureshader");x.setSource(x.getDefaultVertexShader(),t.imgcomp_frag);q=new CGL.Uniform(x,"t","tex",0);B=new CGL.Uniform(x,"t","UVTex",1);D=new CGL.Uniform(x,"4f","bgColor",d,f,g,h);T()}e.pushShader(x);e.currentTextureEffect.bind();if(a.get())e.setTexture(0,a.get().tex);else if(!m.get()&&v.get())e.setTexture(0,v.get().tex);if(o.get())e.setTexture(1,o.get().tex);e.currentTextureEffect.finish();e.popShader()}function P(){if(!y||A)k();e.pushBlend(false);G();const t=e.currentTextureEffect;e.currentTextureEffect=y;e.currentTextureEffect.imgCompVer=3;e.currentTextureEffect.width=s.get();e.currentTextureEffect.height=u.get();y.setSourceTexture(I);y.startEffect(a.get()||CGL.Texture.getEmptyTexture(e,M),true);F();O.trigger();e.pushViewPort(0,0,s.get(),u.get());y.endEffect();v.setRef(y.getCurrentSourceTexture());e.popViewPort();e.popBlend();e.currentTextureEffect=t}}};CABLES.OPS["17212e2b-d692-464c-8f8d-2d511dd3410a"]={f:Ops.Gl.ImageCompose.ImageCompose_v4,objName:"Ops.Gl.ImageCompose.ImageCompose_v4"};Ops.Html.Elements.Element_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const z=t.attachments={};const e=t.inString("Text","Element"),n=t.inSwitch("Position",["Absolute","Static","Relative","Fixed"],"Absolute"),r=t.inSwitch("Interactive",["True","False","No Pointer Events"],"True"),a=t.inValueBool("Set Size",false),o=t.inFloat("Width",100),i=t.inFloat("Height",100),s=t.inSwitch("Size  Units",["px","%","vwh"],"px"),u=t.inSwitch("Overflow",["Visible","Hidden","Scroll","Auto"],"Hidden"),l=t.inStringEditor("Inline Style","","inline-css"),p=t.inString("CSS Class"),R=t.inString("Disable CSS Props"),c=t.inDropDown("Display",["None","Block","Inline","inline-block","flex","inline-flex","grid","inline-grid","flow-root"],"Block"),b=t.inString("Tag Name","div"),m=t.inFloatSlider("Opacity",1),L=t.inValueBool("Propagate Click-Events",true),d=t.outObject("DOM Element",null,"element"),f=t.outBoolNum("Hovering"),g=t.outTrigger("Clicked");t.setPortGroup("Area",[o,i,a,s,u]);t.setPortGroup("CSS",[p,l,R]);let h=null;let O=null;let M="block";let v=null;const j=t.patch.cgl.canvas.parentElement;I();p.onChange=S;e.onChange=x;b.onChange=()=>{A();I();S();x()};a.onChange=q;c.onChange=m.onChange=n.onChange=o.onChange=i.onChange=u.onChange=s.onChange=i.onChange=l.onChange=k;r.onChange=E;x();k();P();E();let y="";t.onDelete=A;d.onLinkChanged=k;r.onLinkChanged=g.onLinkChanged=()=>{t.setUiError("interactiveProblem",null);if(g.isLinked()&&!T())t.setUiError("interactiveProblem","Interactive should be activated when linking clicked port")};function q(){o.setUiAttribs({greyout:!a.get()});i.setUiAttribs({greyout:!a.get()});k()}function I(){v=t.patch.getDocument().createElement(b.get()||"div");v.dataset.op=t.id;v.classList.add("cablesEle");j.appendChild(v);d.setRef(v);k()}function A(){if(v)B();if(v&&v.parentNode)v.parentNode.removeChild(v);O=null;v=null}function x(){let t=e.get();if(O===t)return;O=t;if(v.innerHTML!=t)v.innerHTML=t}function k(){if(!v)return;v.setAttribute("style",l.get());v.style.position=n.get().toLowerCase();v.style.overflow=u.get().toLowerCase();v.style.display=c.get();v.style.opacity=m.get();if(r.get()=="No Pointer Events")v.style.pointerEvents="none";if(a.get()){v.style.width=o.get()+s.get();v.style.height=i.get()+s.get()}else{v.style.width="";v.style.height=""}d.setRef(v);if(!v.parentElement)j.appendChild(v);P()}function B(){if(!v)return;const e=(p.get()||"").split(" ");for(let t=0;t<e.length;t++){if(e[t])v.classList.remove(e[t])}y=""}function S(){const e=(p.get()||"").split(" ");const n=(y||"").split(" ");let r=false;for(let t=0;t<n.length;t++){if(n[t]&&e.indexOf(n[t].trim())==-1){r=true;v.classList.remove(n[t])}}for(let t=0;t<e.length;t++){if(e[t]){v.classList.add(e[t].trim())}}y=p.get();P()}function _(t){f.set(true)}function N(t){f.set(false)}function C(t){if(t.keyCode==13||t.keyCode==32)g.trigger()}function w(t){if(!L.get())t.stopPropagation();g.trigger()}function T(){return r.get()!="No Pointer Events"}function E(){t.setUiError("interactiveProblem",null);V();if(T())D();k()}function V(){if(h){h.removeEventListener("pointerdown",w);h.removeEventListener("pointerleave",N);h.removeEventListener("pointerenter",_);h.removeEventListener("keydown",C,false);h.removeAttribute("tabindex");h=null}}function D(){if(h)V();h=v;if(h){h.addEventListener("pointerdown",w);h.addEventListener("pointerleave",N);h.addEventListener("pointerenter",_);h.setAttribute("tabindex",0);h.addEventListener("keydown",C,false)}}t.addEventListener("onEnabledChange",t=>{A();if(!t)return;I();k();S();x();E()});function P(){if(p.get()&&l.get()){t.setUiError("error","Element uses external and inline CSS",1)}else{t.setUiError("error",null)}}}};CABLES.OPS["a0d2cc80-0b2f-4422-ba2d-c903ac9ca297"]={f:Ops.Html.Elements.Element_v2,objName:"Ops.Html.Elements.Element_v2"};Ops.Boolean.TriggerChangedTrue=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};let n=t.inValueBool("Value",false);let r=t.outTrigger("Next");let a=0;n.onChange=function(){let t=n.get();if(!a&&t){a=true;r.trigger()}else{a=false}}}};CABLES.OPS["385197e1-8b34-4d1c-897f-d1386d99e3b3"]={f:Ops.Boolean.TriggerChangedTrue,objName:"Ops.Boolean.TriggerChangedTrue"};Ops.Team.Plan.PlaceEquals=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inString("Plan",""),r=e.inString("Place Name",""),a=e.outBoolNum("Is Current Place");let o=null;e.setUiError("noplan","plan not found");e.patch.on("plansChanged",i);r.onChange=n.onChange=i;function i(){if(!e.patch.plans)return;o=e.patch.plans[n.get()];e.setUiError("noplan",null);if(!o||!n.get()){e.setUiError("noplan","plan not found");return}o.on("stateChanged",()=>{s()});u();s()}function s(){if(!o)return;let t=o.getCurrentPlaceName()==r.get();a.set(t);e.setUiAttrib({extendTitle:r.get()+": "+t})}function u(){}}};CABLES.OPS["a4b08193-d41e-466a-a3bc-79c93e7ca2f4"]={f:Ops.Team.Plan.PlaceEquals,objName:"Ops.Team.Plan.PlaceEquals"};Ops.Html.Utils.LoadingIndicator=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={css_ellipsis_css:".lds-ellipsis {\n\n}\n.lds-ellipsis div {\n  position: absolute;\n  /*top: 33px;*/\n  margin-top:-12px;\n  margin-left:-13px;\n  width: 13px;\n  height: 13px;\n  border-radius: 50%;\n  background: #fff;\n  animation-timing-function: cubic-bezier(0, 1, 1, 0);\n}\n.lds-ellipsis div:nth-child(1) {\n  left: 8px;\n  animation: lds-ellipsis1 0.6s infinite;\n}\n.lds-ellipsis div:nth-child(2) {\n  left: 8px;\n  animation: lds-ellipsis2 0.6s infinite;\n}\n.lds-ellipsis div:nth-child(3) {\n  left: 32px;\n  animation: lds-ellipsis2 0.6s infinite;\n}\n.lds-ellipsis div:nth-child(4) {\n  left: 56px;\n  animation: lds-ellipsis3 0.6s infinite;\n}\n@keyframes lds-ellipsis1 {\n  0% {\n    transform: scale(0);\n  }\n  100% {\n    transform: scale(1);\n  }\n}\n@keyframes lds-ellipsis3 {\n  0% {\n    transform: scale(1);\n  }\n  100% {\n    transform: scale(0);\n  }\n}\n@keyframes lds-ellipsis2 {\n  0% {\n    transform: translate(0, 0);\n  }\n  100% {\n    transform: translate(24px, 0);\n  }\n}\n",css_ring_css:".lds-ring {\n}\n.lds-ring div {\n  box-sizing: border-box;\n  display: block;\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  margin: 0;\n  border: 3px solid #fff;\n  border-radius: 50%;\n  animation: lds-ring 1.2s cubic-bezier(0.5, 0, 0.5, 1) infinite;\n  border-color: #fff transparent transparent transparent;\n}\n.lds-ring div:nth-child(1) {\n  animation-delay: -0.45s;\n}\n.lds-ring div:nth-child(2) {\n  animation-delay: -0.3s;\n}\n.lds-ring div:nth-child(3) {\n  animation-delay: -0.15s;\n}\n@keyframes lds-ring {\n  0% {\n    transform: rotate(0deg);\n  }\n  100% {\n    transform: rotate(360deg);\n  }\n}\n",css_spinner_css:"._cables_spinner {\n  /*width: 40px;*/\n  /*height: 40px;*/\n  /*margin: 100px auto;*/\n  background-color: #777;\n\n  border-radius: 100%;\n  -webkit-animation: sk-scaleout 1.0s infinite ease-in-out;\n  animation: sk-scaleout 1.0s infinite ease-in-out;\n}\n\n@-webkit-keyframes sk-scaleout {\n  0% { -webkit-transform: scale(0) }\n  100% {\n    -webkit-transform: scale(1.0);\n    opacity: 0;\n  }\n}\n\n@keyframes sk-scaleout {\n  0% {\n    -webkit-transform: scale(0);\n    transform: scale(0);\n  } 100% {\n    -webkit-transform: scale(1.0);\n    transform: scale(1.0);\n    opacity: 0;\n  }\n}"};const n=t.inBool("Visible",true),r=t.inSwitch("Style",["Spinner","Ring","Ellipsis"],"Ring");const a=document.createElement("div");a.dataset.op=t.id;const o=t.patch.cgl.canvas.parentElement;r.onChange=p;a.appendChild(document.createElement("div"));a.appendChild(document.createElement("div"));a.appendChild(document.createElement("div"));const i=50;a.style.width=i+"px";a.style.height=i+"px";a.style.top="50%";a.style.left="50%";a.style["pointer-events"]="none";a.style["margin-left"]="-"+i/2+"px";a.style["margin-top"]="-"+i/2+"px";a.style.position="absolute";a.style["z-index"]="9999999";n.onChange=b;let s="css_loadingicon_"+CABLES.uuid();const u=document.createElement("style");u.type="text/css";u.id=s;let l=document.getElementsByTagName("body")[0];l.appendChild(u);t.onDelete=()=>{c();if(u)u.remove()};o.appendChild(a);p();function p(){const t=r.get();if(t=="Spinner"){a.classList.add("_cables_spinner");u.textContent=e.css_spinner_css}else a.classList.remove("_cables_spinner");if(t=="Ring"){a.classList.add("lds-ring");u.textContent=e.css_ring_css}else a.classList.remove("lds-ring");if(t=="Ellipsis"){a.classList.add("lds-ellipsis");u.textContent=e.css_ellipsis_css}else a.classList.remove("lds-ellipsis")}function c(){a.remove()}function b(){a.style.opacity=n.get()?1:0}}};CABLES.OPS["e102834c-6dcf-459c-9e22-44ebccfc0d3b"]={f:Ops.Html.Utils.LoadingIndicator,objName:"Ops.Html.Utils.LoadingIndicator"};Ops.String.ConcatMulti_v2=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};const o=[];for(let e=0;e<8;e++){let t=n.inString("string "+e);o.push(t);t.onChange=r}const i=n.inBool("add spaces",false),s=n.inBool("new lines",false),u=n.outString("concat string");o.onChange=i.onChange=s.onChange=r;i.setUiAttribs({hidePort:true});s.setUiAttribs({hidePort:true});function r(){let e="";let n="";let r=i.get();for(let t=0;t<o.length;t++){const a=o[t].get();if(!a)continue;if(t>0&&r)e+=" ";if(t>0&&s.get())n="\n";e+=n;e+=a}u.set(e)}}};CABLES.OPS["bc110e48-812d-489d-b1b3-b09c644c6982"]={f:Ops.String.ConcatMulti_v2,objName:"Ops.String.ConcatMulti_v2"};Ops.Json.ObjectSetString_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inObject("Object"),a=t.outObject("Result Object"),o=t.inString("Key"),i=t.inString("Value");r.onChange=i.onChange=n;o.setUiAttribs({stringTrim:true,minLength:1});o.onChange=()=>{t.setUiAttrib({extendTitle:o.get()});n()};function n(){let t=r.get();if(!t)t={};const e=o.get();const n=JSON.parse(JSON.stringify(t));if(e)n[e]=i.get();a.setRef(n)}}};CABLES.OPS["1ed8f375-c3d7-4662-88c7-1afbc3dc6129"]={f:Ops.Json.ObjectSetString_v2,objName:"Ops.Json.ObjectSetString_v2"};Ops.String.StringReplace=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inString("String"),r=e.inString("Search For","foo"),a=e.inString("Replace","bar"),o=e.inSwitch("Replace What",["All","First"],"All"),i=e.outString("Result");a.onChange=n.onChange=o.onChange=r.onChange=s;function s(){e.setUiError("exception",null);let t="";try{if(o.get()=="All")t=String(n.get()).replace(new RegExp(r.get(),"g"),a.get());else t=String(n.get()).replace(r.get(),a.get())}catch(t){e.setUiError("exception","exception "+t.message)}i.set(t)}}};CABLES.OPS["4a053e7a-6b00-4e71-bd51-90cdb190994c"]={f:Ops.String.StringReplace,objName:"Ops.String.StringReplace"};Ops.Data.JsonPath.ObjectGetArrayByPath=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const i=o.inObject("Object"),s=o.inString("Path"),u=o.outArray("Output"),l=o.outBoolNum("Found");i.onChange=s.onChange=e;o.toWorkPortsNeedsString(s);s.setUiAttribs({stringTrim:true});function e(){const e=i.get();const n=s.get();o.setUiError("missing",null);o.setUiError("notiterable",null);if(e&&n){if(!Array.isArray(e)&&!(typeof e==="object")){l.set(false);o.setUiError("notiterable","input object of type "+typeof e+" is not traversable by path")}else{const r=n.split(".");o.setUiAttrib({extendTitle:r[r.length-1]+""});let t=p(n,e);if(t===undefined){const a="could not find element at path "+n;l.set(false);t=null;o.setUiError("missing",a,1)}else if(!Array.isArray(t)){const a="element at path "+n+" is not an array";l.set(false);t=null;o.setUiError("missing",a,1)}else{l.set(true)}u.setRef(t)}}else{l.set(false)}}function p(t,e=self,n="."){const r=Array.isArray(t)?t:t.split(n);return r.reduce((t,e)=>{return t&&t[e]},e)}}};CABLES.OPS["a9354531-a42d-4216-ad8c-364df989a9a1"]={f:Ops.Data.JsonPath.ObjectGetArrayByPath,objName:"Ops.Data.JsonPath.ObjectGetArrayByPath"};Ops.Patch.PaZfgnp.D3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.outObject("d3",null,"d3");n.set(d3)}};CABLES.OPS["0341447e-c404-42cf-9424-22d4d6b43973"]={f:Ops.Patch.PaZfgnp.D3,objName:"Ops.Patch.PaZfgnp.D3"};Ops.Gl.CanvasInfo_v3=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.outNumber("CSS Width"),r=e.outNumber("CSS Height"),a=e.outNumber("Pixel Ratio"),o=e.outNumber("Pixel Width"),i=e.outNumber("Pixel Height"),s=e.outNumber("Aspect Ratio"),u=e.outBool("Landscape"),l=e.outObject("Canvas","element"),p=e.outObject("Canvas Parent","element"),c=e.outTrigger("Resized");let b=e.patch.cgl;l.set(e.patch.cgl.canvas);p.set(e.patch.cgl.canvas.parentElement);b.on("resize",()=>{c.trigger();m()});m();function m(){let t=1;if(b.canvasHeight==0)setTimeout(m,100);r.set(b.canvasHeight/e.patch.cgl.pixelDensity);n.set(b.canvasWidth/e.patch.cgl.pixelDensity);o.set(b.canvasWidth);i.set(b.canvasHeight);a.set(e.patch.cgl.pixelDensity);s.set(b.canvasWidth/b.canvasHeight);u.set(b.canvasWidth>b.canvasHeight?1:0)}}};CABLES.OPS["be186ff9-427e-409f-b6a4-f8d957bf7bc7"]={f:Ops.Gl.CanvasInfo_v3,objName:"Ops.Gl.CanvasInfo_v3"};Ops.Json.Object=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Object"),r=t.outObject("Result");n.onChange=()=>{r.setRef(n.get())}}};CABLES.OPS["d618f2e1-4e60-4ac4-91aa-218bab2a6742"]={f:Ops.Json.Object,objName:"Ops.Json.Object"};Ops.Data.Compose.Object.CompObjectSetArray=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Update"),r=e.inString("Key",""),a=e.inArray("Array"),o=e.outTrigger("Next");e.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true,minLength:1});n.onTriggered=()=>{if(e.patch.tempData.compObject&&e.patch.tempData.compObject.length>0){let t=e.patch.tempData.compObject[e.patch.tempData.compObject.length-1];t[r.get()]=JSON.parse(JSON.stringify(a.get()))}o.trigger()}}};CABLES.OPS["192882bd-17c3-4a7b-a393-d240fa4d9fbf"]={f:Ops.Data.Compose.Object.CompObjectSetArray,objName:"Ops.Data.Compose.Object.CompObjectSetArray"};Ops.Html.Cursor_v2=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTriggerButton("Update"),r=e.inDropDown("CSS Cursors",["auto","crosshair","pointer","hand","move","n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize","ew-resize","text","wait","help","none"],"pointer"),a=e.inBool("Set Parent Element",true),o=e.outTrigger("Next");const i="";n.onTriggered=u;let s="";n.onLinkChanged=o.onLinkChanged=()=>{e.patch.cgl.setCursor("auto")};a.onChange=()=>{if(!a.get()){s="auto";e.patch.cgl.canvas.parentElement.style.cursor="auto"}};function u(){let t=null;e.patch.cgl.setCursor(r.get(),t);if(a.get()&&s!=r.get())e.patch.cgl.canvas.parentElement.style.cursor=r.get();o.trigger()}}};CABLES.OPS["39486799-bdad-42d3-a300-4642c23578a8"]={f:Ops.Html.Cursor_v2,objName:"Ops.Html.Cursor_v2"};Ops.Boolean.TriggerOnChangeBoolean=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueBool("Value"),r=t.outTrigger("True"),a=t.outTrigger("False");n.onChange=function(){if(n.get())r.trigger();else a.trigger()}}};CABLES.OPS["dba19c07-e3c4-4971-a991-c9e6212ca1c8"]={f:Ops.Boolean.TriggerOnChangeBoolean,objName:"Ops.Boolean.TriggerOnChangeBoolean"};Ops.Trigger.NumberByTrigger=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("0"),r=t.inTriggerButton("1"),a=t.inTriggerButton("2"),o=t.inTriggerButton("3"),i=t.inTriggerButton("4"),s=t.inTriggerButton("5"),u=t.inTriggerButton("6"),l=t.inTriggerButton("7"),p=t.outNumber("number");p.changeAlways=true;const c=t.outTrigger("Triggered");n.onTriggered=function(){p.set(0);c.trigger()};r.onTriggered=function(){p.set(1);c.trigger()};a.onTriggered=function(){p.set(2);c.trigger()};o.onTriggered=function(){p.set(3);c.trigger()};i.onTriggered=function(){p.set(4);c.trigger()};s.onTriggered=function(){p.set(5);c.trigger()};u.onTriggered=function(){p.set(6);c.trigger()};l.onTriggered=function(){p.set(7);c.trigger()}}};CABLES.OPS["43ed1123-1312-4383-b843-27b8ec540c09"]={f:Ops.Trigger.NumberByTrigger,objName:"Ops.Trigger.NumberByTrigger"};Ops.String.FilterValidString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String",""),r=t.inBool("Invalid if null",true),a=t.inBool("Invalid if undefined",true),o=t.inBool("Invalid if empty",true),i=t.inBool("Invalid if 0",true),s=t.outString("Last Valid String"),u=t.outBoolNum("Is Valid");n.onChange=r.onChange=a.onChange=o.onChange=function(){const t=n.get();let e=true;if(e===false)e=false;if(e&&i.get()&&(t===0||t==="0"))e=false;if(e&&r.get()&&t===null)e=false;if(e&&a.get()&&t===undefined)e=false;if(e&&o.get()&&t==="")e=false;u.set(e);if(e)s.set(t)}}};CABLES.OPS["a522235d-f220-46ea-bc26-13a5b20ec8c6"]={f:Ops.String.FilterValidString,objName:"Ops.String.FilterValidString"};Ops.Array.ArrayToString_v3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inArray("Array"),a=t.inString("Seperator",","),o=t.inValueBool("New Line"),i=t.outString("Result");r.onChange=i.onChange=a.onChange=o.onChange=n;function n(){var t=r.get();var e="";var n=a.get();if(o.get())n+="\n";if(t&&t.join){e=t.join(n)}i.set(e)}}};CABLES.OPS["7b539bb3-8e86-4367-9e00-a637d3cfd87a"]={f:Ops.Array.ArrayToString_v3,objName:"Ops.Array.ArrayToString_v3"};Ops.Html.CSS.CSSProperty_v2=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("Element"),r=e.inString("Property"),a=e.inFloat("Value"),o=e.inString("Value Suffix","px"),i=e.outObject("HTML Element",null,"element");e.setPortGroup("Element",[n]);e.setPortGroup("Attributes",[r,a,o]);r.onChange=u;a.onChange=l;o.onChange=l;let s=null;n.onChange=n.onLinkChanged=function(){if(s&&s.style){s.style[r.get()]="initial"}l()};function u(){l();e.setUiAttrib({extendTitle:r.get()+""})}function l(){s=n.get();if(s&&s.style){const t=a.get()+o.get();try{if(s.style[r.get()]!=t)s.style[r.get()]=t}catch(t){e.logError(t)}}else{setTimeout(l,50)}i.setRef(n.get())}}};CABLES.OPS["c179aa0e-b558-4130-8c2d-2deab2919a07"]={f:Ops.Html.CSS.CSSProperty_v2,objName:"Ops.Html.CSS.CSSProperty_v2"};Ops.Website.InfoURL=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.outString("URL"),r=t.outString("Host"),a=t.outString("Hash"),o=t.outString("Pathname"),i=t.outString("Protocol"),s=t.outString("Port"),u=t.outTrigger("Hash Changed");t.onDelete=()=>{window.removeEventListener("hashchange",p)};window.addEventListener("hashchange",p);const l=document.location;n.set(l.href);r.set(l.host);a.set(l.hash);o.set(l.pathname);i.set(l.protocol);s.set(l.port);function p(){const t=document.location;a.set(t.hash);u.trigger()}}};CABLES.OPS["e72fbd80-f9c7-4572-8b6d-a485ef474b74"]={f:Ops.Website.InfoURL,objName:"Ops.Website.InfoURL"};Ops.String.StringEquals=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String 1"),r=t.inString("String 2"),a=t.outBoolNum("Result");n.onChange=r.onChange=function(){a.set(n.get()==r.get())}}};CABLES.OPS["ef15195a-760b-4ac5-9630-322b0ba7b722"]={f:Ops.String.StringEquals,objName:"Ops.String.StringEquals"};Ops.Devices.Mouse.MouseDrag=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueBool("Active",true),r=t.inValue("Speed",.01),a=t.inSwitch("Input Type",["All","Mouse","Touch"],"All"),o=t.inSwitch("Area",["Canvas Area","Canvas","Document"],"Canvas Area"),i=t.outNumber("Delta X"),s=t.outNumber("Delta Y"),u=t.outNumber("Is Dragging");let l=null;let p=null;const c=0;const b=0;let m=false;let d=0;let f=0;let g=true;a.onChange=o.onChange=y;y();function h(t){if(o.get()==="Canvas Area"){const e=p.getBoundingClientRect();return t.clientX>e.left&&t.clientX<e.left+e.width&&t.clientY>e.top&&t.clientY<e.top+e.height}return true}function O(t){if(t.touches)t=t.touches[0];if(m&&t&&h(t)){if(!g){u.set(true);const e=(t.clientX-d)*r.get();const n=(t.clientY-f)*r.get();i.set(0);s.set(0);i.set(e);s.set(n)}g=false;d=t.clientX;f=t.clientY}}function v(t){try{l.setPointerCapture(t.pointerId)}catch(t){}m=true}function j(t){try{l.releasePointerCapture(t.pointerId)}catch(t){}m=false;u.set(false);d=0;f=0;g=true}function y(){A();if(o.get()=="Canvas Area"){l=document;p=t.patch.cgl.canvas}else if(o.get()=="Document")l=p=document;else l=p=t.patch.cgl.canvas;if(n.get())I()}function I(){if(!l)y();if(a.get()=="All"||a.get()=="Mouse"){l.addEventListener("mousemove",O);l.addEventListener("mousedown",v);l.addEventListener("mouseup",j);l.addEventListener("mouseenter",j);l.addEventListener("mouseleave",j)}if(a.get()=="All"||a.get()=="Touch"){l.addEventListener("touchmove",O);l.addEventListener("touchend",j);l.addEventListener("touchstart",v)}}function A(){if(!l)return;l.removeEventListener("mousemove",O);l.removeEventListener("mousedown",v);l.removeEventListener("mouseup",j);l.removeEventListener("mouseenter",j);l.removeEventListener("mouseleave",j);l.removeEventListener("touchmove",O);l.removeEventListener("touchend",j);l.removeEventListener("touchstart",v)}n.onChange=function(){if(n.get())I();else A()};t.onDelete=function(){A()}}};CABLES.OPS["5103d14e-2f21-4f43-ae91-c1b55a944226"]={f:Ops.Devices.Mouse.MouseDrag,objName:"Ops.Devices.Mouse.MouseDrag"};Ops.String.StringSwitchByString=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const r=e.inString("String","default");const a=e.outString("Result","");const o=e.inString("Default","");const i=["one","two","three","four","five","six","seven","eight","nine","ten"];const s=[];const u=[];o.onChange=r.onChange=n;for(let t=0;t<i.length;t++){const l=t+1;const p=e.inString("String "+l,i[t]);const c=e.inString("Result String "+l,l);p.onChange=c.onChange=n;s.push(p);u.push(c)}function n(){const e=r.get();let n=false;for(let t=0;t<i.length;t++){if(s[t].get()==e){a.set(u[t].get());n=true}}if(!n)a.set(o.get())}}};CABLES.OPS["625418c2-dcbc-4eea-9ec6-6c3033e6630b"]={f:Ops.String.StringSwitchByString,objName:"Ops.String.StringSwitchByString"};Ops.Math.DeltaSum=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const s=t.inValue("Delta Value"),n=t.inValue("Default Value",0),u=t.inValue("Multiply",1),r=t.inTriggerButton("Reset"),o=t.inValueBool("Limit",false),l=t.inValue("Min",0),p=t.inValue("Max",100),c=t.inValue("Rubberband",0),i=t.outNumber("Absolute Value");s.changeAlways=true;t.setPortGroup("Limit",[o,l,p,c]);let b=0;let m=CABLES.now();let d=null;o.onChange=f;n.onChange=r.onTriggered=a;p.onChange=l.onChange=h;f();function a(){let t=n.get();if(o.get()){t=Math.max(l.get(),t);t=Math.min(p.get(),t)}b=t;i.set(b)}function f(){l.setUiAttribs({greyout:!o.get()});p.setUiAttribs({greyout:!o.get()});c.setUiAttribs({greyout:!o.get()});h()}function g(){const t=l.get();const e=p.get();if(b<t)b=t;if(b>e)b=e;i.set(b)}function h(){if(o.get()){const t=l.get();const e=p.get();const n=c.get();const r=l.get()-n;const a=p.get()+n;if(b<r)b=r;if(b>a)b=a;if(n!==0){clearTimeout(d);d=setTimeout(g.bind(this),300)}}i.set(b)}s.onChange=function(){let t=s.get();const e=c.get();if(e!==0){const n=l.get();const r=p.get();const a=l.get()-e;const o=p.get()+e;if(b<n){const i=Math.abs(b-a)/e;t*=i*i}if(b>r){const i=Math.abs(o-b)/e;t*=i*i}}m=CABLES.now();b+=t*u.get();h()}}};CABLES.OPS["d9d4b3db-c24b-48da-b798-9e6230d861f7"]={f:Ops.Math.DeltaSum,objName:"Ops.Math.DeltaSum"};Ops.Anim.Smooth=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Update"),r=t.inBool("Separate inc/dec",false),a=t.inValue("Value"),o=t.outTrigger("Next"),i=t.inValue("Inc factor",4),s=t.inValue("Dec factor",4),u=t.outNumber("Result",0);let l=0;let p=0;let c=0;let b=0;t.toWorkPortsNeedToBeLinked(n);let m;let d;let f=4;let g=true;let h=0;const O=0;const v=1;j();y();r.setUiAttribs({hidePort:true});i.onChange=s.onChange=y;r.onChange=j;I();function j(){const t=r.get();if(!t)h=O;else h=v;if(h==O){s.setUiAttribs({greyout:true});i.setUiAttribs({title:"Inc/Dec factor"})}else if(h==v){s.setUiAttribs({greyout:false});i.setUiAttribs({title:"Inc factor"})}y();I()}function y(){if(h==O){m=i.get();d=i.get()}else if(h==v){m=i.get();d=s.get()}if(m<=.2||m!=m)m=.2;if(d<=.2||d!=d)d=.2}a.onChange=function(){g=false;let t=p;p=a.get()};i.onChange=function(){y()};function I(){let t=1;if(performance.now()-b>500||b===0)l=a.get()||0;else t=(performance.now()-b)/(performance.now()-b);b=performance.now();if(l!=l)l=0;if(f<=0)f=1e-4;const e=p-l;if(e>=0)l+=e/(d*t);else l+=e/(m*t);if(Math.abs(e)<1e-5)l=p;if(f!=f)l=0;if(l!=l||l==-Infinity||l==Infinity)l=a.get();if(c!=l){u.set(l);c=l}if(l==p&&!g){g=true;u.set(l)}}n.onTriggered=function(){I();o.trigger()}}};CABLES.OPS["5677b5b5-753a-4fbf-9e91-64c81ec68a2f"]={f:Ops.Anim.Smooth,objName:"Ops.Anim.Smooth"};Ops.Html.Event.ElementEventListener_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inObject("Element"),a=t.inString("Event Name",""),o=t.inValueBool("Use Capture",false),n=t.inValueBool("Prevent Default",true),i=t.inValueBool("Stop Propagation",true),s=t.outObject("Element Passthrough"),u=t.outTrigger("Event Trigger"),l=t.outObject("Event Object");let p=null;let c="";let b=false;r.onChange=()=>{s.setRef(r.get());m()};a.onChange=o.onChange=m;function m(){let t=r.get();let e=a.get();let n=o.get();d();f(t,e,n);p=t;c=e;b=n}function d(){if(p&&c){p.removeEventListener(c,g,b)}}function f(t,e,n){if(t&&e){t.addEventListener(e,g,n)}}function g(t){l.set(t);if(n.get()){t.preventDefault()}if(i.get()){t.stopPropagation()}u.trigger()}}};CABLES.OPS["c20ac53e-7ec7-4ac6-8ab9-88c1ad1ea6ea"]={f:Ops.Html.Event.ElementEventListener_v2,objName:"Ops.Html.Event.ElementEventListener_v2"};Ops.Array.ArrayContains_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array"),r=t.inFloat("SearchValue"),a=t.outBoolNum("Found",false),o=t.outNumber("Index",-1);r.onChange=n.onChange=i;function i(){if(n.get()){const t=n.get().indexOf(r.get());o.set(t);a.set(t>-1)}}}};CABLES.OPS["b982d7e3-c9cf-41dd-aead-66daad785fa8"]={f:Ops.Array.ArrayContains_v2,objName:"Ops.Array.ArrayContains_v2"};Ops.Trigger.Repeat_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Execute"),r=t.inValueInt("Repeats",5),a=t.inSwitch("Direction",["Forward","Backward"],"Forward"),o=t.outTrigger("Next"),i=t.addOutPort(new CABLES.Port(t,"index"));a.onChange=s;s();function s(){if(a.get()=="Forward")n.onTriggered=u;else n.onTriggered=l}function u(){const e=Math.floor(r.get());for(let t=0;t<e;t++){i.set(t);o.trigger()}}function l(){const e=Math.floor(r.get());for(let t=e-1;t>-1;t--){i.set(t);o.trigger()}}}};CABLES.OPS["a4deea80-db97-478f-ad1a-5ee30f2f47cc"]={f:Ops.Trigger.Repeat_v2,objName:"Ops.Trigger.Repeat_v2"};Ops.Array.SmoothArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Execute"),a=t.inArray("Array In"),r=t.inBool("Separate inc/dec",false),o=t.inValue("Inc factor",4),i=t.inValue("Dec factor",4),s=t.outTrigger("Next"),u=t.outArray("Array Out");let l=[];let p=false;let c=0;let b=[];u.set(b);let m;let d;let f=false;g();h();function g(){f=r.get();if(!f){i.setUiAttribs({greyout:true});o.setUiAttribs({title:"Inc/Dec factor"})}else{i.setUiAttribs({greyout:false});o.setUiAttribs({title:"Inc factor"})}h();v()}function h(){m=o.get();if(f==false)d=o.get();else d=i.get();if(m<=0||m!=m)m=1e-4;if(d<=0||d!=d)d=1e-4;if(m<=1)m=1;if(d<=1)d=1}a.onLinkChanged=()=>{if(a)a.copyLinkedUiAttrib("stride",u)};a.onChange=function(){let e=a.get();if(!e)return;for(let t=0;t<e.length;t++){l[t]=e[t]||0}};let O=0;function v(){let t=a.get();if(!t)return;if(b.length!=t.length){b.length=t.length||0;p=true}let n=1;if(CABLES.now()-c>500||c===0)p=true;else n=(CABLES.now()-c)/17;c=CABLES.now();if(p){for(var r=0;r<t.length;r++){b[r]=t[r]}p=false}for(var r=0;r<t.length;r++){let t=b[r];let e=l[r]-t;if(e>=0)t+=e/(d*n);else t+=e/(m*n);if(t>0&&t<1e-9)t=0;if(!t)t=0;if(b[r]!=t){b[r]=t;O=t}}u.setRef(b);s.trigger()}n.onTriggered=function(){v()};o.onChange=i.onChange=h;r.onChange=g;v()}};CABLES.OPS["8fd2ed9b-02e5-4349-b7bc-6665ca240ffa"]={f:Ops.Array.SmoothArray,objName:"Ops.Array.SmoothArray"};Ops.Trigger.RouteTriggerString_v2=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=24,r=e.inTriggerButton("Execute"),a=e.inString("Switch Value"),o=e.outTrigger("Next Trigger"),i=e.outNumber("Switched Index");let s=-1;const u=[];const l=[];for(let t=0;t<n;t++){u[t]=e.outTrigger("Trigger "+t);l[t]=e.inString("String "+t);l[t].onChange=p}e.onLoad=e.onInit=a.onChange=p;function p(){s=-1;for(let t=0;t<l.length;t++){if(l[t].get()==a.get()){s=t;break}}}r.onTriggered=()=>{if(s>=0)u[s].trigger();i.set(s);o.trigger()}}};CABLES.OPS["13bdac27-5da7-4311-890b-6a7e49d72040"]={f:Ops.Trigger.RouteTriggerString_v2,objName:"Ops.Trigger.RouteTriggerString_v2"};Ops.String.StringTrim_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String"),r=t.outString("Result","");n.onChange=function(){if(!n.get())r.set("");else r.set(n.get().trim())}}};CABLES.OPS["a9aed302-328a-4d33-bd3f-27e3e6690b9e"]={f:Ops.String.StringTrim_v2,objName:"Ops.String.StringTrim_v2"};Ops.Trigger.TriggerCounter=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("exe"),r=t.inTriggerButton("reset"),a=t.outTrigger("trigger"),o=t.outNumber("timesTriggered");t.toWorkPortsNeedToBeLinked(n);t.setUiAttrib({extendTitle:0});let i=0;r.onTriggered=t.onLoaded=s;n.onTriggered=function(){i++;o.set(i);t.setUiAttrib({extendTitle:i});a.trigger()};function s(){i=0;t.setUiAttrib({extendTitle:i});o.set(i)}}};CABLES.OPS["e640619f-235c-4543-bbf8-b358e0283180"]={f:Ops.Trigger.TriggerCounter,objName:"Ops.Trigger.TriggerCounter"};Ops.Vars.TriggerVarGetObject=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Update"),r=t.outTrigger("Next"),a=t.outObject("Value");t.varName=t.inValueSelect("Variable",[],"",true);const o=new CABLES.VarGetOpWrapper(t,"object",t.varName,null);n.onTriggered=()=>{if(o&&o.variable)a.set(o.variable.getValue());r.trigger()}}};CABLES.OPS["da9061bb-ab7c-439b-a01b-4d42281328b5"]={f:Ops.Vars.TriggerVarGetObject,objName:"Ops.Vars.TriggerVarGetObject"};Ops.Number.GateNumber=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValue("Value In",0),r=t.inValueBool("Pass Through"),a=t.inSwitch("When False",["keep last number","custom"],"keep last number"),o=t.inFloat("Custom Value",0),i=t.outNumber("Value Out");n.onChange=u;r.onChange=u;n.changeAlways=i.changeAlways=true;a.onChange=s;function s(){o.setUiAttribs({greyout:a.get()!="custom"});u()}function u(){if(r.get()){i.set(n.get())}else{if(a.get()=="custom")i.set(o.get())}}}};CABLES.OPS["594105c8-1fdb-4f3c-bbd5-29b9ad6b33e0"]={f:Ops.Number.GateNumber,objName:"Ops.Number.GateNumber"};Ops.Math.Compare.BetweenEquals=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("Value",2),r=t.inValueFloat("Range 1",1),a=t.inValueFloat("Range 2",3),o=t.outNumber("Result");n.onChange=r.onChange=a.onChange=i;i();function i(){o.set(n.get()>=Math.min(r.get(),a.get())&&n.get()<=Math.max(r.get(),a.get()))}}};CABLES.OPS["e2d6d6c4-84c7-42d7-a1b2-e9c5d4c5c13e"]={f:Ops.Math.Compare.BetweenEquals,objName:"Ops.Math.Compare.BetweenEquals"};Ops.Gl.Matrix.ScreenCoordinates_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Execute"),r=t.inSwitch("Pixel Unit",["Display","CSS"],"Display"),a=t.outTrigger("Trigger"),o=t.outNumber("X"),i=t.outNumber("Y"),s=t.outNumber("Visible");const u=t.patch.cgl;const l=vec3.create();const p=mat4.create();const c=vec3.create();const b=vec3.create();let m=-1;r.onChange=d;d();u.on("resize",d);function d(){if(r.get()=="CSS")m=u.pixelDensity;else m=1}n.onTriggered=function(){if(m==-1)d();mat4.multiply(p,u.vMatrix,u.mMatrix);vec3.transformMat4(c,b,p);vec3.transformMat4(l,c,u.pMatrix);const t=u.getViewPort();const e=l[0]*t[2]/2+t[2]/2;const n=l[1]*t[3]/2+t[3]/2;s.set(c[2]<0&&e>0&&e<t[2]&&n>0&&n<t[3]);o.set(e/m);i.set(t[3]/m-n/m);a.trigger()}}};CABLES.OPS["adbf5273-3275-490d-9002-e735b81cbb9a"]={f:Ops.Gl.Matrix.ScreenCoordinates_v2,objName:"Ops.Gl.Matrix.ScreenCoordinates_v2"};Ops.Extension.HtmlElementArray.DivElements=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const i=o.inString("Class"),s=o.inObject("Parent",null,"element"),u=o.inInt("Num",10),l=o.inBool("Active",true),p=o.inArray("Text"),e=o.inTriggerButton("Reset Hover"),c=o.outArray("Elements",null,"element"),b=o.outNumber("Index Clicked"),m=o.outTrigger("Element Clicked"),d=o.outTrigger("Pointer Up"),f=o.outNumber("Index Hovered",-1);const g=[];s.onChange=p.onChange=i.onChange=i.onChange=u.onChange=n;o.onDelete=h;l.onChange=()=>{if(!l.get())h();else n()};function h(){for(let t=0;t<g.length;t++){g[t].remove()}g.length=0}e.onTriggered=()=>{f.set(-1)};function n(){h();if(!l.get())return;const e=s.get();const n=p.get();for(let t=0;t<u.get();t++){const r=document.createElement("div");r.dataset.op=o.id;const a=t;r.addEventListener("pointerdown",()=>{b.set(a);m.trigger()});r.addEventListener("pointerup",()=>{b.set(a);d.trigger()});r.addEventListener("pointerenter",()=>{f.set(a)});r.addEventListener("pointerleave",()=>{f.set(-1)});const e=s.get()||o.patch.cgl.canvas.parentElement;e.appendChild(r);r.setAttribute("class",i.get());r.classList.add("index_"+t);if(n&&n.length>t)r.innerHTML=n[t];g[t]=r}c.set(null);c.set(g)}}};CABLES.OPS["adcf03e3-66ec-48d4-b339-5859900268cb"]={f:Ops.Extension.HtmlElementArray.DivElements,objName:"Ops.Extension.HtmlElementArray.DivElements"};Ops.Extension.HtmlElementArray.ElementArrayCssPropertyNumber=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("Element"),r=e.inTriggerButton("Update"),a=e.inString("Property"),o=e.inFloat("Value"),i=e.inString("Value Suffix","px"),s=e.outObject("HTML Element");e.setPortGroup("Element",[n]);e.setPortGroup("Attributes",[a,o,i]);e.toWorkPortsNeedToBeLinked(n);a.onChange=l;let u=null;r.onTriggered=p;n.onLinkChanged=function(){};function l(){p();e.setUiAttrib({extendTitle:a.get()+""})}function p(){u=n.get();if(u&&u.style){const t=o.get()+i.get();try{u.style[a.get()]=t}catch(t){e.error(t)}}s.set(n.get())}}};CABLES.OPS["0c7a7ef2-e084-4045-81f8-20d5c43ebb1b"]={f:Ops.Extension.HtmlElementArray.ElementArrayCssPropertyNumber,objName:"Ops.Extension.HtmlElementArray.ElementArrayCssPropertyNumber"};Ops.Array.ArrayGetValuesByIndexArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const i=t.inArray("Array");const s=t.inSwitch("Array Stride",["1","2","3","4"],"1");const u=t.inArray("Indices");const l=t.outArray("Results");t.toWorkPortsNeedToBeLinked(i,u);i.onChange=s.onChange=u.onChange=()=>{const e=i.get();if(!e){l.set(null);return}const n=u.get();if(!n){l.set(null);return}const r=[];const a=parseInt(s.get());for(let t=0;t<n.length;t++){const o=n[t]*a;if(a==1){r.push(e[o])}else{for(let t=0;t<a;t++){r.push(e[o+t])}}}l.setRef(r)}}};CABLES.OPS["fe4e2125-f533-4fcf-9cca-cf5691dfb268"]={f:Ops.Array.ArrayGetValuesByIndexArray,objName:"Ops.Array.ArrayGetValuesByIndexArray"};Ops.Array.ArraySwizzle=class extends CABLES.Op{constructor(){super(...arguments);const c=this;const t=c.attachments={};const b=["X","Y","Z","W","0","1","0,1,2..","0-1"];const m=c.inArray("Array"),d=c.inSwitch("Array Stride",["1","2","3","4"],"1"),f=c.inSwitch("Result Stride",["1","2","3","4"],"3"),g=c.inSwitch("X",b,"X"),h=c.inSwitch("Y",b,"0"),O=c.inSwitch("Z",b,"0"),v=c.inSwitch("W",b,"1"),j=c.outArray("Result");c.setPortGroup("Content Result",[g,h,O,v]);const y=[];g.onChange=h.onChange=O.onChange=v.onChange=d.onChange=f.onChange=()=>{e(true)};m.onChange=e;function e(t){const e=m.get();const n=parseInt(d.get());const r=parseInt(f.get());if(CABLES.UI&&t){g.setUiAttribs({greyout:r<1});h.setUiAttribs({greyout:r<2});O.setUiAttribs({greyout:r<3});v.setUiAttribs({greyout:r<4});let t="";if(n=="1")t+="X ";if(n=="2")t+="XY ";if(n=="3")t+="XYZ ";if(n=="4")t+="XYZW ";t+=" > ";t+=g.get();if(r>=2)t+=h.get()+" ";if(r>=3)t+=O.get()+" ";if(r>=4)t+=v.get()+" ";c.setUiAttrib({extendTitle:t})}if(!e)return j.set(null);const a=e.length/n*r;if(a%1!=0){j.set(null);c.setUiError("invalidlength","Invalid array length, is not dividable by stride");return}c.setUiError("invalidlength",null);const o=parseInt(d.get());y.length=a;const i=b.indexOf(g.get());const s=b.indexOf(h.get());const u=b.indexOf(O.get());const l=b.indexOf(v.get());let p=0;for(let t=0;t<e.length;t+=o){j.setUiAttribs({stride:r});if(r>=1){if(i===0)y[p++]=e[t+0];else if(i===1)y[p++]=e[t+1];else if(i===2)y[p++]=e[t+2];else if(i===3)y[p++]=e[t+3];else if(i===4)y[p++]=0;else if(i===5)y[p++]=1;else if(i===6)y[p++]=(p-1)/r;else if(i===7)y[p++]=t/e.length}if(r>=2){if(s===0)y[p++]=e[t+0];else if(s===1)y[p++]=e[t+1];else if(s===2)y[p++]=e[t+2];else if(s===3)y[p++]=e[t+3];else if(s===4)y[p++]=0;else if(s===5)y[p++]=1;else if(s===6)y[p++]=(p-2)/r;else if(s===7)y[p++]=t/e.length}if(r>=3){if(u===0)y[p++]=e[t+0];else if(u===1)y[p++]=e[t+1];else if(u===2)y[p++]=e[t+2];else if(u===3)y[p++]=e[t+3];else if(u===4)y[p++]=0;else if(u===5)y[p++]=1;else if(u===6)y[p++]=(p-3)/r;else if(u===7)y[p++]=t/e.length}if(r>=4){if(l===0)y[p++]=e[t+0];else if(l===1)y[p++]=e[t+1];else if(l===2)y[p++]=e[t+2];else if(l===3)y[p++]=e[t+3];else if(l===4)y[p++]=0;else if(l===5)y[p++]=1;else if(l===6)y[p++]=(p-4)/r;else if(l===7)y[p++]=t/e.length}}j.setRef(y)}}};CABLES.OPS["888b76dd-40ee-4d79-9a1b-410612b4eb06"]={f:Ops.Array.ArraySwizzle,objName:"Ops.Array.ArraySwizzle"};Ops.Number.TriggerOnChangeNumber=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inFloat("Value"),r=t.outTrigger("Next"),a=t.outNumber("Number");n.onChange=function(){a.set(n.get());r.trigger()}}};CABLES.OPS["f5c8c433-ce13-49c4-9a33-74e98f110ed0"]={f:Ops.Number.TriggerOnChangeNumber,objName:"Ops.Number.TriggerOnChangeNumber"};Ops.Boolean.MonoFlop=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.inValue("Duration",1),a=t.inValue("Value True",1),o=t.inValue("Value False",0),i=t.inTriggerButton("Reset"),s=t.outTrigger("Activated"),u=t.outTrigger("Ended"),l=t.outBoolNum("Result",false);let p=-1;i.onTriggered=function(){l.set(o.get());clearTimeout(p)};n.onTriggered=function(){if(l.get()==o.get())s.trigger();l.set(a.get());clearTimeout(p);p=setTimeout(function(){l.set(o.get());u.trigger()},r.get()*1e3)}}};CABLES.OPS["3a4b0a78-4172-41c7-8248-95cb0856ecc8"]={f:Ops.Boolean.MonoFlop,objName:"Ops.Boolean.MonoFlop"};Ops.Html.CSS.SetCssVariableString=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inString("Var Name"),r=e.inString("Value"),a=e.inBool("Output quoted string",false);const o=document.documentElement;r.onChange=n.onChange=a.onChange=i;function i(){e.setUiAttrib({extendTitle:n.get()});let t=r.get();if(a.get()){t='"'+t+'"'}o.style.setProperty("--"+n.get(),t)}}};CABLES.OPS["e7b4ea20-ef7e-461d-92f8-6aff58c5ba6f"]={f:Ops.Html.CSS.SetCssVariableString,objName:"Ops.Html.CSS.SetCssVariableString"};Ops.String.NumberToString_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValue("Number"),r=t.inInt("Decimal Places",4),a=t.outString("Result");let o=false;let i=1;r.onChange=s;n.onChange=u;s();u();function s(){o=r.get()<100;i=Math.pow(10,r.get());u()}function u(){if(o)a.set(String(Math.round(n.get()*i)/i));else a.set(String(n.get()||0))}}};CABLES.OPS["5c6d375a-82db-4366-8013-93f56b4061a9"]={f:Ops.String.NumberToString_v2,objName:"Ops.String.NumberToString_v2"};Ops.Anim.BoolAnim=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=new CABLES.Anim;const r=t.inTrigger("exe"),a=t.inValueBool("bool"),o=n.createPort(t,"easing"),i=t.inValue("duration",.25),s=t.inValueSelect("Direction",["Both","Only True","Only False"],"Both"),u=t.inValue("value false",0),l=t.inValue("value true",1),p=t.outTrigger("trigger"),c=t.outNumber("value"),b=t.outBoolNum("finished"),m=t.outTrigger("Finished Trigger");const d=CABLES.now();t.toWorkPortsNeedToBeLinked(r);t.setPortGroup("Animation",[i,o]);t.setPortGroup("Values",[u,l]);s.onChange=a.onChange=u.onChange=l.onChange=i.onChange=f;f();function f(){if(s.get()=="Animate Both")s.set("Both");b.set(false);const t=(CABLES.now()-d)/1e3;const e=n.getValue(t);n.clear();n.setValue(t,e);if(!a.get()){if(s.get()!="Only True")n.setValue(t+i.get(),u.get());else n.setValue(t,u.get())}else{if(s.get()!="Only False")n.setValue(t+i.get(),l.get());else n.setValue(t,l.get())}}r.onTriggered=function(){const t=(CABLES.now()-d)/1e3;c.set(n.getValue(t));if(n.hasEnded(t)){if(!b.get())m.trigger();b.set(true)}p.trigger()}}};CABLES.OPS["06ad9d35-ccf5-4d31-889c-e23fa062588a"]={f:Ops.Anim.BoolAnim,objName:"Ops.Anim.BoolAnim"};Ops.Math.Compare.GreaterOrEquals=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.outBoolNum("result"),r=t.inValueFloat("number1"),a=t.inValueFloat("number2");r.onLinkChanged=a.onLinkChanged=r.onChange=a.onChange=o;function o(){n.set(r.get()>=a.get())}}};CABLES.OPS["5f9ce320-1e8d-49cb-9927-337e0b3f4d45"]={f:Ops.Math.Compare.GreaterOrEquals,objName:"Ops.Math.Compare.GreaterOrEquals"};Ops.Html.QuerySelector_v2=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const e=o.inTriggerButton("Update"),i=o.inString("Query"),s=o.inValueSelect("Mode",["document","string input"],"document"),u=o.inValueSelect("Type",["text/html","text/xml"],"text/html"),l=o.inStringEditor("Document","xml"),p=o.outObject("Element",null,"element");if(s.get()==="document"){l.setUiAttribs({greyout:true});u.set("text/html");u.setUiAttribs({greyout:true})}e.onTriggered=i.onChange=u.onChange=l.onChange=n;s.onChange=r;function n(){o.setUiError("exc",null);const n=i.get();if(!n){p.setRef(null);return}const r=l.get();const t=s.get();if(t==="string input"&&r){let t=new DOMParser;let e=null;try{e=t.parseFromString(r,u.get());const a=e.querySelector(n);p.setRef(a)}catch(t){o.setUiError("exc",t.message,1);o.logWarn(t)}}else{try{const a=document.querySelector(n);p.setRef(a)}catch(t){o.setUiError("exc",t.message,1);o.logWarn(t)}}}function r(){if(s.get()==="document"){l.setUiAttribs({greyout:true});u.set("text/html");u.setUiAttribs({greyout:true})}else{l.setUiAttribs({greyout:false});u.setUiAttribs({greyout:false})}}}};CABLES.OPS["a1a2189b-564c-4dd7-b3d9-a6cebc0cd94e"]={f:Ops.Html.QuerySelector_v2,objName:"Ops.Html.QuerySelector_v2"};Ops.Html.Event.ElementsArrayEventHandler=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Elements",null,"element");const r=t.inString("Event Name","click");const a=t.inValueBool("Use Capture",false);const o=t.inValueBool("Prevent Default",true);const i=t.inValueBool("Stop Propagation",true);const s=t.outTrigger("Event Trigger");const u=t.outNumber("Index",-1);const l=t.outObject("Event Object");const p=t.outObject("Event Element",null,"element");t.onDelete=g;const c="op"+t.id+"listenerIndex";let b=[];let m="";const d=t=>{const e=t.currentTarget;u.set(-1);if(e.dataset.hasOwnProperty(c))u.set(parseInt(e.dataset[c],10));l.setRef(t);p.setRef(e);s.trigger()};r.onChange=a.onChange=o.onChange=i.onChange=n.onChange=()=>{if(!r.get())return;g(m);b=n.get()||[];m=r.get();f(m)};function f(n){b.forEach((t,e)=>{t.dataset[c]=e;t.addEventListener(n,d,a.get())})}function g(e){b.forEach(t=>{t.removeEventListener(e,d,a.get());t.removeEventListener(e,d,!a.get())})}}};CABLES.OPS["a8d569d1-5238-4c3e-be3c-4507df51740f"]={f:Ops.Html.Event.ElementsArrayEventHandler,objName:"Ops.Html.Event.ElementsArrayEventHandler"};Ops.Html.CSS.ToggleClass=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("HTML Element"),r=t.inString("Classname"),a=t.inValueBool("Active",true);a.onChange=r.onChange=n.onChange=u;t.onDelete=s;let o=null;let i=null;function s(t){if(t&&t.classList)t.classList.remove(i)}function u(){let t=n.get();let e=r.get();if(!n.isLinked())s(o);if(!e||!t||!t.classList)return;if(o&&t!=o)o.classList.remove(e);s(t);if(!a.get())t.classList.remove(e);else t.classList.add(e);i=e;o=t}}};CABLES.OPS["6dd90fb9-7f28-427f-acd8-589f21a906bb"]={f:Ops.Html.CSS.ToggleClass,objName:"Ops.Html.CSS.ToggleClass"};Ops.Json.ObjectGetNumber_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("Data"),r=t.inString("Key"),a=t.outNumber("Result"),o=t.outBoolNum("Found");t.toWorkPortsNeedsString(r);a.ignoreValueSerialize=true;n.ignoreValueSerialize=true;t.setUiAttrib({extendTitlePort:r.name});r.setUiAttribs({stringTrim:true});r.onChange=n.onChange=i;function i(){const t=n.get();if(t){const e=t[r.get()];a.set(parseFloat(e));if(e===undefined)o.set(0);else o.set(1)}else{a.set(0);o.set(0)}}}};CABLES.OPS["a7335e79-046e-40da-9e9c-db779b0a5e53"]={f:Ops.Json.ObjectGetNumber_v2,objName:"Ops.Json.ObjectGetNumber_v2"};Ops.Patch.PaZfgnp.ArrayStringIndexes=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inArray("Array");const a=t.inString("SearchValue");const o=t.outArray("Index",-1);const i=t.outBoolNum("Found",false);a.onChange=()=>{if(!a.isLinked())t.setUiAttrib({extendTitle:a.get()});n()};r.onChange=n;function n(){let e=r.get();const n=[];if(e){if(!Array.isArray(e))e=Array.from(e);for(let t=0;t<e.length;t++){if(e[t]===a.get()){n.push(t)}}o.setRef(n);i.set(n.length>0)}}}};CABLES.OPS["0ecd5e41-d721-4883-a338-c6bc19320629"]={f:Ops.Patch.PaZfgnp.ArrayStringIndexes,objName:"Ops.Patch.PaZfgnp.ArrayStringIndexes"};Ops.Data.Compose.Array.CompArrayPushString=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Update"),r=e.inString("String",""),a=e.outTrigger("Next");n.onTriggered=()=>{if(e.patch.tempData.compArray&&e.patch.tempData.compArray.length>0){let t=e.patch.tempData.compArray[e.patch.tempData.compArray.length-1];t.push(r.get())}a.trigger()}}};CABLES.OPS["90680e4f-e14e-4708-a53b-420c0ea28913"]={f:Ops.Data.Compose.Array.CompArrayPushString,objName:"Ops.Data.Compose.Array.CompArrayPushString"};Ops.Array.GetValuesFromArrayOfObjects=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const u=t.inArray("Array"),l=t.inString("Key"),p=t.inBool("Numbers Only",false),c=t.inBool("Remove empty/invalid",false),b=t.outArray("Result");c.onChange=l.onChange=u.onChange=p.onChange=n;l.setUiAttribs({stringTrim:true,minLength:1});function n(){const e=u.get();if(!e){b.set(null);return}const n=[];const r=l.get();const a=p.get();t.setUiAttrib({extendTitle:l.get()});const o=c.get();for(let t=0;t<e.length;t++){const i=e[t];if(i){if(!(r in i))continue;const s=i[r];if(o){if(s===""||s===null||s===undefined)continue}if(a){if(CABLES.isNumeric(s))n.push(parseFloat(s));else n.push(0)}else{n.push(s)}}}b.setRef(n)}}};CABLES.OPS["e068629a-7963-48b0-853f-a89348d03654"]={f:Ops.Array.GetValuesFromArrayOfObjects,objName:"Ops.Array.GetValuesFromArrayOfObjects"};Ops.Patch.PaZfgnp.ElementArrayToggleClass=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("HTML Element",null,"element"),r=t.inString("Classname");n.onChange=r.onChange=a;function a(){let t=n.get();let e=r.get();if(!e||!t||!t.classList)return;t.classList.toggle(e)}}};CABLES.OPS["b29edcfb-f5cc-4915-a6f2-2125df4dca4f"]={f:Ops.Patch.PaZfgnp.ElementArrayToggleClass,objName:"Ops.Patch.PaZfgnp.ElementArrayToggleClass"};Ops.Team.ACAR.CalculateGraph=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const a=t.inObject("D3",null,"d3");const o=t.inArray("Nodes");const i=t.inArray("Links");const s=t.inObject("Force Props");const n=t.inInt("Ticks per Frame",5);const r=t.inTrigger("Tick");const u=t.outTrigger("Updated");const l=t.outTrigger("Finished");const p=t.outBoolNum("Loading");const d=t.outArray("Nodes Pos",3);const f=t.outArray("Splines Pos",3);let c=null;let b=[];let m=[];let g=[];let h=[];let O={center:{strength:1,x:.5,y:.5},charge:{strength:-50,enabled:true,distanceMin:1,distanceMax:Infinity},collide:{strength:1,enabled:true,iterations:1,radius:1},forceX:{strength:.1,enabled:false,x:0},forceY:{strength:.1,enabled:false,y:0},link:{strength:.1,enabled:true,distance:75,iterations:1}};s.onChange=()=>{j(c,s.get(),h)};o.onChange=()=>{b=o.get()||[];v(false)};i.onChange=()=>{m=i.get()||[];v(false)};r.onTriggered=()=>{if(c){const t=n.get()||5;for(let t=n;t>0;--t){c.tick()}}};a.onChange=v;function v(t=true){O=s.get()||O;const e=a.get();const n=o.get()||[];const r=i.get()||[];if(!e||!n||!r)return;if(t)p.set(true);h=r.map(t=>{return{...t}});g=n.map(t=>{return{...t}});c=e.forceSimulation(g);c.alphaMin(.025);c.on("end",()=>{p.set(false);l.trigger()});c.force("end",()=>{const t=c.alpha();const e=c.alphaMin();if(p.get()){y(g,h);u.trigger()}});c.stop()}function j(t,e){try{if(!t||!e)return;p.set(true);if(e.center.enabled){t.force("center",d3.forceCenter(e.center.x,e.center.y).strength(e.center.strength))}if(e.charge.enabled){t.force("charge",d3.forceManyBody().strength(e.charge.strength).distanceMin(e.charge.distanceMin).distanceMax(e.charge.distanceMax))}if(e.collide.enabled){t.force("collide",d3.forceCollide(e.collide.radius).strength(e.collide.strength).iterations(e.collide.iterations))}if(e.forceX.enabled){t.force("x",d3.forceX(e.forceX.x).strength(e.forceX.strength))}if(e.forceY.enabled){t.force("y",d3.forceY(e.forceY.y).strength(e.forceY.strength))}if(h&&e.link.enabled){t.force("link",d3.forceLink(h).id(t=>{return t.id}).distance(e.link.distance).strength(e.link.strength).iterations(e.link.iterations))}t.alpha(.25).restart()}catch(t){console.warn("d3",t)}}function y(e,n){const r=[];for(let t=0;t<e.length;t++){const o=e[t].x;const i=e[t].y;const s=e[t].z||0;r.push(o);r.push(i);r.push(s)}d.setRef(r);const a=[];for(let t=0;t<n.length;t++){const u=n[t].source.x;const l=n[t].source.y;const p=n[t].source.z||0;const c=n[t].target.x;const b=n[t].target.y;const m=n[t].target.z||0;a.push(u);a.push(l);a.push(p);a.push(c);a.push(b);a.push(m)}f.setRef(a)}}};CABLES.OPS["1a443318-90e7-4200-80cf-761d947fd952"]={f:Ops.Team.ACAR.CalculateGraph,objName:"Ops.Team.ACAR.CalculateGraph"};Ops.Sidebar.SidebarText_v3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("link");const r=t.inString("Text","Value");const a=t.inString("Id","");const o=t.outObject("childs");const i=document.createElement("div");i.dataset.op=t.id;i.classList.add("cablesEle");i.classList.add("sidebar__item");i.classList.add("sidebar__text");const s=document.createElement("div");s.classList.add("sidebar__item-label");const u=document.createElement("div");const l=t.inBool("Visible",true);s.appendChild(u);i.appendChild(s);n.onChange=b;r.onChange=c;a.onChange=p;t.onDelete=f;t.toWorkNeedsParent("Ops.Sidebar.Sidebar");l.onChange=function(){i.style.display=l.get()?"block":"none"};function p(){i.id=a.get()}function c(){const t=r.get();s.innerHTML=t}function b(){o.set(null);const t=n.get();if(t&&t.parentElement){t.parentElement.appendChild(i);o.set(t)}else{if(i.parentElement)i.parentElement.removeChild(i)}}function m(t){if(t)t.style.display="block"}function d(t){if(t)t.style.display="none"}function f(){g(i)}function g(t){if(t&&t.parentNode&&t.parentNode.removeChild)t.parentNode.removeChild(t)}}};CABLES.OPS["c00eef25-67d6-4fa3-9921-cbf533078a54"]={f:Ops.Sidebar.SidebarText_v3,objName:"Ops.Sidebar.SidebarText_v3"};Ops.Team.Plan.CurrentPlace=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("Plan",""),r=t.outString("Current Place"),a=t.outNumber("Level");let o=null;t.setUiError("noplan","plan not found");t.patch.on("plansChanged",i);n.onChange=i;function i(){if(!t.patch.plans)return;o=t.patch.plans[n.get()];t.setUiError("noplan",null);if(!o||!n.get()){t.setUiError("noplan","plan not found");return}o.on("stateChanged",()=>{s()});s()}function s(){if(!o)return;r.set(o.getCurrentPlaceName());a.set(o.getCurrentPlaceLevel());t.setUiAttrib({extendTitle:": "+r.get()})}}};CABLES.OPS["3aaba739-5566-4190-a5d1-ba5cfe7895ab"]={f:Ops.Team.Plan.CurrentPlace,objName:"Ops.Team.Plan.CurrentPlace"};Ops.Vars.VarTriggerArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.inArray("Value",null),a=t.outTrigger("Next");t.varName=t.inDropDown("Variable",[],"",true);new CABLES.VarSetOpWrapper(t,"array",r,t.varName,n,a)}};CABLES.OPS["9fd759cf-6fcc-487e-9dd9-9c9ab6143683"]={f:Ops.Vars.VarTriggerArray,objName:"Ops.Vars.VarTriggerArray"};Ops.Json.TriggerObjectSetNumber=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.inObject("Object"),a=t.inString("Key"),o=t.inFloat("Number"),i=t.outTrigger("Next"),s=t.outObject("Result");a.setUiAttribs({stringTrim:true,minLength:1});n.onTriggered=()=>{const t=r.get();if(t&&a.get()){t[a.get()]=o.get()}s.setRef(t);i.trigger()}}};CABLES.OPS["ecc96e87-c51f-49bf-ad90-25f283c73e87"]={f:Ops.Json.TriggerObjectSetNumber,objName:"Ops.Json.TriggerObjectSetNumber"};Ops.Array.ArrayLookup=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const s=t.inArray("Indices"),u=t.inArray("Values"),l=t.inInt("Stride",1),p=t.outArray("Result");l.onChange=u.onChange=s.onChange=n;function n(){const n=[];const r=s.get();const a=u.get();const o=l.get();p.setUiAttribs({stride:o});if(!r||!a){p.setRef([]);return}for(let e=0;e<r.length;e++){for(let t=0;t<o;t++){const i=r[e]*o+t;n.push(a[i]||0)}}p.setRef(n)}}};CABLES.OPS["45800d01-7c07-41b8-b392-a3924d256549"]={f:Ops.Array.ArrayLookup,objName:"Ops.Array.ArrayLookup"};Ops.Array.InfoArray3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};let c=t.inArray("Array"),b=t.outNumber("Num Items"),m=t.outNumber("Min X"),d=t.outNumber("Min Y"),f=t.outNumber("Min Z"),g=t.outNumber("Max X"),h=t.outNumber("Max Y"),O=t.outNumber("Max Z"),v=t.outNumber("Average X"),j=t.outNumber("Average Y"),y=t.outNumber("Average Z"),I=t.outNumber("Center X"),A=t.outNumber("Center Y"),x=t.outNumber("Center Z");function n(t,e,n,r,a,o){const i=r-t;const s=a-e;const u=o-n;return Math.sqrt(i*i+s*s+u*u)}c.onChange=function(){let e=c.get();let n=999999999;let r=-999999999;let a=0;let o=999999999;let i=-999999999;let s=0;let u=999999999;let l=-999999999;let p=0;b.set(0);if(e){b.set(e.length/3);for(let t=0;t<e.length;t+=3){a+=e[t];n=Math.min(n,e[t]);r=Math.max(r,e[t]);p+=e[t+1];u=Math.min(u,e[t+1]);l=Math.max(l,e[t+1]);s+=e[t+2];o=Math.min(o,e[t+2]);i=Math.max(i,e[t+2])}a/=e.length/3;p/=e.length/3;s/=e.length/3}m.set(n);d.set(u);f.set(o);g.set(r);h.set(l);O.set(i);v.set(a);j.set(p);y.set(s);I.set(CABLES.map(.5,0,1,n,r));A.set(CABLES.map(.5,0,1,u,l));x.set(CABLES.map(.5,0,1,o,i))}}};CABLES.OPS["e2ace702-eed6-4b40-86f6-cea716ba8579"]={f:Ops.Array.InfoArray3,objName:"Ops.Array.InfoArray3"};Ops.Math.Distance2d=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValue("x1"),r=t.inValue("y1"),a=t.inValue("x2"),o=t.inValue("y2"),i=t.outNumber("distance");n.onChange=r.onChange=a.onChange=o.onChange=s;function s(){const t=a.get()-n.get();const e=o.get()-r.get();i.set(Math.sqrt(t*t+e*e))}}};CABLES.OPS["d181cc7c-adbb-467b-842b-e6a854c58bfc"]={f:Ops.Math.Distance2d,objName:"Ops.Math.Distance2d"};Ops.Math.FlipSign=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("Value",1),r=t.outNumber("Result");n.onChange=a;a();function a(){r.set(n.get()*-1)}}};CABLES.OPS["f5c858a2-2654-4108-86fe-319efa70ecec"]={f:Ops.Math.FlipSign,objName:"Ops.Math.FlipSign"};Ops.Math.Sum=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("number1",0),r=t.inValueFloat("number2",0),a=t.outNumber("result");t.setUiAttribs({mathTitle:true});n.onChange=r.onChange=o;o();function o(){const t=n.get()+r.get();if(!isNaN(t))a.set(t)}}};CABLES.OPS["c8fb181e-0b03-4b41-9e55-06b6267bc634"]={f:Ops.Math.Sum,objName:"Ops.Math.Sum"};Ops.Math.Subtract=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValue("number1",1),r=t.inValue("number2",1),a=t.outNumber("result");t.setUiAttribs({mathTitle:true});n.onChange=r.onChange=o;o();function o(){let t=n.get()-r.get();if(!isNaN(t))a.set(t)}}};CABLES.OPS["a4ffe852-d200-4b96-9347-68feb01122ca"]={f:Ops.Math.Subtract,objName:"Ops.Math.Subtract"};Ops.Math.Compare.LessThan=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValue("number1");const r=t.inValue("number2");const a=t.outBoolNum("result");t.setUiAttribs({mathTitle:true});n.onChange=o;r.onChange=o;o();function o(){a.set(n.get()<r.get())}}};CABLES.OPS["04fd113f-ade1-43fb-99fa-f8825f8814c0"]={f:Ops.Math.Compare.LessThan,objName:"Ops.Math.Compare.LessThan"};Ops.Array.ArrayLogic=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const o=e.inArray("array 0"),n=e.inValueSelect("Comparison mode",[">","<",">=","<=","==","!=",">pass","<pass",">=pass","<=pass","==pass","!=pass"],">"),i=e.inValueFloat("Number for comparison",.5),s=e.inFloat("value if true",1),u=e.inFloat("value if false",0),l=e.outArray("Array result"),p=e.outNumber("Array length");e.toWorkPortsNeedToBeLinked(o);let c;let r=false;let b=[];let a=0;n.onChange=m;o.onChange=i.onChange=u.onChange=s.onChange=d;m();function m(){let t=n.get();if(t===">")c=function(t,e,n,r){if(t>e)return n;return r};else if(t==="<")c=function(t,e,n,r){if(t<e)return n;return r};else if(t===">=")c=function(t,e,n,r){if(t>=e)return n;return r};else if(t==="<=")c=function(t,e,n,r){if(t<=e)return n;return r};else if(t==="==")c=function(t,e,n,r){if(t===e)return n;return r};else if(t==="!=")c=function(t,e,n,r){if(t!==e)return n;return r};else if(t===">pass")c=function(t,e,n,r){if(t>e)return t;return r};else if(t==="<pass")c=function(t,e,n,r){if(t<e)return t;return r};else if(t===">=pass")c=function(t,e,n,r){if(t>=e)return t;return r};else if(t==="<=pass")c=function(t,e,n,r){if(t<=e)return t;return r};else if(t==="==pass")c=function(t,e,n,r){if(t===e)return t;return r};else if(t==="!=pass")c=function(t,e,n,r){if(t!==e)return t;return r};d();e.setUiAttrib({extendTitle:t})}function d(){let t=o.get();let e=i.get();let n=u.get();let r=s.get();b.length=0;if(!t){l.set(null);p.set(0);return}b.length=t.length;let a=0;for(a=0;a<t.length;a++){b[a]=c(t[a],e,r,n)}l.setRef(b);p.set(b.length)}}};CABLES.OPS["502083f2-8ade-4cb5-b1c5-e5b60eb3255f"]={f:Ops.Array.ArrayLogic,objName:"Ops.Array.ArrayLogic"};Ops.Math.Compare.GreaterThan=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("number1"),r=t.inValueFloat("number2"),a=t.outBoolNum("result");t.setUiAttribs({mathTitle:true});n.onChange=r.onChange=o;function o(){a.set(n.get()>r.get())}}};CABLES.OPS["b250d606-f7f8-44d3-b099-c29efff2608a"]={f:Ops.Math.Compare.GreaterThan,objName:"Ops.Math.Compare.GreaterThan"};Ops.Extension.HtmlElementArray.ElementArrayCssPropertyString=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inObject("Element"),r=e.inTriggerButton("Update"),a=e.inString("Property"),o=e.inString("Value"),i=e.inString("Value Suffix","px"),s=e.outObject("HTML Element");e.setPortGroup("Element",[n]);e.setPortGroup("Attributes",[a,o,i]);a.onChange=l;let u=null;r.onTriggered=p;n.onLinkChanged=function(){};function l(){p();e.setUiAttrib({extendTitle:a.get()+""})}function p(){u=n.get();if(u&&u.style){const t=o.get()+i.get();try{u.style[a.get()]=t}catch(t){e.error(t)}}s.set(n.get())}}};CABLES.OPS["4bd6fda1-5bd0-47d4-a14c-68f2b6f88be8"]={f:Ops.Extension.HtmlElementArray.ElementArrayCssPropertyString,objName:"Ops.Extension.HtmlElementArray.ElementArrayCssPropertyString"};Ops.Trigger.TriggerButton=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.outTrigger("Next");n.onTriggered=function(){r.trigger()}}};CABLES.OPS["21630924-39e4-4df5-9965-b9136510d156"]={f:Ops.Trigger.TriggerButton,objName:"Ops.Trigger.TriggerButton"};Ops.Boolean.BoolToString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inBool("Boolean",false),r=t.inString("False","false"),a=t.inString("True","true"),o=t.outString("String","false");a.onChange=r.onChange=n.onChange=i;function i(){if(n.get())o.set(a.get());else o.set(r.get())}}};CABLES.OPS["22a734aa-8b08-4db7-929b-393d4704e1d6"]={f:Ops.Boolean.BoolToString,objName:"Ops.Boolean.BoolToString"};Ops.String.OrString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String 1"),r=t.inString("String 2"),a=t.inString("String 3"),o=t.inString("String 4"),i=t.inString("String 5"),s=t.inString("String 6"),u=t.inString("String 7"),l=t.inString("String 8"),p=t.outString("Result");n.onChange=r.onChange=a.onChange=o.onChange=i.onChange=s.onChange=u.onChange=l.onChange=c;function c(){p.set(n.get()||r.get()||a.get()||o.get()||i.get()||s.get()||u.get()||l.get())}}};CABLES.OPS["6b7f9561-6faf-4df7-ac3b-64235dded700"]={f:Ops.String.OrString,objName:"Ops.String.OrString"};Ops.Array.ArrayPushString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array"),r=t.inString("String",""),a=t.outArray("Result");const o=[];r.onChange=n.onChange=function(){const e=n.get();a.set(null);if(!e)return;o.length=e.length+1;for(let t=0;t<e.length;t++){o[t]=e[t]}o[e.length]=r.get();a.set(o)}}};CABLES.OPS["074034c9-9698-4984-897a-849bcb2b9b62"]={f:Ops.Array.ArrayPushString,objName:"Ops.Array.ArrayPushString"};Ops.Boolean.BoolByTrigger=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("True"),r=t.inTriggerButton("false"),a=t.outBoolNum("Result");n.onTriggered=function(){a.set(true)};r.onTriggered=function(){a.set(false)}}};CABLES.OPS["31f65abe-9d6c-4ba6-a291-ef2de41d2087"]={f:Ops.Boolean.BoolByTrigger,objName:"Ops.Boolean.BoolByTrigger"};Ops.Team.ACAR.ClassList=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("HTML Element",null,"element");const r=t.outArray("Classes");n.onChange=a;function a(){let t=n.get();let e=[];if(t)e=Array.from(t.classList);r.setRef(e)}}};CABLES.OPS["1f0670a2-e239-4657-99dc-2aecd35c54d1"]={f:Ops.Team.ACAR.ClassList,objName:"Ops.Team.ACAR.ClassList"};Ops.String.HandleBarsHtml_v2=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inStringEditor("Template","","html"),r=e.inObject("Data"),a=e.outString("Result"),o=e.outString("Errors");let i=null;n.onChange=s;r.onChange=l;function s(){try{i=Handlebars.compile(n.get())}catch(t){e.logWarn(t)}l()}const u=t=>{return t.replaceAll("&","&amp;").replaceAll(">","[").replaceAll("<","]").replaceAll('"',"&quot;").replaceAll("'","&#039;").replaceAll("\\n","<br/>")};function l(){if(!i)return;const t=r.get()||{};e.setUiError("hbserr",null);o.set("");try{a.set(i(t))}catch(t){a.set("");if(t.message){e.setUiError("hbserr","<pre>"+u(JSON.stringify(t.message+"")+"</pre>"));o.set(t.message)}else e.logWarn(t)}}}};CABLES.OPS["1bc0f780-6473-41e5-8e8b-6c509cafc99b"]={f:Ops.String.HandleBarsHtml_v2,objName:"Ops.String.HandleBarsHtml_v2"};Ops.Trigger.TriggerOnChangeString_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String"),r=t.outTrigger("Changed"),a=t.outString("Result");a.ignoreValueSerialize=true;n.onChange=function(){a.set(n.get());r.trigger()};t.init=()=>{if(n.isLinked())r.trigger()}}};CABLES.OPS["874380ae-4a10-4a53-92d9-4982f4c1f3a2"]={f:Ops.Trigger.TriggerOnChangeString_v2,objName:"Ops.Trigger.TriggerOnChangeString_v2"};Ops.Math.Min_v3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValue("Value 1",1),r=t.inValue("Value 2",2),a=t.outNumber("result");n.onChange=r.onChange=o;o();function o(){let t=Math.min(n.get(),r.get());a.set(t)}}};CABLES.OPS["24a9062d-380c-4690-8fe7-6703787fa94c"]={f:Ops.Math.Min_v3,objName:"Ops.Math.Min_v3"};Ops.Math.Max=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("value",1),r=t.inValueFloat("Maximum",1),a=t.outNumber("result");r.onChange=n.onChange=o;o();function o(){let t=Math.max(n.get(),r.get());if(t==t)a.set(t)}}};CABLES.OPS["07f0be49-c226-4029-8039-3b620145dc2a"]={f:Ops.Math.Max,objName:"Ops.Math.Max"};Ops.Patch.PaZfgnp.QuerySelectorAllElement=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const e=o.inTriggerButton("Update"),i=o.inString("Query"),s=o.inValueSelect("Mode",["document","string input","element"],"document"),u=o.inValueSelect("Type",["text/html","text/xml"],"text/html"),l=o.inStringEditor("Document","xml"),p=o.inObject("Element",null,"element"),c=o.outArray("Elements");if(s.get()==="document"){l.setUiAttribs({greyout:true});u.set("text/html");u.setUiAttribs({greyout:true})}e.onTriggered=n;s.onChange=r;function n(){o.setUiError("exc",null);const n=i.get();const r=l.get();const t=s.get();if(t==="string input"&&r){let t=new DOMParser;let e=null;try{e=t.parseFromString(r,u.get());const a=Array.from(e.querySelectorAll(n));c.set(a)}catch(t){o.setUiError("exc",t.message,1);o.logWarn(t)}}else if(t==="document"){try{const a=Array.from(document.querySelectorAll(n));c.set(a)}catch(t){o.setUiError("exc",t.message,1);o.logWarn(t)}}else{try{let t=null;if(p.get()){t=Array.from(p.get().querySelectorAll(n))}c.set(t)}catch(t){o.setUiError("exc",t.message,1);o.logWarn(t)}}}function r(){if(s.get()==="document"){l.setUiAttribs({greyout:true});u.setUiAttribs({greyout:true});p.setUiAttribs({greyout:true})}else if(s.get()==="string input"){l.setUiAttribs({greyout:false});u.setUiAttribs({greyout:false});p.setUiAttribs({greyout:true})}else{l.setUiAttribs({greyout:true});u.setUiAttribs({greyout:true});p.setUiAttribs({greyout:false})}}}};CABLES.OPS["1a1d80e0-0de8-4c4d-8eaa-e2a0eac6239a"]={f:Ops.Patch.PaZfgnp.QuerySelectorAllElement,objName:"Ops.Patch.PaZfgnp.QuerySelectorAllElement"};Ops.Patch.PaZfgnp.Closest=class extends CABLES.Op{constructor(){super(...arguments);const r=this;const t=r.attachments={};const a=r.inObject("HTML Element",null,"element");const o=r.inString("Query");const i=r.outObject("Element",null,"element");o.onChange=a.onChange=e;function e(){r.setUiError("exc",null);let t=a.get();let e=o.get();let n=null;if(t&&e){try{n=t.closest(e)}catch(t){r.setUiError("exc",t.message,1)}}i.setRef(n)}}};CABLES.OPS["678dec70-8c45-4f21-b9ed-019c99275c6e"]={f:Ops.Patch.PaZfgnp.Closest,objName:"Ops.Patch.PaZfgnp.Closest"};Ops.Vars.TriggerVarGetArray=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("Update"),r=t.outTrigger("Next"),a=t.outArray("Value");t.varName=t.inValueSelect("Variable",[],"",true);const o=new CABLES.VarGetOpWrapper(t,"array",t.varName,null);n.onTriggered=()=>{if(o&&o.variable)a.set(o.variable.getValue());r.trigger()}}};CABLES.OPS["39a006e8-bbc7-4d76-9617-c5611e498b71"]={f:Ops.Vars.TriggerVarGetArray,objName:"Ops.Vars.TriggerVarGetArray"};Ops.Trigger.TriggerOnChangeArray_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array"),r=t.outTrigger("Changed"),a=t.outArray("Result");n.onChange=function(){a.set(n.get());r.trigger()};t.init=()=>{if(n.get())r.trigger()}}};CABLES.OPS["cd51b224-eef4-4f32-a4ca-7d5a5a594b7a"]={f:Ops.Trigger.TriggerOnChangeArray_v2,objName:"Ops.Trigger.TriggerOnChangeArray_v2"};Ops.Number.TriggerOnChangeNumber_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inFloat("Value"),r=t.outTrigger("Next"),a=t.outNumber("Number");n.onChange=function(){a.set(n.get());r.trigger()};t.init=()=>{if(n.isLinked())r.trigger()}}};CABLES.OPS["63ec7ad7-a436-4f72-8b5e-257cc20049d4"]={f:Ops.Number.TriggerOnChangeNumber_v2,objName:"Ops.Number.TriggerOnChangeNumber_v2"};Ops.Team.ACAR.DataSet=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("HTML Element",null,"element");const r=t.outObject("Dataset");n.onChange=a;function a(){let t=n.get();let e={};if(t)e=Object.assign({},t.dataset);r.setRef(e)}}};CABLES.OPS["898adc47-b9e5-4ce4-ad21-644984b44503"]={f:Ops.Team.ACAR.DataSet,objName:"Ops.Team.ACAR.DataSet"};Ops.Data.JsonPath.ObjectGetObjectByPath=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const i=o.inObject("Object"),s=o.inString("Path"),u=o.outObject("Output"),l=o.outBoolNum("Found");i.onChange=s.onChange=e;o.toWorkPortsNeedsString(s);s.setUiAttribs({stringTrim:true});function e(){const e=i.get();const n=s.get();o.setUiError("missing",null);o.setUiError("notiterable",null);if(e&&n){if(!Array.isArray(e)&&!(typeof e==="object")){l.set(false);o.setUiError("notiterable","input object of type "+typeof e+" is not traversable by path")}else{const r=n.split(".");o.setUiAttrib({extendTitle:r[r.length-1]+""});let t=p(n,e);if(t===undefined){const a="could not find element at path "+n;l.set(false);t=null;o.setUiError("missing",a,1)}else if(Array.isArray(t)||t===null||typeof t!=="object"){const a="element at path "+n+" is not an object";l.set(false);t=null;o.setUiError("missing",a,1)}else{l.set(true)}u.setRef(t)}}else{l.set(false)}}function p(t,e=self,n="."){const r=Array.isArray(t)?t:t.split(n);return r.reduce((t,e)=>{return t&&t[e]},e)}}};CABLES.OPS["574513c7-472b-433c-bf99-d906d3c737cd"]={f:Ops.Data.JsonPath.ObjectGetObjectByPath,objName:"Ops.Data.JsonPath.ObjectGetObjectByPath"};Ops.Patch.PaZfgnp.ElementEquals=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("HTML Element",null,"element");const r=t.inObject("HTML Element 2",null,"element");const a=t.outBoolNum("Equal");r.onChange=n.onChange=o;function o(){let t=n.get();let e=r.get();if(!t||!e){a.set(false)}else{a.set(t.isEqualNode(e))}}}};CABLES.OPS["8e35f8a9-90bb-4a85-adfa-c6d1a8e15efb"]={f:Ops.Patch.PaZfgnp.ElementEquals,objName:"Ops.Patch.PaZfgnp.ElementEquals"};Ops.Json.RouteObject=class extends CABLES.Op{constructor(){super(...arguments);const r=this;const t=r.attachments={};const a=10,e={},n=r.inInt("index"),o=r.inObject("Object in"),i=r.inObject("default object",e),s=u(e);n.onChange=o.onChange=i.onChange=p;l();p();function u(){let n=[];for(let e=0;e<a;e++){let t=r.outObject("Index "+e+" Object");n.push(t)}i.set(null);return n}function l(){let e=i.get();s.forEach(t=>{return t.set(null)});if(i.get()){s.forEach(t=>{return t.set(e)})}}function p(){l();let t=n.get();let e=o.get();t=Math.floor(t);t=c(t,0,a-1);s[t].setRef(e)}function c(t,e,n){return Math.min(Math.max(t,e),n)}}};CABLES.OPS["bc969951-32b5-4226-9944-80a719a65497"]={f:Ops.Json.RouteObject,objName:"Ops.Json.RouteObject"};Ops.Html.CSS.ElementRemoveClass=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("HTML Element",null,"element");const r=t.inString("Classname");const a=t.outArray("Classes");n.onChange=o;function o(){let t=n.get();if(!t||!r.get())return;t.classList.remove(r.get());a.setRef(Array.from(t.classList))}}};CABLES.OPS["d20ac27f-104b-451b-ae65-99284997e7fd"]={f:Ops.Html.CSS.ElementRemoveClass,objName:"Ops.Html.CSS.ElementRemoveClass"};Ops.Html.CSS.ElementAddClass=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inObject("HTML Element",null,"element");const r=t.inString("Classname");const a=t.outArray("Classes");n.onChange=o;function o(){let t=n.get();if(!t||!r.get())return;t.classList.add(r.get());a.setRef(Array.from(t.classList))}}};CABLES.OPS["3264d58e-4de2-47ca-a3dd-f604d18aafbf"]={f:Ops.Html.CSS.ElementAddClass,objName:"Ops.Html.CSS.ElementAddClass"};Ops.Json.SequenceObjects_v2=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=[];const r=[];for(let t=0;t<16;t++){const a=e.inObject("Number "+t,0);const o=e.outObject("Output "+t);a.changeAlways=true;n.push(o);r.push(a)}for(let t=0;t<r.length;t++){const a=r[t];a.onChange=function(){for(let t=0;t<n.length;t++)n[t].set(a.get())}}}};CABLES.OPS["76c7d6a7-64c9-4a95-bc92-c68213601d28"]={f:Ops.Json.SequenceObjects_v2,objName:"Ops.Json.SequenceObjects_v2"};Ops.String.Concat_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inString("string1","ABC"),a=t.inString("string2","XYZ"),o=t.inValueBool("New Line",false),i=t.inBool("Active",true),s=t.outString("result");o.onChange=a.onChange=r.onChange=i.onChange=n;t.toWorkPortsNeedsString(r,a);n();function n(){if(!i.get()){return s.set(r.get())}let t=r.get();let e=a.get();if(!t&&!e){s.set("");return}if(!t)t="";if(!e)e="";let n="";if(t&&e&&o.get())n="\n";s.set(String(t)+n+String(e))}}};CABLES.OPS["a52722aa-0ca9-402c-a844-b7e98a6c6e60"]={f:Ops.String.Concat_v2,objName:"Ops.String.Concat_v2"};Ops.Data.JsonPath.ObjectGetStringByPath=class extends CABLES.Op{constructor(){super(...arguments);const o=this;const t=o.attachments={};const i=o.inObject("Object"),s=o.inString("Path"),u=o.inBool("Output path if missing",false),l=o.outString("Output"),p=o.outBoolNum("Found");i.ignoreValueSerialize=true;i.onChange=s.onChange=u.onChange=e;o.toWorkPortsNeedsString(s);s.setUiAttribs({stringTrim:true});function e(){const e=i.get();const n=s.get();o.setUiError("missing",null);if(e&&n){if(!Array.isArray(e)&&!(typeof e==="object")){p.set(false);o.setUiError("notiterable","input object of type "+typeof e+" is not traversable by path")}else{o.setUiError("notiterable",null);let t=e[n];const r=n.split(".");o.setUiAttrib({extendTitle:r[r.length-1]+""});if(!t)t=c(n,e);if(t===undefined){const a="could not find element at path "+n;t=null;p.set(false);if(u.get()){t=n}else{t=null}o.setUiError("missing",a,1)}else{p.set(true);t=String(t)}l.set(t)}}else{p.set(false)}}function c(t,e=self,n="."){const r=Array.isArray(t)?t:t.split(n);return r.reduce((t,e)=>{return t&&t[e]},e)}}};CABLES.OPS["497a6b7c-e33c-45e4-8fb2-a9149d972b5b"]={f:Ops.Data.JsonPath.ObjectGetStringByPath,objName:"Ops.Data.JsonPath.ObjectGetStringByPath"};Ops.Array.SwitchArray=class extends CABLES.Op{constructor(){super(...arguments);const n=this;const t=n.attachments={};let e=n.inValueInt("Index");let r=[];let a=n.outArray("Result");e.onChange=o;for(let e=0;e<10;e++){let t=n.inArray("Array "+e);r.push(t);t.onChange=o}function o(){if(e.get()>=0&&r[e.get()]&&r[e.get()].isLinked()){a.setRef(r[e.get()].get())}else a.setRef([])}}};CABLES.OPS["3fab881c-c2cf-42a0-9c42-2d8edfd93f57"]={f:Ops.Array.SwitchArray,objName:"Ops.Array.SwitchArray"};Ops.Array.ArrayGetString=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("array"),r=t.inValueInt("index"),a=t.outString("result");n.ignoreValueSerialize=true;n.onChange=r.onChange=o;function o(){const t=n.get();if(t)a.set(t[r.get()])}}};CABLES.OPS["be8f16c0-0c8a-48a2-a92b-45dbf88c76c1"]={f:Ops.Array.ArrayGetString,objName:"Ops.Array.ArrayGetString"};Ops.Patch.PaZfgnp.GetValuesFromArrayOfObjects=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const u=t.inArray("Array"),l=t.inString("Key"),p=t.inBool("Numbers Only",false),c=t.inBool("Remove empty/invalid",false),b=t.outArray("Result");c.onChange=l.onChange=u.onChange=p.onChange=n;l.setUiAttribs({stringTrim:true,minLength:1});function n(){const e=u.get();if(!e){b.set(null);return}const n=[];const r=l.get();const a=p.get();t.setUiAttrib({extendTitle:l.get()});const o=c.get();for(let t=0;t<e.length;t++){const i=e[t];if(i){if(!(r in i))continue;const s=i[r];if(o){if(s===""||s===null||s===undefined)continue}if(a){if(CABLES.UTILS.isNumeric(s))n.push(parseFloat(s));else n.push(0)}else{n.push(s)}}}b.setRef(n)}}};CABLES.OPS["f257f13f-996b-41c2-a63b-438888920704"]={f:Ops.Patch.PaZfgnp.GetValuesFromArrayOfObjects,objName:"Ops.Patch.PaZfgnp.GetValuesFromArrayOfObjects"};Ops.Math.Clamp=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inValueFloat("val",.5),r=t.inValueFloat("min",0),a=t.inValueFloat("max",1),o=t.inValueBool("ignore outside values"),i=t.outNumber("result");n.onChange=r.onChange=a.onChange=s;function s(){if(o.get()){if(n.get()>a.get())return;if(n.get()<r.get())return}i.set(Math.min(Math.max(n.get(),r.get()),a.get()))}}};CABLES.OPS["cda1a98e-5e16-40bd-9b18-a67e9eaad5a1"]={f:Ops.Math.Clamp,objName:"Ops.Math.Clamp"};Ops.Gl.Meshes.Circle_v3=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTrigger("render"),w=t.inValue("radius",.5),T=t.inValueSlider("innerRadius",0),E=t.inValueInt("segments",40),V=t.inValueSlider("percent",1),P=t.inValue("steps",0),z=t.inValueBool("invertSteps",false),R=t.inSwitch("mapping",["flat","round"]),L=t.inValueBool("Spline",false),r=t.inValueBool("Draw",true),a=t.outTrigger("trigger"),M=t.outObject("geometry",null,"geometry");t.setPortGroup("Size",[w,T]);t.setPortGroup("Display",[V,P,z]);t.toWorkShouldNotBeChild("Ops.Gl.TextureEffects.ImageCompose",CABLES.OP_PORT_TYPE_FUNCTION);r.setUiAttribs({title:"Render mesh"});R.set("flat");R.onChange=E.onChange=w.onChange=T.onChange=V.onChange=P.onChange=z.onChange=L.onChange=c;M.ignoreValueSerialize=true;const o=t.patch.cgl;let q=new CGL.Geometry("circle");let B=null;const i=-1;let s=0;let u=null;let D=true;n.onTriggered=l;t.onDelete=function(){if(B)B.dispose()};t.preRender=()=>{l()};n.onLinkChanged=function(){if(!n.isLinked())M.set(null);else M.setRef(q)};function l(){if(!t.patch.cg)return;if(D)p();if(!CGL.TextureEffect.checkOpNotInTextureEffect(t))return;u=t.patch.cg.getShader();if(!u)return;s=u.glPrimitive;if(L.get())u.glPrimitive=o.gl.LINE_STRIP;if(r.get()&&B){B.render(u)}a.trigger();u.glPrimitive=s}function p(){const n=Math.max(3,Math.floor(E.get()));q.clear();const e=[];const r=[];const a=[];const o=[];const i=[];let s=0,u=0;let l=0,p=0;let c=0,b=0;let m=0,d=0;let f=0,g=0;let h=0,O=0;let v=0,j=0;let y=0,I=0;const A=Math.max(0,V.get());const x=[];if(L.get()){let t=0;let e=0;const k=[];for(s=0;s<=n*A;s++){u=360/n*s*CGL.DEG2RAD;y=Math.cos(u)*w.get();I=Math.sin(u)*w.get();j=.5;if(s>0){x.push(t);x.push(e);x.push(0);v=1-(s-1)/n;k.push(v,j)}x.push(y);x.push(I);x.push(0);t=y;e=I}q.setPointVertices(x)}else if(T.get()<=0){for(s=0;s<=n*A;s++){u=360/n*s*CGL.DEG2RAD;y=Math.cos(u)*w.get();I=Math.sin(u)*w.get();if(R.get()=="flat"){v=(Math.cos(u)+1)/2;j=1-(Math.sin(u)+1)/2;h=.5;O=.5}else if(R.get()=="round"){v=1-s/n;j=0;h=v;O=1}e.push([0,0,0],[l,p,0],[y,I,0]);r.push(h,O,c,b,v,j);a.push(0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0);i.push(0,-1,0,0,-1,0,0,-1,0);c=v;b=j;l=y;p=I}q=CGL.Geometry.buildFromFaces(e,"circle");q.vertexNormals=a;q.tangents=o;q.biTangents=i;q.texCoords=r}else{let t=0;const S=n*A;const _=0;for(s=0;s<=S;s++){t++;u=360/n*s*CGL.DEG2RAD;y=Math.cos(u)*w.get();I=Math.sin(u)*w.get();const N=Math.cos(u)*T.get()*w.get();const C=Math.sin(u)*T.get()*w.get();if(R.get()=="round"){v=1-s/n;j=0;h=v;O=1}if(P.get()===0||t%parseInt(P.get(),10)===0&&!z.get()||t%parseInt(P.get(),10)!==0&&z.get()){e.push([N,C,0],[l,p,0],[y,I,0]);e.push([m,d,0],[l,p,0],[N,C,0]);r.push(v,0,c,0,h,1,v,1,c,0,f,1);a.push(0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1);o.push(1,0,0,1,0,0,1,0,0,1,0,0,1,0,0,1,0,0);i.push(0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1,0,0,-1)}f=h;g=O;c=v;b=j;l=y;p=I;m=N;d=C}q=CGL.Geometry.buildFromFaces(e,"circle");q.vertexNormals=a;q.tangents=o;q.biTangents=i;if(R.get()=="flat")q.mapTexCoords2d();else q.texCoords=r}M.setRef(q);if(q.vertices.length==0)return;if(B)B.dispose();B=null;if(t.patch.cg)B=t.patch.cg.createMesh(q,{opId:t.id});D=false}function c(){D=true}}};CABLES.OPS["ae07830b-91c3-4cbe-a7d6-d3b737392c16"]={f:Ops.Gl.Meshes.Circle_v3,objName:"Ops.Gl.Meshes.Circle_v3"};Ops.Array.Array4GetNumbers=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inArray("Array"),r=t.inValueInt("Index"),a=t.outNumber("X"),o=t.outNumber("Y"),i=t.outNumber("Z"),s=t.outNumber("W");n.onChange=r.onChange=u;function u(){let t=n.get();if(!t){a.set(0);o.set(0);i.set(0);s.set(0);return}let e=Math.min(t.length-4,r.get()*4);if(t&&t.length>e+3){a.set(t[e+0]);o.set(t[e+1]);i.set(t[e+2]);s.set(t[e+3])}}}};CABLES.OPS["95e5c82e-6cc2-4cd3-9f68-f94062e620fa"]={f:Ops.Array.Array4GetNumbers,objName:"Ops.Array.Array4GetNumbers"};Ops.Gl.BlendMode=class extends CABLES.Op{constructor(){super(...arguments);const e=this;const t=e.attachments={};const n=e.inTrigger("Render"),r=e.inValueSelect("Blendmode",["None","Normal","Add","Subtract","Multiply"],"Normal"),a=e.inValueBool("Premultiplied"),o=e.outTrigger("Next");const i=e.patch.cgl;let s=0;r.onChange=u;u();function u(){if(r.get()=="Normal")s=CGL.BLEND_NORMAL;else if(r.get()=="Add")s=CGL.BLEND_ADD;else if(r.get()=="Subtract")s=CGL.BLEND_SUB;else if(r.get()=="Multiply")s=CGL.BLEND_MUL;else s=CGL.BLEND_NONE;if(CABLES.UI){let t="";if(r.get()=="Normal")t="";else if(r.get()=="Add")t="Add";else if(r.get()=="Subtract")t="Sub";else if(r.get()=="Multiply")t="Mul";else t="None";e.setUiAttrib({extendTitle:t})}}n.onTriggered=function(){i.pushBlendMode(s,a.get());i.pushBlend(s!=CGL.BLEND_NONE);o.trigger();i.popBlend();i.popBlendMode();i.gl.blendEquationSeparate(i.gl.FUNC_ADD,i.gl.FUNC_ADD);i.gl.blendFuncSeparate(i.gl.SRC_ALPHA,i.gl.ONE_MINUS_SRC_ALPHA,i.gl.ONE,i.gl.ONE_MINUS_SRC_ALPHA)}}};CABLES.OPS["ce0fff72-1438-4373-924f-e1d0f78b053f"]={f:Ops.Gl.BlendMode,objName:"Ops.Gl.BlendMode"};Ops.Team.ACAR.PrepareNav=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const r=t.inArray("All Nodes");const a=t.inArray("Active Nodes");const o=t.inArray("Active Filters");const n=t.inTriggerButton("Rebuild");const i=t.outObject("Nav Structure");n.onTriggered=()=>{const t=r.get()||[];const l=o.get()||[];const n={id:"acar",title:"Artists Communities Archive  Rhineland",status:"selected",items:[{id:"gruppe",title:"Gruppen",colors:"gruppe",items:[],numEntities:t.filter(t=>{return t.entity==="gruppe"}).length,filterFields:{Gruppenname:{title:"Name",type:"text"},"Grndungsort":{title:"Grndungsort",type:"tag"},Gruppenart:{title:"Gruppenart",type:"tag"},Ziele:{title:"Ziele",type:"tag"}}},{id:"person",title:"Personen",colors:"person",items:[],numEntities:t.filter(t=>{return t.entity==="person"}).length,filterFields:{Name_str:{title:"Name",type:"text"},Geschlecht:{title:"Geschlecht",type:"choice"},Wirkungsorte:{title:"Wirkungsort",type:"tag"},Profession:{title:"Profession",type:"tag"},Ausbildung:{title:"Ausbildung",type:"tag"}}},{id:"ausstellung",title:"Ausstellungen",colors:"ausstellung",items:[],numEntities:t.filter(t=>{return t.entity==="ausstellung"}).length,filterFields:{Ausstellungsname:{title:"Name",type:"text"},"Grndungsdatum":{title:"Datum",type:"year"},Ausstellungsort:{title:"Ort",type:"tag"},Venue:{title:"Venue",type:"tag"},Thematik:{title:"Thematik",type:"tag"}}},{id:"publikation",title:"Publikationen",colors:"publikation",items:[],numEntities:t.filter(t=>{return t.entity==="publikation"}).length,filterFields:{Publikationsname:{title:"Name",type:"text"},Erscheinungsdatum:{title:"Erscheinungsdatum",type:"year"},Erscheinungsort:{title:"Erscheinungsort",type:"tag"},Thematik:{title:"Thematik",type:"tag"}}},{id:"uber-uns",itemType:"cms",title:"ber uns",status:"hidden"},{id:"uber-das-projekt",itemType:"cms",title:"ber das Project",status:"hidden"},{id:"kontakt",itemType:"cms",title:"Kontakt",status:"hidden"},{id:"impressum",itemType:"cms",title:"Impressum",status:"hidden"},{id:"datenschutz",itemType:"cms",title:"Datenschutz",status:"hidden"}]};const p=new Set;const e=a.get()||[];e.forEach(t=>{if(t.id)p.add(t.id)});t.forEach(o=>{const t=o.id;const e=o.name;const i=o.data;let s=n.items.find(t=>{return t.id===o.entity});if(s){if(o.filtered||p.has(o.id)){if(!s.hasOwnProperty("filteredEntities"))s.filteredEntities=0;s.filteredEntities++}const u=s.filterFields;for(let a in i){if(!u||u&&u.hasOwnProperty(a)){let t=a;let e="tag";if(u){t=u[a].title||a;e=u[a].type||"tag"}let r=s.items.find(t=>{return t.id===a});if(!r){r={id:a,title:t,type:e,textFilter:e==="text",items:[]};s.items.push(r)}let n=i[a];if(Array.isArray(n)){n.forEach(n=>{if(n){if(typeof n==="string")n=n.trim();if(["number","boolean","string"].includes(typeof n)){let t=false;let e=r.items.find(t=>{return t.id===n});if(!e){e={id:n,title:n,type:"filter",filter:s.id+"//"+r.id+"//"+n};t=true}if(l.length>0){if(!o.filtered&&!p.has(o.id)&&e.inactive!==false){e.status="inactive";e.inactive=true}else{e.status=null;e.inactive=false}if(l.includes(e.filter)){if(t){s.activeFilters=s.activeFilters++?s.activeFilters++:1;r.activeFilters=r.activeFilters++?r.activeFilters++:1}e.status="selected";s.status="selected";r.status="selected";e.selected=true}}if(t)r.items.push(e)}}})}else if(["number","boolean","string"].includes(typeof n)){if(typeof n==="string")n=n.trim();if(n){let t=false;let e=r.items.find(t=>{return t.id===n});if(!e){e={id:n,title:n,type:"filter",filter:s.id+"//"+r.id+"//"+n};t=true}if(l.length>0){if(!o.filtered&&!p.has(o.id)){e.status="inactive";e.inactive=true}if(l.includes(e.filter)){if(t){s.activeFilters=s.activeFilters++?s.activeFilters++:1;r.activeFilters=r.activeFilters++?r.activeFilters++:1}e.status="selected";e.status="selected";s.status="selected";r.status="selected";e.selected=true}}if(t)r.items.push(e)}}r.items=r.items.sort((t,e)=>{if(t.selected&&!e.selected)return-1;if(e.selected&&!t.selected)return 1;if(t.selected&&e.selected)return t.title.localeCompare(e.title);if(t.inactive&&!e.inactive)return 1;if(!t.inactive&&e.inactive)return-1;if(t.inactive&&e.inactive)return t.title.localeCompare(e.title);return t.title.localeCompare(e.title)})}}}});i.set(n)}}};CABLES.OPS["88c500b8-183a-41ff-8c5c-0015e443850e"]={f:Ops.Team.ACAR.PrepareNav,objName:"Ops.Team.ACAR.PrepareNav"};Ops.Ui.VizTrigger=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inTriggerButton("Trigger"),r=t.inTriggerButton("Reset"),l=t.inBool("Count Overlay",true),a=t.outNumber("Count");t.setUiAttrib({height:100,width:130,resizable:true});let p=0;let c=0;let o=0;r.onTriggered=()=>{c=0;if(!l.get())t.setUiAttrib({extendTitle:"_____"+String(c)});a.set(c)};n.onTriggered=()=>{p=performance.now();c++;if(!l.get())t.setUiAttrib({extendTitle:String(c)});a.set(c)};l.onChange=()=>{t.setUiAttrib({extendTitle:null})};t.renderVizLayer=(t,e)=>{t.fillStyle="#222";t.fillRect(e.x,e.y,e.width,e.height);let n=Math.min(e.height,e.width)/2.4*.8;let r=performance.now()-p;let a=CABLES.map(r,0,100,1,0);t.globalAlpha=a+.3;t.fillStyle="#ccc";let o=new Path2D;const i=a*6;o.arc(e.x+e.width/2,e.y+e.height/2,Math.abs(n-t.lineWidth/2+i*2),0,2*Math.PI,false);t.fill(o);t.globalAlpha=1;if(l.get()){const s=Math.min(e.height,e.width)/4;t.font=s+"px monospace";const u=t.measureText(String(c));t.fillStyle="#000";t.fillText(String(c),e.x+e.width/2-u.width/2,e.y+e.height/2+s/3)}}}};CABLES.OPS["4533060f-3cd4-4572-ac78-dad0710a3f7a"]={f:Ops.Ui.VizTrigger,objName:"Ops.Ui.VizTrigger"};Ops.String.Lowercase_v2=class extends CABLES.Op{constructor(){super(...arguments);const t=this;const e=t.attachments={};const n=t.inString("String"),r=t.outString("Result","");n.onChange=function(){if(n.get()==0)r.set("");else r.set((n.get()||"").toLowerCase())}}};CABLES.OPS["bff9c3d9-e63a-46d2-a59f-932c715aceab"]={f:Ops.String.Lowercase_v2,objName:"Ops.String.Lowercase_v2"};window.addEventListener("load",function(t){CABLES.jsLoaded=new Event("CABLES.jsLoaded");document.dispatchEvent(CABLES.jsLoaded)});(()=>{"use strict";var t={};const e=class{constructor(e,t,n,r,a,o){this._valuePort=n;this._varNamePort=r;this._op=e;this._type=t;this._typeId=-1;this._triggerPort=a;this._nextPort=o;this._btnCreate=e.inTriggerButton("Create new variable");this._btnCreate.setUiAttribs({hidePort:true});this._btnCreate.onTriggered=this._createVar.bind(this);this._helper=e.inUiTriggerButtons("",["Rename"]);this._helper.setUiAttribs({hidePort:true});this._helper.onTriggered=t=>{if(t=="Rename")CABLES.CMD.PATCH.renameVariable(e.varName.get())};this._op.setPortGroup("Variable",[this._helper,this._varNamePort,this._btnCreate]);r.setUiAttribs({_variableSelect:true});this._op.on("uiParamPanel",this._updateVarNamesDropdown.bind(this));this._op.patch.addEventListener("variablesChanged",this._updateName.bind(this));this._op.patch.addEventListener("variableRename",this._renameVar.bind(this));this._varNamePort.onChange=this._updateName.bind(this);this._isTexture=this._valuePort.uiAttribs.objType==="texture";this._valuePort.changeAlways=true;if(this._triggerPort){this._triggerPort.onTriggered=()=>{this._setVarValue(true)}}else{this._valuePort.onChange=this._setVarValue.bind(this)}this._op.init=()=>{this._updateName();if(!this._triggerPort)this._setVarValue();this._updateErrorUi()};if(t=="array")this._typeId=CABLES.Port.TYPE_ARRAY;else if(t=="object")this._typeId=CABLES.Port.TYPE_OBJECT;else if(t=="string")this._typeId=CABLES.Port.TYPE_STRING;else if(t=="texture")this._typeId=CABLES.Port.TYPE_TEXTURE;else this._typeId=CABLES.Port.TYPE_VALUE}_updateErrorUi(){if(CABLES.UI){if(!this._varNamePort.get())this._op.setUiError("novarname","no variable selected");else{if(this._op.hasUiErrors)this._op.setUiError("novarname",null)}}}_updateName(){const t=this._varNamePort.get();this._op.setTitle("var set");this._op.setUiAttrib({extendTitle:"#"+t});this._updateErrorUi();const e=this._op.patch.getVar(t);if(e&&!e.type)e.type=this._type;if(!this._op.patch.hasVar(t)&&t!=0&&!this._triggerPort){this._setVarValue()}if(!this._op.patch.hasVar(t)&&t!=0&&this._triggerPort){if(this._type=="string")this._op.patch.setVarValue(t,"");else if(this._type=="number")this._op.patch.setVarValue(t,"");else this._op.patch.setVarValue(t,null)}if(this._op.isCurrentUiOp()){this._updateVarNamesDropdown();this._op.refreshParams()}this._updateDisplay();this._op.patch.emitEvent("opVariableNameChanged",this._op,this._varNamePort.get())}_createVar(){CABLES.CMD.PATCH.createVariable(this._op,this._type,()=>{this._updateName()})}_updateDisplay(){this._valuePort.setUiAttribs({greyout:!this._varNamePort.get()})}_updateVarNamesDropdown(){if(CABLES.UI&&CABLES.UI.loaded&&CABLES.UI.loaded){const t=gui.uiProfiler.start("[vars] _updateVarNamesDropdown");const e=[];const n=this._op.patch.getVars();for(const r in n)if(n[r].type==this._type&&r!="0")e.push(r);this._varNamePort.uiAttribs.values=e;t.finish()}}_renameVar(t,e){if(t!=this._varNamePort.get())return;this._varNamePort.set(e);this._updateName()}_setVarValue(t){const e=this._varNamePort.get();if(!e)return;const n=this._valuePort.get();if(this._typeId==CABLES.Port.TYPE_VALUE||this._typeId==CABLES.Port.TYPE_STRING){this._op.patch.setVarValue(e,n)}else if(this._typeId==CABLES.Port.TYPE_ARRAY){this._arr=[];CABLES.copyArray(n,this._arr);this._op.patch.setVarValue(e,this._arr)}else{if(this._typeId==CABLES.Port.TYPE_OBJECT){if(this._isTexture)this._op.patch.setVarValue(e,CGL.Texture.getEmptyTexture(this._op.patch.cgl));else this._op.patch.setVarValue(e,null);if(n&&n.tex&&n._cgl&&!this._isTexture)this._op.setUiError("texobj","Dont use object variables for textures, use varSetTexture");else this._op.setUiError("texobj",null)}this._op.patch.setVarValue(e,n)}if(t&&this._nextPort)this._nextPort.trigger()}};const n=class{constructor(t,e,n,r){this._op=t;this._type=e;this._varnamePort=n;this._variable=null;this._valueOutPort=r;this._listenerId=null;this._op.on("uiParamPanel",this._updateVarNamesDropdown.bind(this));this._op.on("uiErrorChange",this._updateTitle.bind(this));this._op.patch.on("variableRename",this._renameVar.bind(this));this._op.patch.on("variableDeleted",t=>{if(this._op.isCurrentUiOp())this._op.refreshParams()});n.setUiAttribs({_variableSelect:true});n.setUiAttribs({_variableSelectGet:true});this._varnamePort.onChange=this._changeVar.bind(this);this._op.patch.addEventListener("variablesChanged",this._init.bind(this));this._op.onDelete=()=>{if(this._variable&&this._listenerId)this._variable.off(this._listenerId)};this._op.init=()=>{this._init()}}get variable(){return this._variable}_changeVar(){if(this._variable&&this._listenerId){this._variable.off(this._listenerId)}this._init()}_renameVar(t,e){if(t!=this._varnamePort.get())return;this._varnamePort.set(e);this._updateVarNamesDropdown();this._updateTitle();this._listenerId=this._variable.on("change",this._setValueOut.bind(this))}_updateVarNamesDropdown(){if(CABLES.UI&&CABLES.UI.loaded){const t=[];const e=this._op.patch.getVars();for(const n in e)if(e[n].type==this._type&&n!="0")t.push(n);this._op.varName.uiAttribs.values=t}}_setValueOut(t){if(this._valueOutPort)if(this._typeId==CABLES.Port.TYPE_ARRAY&&this._typeId==CABLES.Port.TYPE_OBJECT||this._isTexture)this._valueOutPort.setRef(t);else this._valueOutPort.set(t)}_updateTitle(){if(this._variable){this._op.setUiError("unknownvar",null);this._op.setTitle("var get");this._op.setUiAttrib({extendTitle:"#"+this._varnamePort.get()});if(this._valueOutPort)this._valueOutPort.set(this._variable.getValue())}else{this._op.setUiError("unknownvar","unknown variable! - there is no setVariable with this name ("+this._varnamePort.get()+")");this._op.setUiAttrib({extendTitle:"#invalid"});if(this._valueOutPort)this._valueOutPort.set(0)}}_init(){this._updateVarNamesDropdown();if(this._variable&&this._listenerId)this._variable.off(this._listenerId);this._variable=this._op.patch.getVar(this._op.varName.get());if(this._variable)this._listenerId=this._variable.on("change",this._setValueOut.bind(this));this._updateTitle();this._op.patch.emitEvent("opVariableNameChanged",this._op,this._varnamePort.get())}};CABLES.VarSetOpWrapper=e;CABLES.VarGetOpWrapper=n;((this.CABLES=this.CABLES||{}).COREMODULES=this.CABLES.COREMODULES||{}).Vargetset=t.Cables})();(()=>{"use strict";var t={};const e=class{constructor(n,t){t=t||{};this._op=n;n.patchId=n.addInPort(new CABLES.Port(n,"patchId",CABLES.OP_PORT_TYPE_STRING,{display:"readonly",hidePort:true,hideParam:true}));n.setUiAttribs({subPatchOp:{version:2}});if(n.uiAttribs.parentOfSubpatch){n.patchId.set(n.uiAttribs.parentOfSubpatch)}else{if(t.subId)n.patchId.set(t.subId);else n.patchId.set(CABLES.generateUUID())}n.patchId.onChange=()=>{if(t.subId)n.patchId.value=t.subId};n.init=()=>{n.setStorage({subPatchVer:2})};n.loadDependencies=(t,e)=>{if(CABLES.UI){gui.serverOps.loadProjectDependencies(t,()=>{if(e)e()})}else if(e)e()};n.on("delete",()=>{if(n.patch.clearSubPatchCache)n.patch.clearSubPatchCache(this.patchId);const e=n.patch.ops;for(let t=e.length-1;t>=0;t--)if(e[t]&&e[t].uiAttribs&&e[t].uiAttribs.subPatch==n.patchId.get())n.patch.deleteOp(e[t].id)});this._op.isExposableSubpatchOp=()=>{return true}}get patchId(){return this._op.patchId.get()}};CABLES.SubPatchOp=e;((this.CABLES=this.CABLES||{}).COREMODULES=this.CABLES.COREMODULES||{}).Subpatchop=t.Cables})();(()=>{"use strict";var t={};class e{constructor(){this._simpleIdCounter=0}uuid(){let n=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=(n+Math.random()*16)%16|0;n=Math.floor(n/16);return(t==="x"?e:e&3|8).toString(16)})}isNumeric(t){const e=parseFloat(t);return!isNaN(e)&&isFinite(e)}simpleId(){this._simpleIdCounter++;return this._simpleIdCounter}}const a=new e;class n{constructor(t,e){this.initiator=t;this._options=e}stack(t){console.info("["+this.initiator+"] ",t);console.log((new Error).stack)}groupCollapsed(t){if(CABLES.UI&&CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:0},...arguments)||!CABLES.logSilent)console.log("["+this.initiator+"]",...arguments);console.groupCollapsed("["+this.initiator+"] "+t)}table(t){console.table(t)}groupEnd(){console.groupEnd()}error(){if(CABLES.UI&&CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:2},...arguments)||!CABLES.UI){console.error("["+this.initiator+"]",...arguments)}if(this._options&&this._options.onError){this._options.onError(this.initiator,...arguments)}}errorGui(){if(CABLES.UI)CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:2},...arguments)}warn(){if(CABLES.UI&&CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:1},...arguments)||!CABLES.logSilent)console.warn("["+this.initiator+"]",...arguments)}verbose(){if(CABLES.UI&&CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:0},...arguments)||!CABLES.logSilent)console.log("["+this.initiator+"]",...arguments)}info(){if(CABLES.UI&&CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:0},...arguments)||!CABLES.logSilent)console.info("["+this.initiator+"]",...arguments)}log(){if(CABLES.UI&&CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:0},...arguments)||!CABLES.logSilent)console.log("["+this.initiator+"]",...arguments)}logGui(){if(CABLES.UI)CABLES.UI.logFilter.filterLog({initiator:this.initiator,level:0},...arguments)}userInteraction(t){}}class r{#eventLog;constructor(){this.#eventLog=new n("eventtarget");this._eventCallbacks={};this._logName="";this._logEvents=false;this._listeners={};this._countErrorUnknowns=0}on(t,e,n=""){const r={id:(n||"")+a.simpleId(),name:t,cb:e};if(!this._eventCallbacks[t])this._eventCallbacks[t]=[r];else this._eventCallbacks[t].push(r);this._listeners[r.id]=r;return r.id}addEventListener(t,e,n=""){return this.on(t,e,n)}hasEventListener(t,e=null){if(t&&!e){return!!this._listeners[t]}else{this.#eventLog.warn("old eventtarget function haseventlistener!");if(t&&e){if(this._eventCallbacks[t]){const n=this._eventCallbacks[t].indexOf(e);return n!==-1}}}}hasListenerForEventName(t){return this._eventCallbacks[t]&&this._eventCallbacks[t].length>0}removeEventListener(t){return this.off(t)}off(r){if(r===null||r===undefined){this.#eventLog.warn("removeEventListener id null",r);return}if(typeof r=="string"){const a=this._listeners[r];if(!a){if(this._countErrorUnknowns==20)this.#eventLog.warn("stopped reporting unknown events");if(this._countErrorUnknowns<20)this.#eventLog.warn("could not find event...",r);this._countErrorUnknowns++;return}let t=0;let n=true;while(n){n=false;let e=-1;for(let t=0;t<this._eventCallbacks[a.name].length;t++){if(this._eventCallbacks[a.name][t].id.indexOf(r)===0){n=true;e=t}}if(e!==-1){this._eventCallbacks[a.name].splice(e,1);delete this._listeners[r];t++}}if(t==0)console.log("no events removed",a.name,r);return}else{console.log("old function signature: removeEventListener! use listener id")}}logEvents(t,e){this._logEvents=t;this._logName=e}emitEvent(e,n=null,r=null,a=null,o=null,i=null,s=null){if(this._logEvents)this.#eventLog.log("[event] ",this._logName,e,this._eventCallbacks);if(this._eventCallbacks[e]){for(let t=0;t<this._eventCallbacks[e].length;t++){if(this._eventCallbacks[e][t]){this._eventCallbacks[e][t].cb(n,r,a,o,i,s)}}}else{if(this._logEvents)this.#eventLog.log("[event] has no event callback",e,this._eventCallbacks)}}}const o=class extends r{constructor(t){super();this._op=t;this._patch=t.patch;this._patch.plans=this._patch.plans||{};this.durationIn=.25;this.durationOut=.5;this._anims={};this._anims.__level=new CABLES.Anim;this._data=null;this._currentPlaceName="";this.setName("unknown");this._patch.emitEvent("plansChanged")}get currentPlaceName(){return this._currentPlaceName}setEasing(t,e){this.easingEnter=t;this.easingExit=e}update(){this._op.updatePlan()}setName(t){delete this._patch.plans[this.name];this.name=t;this._patch.plans[this.name]=this;this._patch.emitEvent("plansChanged")}getProgress(t){this._anims[t]=this._anims[t]||new CABLES.Anim;return this._anims[t].getValue(CABLES.now()/1e3)}_animPlace(t,e,n){let r=this.durationIn;this._anims[t]=this._anims[t]||new CABLES.Anim;if(n==0){r=this.durationOut;this._anims[t].defaultEasing=this.easingExit}else{r=this.durationIn;this._anims[t].defaultEasing=this.easingEnter}this._anims[t].clear();this._anims[t].setValue(CABLES.now()/1e3,e);this._anims[t].setValue(CABLES.now()/1e3+r,n)}setCurrentPlaceName(t){this._animPlace("__levelAnim"+this.getCurrentPlace().level,1,0);this._animPlace(this._currentPlaceName,1,0);this._animPlace(t,0,1);this._currentPlaceName=t;this._animPlace("__level",this._anims.__level.getValue(CABLES.now()/1e3),this.getCurrentPlace().level);this._animPlace("__levelAnim"+this.getCurrentPlace().level,0,1);this.emitEvent("stateChanged")}getCurrentPlaceName(){const t=this.getCurrentPlace();if(t)return t.name}getCurrentPlaceLevel(){return this.getCurrentPlace().level||0}getCurrentPlace(){if(!this._data)return{name:"no plan data"};for(let t=0;t<this._data.places.length;t++){const e=this._data.places[t];if(e.name==this._currentPlaceName)return e}return{name:""}}getCurrentExitNames(){const t=this.getCurrentPlace();const e=[];for(const n in t.exits)e.push(n);return e}getCurrentExits(){const t=this.getCurrentPlace();const e=[];return t.exits}gotoPlace(e){if(!this._data)return;for(let t=0;t<this._data.places.length;t++){const n=this._data.places[t];if(n.name==this._currentPlaceName){for(const r in n.exits){if(n.exits[r].place==e){this.setCurrentPlaceName(e);return}}break}}console.log("NO exit to "+e+" found :(")}useExit(e){if(!this._data)return;for(let t=0;t<this._data.places.length;t++){const n=this._data.places[t];if(n.name==this._currentPlaceName){for(const r in n.exits){if(r==e){this.setCurrentPlaceName(n.exits[r].place);return}}break}}console.log("exit "+e+" NOT found :(")}setData(t){this._data=t}getPlan(t,e){if(t.plans&&t.plans[e])return t.plans[e]}};CABLES.Plan=o;((this.CABLES=this.CABLES||{}).COREMODULES=this.CABLES.COREMODULES||{}).Plan=t.Cables})();(()=>{"use strict";var t={};class e{constructor(t,e,n){this.cgl=t;this._options=n;this.fb=null;let r=n.shader;this._useDefaultShader=true;if(n.shader)this._useDefaultShader=false;n.numRenderBuffers=n.numRenderBuffers||1;if(!r){r="".endl()+"IN vec2 texCoord;";for(let t=0;t<n.numRenderBuffers;t++){r=r.endl()+"UNI sampler2D tex"+t+";".endl()}r=r.endl()+"void main()".endl()+"{";if(n.numRenderBuffers==1){r=r.endl()+"    outColor= texture(tex0,texCoord);".endl()}else for(let t=0;t<n.numRenderBuffers;t++){r=r.endl()+"outColor"+t+" = texture(tex"+t+",texCoord);".endl()}r=r.endl()+"}"}const a=n.vertexShader||"".endl()+"IN vec3 vPosition;".endl()+"IN vec2 attrTexCoord;".endl()+"OUT vec2 texCoord;".endl()+"void main()".endl()+"{".endl()+"   texCoord=attrTexCoord;".endl()+"   gl_Position = vec4(vPosition,  1.0);".endl()+"}";this.bgShader=new CGL.Shader(t,"corelib copytexture "+e);this.bgShader.setSource(a,r);if(!n.vertexShader)this.bgShader.ignoreMissingUniforms=true;new CGL.Uniform(this.bgShader,"t","tex",0);new CGL.Uniform(this.bgShader,"t","tex1",1);new CGL.Uniform(this.bgShader,"t","tex2",2);new CGL.Uniform(this.bgShader,"t","tex3",3);this.mesh=CABLES.CGL.MESHES.getSimpleRect(this.cgl,"texEffectRect")}setSize(t,e){this._options.width=t;this._options.height=e}copy(t,e,n,r,a){const o=this.cgl;if(!t)t=CGL.Texture.getEmptyTexture(this.cgl);let i=this._options.width||t.width,s=this._options.height||t.height;if(this.fb){if(i<=0)i=8;if(s<=0)s=8;if(this.fb.getWidth()!=i||this.fb.getHeight()!=s)this.fb.setSize(i,s)}else{let t=CGL.Texture.FILTER_LINEAR;let e=CGL.Texture.WRAP_CLAMP_TO_EDGE;if(this._options.isFloatingPointTexture)t=CGL.Texture.FILTER_NEAREST;if(this._options.hasOwnProperty("filter"))t=this._options.filter;if(this._options.hasOwnProperty("wrap"))e=this._options.wrap;const u={isFloatingPointTexture:this._options.isFloatingPointTexture,pixelFormat:this._options.pixelFormat,numRenderBuffers:this._options.numRenderBuffers||1,filter:t,wrap:e};if(o.glVersion==1)this.fb=new CGL.Framebuffer(o,i,s,u);else this.fb=new CGL.Framebuffer2(o,i,s,u)}o.tempData.renderOffscreen=true;this.fb.renderStart(o);o.setTexture(0,t.tex);if(e)o.setTexture(1,e.tex);if(n)o.setTexture(2,n.tex);if(r)o.setTexture(3,r.tex);if(a)o.setTexture(4,a.tex);o.pushShader(this.bgShader);this.mesh.render(this.bgShader);o.popShader();this.fb.renderEnd();o.tempData.renderOffscreen=false;return this.fb.getTextureColor()}dispose(){if(this.fb)this.fb.dispose();if(this.bgShader)this.bgShader.dispose();if(this.mesh)this.mesh.dispose()}}CGL.CopyTexture=e;((this.CGL=this.CGL||{}).COREMODULES=this.CGL.COREMODULES||{}).Copytexture=t.Copytexture})();!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).d3=t.d3||{})}(this,function(s){"use strict";function u(t,e){return null==t||null==e?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function d(t,e){return null==t||null==e?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function f(n){let a,o,i;function s(t,e,n=0,r=t.length){if(n<r){if(0!==a(e,e))return r;do{const a=n+r>>>1;o(t[a],e)<0?n=a+1:r=a}while(n<r)}return n}return 2!==n.length?(a=u,o=(t,e)=>u(n(t),e),i=(t,e)=>n(t)-e):(a=n===u||n===d?n:g,o=n,i=n),{left:s,center:function(t,e,n=0,r=t.length){const a=s(t,e,n,r-1);return a>n&&i(t[a-1],e)>-i(t[a],e)?a-1:a},right:function(t,e,n=0,r=t.length){if(n<r){if(0!==a(e,e))return r;do{const a=n+r>>>1;o(t[a],e)<=0?n=a+1:r=a}while(n<r)}return n}}}function g(){return 0}function h(t){return null===t?NaN:+t}const v=f(u),A=v.right,x=v.left,k=f(h).center;var S=A;const _=C(W),N=C(function(t){const o=W(t);return(t,e,n,r,a)=>{o(t,e,(n<<=2)+0,(r<<=2)+0,a<<=2),o(t,e,n+1,r+1,a),o(t,e,n+2,r+2,a),o(t,e,n+3,r+3,a)}});function C(l){return function(t,e,n=e){if(!((e=+e)>=0))throw new RangeError("invalid rx");if(!((n=+n)>=0))throw new RangeError("invalid ry");let{data:r,width:a,height:o}=t;if(!((a=Math.floor(a))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(void 0!==o?o:r.length/a))>=0))throw new RangeError("invalid height");if(!a||!o||!e&&!n)return t;const i=e&&l(e),s=n&&l(n),u=r.slice();return i&&s?(w(i,u,r,a,o),w(i,r,u,a,o),w(i,u,r,a,o),J(s,r,u,a,o),J(s,u,r,a,o),J(s,r,u,a,o)):i?(w(i,r,u,a,o),w(i,u,r,a,o),w(i,r,u,a,o)):s&&(J(s,r,u,a,o),J(s,u,r,a,o),J(s,r,u,a,o)),t}}function w(n,r,a,o,i){for(let t=0,e=o*i;t<e;)n(r,a,t,t+=o,1)}function J(n,r,a,o,i){for(let t=0,e=o*i;t<o;++t)n(r,a,t,t+e,o)}function W(t){const e=Math.floor(t);if(e===t)return function(t){const l=2*t+1;return(n,r,a,o,i)=>{if(!((o-=i)>=a))return;let s=t*r[a];const u=i*t;for(let t=a,e=a+u;t<e;t+=i)s+=r[Math.min(o,t)];for(let t=a,e=o;t<=e;t+=i)s+=r[Math.min(o,t+u)],n[t]=s/l,s-=r[Math.max(a,t-u)]}}(t);const p=t-e,c=2*t+1;return(n,r,a,o,i)=>{if(!((o-=i)>=a))return;let s=e*r[a];const u=i*e,l=u+i;for(let t=a,e=a+u;t<e;t+=i)s+=r[Math.min(o,t)];for(let t=a,e=o;t<=e;t+=i)s+=r[Math.min(o,t+u)],n[t]=(s+p*(r[Math.max(a,t-l)]+r[Math.min(o,t+l)]))/c,s-=r[Math.max(a,t-u)]}}function Y(n,r){let a=0;if(void 0===r)for(let t of n)null!=t&&(t=+t)>=t&&++a;else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&(t=+t)>=t&&++a}return a}function $(t){return 0|t.length}function Q(t){return!(t>0)}function tt(t){return"object"!=typeof t||"length"in t?t:Array.from(t)}function et(n,r){let a,o=0,i=0,s=0;if(void 0===r)for(let t of n)null!=t&&(t=+t)>=t&&(a=t-i,i+=a/++o,s+=a*(t-i));else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&(t=+t)>=t&&(a=t-i,i+=a/++o,s+=a*(t-i))}if(o>1)return s/(o-1)}function nt(t,e){const n=et(t,e);return n?Math.sqrt(n):n}function rt(n,r){let a,o;if(void 0===r)for(const r of n)null!=r&&(void 0===a?r>=r&&(a=o=r):(a>r&&(a=r),o<r&&(o=r)));else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&(void 0===a?t>=t&&(a=o=t):(a>t&&(a=t),o<t&&(o=t)))}return[a,o]}class E{constructor(){this._partials=new Float64Array(32),this._n=0}add(a){const o=this._partials;let i=0;for(let r=0;r<this._n&&r<32;r++){const t=o[r],e=a+t,n=Math.abs(a)<Math.abs(t)?a-(e-t):t-(e-a);n&&(o[i++]=n),a=e}return o[i]=a,this._n=i+1,this}valueOf(){const t=this._partials;let e,n,r,a=this._n,o=0;if(a>0){for(o=t[--a];a>0&&(e=o,n=t[--a],o=e+n,r=n-(o-e),!r););a>0&&(r<0&&t[a-1]<0||r>0&&t[a-1]>0)&&(n=2*r,e=o+n,n==e-o&&(o=e))}return o}}class at extends Map{constructor(e,n=lt){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),null!=e)for(const[n,t]of e)this.set(n,t)}get(t){return super.get(it(this,t))}has(t){return super.has(it(this,t))}set(t,e){return super.set(st(this,t),e)}delete(t){return super.delete(ut(this,t))}}class ot extends Set{constructor(t,e=lt){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:e}}),null!=t)for(const e of t)this.add(e)}has(t){return super.has(it(this,t))}add(t){return super.add(st(this,t))}delete(t){return super.delete(ut(this,t))}}function it({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function st({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function ut({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function lt(t){return null!==t&&"object"==typeof t?t.valueOf():t}function pt(t){return t}function ct(t,...e){return ht(t,pt,pt,e)}function bt(t,...e){return ht(t,Array.from,pt,e)}function mt(n,r){for(let t=1,e=r.length;t<e;++t)n=n.flatMap(n=>n.pop().map(([t,e])=>[...n,t,e]));return n}function dt(t,e,...n){return ht(t,pt,e,n)}function ft(t,e,...n){return ht(t,Array.from,e,n)}function gt(t){if(1!==t.length)throw new Error("duplicate key");return t[0]}function ht(t,i,s,u){return function t(e,n){if(n>=u.length)return s(e);const r=new at,a=u[n++];let o=-1;for(const t of e){const i=a(t,++o,e),s=r.get(i);s?s.push(t):r.set(i,[t])}for(const[i,s]of r)r.set(i,t(s,n));return i(r)}(t,0)}function Ot(e,t){return Array.from(t,t=>e[t])}function vt(e,...r){if("function"!=typeof e[Symbol.iterator])throw new TypeError("values is not iterable");e=Array.from(e);let[n]=r;if(n&&2!==n.length||r.length>1){const t=Uint32Array.from(e,(t,e)=>e);return r.length>1?(r=r.map(t=>e.map(t)),t.sort((e,n)=>{for(const t of r){const r=yt(t[e],t[n]);if(r)return r}})):(n=e.map(n),t.sort((t,e)=>yt(n[t],n[e]))),Ot(e,t)}return e.sort(jt(n))}function jt(r=u){if(r===u)return yt;if("function"!=typeof r)throw new TypeError("compare is not a function");return(t,e)=>{const n=r(t,e);return n||0===n?n:(0===r(e,e))-(0===r(t,t))}}function yt(t,e){return(null==t||!(t>=t))-(null==e||!(e>=e))||(t<e?-1:t>e?1:0)}var It=Array.prototype.slice;function At(t){return()=>t}const xt=Math.sqrt(50),kt=Math.sqrt(10),St=Math.sqrt(2);function _t(t,e,n){const r=(e-t)/Math.max(0,n),a=Math.floor(Math.log10(r)),o=r/Math.pow(10,a),i=o>=xt?10:o>=kt?5:o>=St?2:1;let s,u,l;return a<0?(l=Math.pow(10,-a)/i,s=Math.round(t*l),u=Math.round(e*l),s/l<t&&++s,u/l>e&&--u,l=-l):(l=Math.pow(10,a)*i,s=Math.round(t/l),u=Math.round(e/l),s*l<t&&++s,u*l>e&&--u),u<s&&.5<=n&&n<2?_t(t,e,2*n):[s,u,l]}function Nt(t,e,n){if(!((n=+n)>0))return[];if((t=+t)===(e=+e))return[t];const r=e<t,[a,o,i]=r?_t(e,t,n):_t(t,e,n);if(!(o>=a))return[];const s=o-a+1,u=new Array(s);if(r)if(i<0)for(let t=0;t<s;++t)u[t]=(o-t)/-i;else for(let t=0;t<s;++t)u[t]=(o-t)*i;else if(i<0)for(let t=0;t<s;++t)u[t]=(a+t)/-i;else for(let t=0;t<s;++t)u[t]=(a+t)*i;return u}function Ct(t,e,n){return _t(t=+t,e=+e,n=+n)[2]}function wt(t,e,n){n=+n;const r=(e=+e)<(t=+t),a=r?Ct(e,t,n):Ct(t,e,n);return(r?-1:1)*(a<0?1/-a:a)}function Tt(e,n,r){let a;for(;;){const t=Ct(e,n,r);if(t===a||0===t||!isFinite(t))return[e,n];t>0?(e=Math.floor(e/t)*t,n=Math.ceil(n/t)*t):t<0&&(e=Math.ceil(e*t)/t,n=Math.floor(n*t)/t),a=t}}function Et(t){return Math.max(1,Math.ceil(Math.log(Y(t))/Math.LN2)+1)}function Vt(){var f=pt,g=rt,h=Et;function e(t){Array.isArray(t)||(t=Array.from(t));var e,n,r,a=t.length,o=new Array(a);for(e=0;e<a;++e)o[e]=f(t[e],e,t);var i=g(o),s=i[0],u=i[1],l=h(o,s,u);if(!Array.isArray(l)){const f=u,h=+l;if(g===rt&&([s,u]=Tt(s,u,h)),(l=Nt(s,u,h))[0]<=s&&(r=Ct(s,u,h)),l[l.length-1]>=u)if(f>=u&&g===rt){const f=Ct(s,u,h);isFinite(f)&&(f>0?u=(Math.floor(u/f)+1)*f:f<0&&(u=(Math.ceil(u*-f)+1)/-f))}else l.pop()}for(var p=l.length,c=0,b=p;l[c]<=s;)++c;for(;l[b-1]>u;)--b;(c||b<p)&&(l=l.slice(c,b),p=b-c);var m,d=new Array(p+1);for(e=0;e<=p;++e)(m=d[e]=[]).x0=e>0?l[e-1]:s,m.x1=e<p?l[e]:u;if(isFinite(r)){if(r>0)for(e=0;e<a;++e)null!=(n=o[e])&&s<=n&&n<=u&&d[Math.min(p,Math.floor((n-s)/r))].push(t[e]);else if(r<0)for(e=0;e<a;++e)if(null!=(n=o[e])&&s<=n&&n<=u){const f=Math.floor((s-n)*r);d[Math.min(p,f+(l[f]<=n))].push(t[e])}}else for(e=0;e<a;++e)null!=(n=o[e])&&s<=n&&n<=u&&d[S(l,n,0,p)].push(t[e]);return d}return e.value=function(t){return arguments.length?(f="function"==typeof t?t:At(t),e):f},e.domain=function(t){return arguments.length?(g="function"==typeof t?t:At([t[0],t[1]]),e):g},e.thresholds=function(t){return arguments.length?(h="function"==typeof t?t:At(Array.isArray(t)?It.call(t):t),e):h},e}function Pt(n,r){let a;if(void 0===r)for(const r of n)null!=r&&(a<r||void 0===a&&r>=r)&&(a=r);else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&(a<t||void 0===a&&t>=t)&&(a=t)}return a}function zt(e,n){let r,a=-1,o=-1;if(void 0===n)for(const n of e)++o,null!=n&&(r<n||void 0===r&&n>=n)&&(r=n,a=o);else for(let t of e)null!=(t=n(t,++o,e))&&(r<t||void 0===r&&t>=t)&&(r=t,a=o);return a}function Rt(n,r){let a;if(void 0===r)for(const r of n)null!=r&&(a>r||void 0===a&&r>=r)&&(a=r);else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&(a>t||void 0===a&&t>=t)&&(a=t)}return a}function Lt(e,n){let r,a=-1,o=-1;if(void 0===n)for(const n of e)++o,null!=n&&(r>n||void 0===r&&n>=n)&&(r=n,a=o);else for(let t of e)null!=(t=n(t,++o,e))&&(r>t||void 0===r&&t>=t)&&(r=t,a=o);return a}function Mt(o,i,s=0,u=1/0,l){if(i=Math.floor(i),s=Math.floor(Math.max(0,s)),u=Math.floor(Math.min(o.length-1,u)),!(s<=i&&i<=u))return o;for(l=void 0===l?yt:jt(l);u>s;){if(u-s>600){const t=u-s+1,e=i-s+1,n=Math.log(t),r=.5*Math.exp(2*n/3),a=.5*Math.sqrt(n*r*(t-r)/t)*(e-t/2<0?-1:1);Mt(o,i,Math.max(s,Math.floor(i-e*r/t+a)),Math.min(u,Math.floor(i+(t-e)*r/t+a)),l)}const t=o[i];let e=s,n=u;for(qt(o,s,i),l(o[u],t)>0&&qt(o,s,u);e<n;){for(qt(o,e,n),++e,--n;l(o[e],t)<0;)++e;for(;l(o[n],t)>0;)--n}0===l(o[s],t)?qt(o,s,n):(++n,qt(o,n,u)),n<=i&&(s=n+1),i<=n&&(u=n-1)}return o}function qt(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Bt(n,r=u){let a,o=!1;if(1===r.length){let e;for(const t of n){const n=r(t);(o?u(n,e)>0:0===u(n,n))&&(a=t,e=n,o=!0)}}else for(const u of n)(o?r(u,a)>0:0===r(u,u))&&(a=u,o=!0);return a}function Dt(t,e,n){if(t=Float64Array.from(function*(n,r){if(void 0===r)for(let t of n)null!=t&&(t=+t)>=t&&(yield t);else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&(t=+t)>=t&&(yield t)}}(t,n)),(r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return Rt(t);if(e>=1)return Pt(t);var r,a=(r-1)*e,o=Math.floor(a),i=Pt(Mt(t,o).subarray(0,o+1));return i+(Rt(t.subarray(o+1))-i)*(a-o)}}function Ut(t,e,n=h){if((r=t.length)&&!isNaN(e=+e)){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,a=(r-1)*e,o=Math.floor(a),i=+n(t[o],o,t);return i+(+n(t[o+1],o+1,t)-i)*(a-o)}}function Gt(n,t,r=h){if(!isNaN(t=+t)){if(a=Float64Array.from(n,(t,e)=>h(r(n[e],e,n))),t<=0)return Lt(a);if(t>=1)return zt(a);var a,e=Uint32Array.from(n,(t,e)=>e),o=a.length-1,i=Math.floor(o*t);return Mt(e,i,0,o,(t,e)=>yt(a[t],a[e])),(i=Bt(e.subarray(0,i+1),t=>a[t]))>=0?i:-1}}function Ft(t){return Array.from(function*(e){for(const t of e)yield*t}(t))}function Ht(t,e){return[t,e]}function Jt(t,e,n){t=+t,e=+e,n=(a=arguments.length)<2?(e=t,t=0,1):a<3?1:+n;for(var r=-1,a=0|Math.max(0,Math.ceil((e-t)/n)),o=new Array(a);++r<a;)o[r]=t+r*n;return o}function Kt(t,e=u){if(1===e.length)return Lt(t,e);let n,r=-1,a=-1;for(const u of t)++a,(r<0?0===e(u,u):e(u,n)<0)&&(n=u,r=a);return r}var Xt=Zt(Math.random);function Zt(o){return function(e,n=0,r=e.length){let a=r-(n=+n);for(;a;){const r=o()*a--|0,t=e[a+n];e[a+n]=e[r+n],e[r+n]=t}return e}}function Wt(t){if(!(a=t.length))return[];for(var e=-1,n=Rt(t,Yt),r=new Array(n);++e<n;)for(var a,o=-1,i=r[e]=new Array(a);++o<a;)i[o]=t[o][e];return r}function Yt(t){return t.length}function $t(t){return t instanceof ot?t:new ot(t)}function Qt(n,r){const a=n[Symbol.iterator](),o=new Set;for(const n of r){const r=te(n);if(o.has(r))continue;let t,e;for(;{value:t,done:e}=a.next();){if(e)return!1;const n=te(t);if(o.add(n),Object.is(r,n))break}}return!0}function te(t){return null!==t&&"object"==typeof t?t.valueOf():t}function ee(t){return t}var ne=1,re=2,ae=3,oe=4,ie=1e-6;function se(t){return"translate("+t+",0)"}function ue(t){return"translate(0,"+t+")"}function le(e){return t=>+e(t)}function pe(e,n){return n=Math.max(0,e.bandwidth()-2*n)/2,e.round()&&(n=Math.round(n)),t=>+e(t)+n}function ce(){return!this.__axis}function be(f,g){var h=[],O=null,v=null,j=6,y=6,I=3,A="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5,x=f===ne||f===oe?-1:1,k=f===oe||f===re?"x":"y",S=f===ne||f===ae?se:ue;function e(t){var e=null==O?g.ticks?g.ticks.apply(g,h):g.domain():O,n=null==v?g.tickFormat?g.tickFormat.apply(g,h):ee:v,r=Math.max(j,0)+I,a=g.range(),o=+a[0]+A,i=+a[a.length-1]+A,s=(g.bandwidth?pe:le)(g.copy(),A),u=t.selection?t.selection():t,l=u.selectAll(".domain").data([null]),p=u.selectAll(".tick").data(e,g).order(),c=p.exit(),b=p.enter().append("g").attr("class","tick"),m=p.select("line"),d=p.select("text");l=l.merge(l.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),p=p.merge(b),m=m.merge(b.append("line").attr("stroke","currentColor").attr(k+"2",x*j)),d=d.merge(b.append("text").attr("fill","currentColor").attr(k,x*r).attr("dy",f===ne?"0em":f===ae?"0.71em":"0.32em")),t!==u&&(l=l.transition(t),p=p.transition(t),m=m.transition(t),d=d.transition(t),c=c.transition(t).attr("opacity",ie).attr("transform",function(t){return isFinite(t=s(t))?S(t+A):this.getAttribute("transform")}),b.attr("opacity",ie).attr("transform",function(t){var e=this.parentNode.__axis;return S((e&&isFinite(e=e(t))?e:s(t))+A)})),c.remove(),l.attr("d",f===oe||f===re?y?"M"+x*y+","+o+"H"+A+"V"+i+"H"+x*y:"M"+A+","+o+"V"+i:y?"M"+o+","+x*y+"V"+A+"H"+i+"V"+x*y:"M"+o+","+A+"H"+i),p.attr("opacity",1).attr("transform",function(t){return S(s(t)+A)}),m.attr(k+"2",x*j),d.attr(k,x*r).text(n),u.filter(ce).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",f===re?"start":f===oe?"end":"middle"),u.each(function(){this.__axis=s})}return e.scale=function(t){return arguments.length?(g=t,e):g},e.ticks=function(){return h=Array.from(arguments),e},e.tickArguments=function(t){return arguments.length?(h=null==t?[]:Array.from(t),e):h.slice()},e.tickValues=function(t){return arguments.length?(O=null==t?null:Array.from(t),e):O&&O.slice()},e.tickFormat=function(t){return arguments.length?(v=t,e):v},e.tickSize=function(t){return arguments.length?(j=y=+t,e):j},e.tickSizeInner=function(t){return arguments.length?(j=+t,e):j},e.tickSizeOuter=function(t){return arguments.length?(y=+t,e):y},e.tickPadding=function(t){return arguments.length?(I=+t,e):I},e.offset=function(t){return arguments.length?(A=+t,e):A},e}var me={value:()=>{}};function de(){for(var t,e=0,n=arguments.length,r={};e<n;++e){if(!(t=arguments[e]+"")||t in r||/[\s.]/.test(t))throw new Error("illegal type: "+t);r[t]=[]}return new fe(r)}function fe(t){this._=t}function ge(t,e){for(var n,r=0,a=t.length;r<a;++r)if((n=t[r]).name===e)return n.value}function he(t,e,n){for(var r=0,a=t.length;r<a;++r)if(t[r].name===e){t[r]=me,t=t.slice(0,r).concat(t.slice(r+1));break}return null!=n&&t.push({name:e,value:n}),t}fe.prototype=de.prototype={constructor:fe,on:function(t,e){var n,r,a=this._,o=(r=a,(t+"").trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");if(n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),t&&!r.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:e}})),i=-1,s=o.length;if(!(arguments.length<2)){if(null!=e&&"function"!=typeof e)throw new Error("invalid callback: "+e);for(;++i<s;)if(n=(t=o[i]).type)a[n]=he(a[n],t.name,e);else if(null==e)for(n in a)a[n]=he(a[n],t.name,null);return this}for(;++i<s;)if((n=(t=o[i]).type)&&(n=ge(a[n],t.name)))return n},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new fe(t)},call:function(t,e){if((n=arguments.length-2)>0)for(var n,r,a=new Array(n),o=0;o<n;++o)a[o]=arguments[o+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=0,n=(r=this._[t]).length;o<n;++o)r[o].value.apply(e,a)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],a=0,o=r.length;a<o;++a)r[a].value.apply(e,n)}};var Oe="http://www.w3.org/1999/xhtml",ve={svg:"http://www.w3.org/2000/svg",xhtml:Oe,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function je(t){var e=t+="",n=e.indexOf(":");return n>=0&&"xmlns"!==(e=t.slice(0,n))&&(t=t.slice(n+1)),ve.hasOwnProperty(e)?{space:ve[e],local:t}:t}function ye(n){return function(){var t=this.ownerDocument,e=this.namespaceURI;return e===Oe&&t.documentElement.namespaceURI===Oe?t.createElement(n):t.createElementNS(e,n)}}function Ie(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ae(t){var e=je(t);return(e.local?Ie:ye)(e)}function xe(){}function ke(t){return null==t?xe:function(){return this.querySelector(t)}}function Se(t){return null==t?[]:Array.isArray(t)?t:Array.from(t)}function _e(){return[]}function Ne(t){return null==t?_e:function(){return this.querySelectorAll(t)}}function Ce(t){return function(){return this.matches(t)}}function we(e){return function(t){return t.matches(e)}}var Te=Array.prototype.find;function Ee(){return this.firstElementChild}var Ve=Array.prototype.filter;function Pe(){return Array.from(this.children)}function ze(t){return new Array(t.length)}function Re(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}function Le(t,e,n,r,a,o){for(var i,s=0,u=e.length,l=o.length;s<l;++s)(i=e[s])?(i.__data__=o[s],r[s]=i):n[s]=new Re(t,o[s]);for(;s<u;++s)(i=e[s])&&(a[s]=i)}function Me(t,e,n,r,a,o,i){var s,u,l,p=new Map,c=e.length,b=o.length,m=new Array(c);for(s=0;s<c;++s)(u=e[s])&&(m[s]=l=i.call(u,u.__data__,s,e)+"",p.has(l)?a[s]=u:p.set(l,u));for(s=0;s<b;++s)l=i.call(t,o[s],s,o)+"",(u=p.get(l))?(r[s]=u,u.__data__=o[s],p.delete(l)):n[s]=new Re(t,o[s]);for(s=0;s<c;++s)(u=e[s])&&p.get(m[s])===u&&(a[s]=u)}function qe(t){return t.__data__}function Be(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function De(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function Ue(t){return function(){this.removeAttribute(t)}}function Ge(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Fe(t,e){return function(){this.setAttribute(t,e)}}function He(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function Je(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttribute(e):this.setAttribute(e,t)}}function Ke(e,n){return function(){var t=n.apply(this,arguments);null==t?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,t)}}function Xe(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function Ze(t){return function(){this.style.removeProperty(t)}}function We(t,e,n){return function(){this.style.setProperty(t,e,n)}}function Ye(e,n,r){return function(){var t=n.apply(this,arguments);null==t?this.style.removeProperty(e):this.style.setProperty(e,t,r)}}function $e(t,e){return t.style.getPropertyValue(e)||Xe(t).getComputedStyle(t,null).getPropertyValue(e)}function Qe(t){return function(){delete this[t]}}function tn(t,e){return function(){this[t]=e}}function en(e,n){return function(){var t=n.apply(this,arguments);null==t?delete this[e]:this[e]=t}}function nn(t){return t.trim().split(/^|\s+/)}function rn(t){return t.classList||new an(t)}function an(t){this._node=t,this._names=nn(t.getAttribute("class")||"")}function on(t,e){for(var n=rn(t),r=-1,a=e.length;++r<a;)n.add(e[r])}function sn(t,e){for(var n=rn(t),r=-1,a=e.length;++r<a;)n.remove(e[r])}function un(t){return function(){on(this,t)}}function ln(t){return function(){sn(this,t)}}function pn(t,e){return function(){(e.apply(this,arguments)?on:sn)(this,t)}}function cn(){this.textContent=""}function bn(t){return function(){this.textContent=t}}function mn(e){return function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}}function dn(){this.innerHTML=""}function fn(t){return function(){this.innerHTML=t}}function gn(e){return function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}}function hn(){this.nextSibling&&this.parentNode.appendChild(this)}function On(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function vn(){return null}function jn(){var t=this.parentNode;t&&t.removeChild(this)}function yn(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function In(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function An(o){return function(){var t=this.__on;if(t){for(var e,n=0,r=-1,a=t.length;n<a;++n)e=t[n],o.type&&e.type!==o.type||e.name!==o.name?t[++r]=e:this.removeEventListener(e.type,e.listener,e.options);++r?t.length=r:delete this.__on}}}function xn(o,i,s){return function(){var t,e=this.__on,n=function(e){return function(t){e.call(this,t,this.__data__)}}(i);if(e)for(var r=0,a=e.length;r<a;++r)if((t=e[r]).type===o.type&&t.name===o.name)return this.removeEventListener(t.type,t.listener,t.options),this.addEventListener(t.type,t.listener=n,t.options=s),void(t.value=i);this.addEventListener(o.type,n,s),t={type:o.type,name:o.name,value:i,listener:n,options:s},e?e.push(t):this.__on=[t]}}function kn(t,e,n){var r=Xe(t),a=r.CustomEvent;"function"==typeof a?a=new a(e,n):(a=r.document.createEvent("Event"),n?(a.initEvent(e,n.bubbles,n.cancelable),a.detail=n.detail):a.initEvent(e,!1,!1)),t.dispatchEvent(a)}function Sn(t,e){return function(){return kn(this,t,e)}}function _n(t,e){return function(){return kn(this,t,e.apply(this,arguments))}}Re.prototype={constructor:Re,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}},an.prototype={add:function(t){this._names.indexOf(t)<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};var Nn=[null];function y(t,e){this._groups=t,this._parents=e}function Cn(){return new y([[document.documentElement]],Nn)}function D(t){return"string"==typeof t?new y([[document.querySelector(t)]],[document.documentElement]):new y([[t]],Nn)}y.prototype=Cn.prototype={constructor:y,select:function(t){"function"!=typeof t&&(t=ke(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var o,i,s=e[a],u=s.length,l=r[a]=new Array(u),p=0;p<u;++p)(o=s[p])&&(i=t.call(o,o.__data__,p,s))&&("__data__"in o&&(i.__data__=o.__data__),l[p]=i);return new y(r,this._parents)},selectAll:function(t){t="function"==typeof t?function(t){return function(){return Se(t.apply(this,arguments))}}(t):Ne(t);for(var e=this._groups,n=e.length,r=[],a=[],o=0;o<n;++o)for(var i,s=e[o],u=s.length,l=0;l<u;++l)(i=s[l])&&(r.push(t.call(i,i.__data__,l,s)),a.push(i));return new y(r,a)},selectChild:function(t){return this.select(null==t?Ee:function(t){return function(){return Te.call(this.children,t)}}("function"==typeof t?t:we(t)))},selectChildren:function(t){return this.selectAll(null==t?Pe:function(t){return function(){return Ve.call(this.children,t)}}("function"==typeof t?t:we(t)))},filter:function(t){"function"!=typeof t&&(t=Ce(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var o,i=e[a],s=i.length,u=r[a]=[],l=0;l<s;++l)(o=i[l])&&t.call(o,o.__data__,l,i)&&u.push(o);return new y(r,this._parents)},data:function(t,e){if(!arguments.length)return Array.from(this,qe);var n=e?Me:Le,r=this._parents,a=this._groups;"function"!=typeof t&&(t=function(t){return function(){return t}}(t));for(var o=a.length,i=new Array(o),s=new Array(o),u=new Array(o),l=0;l<o;++l){var p=r[l],c=a[l],b=c.length,m=Be(t.call(p,p&&p.__data__,l,r)),d=m.length,f=s[l]=new Array(d),g=i[l]=new Array(d);n(p,c,f,g,u[l]=new Array(b),m,e);for(var h,O,v=0,j=0;v<d;++v)if(h=f[v]){for(v>=j&&(j=v+1);!(O=g[j])&&++j<d;);h._next=O||null}}return(i=new y(i,r))._enter=s,i._exit=u,i},enter:function(){return new y(this._enter||this._groups.map(ze),this._parents)},exit:function(){return new y(this._exit||this._groups.map(ze),this._parents)},join:function(t,e,n){var r=this.enter(),a=this,o=this.exit();return"function"==typeof t?(r=t(r))&&(r=r.selection()):r=r.append(t+""),null!=e&&(a=e(a))&&(a=a.selection()),null==n?o.remove():n(o),r&&a?r.merge(a).order():a},merge:function(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,a=n.length,o=r.length,i=Math.min(a,o),s=new Array(a),u=0;u<i;++u)for(var l,p=n[u],c=r[u],b=p.length,m=s[u]=new Array(b),d=0;d<b;++d)(l=p[d]||c[d])&&(m[d]=l);for(;u<a;++u)s[u]=n[u];return new y(s,this._parents)},selection:function(){return this},order:function(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r,a=t[e],o=a.length-1,i=a[o];--o>=0;)(r=a[o])&&(i&&4^r.compareDocumentPosition(i)&&i.parentNode.insertBefore(r,i),i=r);return this},sort:function(n){function t(t,e){return t&&e?n(t.__data__,e.__data__):!t-!e}n||(n=De);for(var e=this._groups,r=e.length,a=new Array(r),o=0;o<r;++o){for(var i,s=e[o],u=s.length,l=a[o]=new Array(u),p=0;p<u;++p)(i=s[p])&&(l[p]=i);l.sort(t)}return new y(a,this._parents).order()},call:function(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this},nodes:function(){return Array.from(this)},node:function(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],a=0,o=r.length;a<o;++a){var i=r[a];if(i)return i}return null},size:function(){let e=0;for(const t of this)++e;return e},empty:function(){return!this.node()},each:function(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var a,o=e[n],i=0,s=o.length;i<s;++i)(a=o[i])&&t.call(a,a.__data__,i,o);return this},attr:function(t,e){var n=je(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((null==e?n.local?Ge:Ue:"function"==typeof e?n.local?Ke:Je:n.local?He:Fe)(n,e))},style:function(t,e,n){return arguments.length>1?this.each((null==e?Ze:"function"==typeof e?Ye:We)(t,e,null==n?"":n)):$e(this.node(),t)},property:function(t,e){return arguments.length>1?this.each((null==e?Qe:"function"==typeof e?en:tn)(t,e)):this.node()[t]},classed:function(t,e){var n=nn(t+"");if(arguments.length<2){for(var r=rn(this.node()),a=-1,o=n.length;++a<o;)if(!r.contains(n[a]))return!1;return!0}return this.each(("function"==typeof e?pn:e?un:ln)(n,e))},text:function(t){return arguments.length?this.each(null==t?cn:("function"==typeof t?mn:bn)(t)):this.node().textContent},html:function(t){return arguments.length?this.each(null==t?dn:("function"==typeof t?gn:fn)(t)):this.node().innerHTML},raise:function(){return this.each(hn)},lower:function(){return this.each(On)},append:function(t){var e="function"==typeof t?t:Ae(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})},insert:function(t,e){var n="function"==typeof t?t:Ae(t),r=null==e?vn:"function"==typeof e?e:ke(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})},remove:function(){return this.each(jn)},clone:function(t){return this.select(t?In:yn)},datum:function(t){return arguments.length?this.property("__data__",t):this.node().__data__},on:function(t,e,n){var r,a,o=function(t){return t.trim().split(/^|\s+/).map(function(t){var e="",n=t.indexOf(".");return n>=0&&(e=t.slice(n+1),t=t.slice(0,n)),{type:t,name:e}})}(t+""),i=o.length;if(!(arguments.length<2)){for(s=e?xn:An,r=0;r<i;++r)this.each(s(o[r],e,n));return this}var s=this.node().__on;if(s)for(var u,l=0,p=s.length;l<p;++l)for(r=0,u=s[l];r<i;++r)if((a=o[r]).type===u.type&&a.name===u.name)return u.value},dispatch:function(t,e){return this.each(("function"==typeof e?_n:Sn)(t,e))},[Symbol.iterator]:function*(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r,a=t[e],o=0,i=a.length;o<i;++o)(r=a[o])&&(yield r)}};var wn=0;function Tn(){return new En}function En(){this._="@"+(++wn).toString(36)}function Vn(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Pn(t,e){if(t=Vn(t),void 0===e&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,[(r=r.matrixTransform(e.getScreenCTM().inverse())).x,r.y]}if(e.getBoundingClientRect){var a=e.getBoundingClientRect();return[t.clientX-a.left-e.clientLeft,t.clientY-a.top-e.clientTop]}}return[t.pageX,t.pageY]}En.prototype=Tn.prototype={constructor:En,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};const zn={passive:!1},Rn={capture:!0,passive:!1};function Ln(t){t.stopImmediatePropagation()}function Mn(t){t.preventDefault(),t.stopImmediatePropagation()}function qn(t){var e=t.document.documentElement,n=D(t).on("dragstart.drag",Mn,Rn);"onselectstart"in e?n.on("selectstart.drag",Mn,Rn):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Bn(t,e){var n=t.document.documentElement,r=D(t).on("dragstart.drag",null);e&&(r.on("click.drag",Mn,Rn),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}var Dn=t=>()=>t;function Un(t,{sourceEvent:e,subject:n,target:r,identifier:a,active:o,x:i,y:s,dx:u,dy:l,dispatch:p}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:a,enumerable:!0,configurable:!0},active:{value:o,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:s,enumerable:!0,configurable:!0},dx:{value:u,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:p}})}function Gn(t){return!t.ctrlKey&&!t.button}function Fn(){return this.parentNode}function Hn(t,e){return null==e?{x:t.x,y:t.y}:e}function Jn(){return navigator.maxTouchPoints||"ontouchstart"in this}function Kn(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function Xn(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function Zn(){}Un.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};var Wn=.7,Yn=1/Wn,$n="\\s*([+-]?\\d+)\\s*",Qn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",tr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",er=/^#([0-9a-f]{3,8})$/,nr=new RegExp(`^rgb\\(${$n},${$n},${$n}\\)$`),rr=new RegExp(`^rgb\\(${tr},${tr},${tr}\\)$`),ar=new RegExp(`^rgba\\(${$n},${$n},${$n},${Qn}\\)$`),or=new RegExp(`^rgba\\(${tr},${tr},${tr},${Qn}\\)$`),ir=new RegExp(`^hsl\\(${Qn},${tr},${tr}\\)$`),sr=new RegExp(`^hsla\\(${Qn},${tr},${tr},${Qn}\\)$`),ur={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function lr(){return this.rgb().formatHex()}function pr(){return this.rgb().formatRgb()}function cr(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=er.exec(t))?(n=e[1].length,e=parseInt(e[1],16),6===n?br(e):3===n?new l(e>>8&15|e>>4&240,e>>4&15|240&e,(15&e)<<4|15&e,1):8===n?mr(e>>24&255,e>>16&255,e>>8&255,(255&e)/255):4===n?mr(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|240&e,((15&e)<<4|15&e)/255):null):(e=nr.exec(t))?new l(e[1],e[2],e[3],1):(e=rr.exec(t))?new l(255*e[1]/100,255*e[2]/100,255*e[3]/100,1):(e=ar.exec(t))?mr(e[1],e[2],e[3],e[4]):(e=or.exec(t))?mr(255*e[1]/100,255*e[2]/100,255*e[3]/100,e[4]):(e=ir.exec(t))?yr(e[1],e[2]/100,e[3]/100,1):(e=sr.exec(t))?yr(e[1],e[2]/100,e[3]/100,e[4]):ur.hasOwnProperty(t)?br(ur[t]):"transparent"===t?new l(NaN,NaN,NaN,0):null}function br(t){return new l(t>>16&255,t>>8&255,255&t,1)}function mr(t,e,n,r){return r<=0&&(t=e=n=NaN),new l(t,e,n,r)}function dr(t){return t instanceof Zn||(t=cr(t)),t?new l((t=t.rgb()).r,t.g,t.b,t.opacity):new l}function fr(t,e,n,r){return 1===arguments.length?dr(t):new l(t,e,n,null==r?1:r)}function l(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}function gr(){return`#${jr(this.r)}${jr(this.g)}${jr(this.b)}`}function hr(){const t=Or(this.opacity);return`${1===t?"rgb(":"rgba("}${vr(this.r)}, ${vr(this.g)}, ${vr(this.b)}${1===t?")":`, ${t})`}`}function Or(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function vr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function jr(t){return((t=vr(t))<16?"0":"")+t.toString(16)}function yr(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new xr(t,e,n,r)}function Ir(t){if(t instanceof xr)return new xr(t.h,t.s,t.l,t.opacity);if(t instanceof Zn||(t=cr(t)),!t)return new xr;if(t instanceof xr)return t;var e=(t=t.rgb()).r/255,n=t.g/255,r=t.b/255,a=Math.min(e,n,r),o=Math.max(e,n,r),i=NaN,s=o-a,u=(o+a)/2;return s?(i=e===o?(n-r)/s+6*(n<r):n===o?(r-e)/s+2:(e-n)/s+4,s/=u<.5?o+a:2-o-a,i*=60):s=u>0&&u<1?0:i,new xr(i,s,u,t.opacity)}function Ar(t,e,n,r){return 1===arguments.length?Ir(t):new xr(t,e,n,null==r?1:r)}function xr(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function kr(t){return(t=(t||0)%360)<0?t+360:t}function Sr(t){return Math.max(0,Math.min(1,t||0))}function _r(t,e,n){return 255*(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)}Kn(Zn,cr,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:lr,formatHex:lr,formatHex8:function(){return this.rgb().formatHex8()},formatHsl:function(){return Ir(this).formatHsl()},formatRgb:pr,toString:pr}),Kn(l,fr,Xn(Zn,{brighter(t){return t=null==t?Yn:Math.pow(Yn,t),new l(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=null==t?Wn:Math.pow(Wn,t),new l(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new l(vr(this.r),vr(this.g),vr(this.b),Or(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:gr,formatHex:gr,formatHex8:function(){return`#${jr(this.r)}${jr(this.g)}${jr(this.b)}${jr(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:hr,toString:hr})),Kn(xr,Ar,Xn(Zn,{brighter(t){return t=null==t?Yn:Math.pow(Yn,t),new xr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wn:Math.pow(Wn,t),new xr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+360*(this.h<0),e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,a=2*n-r;return new l(_r(t>=240?t-240:t+120,a,r),_r(t,a,r),_r(t<120?t+240:t-120,a,r),this.opacity)},clamp(){return new xr(kr(this.h),Sr(this.s),Sr(this.l),Or(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Or(this.opacity);return`${1===t?"hsl(":"hsla("}${kr(this.h)}, ${100*Sr(this.s)}%, ${100*Sr(this.l)}%${1===t?")":`, ${t})`}`}}));const Nr=Math.PI/180,Cr=180/Math.PI,wr=.96422,Tr=1,Er=.82521,Vr=4/29,Pr=6/29,zr=3*Pr*Pr,Rr=Pr*Pr*Pr;function Lr(t){if(t instanceof qr)return new qr(t.l,t.a,t.b,t.opacity);if(t instanceof Jr)return Kr(t);t instanceof l||(t=dr(t));var e,n,r=Gr(t.r),a=Gr(t.g),o=Gr(t.b),i=Br((.2225045*r+.7168786*a+.0606169*o)/Tr);return r===a&&a===o?e=n=i:(e=Br((.4360747*r+.3850649*a+.1430804*o)/wr),n=Br((.0139322*r+.0971045*a+.7141733*o)/Er)),new qr(116*i-16,500*(e-i),200*(i-n),t.opacity)}function Mr(t,e,n,r){return 1===arguments.length?Lr(t):new qr(t,e,n,null==r?1:r)}function qr(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}function Br(t){return t>Rr?Math.pow(t,1/3):t/zr+Vr}function Dr(t){return t>Pr?t*t*t:zr*(t-Vr)}function Ur(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Gr(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function Fr(t){if(t instanceof Jr)return new Jr(t.h,t.c,t.l,t.opacity);if(t instanceof qr||(t=Lr(t)),0===t.a&&0===t.b)return new Jr(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Cr;return new Jr(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function Hr(t,e,n,r){return 1===arguments.length?Fr(t):new Jr(t,e,n,null==r?1:r)}function Jr(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function Kr(t){if(isNaN(t.h))return new qr(t.l,0,0,t.opacity);var e=t.h*Nr;return new qr(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}Kn(qr,Mr,Xn(Zn,{brighter(t){return new qr(this.l+18*(null==t?1:t),this.a,this.b,this.opacity)},darker(t){return new qr(this.l-18*(null==t?1:t),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return new l(Ur(3.1338561*(e=wr*Dr(e))-1.6168667*(t=Tr*Dr(t))-.4906146*(n=Er*Dr(n))),Ur(-.9787684*e+1.9161415*t+.033454*n),Ur(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}})),Kn(Jr,Hr,Xn(Zn,{brighter(t){return new Jr(this.h,this.c,this.l+18*(null==t?1:t),this.opacity)},darker(t){return new Jr(this.h,this.c,this.l-18*(null==t?1:t),this.opacity)},rgb(){return Kr(this).rgb()}}));var Xr=-.14861,Zr=1.78277,Wr=-.29227,Yr=-.90649,$r=1.97294,Qr=$r*Yr,ta=$r*Zr,ea=Zr*Wr-Yr*Xr;function na(t,e,n,r){return 1===arguments.length?function(t){if(t instanceof ra)return new ra(t.h,t.s,t.l,t.opacity);t instanceof l||(t=dr(t));var e=t.r/255,n=t.g/255,r=t.b/255,a=(ea*r+Qr*e-ta*n)/(ea+Qr-ta),o=r-a,i=($r*(n-a)-Wr*o)/Yr,s=Math.sqrt(i*i+o*o)/($r*a*(1-a)),u=s?Math.atan2(i,o)*Cr-120:NaN;return new ra(u<0?u+360:u,s,a,t.opacity)}(t):new ra(t,e,n,null==r?1:r)}function ra(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}function aa(t,e,n,r,a){var o=t*t,i=o*t;return((1-3*t+3*o-i)*e+(4-6*o+3*i)*n+(1+3*t+3*o-3*i)*r+i*a)/6}function oa(i){var s=i.length-1;return function(t){var e=t<=0?t=0:t>=1?(t=1,s-1):Math.floor(t*s),n=i[e],r=i[e+1],a=e>0?i[e-1]:2*n-r,o=e<s-1?i[e+2]:2*r-n;return aa((t-e/s)*s,a,n,r,o)}}function ia(i){var s=i.length;return function(t){var e=Math.floor(((t%=1)<0?++t:t)*s),n=i[(e+s-1)%s],r=i[e%s],a=i[(e+1)%s],o=i[(e+2)%s];return aa((t-e/s)*s,n,r,a,o)}}Kn(ra,na,Xn(Zn,{brighter(t){return t=null==t?Yn:Math.pow(Yn,t),new ra(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=null==t?Wn:Math.pow(Wn,t),new ra(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*Nr,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),a=Math.sin(t);return new l(255*(e+n*(Xr*r+Zr*a)),255*(e+n*(Wr*r+Yr*a)),255*(e+n*($r*r)),this.opacity)}}));var sa=t=>()=>t;function ua(e,n){return function(t){return e+t*n}}function la(t,e){var n=e-t;return n?ua(t,n>180||n<-180?n-360*Math.round(n/360):n):sa(isNaN(t)?e:t)}function pa(n){return 1==(n=+n)?p:function(t,e){return e-t?function(e,n,r){return e=Math.pow(e,r),n=Math.pow(n,r)-e,r=1/r,function(t){return Math.pow(e+t*n,r)}}(t,e,n):sa(isNaN(t)?e:t)}}function p(t,e){var n=e-t;return n?ua(t,n):sa(isNaN(t)?e:t)}var ca=function t(e){var i=pa(e);function n(e,t){var n=i((e=fr(e)).r,(t=fr(t)).r),r=i(e.g,t.g),a=i(e.b,t.b),o=p(e.opacity,t.opacity);return function(t){return e.r=n(t),e.g=r(t),e.b=a(t),e.opacity=o(t),e+""}}return n.gamma=t,n}(1);function ba(s){return function(t){var e,n,r=t.length,a=new Array(r),o=new Array(r),i=new Array(r);for(e=0;e<r;++e)n=fr(t[e]),a[e]=n.r||0,o[e]=n.g||0,i[e]=n.b||0;return a=s(a),o=s(o),i=s(i),n.opacity=1,function(t){return n.r=a(t),n.g=o(t),n.b=i(t),n+""}}}var ma=ba(oa),da=ba(ia);function fa(e,n){n||(n=[]);var r,a=e?Math.min(n.length,e.length):0,o=n.slice();return function(t){for(r=0;r<a;++r)o[r]=e[r]*(1-t)+n[r]*t;return o}}function ga(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function ha(t,e){var n,r=e?e.length:0,a=t?Math.min(r,t.length):0,o=new Array(a),i=new Array(r);for(n=0;n<a;++n)o[n]=xa(t[n],e[n]);for(;n<r;++n)i[n]=e[n];return function(t){for(n=0;n<a;++n)i[n]=o[n](t);return i}}function Oa(e,n){var r=new Date;return e=+e,n=+n,function(t){return r.setTime(e*(1-t)+n*t),r}}function va(e,n){return e=+e,n=+n,function(t){return e*(1-t)+n*t}}function ja(t,e){var n,r={},a={};for(n in null!==t&&"object"==typeof t||(t={}),null!==e&&"object"==typeof e||(e={}),e)n in t?r[n]=xa(t[n],e[n]):a[n]=e[n];return function(t){for(n in r)a[n]=r[n](t);return a}}var ya=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ia=new RegExp(ya.source,"g");function Aa(t,r){var e,n,a,o=ya.lastIndex=Ia.lastIndex=0,i=-1,s=[],u=[];for(t+="",r+="";(e=ya.exec(t))&&(n=Ia.exec(r));)(a=n.index)>o&&(a=r.slice(o,a),s[i]?s[i]+=a:s[++i]=a),(e=e[0])===(n=n[0])?s[i]?s[i]+=n:s[++i]=n:(s[++i]=null,u.push({i:i,x:va(e,n)})),o=Ia.lastIndex;return o<r.length&&(a=r.slice(o),s[i]?s[i]+=a:s[++i]=a),s.length<2?u[0]?function(e){return function(t){return e(t)+""}}(u[0].x):function(t){return function(){return t}}(r):(r=u.length,function(t){for(var e,n=0;n<r;++n)s[(e=u[n]).i]=e.x(t);return s.join("")})}function xa(t,e){var n,r=typeof e;return null==e||"boolean"===r?sa(e):("number"===r?va:"string"===r?(n=cr(e))?(e=n,ca):Aa:e instanceof cr?ca:e instanceof Date?Oa:ga(e)?fa:Array.isArray(e)?ha:"function"!=typeof e.valueOf&&"function"!=typeof e.toString||isNaN(e)?ja:va)(t,e)}function ka(e,n){return e=+e,n=+n,function(t){return Math.round(e*(1-t)+n*t)}}var Sa,_a=180/Math.PI,Na={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Ca(t,e,n,r,a,o){var i,s,u;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(u=t*n+e*r)&&(n-=t*u,r-=e*u),(s=Math.sqrt(n*n+r*r))&&(n/=s,r/=s,u/=s),t*r<e*n&&(t=-t,e=-e,u=-u,i=-i),{translateX:a,translateY:o,rotate:Math.atan2(e,t)*_a,skewX:Math.atan(u)*_a,scaleX:i,scaleY:s}}function wa(n,s,u,i){function l(t){return t.length?t.pop()+" ":""}return function(t,e){var a=[],o=[];return t=n(t),e=n(e),function(t,e,n,r,a,o){if(t!==n||e!==r){var i=a.push("translate(",null,s,null,u);o.push({i:i-4,x:va(t,n)},{i:i-2,x:va(e,r)})}else(n||r)&&a.push("translate("+n+s+r+u)}(t.translateX,t.translateY,e.translateX,e.translateY,a,o),function(t,e,n,r){t!==e?(t-e>180?e+=360:e-t>180&&(t+=360),r.push({i:n.push(l(n)+"rotate(",null,i)-2,x:va(t,e)})):e&&n.push(l(n)+"rotate("+e+i)}(t.rotate,e.rotate,a,o),function(t,e,n,r){t!==e?r.push({i:n.push(l(n)+"skewX(",null,i)-2,x:va(t,e)}):e&&n.push(l(n)+"skewX("+e+i)}(t.skewX,e.skewX,a,o),function(t,e,n,r,a,o){if(t!==n||e!==r){var i=a.push(l(a)+"scale(",null,",",null,")");o.push({i:i-4,x:va(t,n)},{i:i-2,x:va(e,r)})}else 1===n&&1===r||a.push(l(a)+"scale("+n+","+r+")")}(t.scaleX,t.scaleY,e.scaleX,e.scaleY,a,o),t=e=null,function(t){for(var e,n=-1,r=o.length;++n<r;)a[(e=o[n]).i]=e.x(t);return a.join("")}}}var Ta=wa(function(t){const e=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Na:Ca(e.a,e.b,e.c,e.d,e.e,e.f)},"px, ","px)","deg)"),Ea=wa(function(t){return null==t?Na:(Sa||(Sa=document.createElementNS("http://www.w3.org/2000/svg","g")),Sa.setAttribute("transform",t),(t=Sa.transform.baseVal.consolidate())?Ca((t=t.matrix).a,t.b,t.c,t.d,t.e,t.f):Na)},", ",")",")");function Va(t){return((t=Math.exp(t))+1/t)/2}var Pa=function r(O,v,j){function t(t,e){var n,a,o=t[0],i=t[1],s=t[2],r=e[0],u=e[1],l=e[2],p=r-o,c=u-i,b=p*p+c*c;if(b<1e-12)a=Math.log(l/s)/O,n=function(t){return[o+t*p,i+t*c,s*Math.exp(O*t*a)]};else{var m=Math.sqrt(b),d=(l*l-s*s+j*b)/(2*s*v*m),f=(l*l-s*s-j*b)/(2*l*v*m),g=Math.log(Math.sqrt(d*d+1)-d),h=Math.log(Math.sqrt(f*f+1)-f);a=(h-g)/O,n=function(t){var e=t*a,n=Va(g),r=s/(v*m)*(n*function(t){return((t=Math.exp(2*t))-1)/(t+1)}(O*e+g)-function(t){return((t=Math.exp(t))-1/t)/2}(g));return[o+r*p,i+r*c,s*n/Va(O*e+g)]}}return n.duration=1e3*a*O/Math.SQRT2,n}return t.rho=function(t){var e=Math.max(.001,+t),n=e*e;return r(e,n,n*n)},t}(Math.SQRT2,2,4);function za(i){return function(e,t){var n=i((e=Ar(e)).h,(t=Ar(t)).h),r=p(e.s,t.s),a=p(e.l,t.l),o=p(e.opacity,t.opacity);return function(t){return e.h=n(t),e.s=r(t),e.l=a(t),e.opacity=o(t),e+""}}}var Ra=za(la),La=za(p);function Ma(i){return function(e,t){var n=i((e=Hr(e)).h,(t=Hr(t)).h),r=p(e.c,t.c),a=p(e.l,t.l),o=p(e.opacity,t.opacity);return function(t){return e.h=n(t),e.c=r(t),e.l=a(t),e.opacity=o(t),e+""}}}var qa=Ma(la),Ba=Ma(p);function Da(s){return function t(i){function e(e,t){var n=s((e=na(e)).h,(t=na(t)).h),r=p(e.s,t.s),a=p(e.l,t.l),o=p(e.opacity,t.opacity);return function(t){return e.h=n(t),e.s=r(t),e.l=a(Math.pow(t,i)),e.opacity=o(t),e+""}}return i=+i,e.gamma=t,e}(1)}var Ua=Da(la),Ga=Da(p);function Fa(t,e){void 0===e&&(e=t,t=xa);for(var n=0,r=e.length-1,a=e[0],o=new Array(r<0?0:r);n<r;)o[n]=t(a,a=e[++n]);return function(t){var e=Math.max(0,Math.min(r-1,Math.floor(t*=r)));return o[e](t-e)}}var Ha,Ja,Ka=0,Xa=0,Za=0,Wa=1e3,Ya=0,$a=0,Qa=0,to="object"==typeof performance&&performance.now?performance:Date,eo="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function no(){return $a||(eo(ro),$a=to.now()+Qa)}function ro(){$a=0}function ao(){this._call=this._time=this._next=null}function oo(t,e,n){var r=new ao;return r.restart(t,e,n),r}function io(){no(),++Ka;for(var t,e=Ha;e;)(t=$a-e._time)>=0&&e._call.call(void 0,t),e=e._next;--Ka}function so(){$a=(Ya=to.now())+Qa,Ka=Xa=0;try{io()}finally{Ka=0,function(){var t,e,n=Ha,r=1/0;for(;n;)n._call?(r>n._time&&(r=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:Ha=e);Ja=t,lo(r)}(),$a=0}}function uo(){var t=to.now(),e=t-Ya;e>Wa&&(Qa-=e,Ya=t)}function lo(t){Ka||(Xa&&(Xa=clearTimeout(Xa)),t-$a>24?(t<1/0&&(Xa=setTimeout(so,t-to.now()-Qa)),Za&&(Za=clearInterval(Za))):(Za||(Ya=to.now(),Za=setInterval(uo,Wa)),Ka=1,eo(so)))}function po(e,n,t){var r=new ao;return n=null==n?0:+n,r.restart(t=>{r.stop(),e(t+n)},n,t),r}ao.prototype=oo.prototype={constructor:ao,restart:function(t,e,n){if("function"!=typeof t)throw new TypeError("callback is not a function");n=(null==n?no():+n)+(null==e?0:+e),this._next||Ja===this||(Ja?Ja._next=this:Ha=this,Ja=this),this._call=t,this._time=n,lo()},stop:function(){this._call&&(this._call=null,this._time=1/0,lo())}};var co=de("start","end","cancel","interrupt"),bo=[],mo=0,fo=1,go=2,ho=3,Oo=4,vo=5,jo=6;function yo(t,e,n,r,a,o){var i=t.__transition;if(i){if(n in i)return}else t.__transition={};!function(o,i,s){var u,l=o.__transition;function t(t){s.state=fo,s.timer.restart(p,s.delay,s.time),s.delay<=t&&p(t-s.delay)}function p(t){var e,n,r,a;if(s.state!==fo)return b();for(e in l)if((a=l[e]).name===s.name){if(a.state===ho)return po(p);a.state===Oo?(a.state=jo,a.timer.stop(),a.on.call("interrupt",o,o.__data__,a.index,a.group),delete l[e]):+e<i&&(a.state=jo,a.timer.stop(),a.on.call("cancel",o,o.__data__,a.index,a.group),delete l[e])}if(po(function(){s.state===ho&&(s.state=Oo,s.timer.restart(c,s.delay,s.time),c(t))}),s.state=go,s.on.call("start",o,o.__data__,s.index,s.group),s.state===go){for(s.state=ho,u=new Array(r=s.tween.length),e=0,n=-1;e<r;++e)(a=s.tween[e].value.call(o,o.__data__,s.index,s.group))&&(u[++n]=a);u.length=n+1}}function c(t){for(var e=t<s.duration?s.ease.call(null,t/s.duration):(s.timer.restart(b),s.state=vo,1),n=-1,r=u.length;++n<r;)u[n].call(o,e);s.state===vo&&(s.on.call("end",o,o.__data__,s.index,s.group),b())}function b(){for(var t in s.state=jo,s.timer.stop(),delete l[i],l)return;delete o.__transition}l[i]=s,s.timer=oo(t,0,s.time)}(t,n,{name:e,index:r,group:a,on:co,tween:bo,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:mo})}function Io(t,e){var n=xo(t,e);if(n.state>mo)throw new Error("too late; already scheduled");return n}function Ao(t,e){var n=xo(t,e);if(n.state>ho)throw new Error("too late; already running");return n}function xo(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function ko(t,e){var n,r,a,o=t.__transition,i=!0;if(o){for(a in e=null==e?null:e+"",o)(n=o[a]).name===e?(r=n.state>go&&n.state<vo,n.state=jo,n.timer.stop(),n.on.call(r?"interrupt":"cancel",t,t.__data__,n.index,n.group),delete o[a]):i=!1;i&&delete t.__transition}}function So(a,o){var i,s;return function(){var t=Ao(this,a),e=t.tween;if(e!==i)for(var n=0,r=(s=i=e).length;n<r;++n)if(s[n].name===o){(s=s.slice()).splice(n,1);break}t.tween=s}}function _o(o,i,s){var u,l;if("function"!=typeof s)throw new Error;return function(){var t=Ao(this,o),e=t.tween;if(e!==u){l=(u=e).slice();for(var n={name:i,value:s},r=0,a=l.length;r<a;++r)if(l[r].name===i){l[r]=n;break}r===a&&l.push(n)}t.tween=l}}function No(t,e,n){var r=t._id;return t.each(function(){var t=Ao(this,r);(t.value||(t.value={}))[e]=n.apply(this,arguments)}),function(t){return xo(t,r).value[e]}}function Co(t,e){var n;return("number"==typeof e?va:e instanceof cr?ca:(n=cr(e))?(e=n,ca):Aa)(t,e)}function wo(t){return function(){this.removeAttribute(t)}}function To(t){return function(){this.removeAttributeNS(t.space,t.local)}}function Eo(e,n,r){var a,o,i=r+"";return function(){var t=this.getAttribute(e);return t===i?null:t===a?o:o=n(a=t,r)}}function Vo(e,n,r){var a,o,i=r+"";return function(){var t=this.getAttributeNS(e.space,e.local);return t===i?null:t===a?o:o=n(a=t,r)}}function Po(r,a,o){var i,s,u;return function(){var t,e,n=o(this);if(null!=n)return(t=this.getAttribute(r))===(e=n+"")?null:t===i&&e===s?u:(s=e,u=a(i=t,n));this.removeAttribute(r)}}function zo(r,a,o){var i,s,u;return function(){var t,e,n=o(this);if(null!=n)return(t=this.getAttributeNS(r.space,r.local))===(e=n+"")?null:t===i&&e===s?u:(s=e,u=a(i=t,n));this.removeAttributeNS(r.space,r.local)}}function Ro(e,n){var r,a;function t(){var t=n.apply(this,arguments);return t!==a&&(r=(a=t)&&function(e,n){return function(t){this.setAttributeNS(e.space,e.local,n.call(this,t))}}(e,t)),r}return t._value=n,t}function Lo(e,n){var r,a;function t(){var t=n.apply(this,arguments);return t!==a&&(r=(a=t)&&function(e,n){return function(t){this.setAttribute(e,n.call(this,t))}}(e,t)),r}return t._value=n,t}function Mo(t,e){return function(){Io(this,t).delay=+e.apply(this,arguments)}}function qo(t,e){return e=+e,function(){Io(this,t).delay=e}}function Bo(t,e){return function(){Ao(this,t).duration=+e.apply(this,arguments)}}function Do(t,e){return e=+e,function(){Ao(this,t).duration=e}}var Uo=Cn.prototype.constructor;function Go(t){return function(){this.style.removeProperty(t)}}var Fo=0;function Ho(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Jo(t){return Cn().transition(t)}function Ko(){return++Fo}var Xo=Cn.prototype;Ho.prototype=Jo.prototype={constructor:Ho,select:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=ke(t));for(var r=this._groups,a=r.length,o=new Array(a),i=0;i<a;++i)for(var s,u,l=r[i],p=l.length,c=o[i]=new Array(p),b=0;b<p;++b)(s=l[b])&&(u=t.call(s,s.__data__,b,l))&&("__data__"in s&&(u.__data__=s.__data__),c[b]=u,yo(c[b],e,n,b,c,xo(s,n)));return new Ho(o,this._parents,e,n)},selectAll:function(t){var e=this._name,n=this._id;"function"!=typeof t&&(t=Ne(t));for(var r=this._groups,a=r.length,o=[],i=[],s=0;s<a;++s)for(var u,l=r[s],p=l.length,c=0;c<p;++c)if(u=l[c]){for(var b,m=t.call(u,u.__data__,c,l),d=xo(u,n),f=0,g=m.length;f<g;++f)(b=m[f])&&yo(b,e,n,f,m,d);o.push(m),i.push(u)}return new Ho(o,i,e,n)},selectChild:Xo.selectChild,selectChildren:Xo.selectChildren,filter:function(t){"function"!=typeof t&&(t=Ce(t));for(var e=this._groups,n=e.length,r=new Array(n),a=0;a<n;++a)for(var o,i=e[a],s=i.length,u=r[a]=[],l=0;l<s;++l)(o=i[l])&&t.call(o,o.__data__,l,i)&&u.push(o);return new Ho(r,this._parents,this._name,this._id)},merge:function(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,a=n.length,o=Math.min(r,a),i=new Array(r),s=0;s<o;++s)for(var u,l=e[s],p=n[s],c=l.length,b=i[s]=new Array(c),m=0;m<c;++m)(u=l[m]||p[m])&&(b[m]=u);for(;s<r;++s)i[s]=e[s];return new Ho(i,this._parents,this._name,this._id)},selection:function(){return new Uo(this._groups,this._parents)},transition:function(){for(var t=this._name,e=this._id,n=Ko(),r=this._groups,a=r.length,o=0;o<a;++o)for(var i,s=r[o],u=s.length,l=0;l<u;++l)if(i=s[l]){var p=xo(i,e);yo(i,t,n,l,s,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Ho(r,this._parents,t,n)},call:Xo.call,nodes:Xo.nodes,node:Xo.node,size:Xo.size,empty:Xo.empty,each:Xo.each,on:function(t,e){var n=this._id;return arguments.length<2?xo(this.node(),n).on.on(t):this.each(function(n,r,a){var o,i,s=function(t){return(t+"").trim().split(/^|\s+/).every(function(t){var e=t.indexOf(".");return e>=0&&(t=t.slice(0,e)),!t||"start"===t})}(r)?Io:Ao;return function(){var t=s(this,n),e=t.on;e!==o&&(i=(o=e).copy()).on(r,a),t.on=i}}(n,t,e))},attr:function(t,e){var n=je(t),r="transform"===n?Ea:Co;return this.attrTween(t,"function"==typeof e?(n.local?zo:Po)(n,r,No(this,"attr."+t,e)):null==e?(n.local?To:wo)(n):(n.local?Vo:Eo)(n,r,e))},attrTween:function(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(null==e)return this.tween(n,null);if("function"!=typeof e)throw new Error;var r=je(t);return this.tween(n,(r.local?Ro:Lo)(r,e))},style:function(t,e,n){var r="transform"==(t+="")?Ta:Co;return null==e?this.styleTween(t,function(n,r){var a,o,i;return function(){var t=$e(this,n),e=(this.style.removeProperty(n),$e(this,n));return t===e?null:t===a&&e===o?i:i=r(a=t,o=e)}}(t,r)).on("end.style."+t,Go(t)):"function"==typeof e?this.styleTween(t,function(r,a,o){var i,s,u;return function(){var t=$e(this,r),e=o(this),n=e+"";return null==e&&(this.style.removeProperty(r),n=e=$e(this,r)),t===n?null:t===i&&n===s?u:(s=n,u=a(i=t,e))}}(t,r,No(this,"style."+t,e))).each(function(r,a){var o,i,s,u,l="style."+a,p="end."+l;return function(){var t=Ao(this,r),e=t.on,n=null==t.value[l]?u||(u=Go(a)):void 0;e===o&&s===n||(i=(o=e).copy()).on(p,s=n),t.on=i}}(this._id,t)):this.styleTween(t,function(e,n,r){var a,o,i=r+"";return function(){var t=$e(this,e);return t===i?null:t===a?o:o=n(a=t,r)}}(t,r,e),n).on("end.style."+t,null)},styleTween:function(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(null==e)return this.tween(r,null);if("function"!=typeof e)throw new Error;return this.tween(r,function(e,n,r){var a,o;function t(){var t=n.apply(this,arguments);return t!==o&&(a=(o=t)&&function(e,n,r){return function(t){this.style.setProperty(e,n.call(this,t),r)}}(e,t,r)),a}return t._value=n,t}(t,e,null==n?"":n))},text:function(t){return this.tween("text","function"==typeof t?function(e){return function(){var t=e(this);this.textContent=null==t?"":t}}(No(this,"text",t)):function(t){return function(){this.textContent=t}}(null==t?"":t+""))},textTween:function(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(null==t)return this.tween(e,null);if("function"!=typeof t)throw new Error;return this.tween(e,function(e){var n,r;function t(){var t=e.apply(this,arguments);return t!==r&&(n=(r=t)&&function(e){return function(t){this.textContent=e.call(this,t)}}(t)),n}return t._value=e,t}(t))},remove:function(){return this.on("end.remove",function(n){return function(){var t=this.parentNode;for(var e in this.__transition)if(+e!==n)return;t&&t.removeChild(this)}}(this._id))},tween:function(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r,a=xo(this.node(),n).tween,o=0,i=a.length;o<i;++o)if((r=a[o]).name===t)return r.value;return null}return this.each((null==e?So:_o)(n,t,e))},delay:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Mo:qo)(e,t)):xo(this.node(),e).delay},duration:function(t){var e=this._id;return arguments.length?this.each(("function"==typeof t?Bo:Do)(e,t)):xo(this.node(),e).duration},ease:function(t){var e=this._id;return arguments.length?this.each(function(t,e){if("function"!=typeof e)throw new Error;return function(){Ao(this,t).ease=e}}(e,t)):xo(this.node(),e).ease},easeVarying:function(t){if("function"!=typeof t)throw new Error;return this.each(function(e,n){return function(){var t=n.apply(this,arguments);if("function"!=typeof t)throw new Error;Ao(this,e).ease=t}}(this._id,t))},end:function(){var a,o,i=this,s=i._id,u=i.size();return new Promise(function(t,e){var n={value:e},r={value:function(){0==--u&&t()}};i.each(function(){var t=Ao(this,s),e=t.on;e!==a&&((o=(a=e).copy())._.cancel.push(n),o._.interrupt.push(n),o._.end.push(r)),t.on=o}),0===u&&t()})},[Symbol.iterator]:Xo[Symbol.iterator]};function Zo(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function Wo(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var Yo=function t(e){function n(t){return Math.pow(t,e)}return e=+e,n.exponent=t,n}(3),$o=function t(e){function n(t){return 1-Math.pow(1-t,e)}return e=+e,n.exponent=t,n}(3),Qo=function t(e){function n(t){return((t*=2)<=1?Math.pow(t,e):2-Math.pow(2-t,e))/2}return e=+e,n.exponent=t,n}(3),ti=Math.PI,ei=ti/2;function ni(t){return(1-Math.cos(ti*t))/2}function ri(t){return 1.0009775171065494*(Math.pow(2,-10*t)-.0009765625)}function ai(t){return((t*=2)<=1?ri(1-t):2-ri(t-1))/2}function oi(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var ii=4/11,si=6/11,ui=8/11,li=3/4,pi=9/11,ci=10/11,bi=15/16,mi=21/22,di=63/64,fi=1/ii/ii;function gi(t){return(t=+t)<ii?fi*t*t:t<ui?fi*(t-=si)*t+li:t<ci?fi*(t-=pi)*t+bi:fi*(t-=mi)*t+di}var hi=1.70158,Oi=function t(e){function n(t){return(t=+t)*t*(e*(t-1)+t)}return e=+e,n.overshoot=t,n}(hi),vi=function t(e){function n(t){return--t*t*((t+1)*e+t)+1}return e=+e,n.overshoot=t,n}(hi),ji=function t(e){function n(t){return((t*=2)<1?t*t*((e+1)*t-e):(t-=2)*t*((e+1)*t+e)+2)/2}return e=+e,n.overshoot=t,n}(hi),yi=2*Math.PI,Ii=function e(n,r){var a=Math.asin(1/(n=Math.max(1,n)))*(r/=yi);function t(t){return n*ri(- --t)*Math.sin((a-t)/r)}return t.amplitude=function(t){return e(t,r*yi)},t.period=function(t){return e(n,t)},t}(1,.3),Ai=function e(n,r){var a=Math.asin(1/(n=Math.max(1,n)))*(r/=yi);function t(t){return 1-n*ri(t=+t)*Math.sin((t+a)/r)}return t.amplitude=function(t){return e(t,r*yi)},t.period=function(t){return e(n,t)},t}(1,.3),xi=function e(n,r){var a=Math.asin(1/(n=Math.max(1,n)))*(r/=yi);function t(t){return((t=2*t-1)<0?n*ri(-t)*Math.sin((a-t)/r):2-n*ri(t)*Math.sin((a+t)/r))/2}return t.amplitude=function(t){return e(t,r*yi)},t.period=function(t){return e(n,t)},t}(1,.3),ki={time:null,delay:0,duration:250,ease:Wo};function Si(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}Cn.prototype.interrupt=function(t){return this.each(function(){ko(this,t)})},Cn.prototype.transition=function(t){var e,n;t instanceof Ho?(e=t._id,t=t._name):(e=Ko(),(n=ki).time=no(),t=null==t?null:t+"");for(var r=this._groups,a=r.length,o=0;o<a;++o)for(var i,s=r[o],u=s.length,l=0;l<u;++l)(i=s[l])&&yo(i,t,e,l,s,n||Si(i,e));return new Ho(r,this._parents,t,e)};var _i=[null];var Ni=t=>()=>t;function Ci(t,{sourceEvent:e,target:n,selection:r,mode:a,dispatch:o}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:a,enumerable:!0,configurable:!0},_:{value:o}})}function wi(t){t.preventDefault(),t.stopImmediatePropagation()}var Ti={name:"drag"},Ei={name:"space"},Vi={name:"handle"},Pi={name:"center"};const{abs:zi,max:U,min:G}=Math;function Ri(t){return[+t[0],+t[1]]}function Li(t){return[Ri(t[0]),Ri(t[1])]}var Mi={name:"x",handles:["w","e"].map(Ji),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},qi={name:"y",handles:["n","s"].map(Ji),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},Bi={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(Ji),input:function(t){return null==t?null:Li(t)},output:function(t){return t}},Di={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Ui={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},Gi={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},Fi={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},Hi={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function Ji(t){return{type:t}}function Ki(t){return!t.ctrlKey&&!t.button}function Xi(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function Zi(){return navigator.maxTouchPoints||"ontouchstart"in this}function Wi(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function Yi(z){var R,e=Xi,L=Ki,r=Zi,M=!0,a=de("start","brush","end"),n=6;function o(t){var e=t.property("__brush",p).selectAll(".overlay").data([Ji("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Di.overlay).merge(e).each(function(){var t=Wi(this).extent;D(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])}),t.selectAll(".selection").data([Ji("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Di.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var n=t.selectAll(".handle").data(z.handles,function(t){return t.type});n.exit().remove(),n.enter().append("rect").attr("class",function(t){return"handle handle--"+t.type}).attr("cursor",function(t){return Di[t.type]}),t.each(q).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",s).filter(r).on("touchstart.brush",s).on("touchmove.brush",u).on("touchend.brush touchcancel.brush",l).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function q(){var t=D(this),e=Wi(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",function(t){return"e"===t.type[t.type.length-1]?e[1][0]-n/2:e[0][0]-n/2}).attr("y",function(t){return"s"===t.type[0]?e[1][1]-n/2:e[0][1]-n/2}).attr("width",function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+n:n}).attr("height",function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+n:n})):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function B(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new i(t,e,n):r}function i(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function s(t){if((!R||t.touches)&&L.apply(this,arguments)){var a,o,i,s,u,l,p,c,n,b,m,d=this,f=t.target.__data__.type,g="selection"===(M&&t.metaKey?f="overlay":f)?Ti:M&&t.altKey?Pi:Vi,h=z===qi?null:Fi[f],O=z===Mi?null:Hi[f],v=Wi(d),e=v.extent,j=v.selection,y=e[0][0],I=e[0][1],A=e[1][0],x=e[1][1],k=0,S=0,r=h&&O&&M&&t.shiftKey,_=Array.from(t.touches||[t],t=>{const e=t.identifier;return(t=Pn(t,d)).point0=t.slice(),t.identifier=e,t});ko(d);var N=B(d,arguments,!0).beforestart();if("overlay"===f){j&&(n=!0);const R=[_[0],_[1]||_[0]];v.selection=j=[[a=z===qi?y:G(R[0][0],R[1][0]),i=z===Mi?I:G(R[0][1],R[1][1])],[u=z===qi?A:U(R[0][0],R[1][0]),p=z===Mi?x:U(R[0][1],R[1][1])]],_.length>1&&V(t)}else a=j[0][0],i=j[0][1],u=j[1][0],p=j[1][1];o=a,s=i,l=u,c=p;var C=D(d).attr("pointer-events","none"),w=C.selectAll(".overlay").attr("cursor",Di[f]);if(t.touches)N.moved=E,N.ended=P;else{var T=D(t.view).on("mousemove.brush",E,!0).on("mouseup.brush",P,!0);M&&T.on("keydown.brush",function(t){switch(t.keyCode){case 16:r=h&&O;break;case 18:g===Vi&&(h&&(u=l-k*h,a=o+k*h),O&&(p=c-S*O,i=s+S*O),g=Pi,V(t));break;case 32:g!==Vi&&g!==Pi||(h<0?u=l-k:h>0&&(a=o-k),O<0?p=c-S:O>0&&(i=s-S),g=Ei,w.attr("cursor",Di.selection),V(t));break;default:return}wi(t)},!0).on("keyup.brush",function(t){switch(t.keyCode){case 16:r&&(b=m=r=!1,V(t));break;case 18:g===Pi&&(h<0?u=l:h>0&&(a=o),O<0?p=c:O>0&&(i=s),g=Vi,V(t));break;case 32:g===Ei&&(t.altKey?(h&&(u=l-k*h,a=o+k*h),O&&(p=c-S*O,i=s+S*O),g=Pi):(h<0?u=l:h>0&&(a=o),O<0?p=c:O>0&&(i=s),g=Vi),w.attr("cursor",Di[f]),V(t));break;default:return}wi(t)},!0),qn(t.view)}q.call(d),N.start(t,g.name)}function E(e){for(const t of e.changedTouches||[e])for(const e of _)e.identifier===t.identifier&&(e.cur=Pn(t,d));if(r&&!b&&!m&&1===_.length){const e=_[0];zi(e.cur[0]-e[0])>zi(e.cur[1]-e[1])?m=!0:b=!0}for(const e of _)e.cur&&(e[0]=e.cur[0],e[1]=e.cur[1]);n=!0,wi(e),V(e)}function V(t){const e=_[0],n=e.point0;var r;switch(k=e[0]-n[0],S=e[1]-n[1],g){case Ei:case Ti:h&&(k=U(y-a,G(A-u,k)),o=a+k,l=u+k),O&&(S=U(I-i,G(x-p,S)),s=i+S,c=p+S);break;case Vi:_[1]?(h&&(o=U(y,G(A,_[0][0])),l=U(y,G(A,_[1][0])),h=1),O&&(s=U(I,G(x,_[0][1])),c=U(I,G(x,_[1][1])),O=1)):(h<0?(k=U(y-a,G(A-a,k)),o=a+k,l=u):h>0&&(k=U(y-u,G(A-u,k)),o=a,l=u+k),O<0?(S=U(I-i,G(x-i,S)),s=i+S,c=p):O>0&&(S=U(I-p,G(x-p,S)),s=i,c=p+S));break;case Pi:h&&(o=U(y,G(A,a-k*h)),l=U(y,G(A,u+k*h))),O&&(s=U(I,G(x,i-S*O)),c=U(I,G(x,p+S*O)))}l<o&&(h*=-1,r=a,a=u,u=r,r=o,o=l,l=r,f in Ui&&w.attr("cursor",Di[f=Ui[f]])),c<s&&(O*=-1,r=i,i=p,p=r,r=s,s=c,c=r,f in Gi&&w.attr("cursor",Di[f=Gi[f]])),v.selection&&(j=v.selection),b&&(o=j[0][0],l=j[1][0]),m&&(s=j[0][1],c=j[1][1]),j[0][0]===o&&j[0][1]===s&&j[1][0]===l&&j[1][1]===c||(v.selection=[[o,s],[l,c]],q.call(d),N.brush(t,g.name))}function P(t){if(function(t){t.stopImmediatePropagation()}(t),t.touches){if(t.touches.length)return;R&&clearTimeout(R),R=setTimeout(function(){R=null},500)}else Bn(t.view,n),T.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);C.attr("pointer-events","all"),w.attr("cursor",Di.overlay),v.selection&&(j=v.selection),function(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}(j)&&(v.selection=null,q.call(d)),N.end(t,g.name)}}function u(t){B(this,arguments).moved(t)}function l(t){B(this,arguments).ended(t)}function p(){var t=this.__brush||{selection:null};return t.extent=Li(e.apply(this,arguments)),t.dim=z,t}return o.move=function(t,s,o){t.tween?t.on("start.brush",function(t){B(this,arguments).beforestart().start(t)}).on("interrupt.brush end.brush",function(t){B(this,arguments).end(t)}).tween("brush",function(){var e=this,n=e.__brush,r=B(e,arguments),t=n.selection,a=z.input("function"==typeof s?s.apply(this,arguments):s,n.extent),o=xa(t,a);function i(t){n.selection=1===t&&null===a?null:o(t),q.call(e),r.brush()}return null!==t&&null!==a?i:i(1)}):t.each(function(){var t=this,e=arguments,n=t.__brush,r=z.input("function"==typeof s?s.apply(t,e):s,n.extent),a=B(t,e).beforestart();ko(t),n.selection=null===r?null:r,q.call(t),a.start(o).brush(o).end(o)})},o.clear=function(t,e){o.move(t,null,e)},i.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,e){return this.starting?(this.starting=!1,this.emit("start",t,e)):this.emit("brush",t),this},brush:function(t,e){return this.emit("brush",t,e),this},end:function(t,e){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,e)),this},emit:function(t,e,n){var r=D(this.that).datum();a.call(t,this.that,new Ci(t,{sourceEvent:e,target:o,selection:z.output(this.state.selection),mode:n,dispatch:a}),r)}},o.extent=function(t){return arguments.length?(e="function"==typeof t?t:Ni(Li(t)),o):e},o.filter=function(t){return arguments.length?(L="function"==typeof t?t:Ni(!!t),o):L},o.touchable=function(t){return arguments.length?(r="function"==typeof t?t:Ni(!!t),o):r},o.handleSize=function(t){return arguments.length?(n=+t,o):n},o.keyModifiers=function(t){return arguments.length?(M=!!t,o):M},o.on=function(){var t=a.on.apply(a,arguments);return t===a?o:t},o}var $i=Math.abs,Qi=Math.cos,ts=Math.sin,es=Math.PI,ns=es/2,rs=2*es,as=Math.max,os=1e-12;function is(n,t){return Array.from({length:t-n},(t,e)=>n+e)}function ss(l,p){var c=0,b=null,m=null,e=null;function r(r){var t,a=r.length,o=new Array(a),n=is(0,a),i=new Array(a*a),s=new Array(a),u=0;r=Float64Array.from({length:a*a},p?(t,e)=>r[e%a][e/a|0]:(t,e)=>r[e/a|0][e%a]);for(let n=0;n<a;++n){let e=0;for(let t=0;t<a;++t)e+=r[n*a+t]+l*r[t*a+n];u+=o[n]=e}t=(u=as(0,rs-c*a)/u)?c:rs/a;{let e=0;b&&n.sort((t,e)=>b(o[t],o[e]));for(const c of n){const b=e;if(l){const l=is(1+~a,a).filter(t=>t<0?r[~t*a+c]:r[c*a+t]);m&&l.sort((t,e)=>m(t<0?-r[~t*a+c]:r[c*a+t],e<0?-r[~e*a+c]:r[c*a+e]));for(const b of l)if(b<0){(i[~b*a+c]||(i[~b*a+c]={source:null,target:null})).target={index:c,startAngle:e,endAngle:e+=r[~b*a+c]*u,value:r[~b*a+c]}}else{(i[c*a+b]||(i[c*a+b]={source:null,target:null})).source={index:c,startAngle:e,endAngle:e+=r[c*a+b]*u,value:r[c*a+b]}}s[c]={index:c,startAngle:b,endAngle:e,value:o[c]}}else{const l=is(0,a).filter(t=>r[c*a+t]||r[t*a+c]);m&&l.sort((t,e)=>m(r[c*a+t],r[c*a+e]));for(const b of l){let t;if(c<b?(t=i[c*a+b]||(i[c*a+b]={source:null,target:null}),t.source={index:c,startAngle:e,endAngle:e+=r[c*a+b]*u,value:r[c*a+b]}):(t=i[b*a+c]||(i[b*a+c]={source:null,target:null}),t.target={index:c,startAngle:e,endAngle:e+=r[c*a+b]*u,value:r[c*a+b]},c===b&&(t.source=t.target)),t.source&&t.target&&t.source.value<t.target.value){const p=t.source;t.source=t.target,t.target=p}}s[c]={index:c,startAngle:b,endAngle:e,value:o[c]}}e+=t}}return(i=Object.values(i)).groups=s,e?i.sort(e):i}return r.padAngle=function(t){return arguments.length?(c=as(0,t),r):c},r.sortGroups=function(t){return arguments.length?(b=t,r):b},r.sortSubgroups=function(t){return arguments.length?(m=t,r):m},r.sortChords=function(t){return arguments.length?(null==t?e=null:(n=t,e=function(t,e){return n(t.source.value+t.target.value,e.source.value+e.target.value)})._=t,r):e&&e._;var n},r}const us=Math.PI,ls=2*us,ps=1e-6,cs=ls-ps;function bs(n){this._+=n[0];for(let t=1,e=n.length;t<e;++t)this._+=arguments[t]+n[t]}let ms=class{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=null==t?bs:function(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return bs;const r=10**e;return function(n){this._+=n[0];for(let t=1,e=n.length;t<e;++t)this._+=Math.round(arguments[t]*r)/r+n[t]}}(t)}moveTo(t,e){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,e){this._append`L${this._x1=+t},${this._y1=+e}`}quadraticCurveTo(t,e,n,r){this._append`Q${+t},${+e},${this._x1=+n},${this._y1=+r}`}bezierCurveTo(t,e,n,r,a,o){this._append`C${+t},${+e},${+n},${+r},${this._x1=+a},${this._y1=+o}`}arcTo(l,p,c,b,m){if(l=+l,p=+p,c=+c,b=+b,(m=+m)<0)throw new Error(`negative radius: ${m}`);let d=this._x1,f=this._y1,g=c-l,h=b-p,O=d-l,v=f-p,j=O*O+v*v;if(null===this._x1)this._append`M${this._x1=l},${this._y1=p}`;else if(j>ps)if(Math.abs(v*g-h*O)>ps&&m){let t=c-d,e=b-f,n=g*g+h*h,r=t*t+e*e,a=Math.sqrt(n),o=Math.sqrt(j),i=m*Math.tan((us-Math.acos((n+j-r)/(2*a*o)))/2),s=i/o,u=i/a;Math.abs(s-1)>ps&&this._append`L${l+s*O},${p+s*v}`,this._append`A${m},${m},0,0,${+(v*t>O*e)},${this._x1=l+u*g},${this._y1=p+u*h}`}else this._append`L${this._x1=l},${this._y1=p}`;else;}arc(t,e,n,r,a,o){if(t=+t,e=+e,o=!!o,(n=+n)<0)throw new Error(`negative radius: ${n}`);let i=n*Math.cos(r),s=n*Math.sin(r),u=t+i,l=e+s,p=1^o,c=o?r-a:a-r;null===this._x1?this._append`M${u},${l}`:(Math.abs(this._x1-u)>ps||Math.abs(this._y1-l)>ps)&&this._append`L${u},${l}`,n&&(c<0&&(c=c%ls+ls),c>cs?this._append`A${n},${n},0,1,${p},${t-i},${e-s}A${n},${n},0,1,${p},${this._x1=u},${this._y1=l}`:c>ps&&this._append`A${n},${n},0,${+(c>=us)},${p},${this._x1=t+n*Math.cos(a)},${this._y1=e+n*Math.sin(a)}`)}rect(t,e,n,r){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${n=+n}v${+r}h${-n}Z`}toString(){return this._}};function ds(){return new ms}ds.prototype=ms.prototype;var fs=Array.prototype.slice;function gs(t){return function(){return t}}function hs(t){return t.source}function Os(t){return t.target}function vs(t){return t.radius}function js(t){return t.startAngle}function ys(t){return t.endAngle}function Is(){return 0}function As(){return 10}function xs(m){var d=hs,f=Os,g=vs,h=vs,O=js,v=ys,j=Is,y=null;function e(){var t,e=d.apply(this,arguments),n=f.apply(this,arguments),r=j.apply(this,arguments)/2,a=fs.call(arguments),o=+g.apply(this,(a[0]=e,a)),i=O.apply(this,a)-ns,s=v.apply(this,a)-ns,u=+h.apply(this,(a[0]=n,a)),l=O.apply(this,a)-ns,p=v.apply(this,a)-ns;if(y||(y=t=ds()),r>os&&($i(s-i)>2*r+os?s>i?(i+=r,s-=r):(i-=r,s+=r):i=s=(i+s)/2,$i(p-l)>2*r+os?p>l?(l+=r,p-=r):(l-=r,p+=r):l=p=(l+p)/2),y.moveTo(o*Qi(i),o*ts(i)),y.arc(0,0,o,i,s),i!==l||s!==p)if(m){var c=u-+m.apply(this,arguments),b=(l+p)/2;y.quadraticCurveTo(0,0,c*Qi(l),c*ts(l)),y.lineTo(u*Qi(b),u*ts(b)),y.lineTo(c*Qi(p),c*ts(p))}else y.quadraticCurveTo(0,0,u*Qi(l),u*ts(l)),y.arc(0,0,u,l,p);if(y.quadraticCurveTo(0,0,o*Qi(i),o*ts(i)),y.closePath(),t)return y=null,t+""||null}return m&&(e.headRadius=function(t){return arguments.length?(m="function"==typeof t?t:gs(+t),e):m}),e.radius=function(t){return arguments.length?(g=h="function"==typeof t?t:gs(+t),e):g},e.sourceRadius=function(t){return arguments.length?(g="function"==typeof t?t:gs(+t),e):g},e.targetRadius=function(t){return arguments.length?(h="function"==typeof t?t:gs(+t),e):h},e.startAngle=function(t){return arguments.length?(O="function"==typeof t?t:gs(+t),e):O},e.endAngle=function(t){return arguments.length?(v="function"==typeof t?t:gs(+t),e):v},e.padAngle=function(t){return arguments.length?(j="function"==typeof t?t:gs(+t),e):j},e.source=function(t){return arguments.length?(d=t,e):d},e.target=function(t){return arguments.length?(f=t,e):f},e.context=function(t){return arguments.length?(y=null==t?null:t,e):y},e}var ks=Array.prototype.slice;function Ss(t,e){return t-e}var _s=t=>()=>t;function Ns(t,e){for(var n,r=-1,a=e.length;++r<a;)if(n=Cs(t,e[r]))return n;return 0}function Cs(t,e){for(var n=e[0],r=e[1],a=-1,o=0,i=t.length,s=i-1;o<i;s=o++){var u=t[o],l=u[0],p=u[1],c=t[s],b=c[0],m=c[1];if(ws(u,c,e))return 0;p>r!=m>r&&n<(b-l)*(r-p)/(m-p)+l&&(a=-a)}return a}function ws(t,e,n){var r,a,o,i;return function(t,e,n){return(e[0]-t[0])*(n[1]-t[1])==(n[0]-t[0])*(e[1]-t[1])}(t,e,n)&&(a=t[r=+(t[0]===e[0])],o=n[r],i=e[r],a<=o&&o<=i||i<=o&&o<=a)}function Ts(){}var Es=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Vs(){var b=1,m=1,n=Et,o=e;function r(e){var t=n(e);if(Array.isArray(t))t=t.slice().sort(Ss);else{const n=rt(e,Ps);for(t=Nt(...Tt(n[0],n[1],t),t);t[t.length-1]>=n[1];)t.pop();for(;t[1]<n[0];)t.shift()}return t.map(t=>a(e,t))}function a(e,t){const n=null==t?NaN:+t;if(isNaN(n))throw new Error(`invalid value: ${t}`);var a=[],r=[];return function(t,e,s){var u,l,n,r,a,o,p=new Array,c=new Array;u=l=-1,r=zs(t[0],e),Es[r<<1].forEach(i);for(;++u<b-1;)n=r,r=zs(t[u+1],e),Es[n|r<<1].forEach(i);Es[r|0].forEach(i);for(;++l<m-1;){for(u=-1,r=zs(t[l*b+b],e),a=zs(t[l*b],e),Es[r<<1|a<<2].forEach(i);++u<b-1;)n=r,r=zs(t[l*b+b+u+1],e),o=a,a=zs(t[l*b+u+1],e),Es[n|r<<1|a<<2|o<<3].forEach(i);Es[r|a<<3].forEach(i)}u=-1,a=t[l*b]>=e,Es[a<<2].forEach(i);for(;++u<b-1;)o=a,a=zs(t[l*b+u+1],e),Es[a<<2|o<<3].forEach(i);function i(t){var e,n,r=[t[0][0]+u,t[0][1]+l],a=[t[1][0]+u,t[1][1]+l],o=d(r),i=d(a);(e=c[o])?(n=p[i])?(delete c[e.end],delete p[n.start],e===n?(e.ring.push(a),s(e.ring)):p[e.start]=c[n.end]={start:e.start,end:n.end,ring:e.ring.concat(n.ring)}):(delete c[e.end],e.ring.push(a),c[e.end=i]=e):(e=p[i])?(n=c[o])?(delete p[e.start],delete c[n.end],e===n?(e.ring.push(a),s(e.ring)):p[n.start]=c[e.end]={start:n.start,end:e.end,ring:n.ring.concat(e.ring)}):(delete p[e.start],e.ring.unshift(r),p[e.start=o]=e):p[o]=c[i]={start:o,end:i,ring:[r,a]}}Es[a<<3].forEach(i)}(e,n,function(t){o(t,e,n),function(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}(t)>0?a.push([t]):r.push(t)}),r.forEach(function(t){for(var e,n=0,r=a.length;n<r;++n)if(-1!==Ns((e=a[n])[0],t))return void e.push(t)}),{type:"MultiPolygon",value:t,coordinates:a}}function d(t){return 2*t[0]+t[1]*(b+1)*4}function e(t,i,s){t.forEach(function(t){var e=t[0],n=t[1],r=0|e,a=0|n,o=Rs(i[a*b+r]);e>0&&e<b&&r===e&&(t[0]=Ls(e,Rs(i[a*b+r-1]),o,s)),n>0&&n<m&&a===n&&(t[1]=Ls(n,Rs(i[(a-1)*b+r]),o,s))})}return r.contour=a,r.size=function(t){if(!arguments.length)return[b,m];var e=Math.floor(t[0]),n=Math.floor(t[1]);if(!(e>=0&&n>=0))throw new Error("invalid size");return b=e,m=n,r},r.thresholds=function(t){return arguments.length?(n="function"==typeof t?t:Array.isArray(t)?_s(ks.call(t)):_s(t),r):n},r.smooth=function(t){return arguments.length?(o=t?e:Ts,r):o===e},r}function Ps(t){return isFinite(t)?t:NaN}function zs(t,e){return null!=t&&+t>=e}function Rs(t){return null==t||isNaN(t=+t)?-1/0:t}function Ls(t,e,n,r){const a=r-e,o=n-e,i=isFinite(a)||isFinite(o)?a/o:Math.sign(a)/Math.sign(o);return isNaN(i)?t:t+i-.5}function Ms(t){return t[0]}function qs(t){return t[1]}function Bs(){return 1}const P=134217729,Ds=33306690738754706e-32;function Us(t,e,n,r,a){let o,i,s,u,l=e[0],p=r[0],c=0,b=0;p>l==p>-l?(o=l,l=e[++c]):(o=p,p=r[++b]);let m=0;if(c<t&&b<n)for(p>l==p>-l?(i=l+o,s=o-(i-l),l=e[++c]):(i=p+o,s=o-(i-p),p=r[++b]),o=i,0!==s&&(a[m++]=s);c<t&&b<n;)p>l==p>-l?(i=o+l,u=i-o,s=o-(i-u)+(l-u),l=e[++c]):(i=o+p,u=i-o,s=o-(i-u)+(p-u),p=r[++b]),o=i,0!==s&&(a[m++]=s);for(;c<t;)i=o+l,u=i-o,s=o-(i-u)+(l-u),l=e[++c],o=i,0!==s&&(a[m++]=s);for(;b<n;)i=o+p,u=i-o,s=o-(i-u)+(p-u),p=r[++b],o=i,0!==s&&(a[m++]=s);return 0===o&&0!==m||(a[m++]=o),m}function Gs(t){return new Float64Array(t)}const Fs=22204460492503146e-32,Hs=11093356479670487e-47,Js=Gs(4),Ks=Gs(8),Xs=Gs(12),Zs=Gs(16),z=Gs(4);function Ws(t,e,n,r,a,o){const i=(e-o)*(n-a),s=(t-a)*(r-o),u=i-s,l=Math.abs(i+s);return Math.abs(u)>=33306690738754716e-32*l?u:-function(t,e,n,r,a,o,i){let s,u,l,p,c,b,m,d,f,g,h,O,v,j,y,I,A,x;const k=t-a,S=n-a,_=e-o,N=r-o;j=k*N,b=P*k,m=b-(b-k),d=k-m,b=P*N,f=b-(b-N),g=N-f,y=d*g-(j-m*f-d*f-m*g),I=_*S,b=P*_,m=b-(b-_),d=_-m,b=P*S,f=b-(b-S),g=S-f,A=d*g-(I-m*f-d*f-m*g),h=y-A,c=y-h,Js[0]=y-(h+c)+(c-A),O=j+h,c=O-j,v=j-(O-c)+(h-c),h=v-I,c=v-h,Js[1]=v-(h+c)+(c-I),x=O+h,c=x-O,Js[2]=O-(x-c)+(h-c),Js[3]=x;let C=function(e,n){let r=n[0];for(let t=1;t<e;t++)r+=n[t];return r}(4,Js),w=Fs*i;if(C>=w||-C>=w)return C;if(c=t-k,s=t-(k+c)+(c-a),c=n-S,l=n-(S+c)+(c-a),c=e-_,u=e-(_+c)+(c-o),c=r-N,p=r-(N+c)+(c-o),0===s&&0===u&&0===l&&0===p)return C;if(w=Hs*i+Ds*Math.abs(C),C+=k*p+N*s-(_*l+S*u),C>=w||-C>=w)return C;j=s*N,b=P*s,m=b-(b-s),d=s-m,b=P*N,f=b-(b-N),g=N-f,y=d*g-(j-m*f-d*f-m*g),I=u*S,b=P*u,m=b-(b-u),d=u-m,b=P*S,f=b-(b-S),g=S-f,A=d*g-(I-m*f-d*f-m*g),h=y-A,c=y-h,z[0]=y-(h+c)+(c-A),O=j+h,c=O-j,v=j-(O-c)+(h-c),h=v-I,c=v-h,z[1]=v-(h+c)+(c-I),x=O+h,c=x-O,z[2]=O-(x-c)+(h-c),z[3]=x;const T=Us(4,Js,4,z,Ks);j=k*p,b=P*k,m=b-(b-k),d=k-m,b=P*p,f=b-(b-p),g=p-f,y=d*g-(j-m*f-d*f-m*g),I=_*l,b=P*_,m=b-(b-_),d=_-m,b=P*l,f=b-(b-l),g=l-f,A=d*g-(I-m*f-d*f-m*g),h=y-A,c=y-h,z[0]=y-(h+c)+(c-A),O=j+h,c=O-j,v=j-(O-c)+(h-c),h=v-I,c=v-h,z[1]=v-(h+c)+(c-I),x=O+h,c=x-O,z[2]=O-(x-c)+(h-c),z[3]=x;const E=Us(T,Ks,4,z,Xs);j=s*p,b=P*s,m=b-(b-s),d=s-m,b=P*p,f=b-(b-p),g=p-f,y=d*g-(j-m*f-d*f-m*g),I=u*l,b=P*u,m=b-(b-u),d=u-m,b=P*l,f=b-(b-l),g=l-f,A=d*g-(I-m*f-d*f-m*g),h=y-A,c=y-h,z[0]=y-(h+c)+(c-A),O=j+h,c=O-j,v=j-(O-c)+(h-c),h=v-I,c=v-h,z[1]=v-(h+c)+(c-I),x=O+h,c=x-O,z[2]=O-(x-c)+(h-c),z[3]=x;const V=Us(E,Xs,4,z,Zs);return Zs[V-1]}(t,e,n,r,a,o,l)}const Ys=Math.pow(2,-52),$s=new Uint32Array(512);class Qs{static from(e,n=ou,r=iu){const a=e.length,o=new Float64Array(2*a);for(let t=0;t<a;t++){const a=e[t];o[2*t]=n(a),o[2*t+1]=r(a)}return new Qs(o)}constructor(t){const e=t.length>>1;if(e>0&&"number"!=typeof t[0])throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*e-5,0);this._triangles=new Uint32Array(3*n),this._halfedges=new Int32Array(3*n),this._hashSize=Math.ceil(Math.sqrt(e)),this._hullPrev=new Uint32Array(e),this._hullNext=new Uint32Array(e),this._hullTri=new Uint32Array(e),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(e),this._dists=new Float64Array(e),this.update()}update(){const{coords:u,_hullPrev:l,_hullNext:p,_hullTri:c,_hullHash:b}=this,r=u.length>>1;let e=1/0,n=1/0,m=-1/0,d=-1/0;for(let t=0;t<r;t++){const p=u[2*t],c=u[2*t+1];p<e&&(e=p),c<n&&(n=c),p>m&&(m=p),c>d&&(d=c),this._ids[t]=t}const f=(e+m)/2,a=(n+d)/2;let g,h,O;for(let t=0,e=1/0;t<r;t++){const c=tu(f,a,u[2*t],u[2*t+1]);c<e&&(g=t,e=c)}const o=u[2*g],i=u[2*g+1];for(let t=0,e=1/0;t<r;t++){if(t===g)continue;const c=tu(o,i,u[2*t],u[2*t+1]);c<e&&c>0&&(h=t,e=c)}let s=u[2*h],v=u[2*h+1],j=1/0;for(let t=0;t<r;t++){if(t===g||t===h)continue;const p=nu(o,i,s,v,u[2*t],u[2*t+1]);p<j&&(O=t,j=p)}let t=u[2*O],y=u[2*O+1];if(j===1/0){for(let t=0;t<r;t++)this._dists[t]=u[2*t]-u[0]||u[2*t+1]-u[1];ru(this._ids,this._dists,0,r-1);const l=new Uint32Array(r);let n=0;for(let t=0,e=-1/0;t<r;t++){const b=this._ids[t],r=this._dists[b];r>e&&(l[n++]=b,e=r)}return this.hull=l.subarray(0,n),this.triangles=new Uint32Array(0),void(this.halfedges=new Uint32Array(0))}if(Ws(o,i,s,v,t,y)<0){const u=h,l=s,p=v;h=O,s=t,v=y,O=u,t=l,y=p}const I=function(t,e,n,r,a,o){const i=n-t,s=r-e,u=a-t,l=o-e,p=i*i+s*s,c=u*u+l*l,b=.5/(i*l-s*u),m=t+(l*p-s*c)*b,d=e+(i*c-u*p)*b;return{x:m,y:d}}(o,i,s,v,t,y);this._cx=I.x,this._cy=I.y;for(let t=0;t<r;t++)this._dists[t]=tu(u[2*t],u[2*t+1],I.x,I.y);ru(this._ids,this._dists,0,r-1),this._hullStart=g;let A=3;p[g]=l[O]=h,p[h]=l[g]=O,p[O]=l[h]=g,c[g]=0,c[h]=1,c[O]=2,b.fill(-1),b[this._hashKey(o,i)]=g,b[this._hashKey(s,v)]=h,b[this._hashKey(t,y)]=O,this.trianglesLen=0,this._addTriangle(g,h,O,-1,-1,-1);for(let o,i,s=0;s<this._ids.length;s++){const m=this._ids[s],d=u[2*m],f=u[2*m+1];if(s>0&&Math.abs(d-o)<=Ys&&Math.abs(f-i)<=Ys)continue;if(o=d,i=f,m===g||m===h||m===O)continue;let n=0;for(let t=0,e=this._hashKey(d,f);t<this._hashSize&&(n=b[(e+t)%this._hashSize],-1===n||n===p[n]);t++);n=l[n];let t,e=n;for(;t=p[e],Ws(d,f,u[2*e],u[2*e+1],u[2*t],u[2*t+1])>=0;)if(e=t,e===n){e=-1;break}if(-1===e)continue;let r=this._addTriangle(e,m,p[e],-1,-1,c[e]);c[m]=this._legalize(r+2),c[e]=r,A++;let a=p[e];for(;t=p[a],Ws(d,f,u[2*a],u[2*a+1],u[2*t],u[2*t+1])<0;)r=this._addTriangle(a,m,t,c[m],-1,c[a]),c[m]=this._legalize(r+2),p[a]=a,A--,a=t;if(e===n)for(;t=l[e],Ws(d,f,u[2*t],u[2*t+1],u[2*e],u[2*e+1])<0;)r=this._addTriangle(t,m,e,-1,c[e],c[t]),this._legalize(r+2),c[t]=r,p[e]=e,A--,e=t;this._hullStart=l[m]=e,p[e]=l[a]=m,p[m]=a,b[this._hashKey(d,f)]=m,b[this._hashKey(u[2*e],u[2*e+1])]=e}this.hull=new Uint32Array(A);for(let t=0,e=this._hullStart;t<A;t++)this.hull[t]=e,e=p[e];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,e){return Math.floor(function(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}(t-this._cx,e-this._cy)*this._hashSize)%this._hashSize}_legalize(l){const{_triangles:p,_halfedges:c,coords:b}=this;let m=0,d=0;for(;;){const e=c[l],t=l-l%3;if(d=t+(l+2)%3,-1===e){if(0===m)break;l=$s[--m];continue}const n=e-e%3,r=t+(l+1)%3,a=n+(e+2)%3,o=p[d],i=p[l],s=p[r],u=p[a];if(eu(b[2*o],b[2*o+1],b[2*i],b[2*i+1],b[2*s],b[2*s+1],b[2*u],b[2*u+1])){p[l]=u,p[e]=o;const b=c[a];if(-1===b){let t=this._hullStart;do{if(this._hullTri[t]===a){this._hullTri[t]=l;break}t=this._hullPrev[t]}while(t!==this._hullStart)}this._link(l,b),this._link(e,c[d]),this._link(d,a);const t=n+(e+1)%3;m<$s.length&&($s[m++]=t)}else{if(0===m)break;l=$s[--m]}}return d}_link(t,e){this._halfedges[t]=e,-1!==e&&(this._halfedges[e]=t)}_addTriangle(t,e,n,r,a,o){const i=this.trianglesLen;return this._triangles[i]=t,this._triangles[i+1]=e,this._triangles[i+2]=n,this._link(i,r),this._link(i+1,a),this._link(i+2,o),this.trianglesLen+=3,i}}function tu(t,e,n,r){const a=t-n,o=e-r;return a*a+o*o}function eu(t,e,n,r,a,o,i,s){const u=t-i,l=e-s,p=n-i,c=r-s,b=a-i,m=o-s,d=p*p+c*c,f=b*b+m*m;return u*(c*f-d*m)-l*(p*f-d*b)+(u*u+l*l)*(p*m-c*b)<0}function nu(t,e,n,r,a,o){const i=n-t,s=r-e,u=a-t,l=o-e,p=i*i+s*s,c=u*u+l*l,b=.5/(i*l-s*u),m=(l*p-s*c)*b,d=(i*c-u*p)*b;return m*m+d*d}function ru(a,o,i,s){if(s-i<=20)for(let n=i+1;n<=s;n++){const s=a[n],t=o[s];let e=n-1;for(;e>=i&&o[a[e]]>t;)a[e+1]=a[e--];a[e+1]=s}else{let t=i+1,e=s;au(a,i+s>>1,t),o[a[i]]>o[a[s]]&&au(a,i,s),o[a[t]]>o[a[s]]&&au(a,t,s),o[a[i]]>o[a[t]]&&au(a,i,t);const n=a[t],r=o[n];for(;;){do{t++}while(o[a[t]]<r);do{e--}while(o[a[e]]>r);if(e<t)break;au(a,t,e)}a[i+1]=a[e],a[e]=n,s-t+1>=e-i?(ru(a,o,t,s),ru(a,o,i,e-1)):(ru(a,o,i,e-1),ru(a,o,t,s))}}function au(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function ou(t){return t[0]}function iu(t){return t[1]}const su=1e-6;class uu{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(t,e){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}`}closePath(){null!==this._x1&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(t,e){this._+=`L${this._x1=+t},${this._y1=+e}`}arc(t,e,n){const r=(t=+t)+(n=+n),a=e=+e;if(n<0)throw new Error("negative radius");null===this._x1?this._+=`M${r},${a}`:(Math.abs(this._x1-r)>su||Math.abs(this._y1-a)>su)&&(this._+="L"+r+","+a),n&&(this._+=`A${n},${n},0,1,1,${t-n},${e}A${n},${n},0,1,1,${this._x1=r},${this._y1=a}`)}rect(t,e,n,r){this._+=`M${this._x0=this._x1=+t},${this._y0=this._y1=+e}h${+n}v${+r}h${-n}Z`}value(){return this._||null}}class lu{constructor(){this._=[]}moveTo(t,e){this._.push([t,e])}closePath(){this._.push(this._[0].slice())}lineTo(t,e){this._.push([t,e])}value(){return this._.length?this._:null}}class pu{constructor(t,[e,n,r,a]=[0,0,960,500]){if(!((r=+r)>=(e=+e)&&(a=+a)>=(n=+n)))throw new Error("invalid bounds");this.delaunay=t,this._circumcenters=new Float64Array(2*t.points.length),this.vectors=new Float64Array(2*t.points.length),this.xmax=r,this.xmin=e,this.ymax=a,this.ymin=n,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:d,hull:f,triangles:g},vectors:e}=this;let h,O;const v=this.circumcenters=this._circumcenters.subarray(0,g.length/3*2);for(let p,c,b=0,m=0,t=g.length;b<t;b+=3,m+=2){const j=2*g[b],y=2*g[b+1],I=2*g[b+2],A=d[j],t=d[j+1],e=d[y],n=d[y+1],r=d[I],a=d[I+1],o=e-A,i=n-t,s=r-A,u=a-t,l=2*(o*u-i*s);if(Math.abs(l)<1e-9){if(void 0===h){h=O=0;for(const g of f)h+=d[2*g],O+=d[2*g+1];h/=f.length,O/=f.length}const g=1e9*Math.sign((h-A)*u-(O-t)*s);p=(A+r)/2-g*u,c=(t+a)/2+g*s}else{const d=1/l,f=o*o+i*i,g=s*s+u*u;p=A+(u*f-i*g)*d,c=t+(o*g-s*f)*d}v[m]=p,v[m+1]=c}let n,r,a,j=f[f.length-1],y=4*j,I=d[2*j],A=d[2*j+1];e.fill(0);for(let t=0;t<f.length;++t)j=f[t],n=y,r=I,a=A,y=4*j,I=d[2*j],A=d[2*j+1],e[n+2]=e[y]=a-A,e[n+3]=e[y+1]=I-r}render(o){const t=null==o?o=new uu:void 0,{delaunay:{halfedges:i,inedges:s,hull:u},circumcenters:l,vectors:p}=this;if(u.length<=1)return null;for(let n=0,t=i.length;n<t;++n){const s=i[n];if(s<n)continue;const u=2*Math.floor(n/3),p=2*Math.floor(s/3),c=l[u],b=l[u+1],t=l[p],e=l[p+1];this._renderSegment(c,b,t,e,o)}let c,b=u[u.length-1];for(let a=0;a<u.length;++a){c=b,b=u[a];const i=2*Math.floor(s[b]/3),t=l[i],e=l[i+1],n=4*c,r=this._project(t,e,p[n+2],p[n+3]);r&&this._renderSegment(t,e,r[0],r[1],o)}return t&&t.value()}renderBounds(t){const e=null==t?t=new uu:void 0;return t.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),e&&e.value()}renderCell(t,e){const n=null==e?e=new uu:void 0,r=this._clip(t);if(null===r||!r.length)return;e.moveTo(r[0],r[1]);let a=r.length;for(;r[0]===r[a-2]&&r[1]===r[a-1]&&a>1;)a-=2;for(let t=2;t<a;t+=2)r[t]===r[t-2]&&r[t+1]===r[t-1]||e.lineTo(r[t],r[t+1]);return e.closePath(),n&&n.value()}*cellPolygons(){const{delaunay:{points:n}}=this;for(let t=0,e=n.length/2;t<e;++t){const n=this.cellPolygon(t);n&&(n.index=t,yield n)}}cellPolygon(t){const e=new lu;return this.renderCell(t,e),e.value()}_renderSegment(t,e,n,r,a){let o;const i=this._regioncode(t,e),s=this._regioncode(n,r);0===i&&0===s?(a.moveTo(t,e),a.lineTo(n,r)):(o=this._clipSegment(t,e,n,r,i,s))&&(a.moveTo(o[0],o[1]),a.lineTo(o[2],o[3]))}contains(t,e,n){return(e=+e)==e&&(n=+n)==n&&this.delaunay._step(t,e,n)===t}*neighbors(o){const i=this._clip(o);if(i)for(const a of this.delaunay.neighbors(o)){const o=this._clip(a);if(o)t:for(let n=0,r=i.length;n<r;n+=2)for(let t=0,e=o.length;t<e;t+=2)if(i[n]===o[t]&&i[n+1]===o[t+1]&&i[(n+2)%r]===o[(t+e-2)%e]&&i[(n+3)%r]===o[(t+e-1)%e]){yield a;break t}}}_cell(t){const{circumcenters:e,delaunay:{inedges:n,halfedges:r,triangles:a}}=this,o=n[t];if(-1===o)return null;const i=[];let s=o;do{const n=Math.floor(s/3);if(i.push(e[2*n],e[2*n+1]),s=s%3==2?s-2:s+1,a[s]!==t)break;s=r[s]}while(s!==o&&-1!==s);return i}_clip(t){if(0===t&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const e=this._cell(t);if(null===e)return null;const{vectors:n}=this,r=4*t;return this._simplify(n[r]||n[r+1]?this._clipInfinite(t,e,n[r],n[r+1],n[r+2],n[r+3]):this._clipFinite(t,e))}_clipFinite(o,e){const n=e.length;let i,s,u,l,p=null,c=e[n-2],b=e[n-1],m=this._regioncode(c,b),d=0;for(let t=0;t<n;t+=2)if(i=c,s=b,c=e[t],b=e[t+1],u=m,m=this._regioncode(c,b),0===u&&0===m)l=d,d=0,p?p.push(c,b):p=[c,b];else{let t,e,n,r,a;if(0===u){if(null===(t=this._clipSegment(i,s,c,b,u,m)))continue;[e,n,r,a]=t}else{if(null===(t=this._clipSegment(c,b,i,s,m,u)))continue;[r,a,e,n]=t,l=d,d=this._edgecode(e,n),l&&d&&this._edge(o,l,d,p,p.length),p?p.push(e,n):p=[e,n]}l=d,d=this._edgecode(r,a),l&&d&&this._edge(o,l,d,p,p.length),p?p.push(r,a):p=[r,a]}if(p)l=d,d=this._edgecode(p[0],p[1]),l&&d&&this._edge(o,l,d,p,p.length);else if(this.contains(o,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return p}_clipSegment(r,a,o,i,s,u){const l=s<u;for(l&&([r,a,o,i,s,u]=[o,i,r,a,u,s]);;){if(0===s&&0===u)return l?[o,i,r,a]:[r,a,o,i];if(s&u)return null;let t,e,n=s||u;8&n?(t=r+(o-r)*(this.ymax-a)/(i-a),e=this.ymax):4&n?(t=r+(o-r)*(this.ymin-a)/(i-a),e=this.ymin):2&n?(e=a+(i-a)*(this.xmax-r)/(o-r),t=this.xmax):(e=a+(i-a)*(this.xmin-r)/(o-r),t=this.xmin),s?(r=t,a=e,s=this._regioncode(r,a)):(o=t,i=e,u=this._regioncode(o,i))}}_clipInfinite(a,t,e,n,r,o){let i,s=Array.from(t);if((i=this._project(s[0],s[1],e,n))&&s.unshift(i[0],i[1]),(i=this._project(s[s.length-2],s[s.length-1],r,o))&&s.push(i[0],i[1]),s=this._clipFinite(a,s))for(let t,e=0,n=s.length,r=this._edgecode(s[n-2],s[n-1]);e<n;e+=2)t=r,r=this._edgecode(s[e],s[e+1]),t&&r&&(e=this._edge(a,t,r,s,e),n=s.length);else this.contains(a,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(s=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return s}_edge(n,r,t,a,o){for(;r!==t;){let t,e;switch(r){case 5:r=4;continue;case 4:r=6,t=this.xmax,e=this.ymin;break;case 6:r=2;continue;case 2:r=10,t=this.xmax,e=this.ymax;break;case 10:r=8;continue;case 8:r=9,t=this.xmin,e=this.ymax;break;case 9:r=1;continue;case 1:r=5,t=this.xmin,e=this.ymin}a[o]===t&&a[o+1]===e||!this.contains(n,t,e)||(a.splice(o,0,t,e),o+=2)}return o}_project(t,e,n,r){let a,o,i,s=1/0;if(r<0){if(e<=this.ymin)return null;(a=(this.ymin-e)/r)<s&&(i=this.ymin,o=t+(s=a)*n)}else if(r>0){if(e>=this.ymax)return null;(a=(this.ymax-e)/r)<s&&(i=this.ymax,o=t+(s=a)*n)}if(n>0){if(t>=this.xmax)return null;(a=(this.xmax-t)/n)<s&&(o=this.xmax,i=e+(s=a)*r)}else if(n<0){if(t<=this.xmin)return null;(a=(this.xmin-t)/n)<s&&(o=this.xmin,i=e+(s=a)*r)}return[o,i]}_edgecode(t,e){return(t===this.xmin?1:t===this.xmax?2:0)|(e===this.ymin?4:e===this.ymax?8:0)}_regioncode(t,e){return(t<this.xmin?1:t>this.xmax?2:0)|(e<this.ymin?4:e>this.ymax?8:0)}_simplify(r){if(r&&r.length>4){for(let n=0;n<r.length;n+=2){const t=(n+2)%r.length,e=(n+4)%r.length;(r[n]===r[t]&&r[t]===r[e]||r[n+1]===r[t+1]&&r[t+1]===r[e+1])&&(r.splice(t,2),n-=2)}r.length||(r=null)}return r}}const cu=2*Math.PI,bu=Math.pow;function mu(t){return t[0]}function du(t){return t[1]}function fu(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class gu{static from(t,e=mu,n=du,r){return new gu("length"in t?function(e,n,r,a){const o=e.length,i=new Float64Array(2*o);for(let t=0;t<o;++t){const o=e[t];i[2*t]=n.call(a,o,t,e),i[2*t+1]=r.call(a,o,t,e)}return i}(t,e,n,r):Float64Array.from(function*(e,n,r,a){let o=0;for(const t of e)yield n.call(a,t,o,e),yield r.call(a,t,o,e),++o}(t,e,n,r)))}constructor(t){this._delaunator=new Qs(t),this.inedges=new Int32Array(t.length/2),this._hullIndex=new Int32Array(t.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const t=this._delaunator,n=this.points;if(t.hull&&t.hull.length>2&&function(t){const{triangles:a,coords:o}=t;for(let r=0;r<a.length;r+=3){const t=2*a[r],e=2*a[r+1],n=2*a[r+2];if((o[n]-o[t])*(o[e+1]-o[t+1])-(o[e]-o[t])*(o[n+1]-o[t+1])>1e-10)return!1}return!0}(t)){this.collinear=Int32Array.from({length:n.length/2},(t,e)=>e).sort((t,e)=>n[2*t]-n[2*e]||n[2*t+1]-n[2*e+1]);const t=this.collinear[0],r=this.collinear[this.collinear.length-1],a=[n[2*t],n[2*t+1],n[2*r],n[2*r+1]],o=1e-8*Math.hypot(a[3]-a[1],a[2]-a[0]);for(let t=0,e=n.length/2;t<e;++t){const r=fu(n[2*t],n[2*t+1],o);n[2*t]=r[0],n[2*t+1]=r[1]}this._delaunator=new Qs(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,a=this.hull=this._delaunator.hull,o=this.triangles=this._delaunator.triangles,i=this.inedges.fill(-1),s=this._hullIndex.fill(-1);for(let t=0,e=r.length;t<e;++t){const n=o[t%3==2?t-2:t+1];-1!==r[t]&&-1!==i[n]||(i[n]=t)}for(let t=0,e=a.length;t<e;++t)s[a[t]]=t;a.length<=2&&a.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=a[0],i[a[0]]=1,2===a.length&&(i[a[1]]=0,this.triangles[1]=a[1],this.triangles[2]=a[1]))}voronoi(t){return new pu(this,t)}*neighbors(t){const{inedges:e,hull:n,_hullIndex:r,halfedges:a,triangles:o,collinear:i}=this;if(i){const e=i.indexOf(t);return e>0&&(yield i[e-1]),void(e<i.length-1&&(yield i[e+1]))}const s=e[t];if(-1===s)return;let u=s,l=-1;do{if(yield l=o[u],u=u%3==2?u-2:u+1,o[u]!==t)return;if(u=a[u],-1===u){const e=n[(r[t]+1)%n.length];return void(e!==l&&(yield e))}}while(u!==s)}find(t,e,n=0){if((t=+t)!=t||(e=+e)!=e)return-1;const r=n;let a;for(;(a=this._step(n,t,e))>=0&&a!==n&&a!==r;)n=a;return a}_step(e,n,r){const{inedges:t,hull:a,_hullIndex:o,halfedges:i,triangles:s,points:u}=this;if(-1===t[e]||!u.length)return(e+1)%(u.length>>1);let l=e,p=bu(n-u[2*e],2)+bu(r-u[2*e+1],2);const c=t[e];let b=c;do{let t=s[b];const c=bu(n-u[2*t],2)+bu(r-u[2*t+1],2);if(c<p&&(p=c,l=t),b=b%3==2?b-2:b+1,s[b]!==e)break;if(b=i[b],-1===b){if(b=a[(o[e]+1)%a.length],b!==t&&bu(n-u[2*b],2)+bu(r-u[2*b+1],2)<p)return b;break}}while(b!==c);return l}render(a){const t=null==a?a=new uu:void 0,{points:o,halfedges:i,triangles:s}=this;for(let r=0,t=i.length;r<t;++r){const t=i[r];if(t<r)continue;const e=2*s[r],n=2*s[t];a.moveTo(o[e],o[e+1]),a.lineTo(o[n],o[n+1])}return this.renderHull(a),t&&t.value()}renderPoints(r,a){void 0!==a||r&&"function"==typeof r.moveTo||(a=r,r=null),a=null==a?2:+a;const t=null==r?r=new uu:void 0,{points:o}=this;for(let n=0,t=o.length;n<t;n+=2){const t=o[n],e=o[n+1];r.moveTo(t+a,e),r.arc(t,e,a,0,cu)}return t&&t.value()}renderHull(e){const t=null==e?e=new uu:void 0,{hull:n,points:r}=this,a=2*n[0],o=n.length;e.moveTo(r[a],r[a+1]);for(let t=1;t<o;++t){const a=2*n[t];e.lineTo(r[a],r[a+1])}return e.closePath(),t&&t.value()}hullPolygon(){const t=new lu;return this.renderHull(t),t.value()}renderTriangle(t,e){const n=null==e?e=new uu:void 0,{points:r,triangles:a}=this,o=2*a[t*=3],i=2*a[t+1],s=2*a[t+2];return e.moveTo(r[o],r[o+1]),e.lineTo(r[i],r[i+1]),e.lineTo(r[s],r[s+1]),e.closePath(),n&&n.value()}*trianglePolygons(){const{triangles:n}=this;for(let t=0,e=n.length/3;t<e;++t)yield this.trianglePolygon(t)}trianglePolygon(t){const e=new lu;return this.renderTriangle(t,e),e.value()}}var hu={},Ou={},vu=34,ju=10,yu=13;function Iu(t){return new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+'] || ""'}).join(",")+"}")}function Au(t){var n=Object.create(null),r=[];return t.forEach(function(t){for(var e in t)e in n||r.push(n[e]=e)}),r}function xu(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function ku(t){var e,n=t.getUTCHours(),r=t.getUTCMinutes(),a=t.getUTCSeconds(),o=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":((e=t.getUTCFullYear())<0?"-"+xu(-e,6):e>9999?"+"+xu(e,6):xu(e,4))+"-"+xu(t.getUTCMonth()+1,2)+"-"+xu(t.getUTCDate(),2)+(o?"T"+xu(n,2)+":"+xu(r,2)+":"+xu(a,2)+"."+xu(o,3)+"Z":a?"T"+xu(n,2)+":"+xu(r,2)+":"+xu(a,2)+"Z":r||n?"T"+xu(n,2)+":"+xu(r,2)+"Z":"")}function Su(r){var e=new RegExp('["'+r+"\n\r]"),c=r.charCodeAt(0);function o(r,t){var e,n=[],a=r.length,o=0,i=0,s=a<=0,u=!1;function l(){if(s)return Ou;if(u)return u=!1,hu;var t,e,n=o;if(r.charCodeAt(n)===vu){for(;o++<a&&r.charCodeAt(o)!==vu||r.charCodeAt(++o)===vu;);return(t=o)>=a?s=!0:(e=r.charCodeAt(o++))===ju?u=!0:e===yu&&(u=!0,r.charCodeAt(o)===ju&&++o),r.slice(n+1,t-1).replace(/""/g,'"')}for(;o<a;){if((e=r.charCodeAt(t=o++))===ju)u=!0;else if(e===yu)u=!0,r.charCodeAt(o)===ju&&++o;else if(e!==c)continue;return r.slice(n,t)}return s=!0,r.slice(n,a)}for(r.charCodeAt(a-1)===ju&&--a,r.charCodeAt(a-1)===yu&&--a;(e=l())!==Ou;){for(var p=[];e!==hu&&e!==Ou;)p.push(e),e=l();t&&null==(p=t(p,i++))||n.push(p)}return n}function n(t,n){return t.map(function(e){return n.map(function(t){return i(e[t])}).join(r)})}function a(t){return t.map(i).join(r)}function i(t){return null==t?"":t instanceof Date?ku(t):e.test(t+="")?'"'+t.replace(/"/g,'""')+'"':t}return{parse:function(t,n){var r,a,e=o(t,function(t,e){if(r)return r(t,e-1);a=t,r=n?function(n,r){var a=Iu(n);return function(t,e){return r(a(t),e,n)}}(t,n):Iu(t)});return e.columns=a||[],e},parseRows:o,format:function(t,e){return null==e&&(e=Au(t)),[e.map(i).join(r)].concat(n(t,e)).join("\n")},formatBody:function(t,e){return null==e&&(e=Au(t)),n(t,e).join("\n")},formatRows:function(t){return t.map(a).join("\n")},formatRow:a,formatValue:i}}var _u=Su(","),Nu=_u.parse,Cu=_u.parseRows,wu=_u.format,Tu=_u.formatBody,Eu=_u.formatRows,Vu=_u.formatRow,Pu=_u.formatValue,zu=Su("\t"),Ru=zu.parse,Lu=zu.parseRows,Mu=zu.format,qu=zu.formatBody,Bu=zu.formatRows,Du=zu.formatRow,Uu=zu.formatValue;const Gu=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function Fu(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function Hu(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function Ju(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function Ku(t,e){return fetch(t,e).then(Ju)}function Xu(r){return function(t,e,n){return 2===arguments.length&&"function"==typeof e&&(n=e,e=void 0),Ku(t,e).then(function(t){return r(t,n)})}}var Zu=Xu(Nu),Wu=Xu(Ru);function Yu(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(204!==t.status&&205!==t.status)return t.json()}function $u(n){return(t,e)=>Ku(t,e).then(t=>(new DOMParser).parseFromString(t,n))}var Qu=$u("application/xml"),tl=$u("text/html"),el=$u("image/svg+xml");function nl(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var a,o,i,s,u,l,p,c,b,m=t._root,d={data:r},f=t._x0,g=t._y0,h=t._x1,O=t._y1;if(!m)return t._root=d,t;for(;m.length;)if((l=e>=(o=(f+h)/2))?f=o:h=o,(p=n>=(i=(g+O)/2))?g=i:O=i,a=m,!(m=m[c=p<<1|l]))return a[c]=d,t;if(s=+t._x.call(null,m.data),u=+t._y.call(null,m.data),e===s&&n===u)return d.next=m,a?a[c]=d:t._root=d,t;do{a=a?a[c]=new Array(4):t._root=new Array(4),(l=e>=(o=(f+h)/2))?f=o:h=o,(p=n>=(i=(g+O)/2))?g=i:O=i}while((c=p<<1|l)==(b=(u>=i)<<1|s>=o));return a[b]=m,a[c]=d,t}function I(t,e,n,r,a){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=a}function rl(t){return t[0]}function al(t){return t[1]}function ol(t,e,n){var r=new il(null==e?rl:e,null==n?al:n,NaN,NaN,NaN,NaN);return null==t?r:r.addAll(t)}function il(t,e,n,r,a,o){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=a,this._y1=o,this._root=void 0}function sl(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var t=ol.prototype=il.prototype;function O(t){return function(){return t}}function ul(t){return 1e-6*(t()-.5)}function ll(t){return t.x+t.vx}function pl(t){return t.y+t.vy}function cl(t){return t.index}function bl(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}t.copy=function(){var t,e,n=new il(this._x,this._y,this._x0,this._y0,this._x1,this._y1),r=this._root;if(!r)return n;if(!r.length)return n._root=sl(r),n;for(t=[{source:r,target:n._root=new Array(4)}];r=t.pop();)for(var a=0;a<4;++a)(e=r.source[a])&&(e.length?t.push({source:e,target:r.target[a]=new Array(4)}):r.target[a]=sl(e));return n},t.add=function(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return nl(this.cover(e,n),e,n,t)},t.addAll=function(t){var e,n,r,a,o=t.length,i=new Array(o),s=new Array(o),u=1/0,l=1/0,p=-1/0,c=-1/0;for(n=0;n<o;++n)isNaN(r=+this._x.call(null,e=t[n]))||isNaN(a=+this._y.call(null,e))||(i[n]=r,s[n]=a,r<u&&(u=r),r>p&&(p=r),a<l&&(l=a),a>c&&(c=a));if(u>p||l>c)return this;for(this.cover(u,l).cover(p,c),n=0;n<o;++n)nl(this,i[n],s[n],t[n]);return this},t.cover=function(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,a=this._x1,o=this._y1;if(isNaN(n))a=(n=Math.floor(t))+1,o=(r=Math.floor(e))+1;else{for(var i,s,u=a-n||1,l=this._root;n>t||t>=a||r>e||e>=o;)switch(s=(e<r)<<1|t<n,(i=new Array(4))[s]=l,l=i,u*=2,s){case 0:a=n+u,o=r+u;break;case 1:n=a-u,o=r+u;break;case 2:a=n+u,r=o-u;break;case 3:n=a-u,r=o-u}this._root&&this._root.length&&(this._root=l)}return this._x0=n,this._y0=r,this._x1=a,this._y1=o,this},t.data=function(){var e=[];return this.visit(function(t){if(!t.length)do{e.push(t.data)}while(t=t.next)}),e},t.extent=function(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]},t.find=function(t,e,n){var r,a,o,i,s,u,l,p=this._x0,c=this._y0,b=this._x1,m=this._y1,d=[],f=this._root;for(f&&d.push(new I(f,p,c,b,m)),null==n?n=1/0:(p=t-n,c=e-n,b=t+n,m=e+n,n*=n);u=d.pop();)if(!(!(f=u.node)||(a=u.x0)>b||(o=u.y0)>m||(i=u.x1)<p||(s=u.y1)<c))if(f.length){var g=(a+i)/2,h=(o+s)/2;d.push(new I(f[3],g,h,i,s),new I(f[2],a,h,g,s),new I(f[1],g,o,i,h),new I(f[0],a,o,g,h)),(l=(e>=h)<<1|t>=g)&&(u=d[d.length-1],d[d.length-1]=d[d.length-1-l],d[d.length-1-l]=u)}else{var O=t-+this._x.call(null,f.data),v=e-+this._y.call(null,f.data),j=O*O+v*v;if(j<n){var y=Math.sqrt(n=j);p=t-y,c=e-y,b=t+y,m=e+y,r=f.data}}return r},t.remove=function(t){if(isNaN(o=+this._x.call(null,t))||isNaN(i=+this._y.call(null,t)))return this;var e,n,r,a,o,i,s,u,l,p,c,b,m=this._root,d=this._x0,f=this._y0,g=this._x1,h=this._y1;if(!m)return this;if(m.length)for(;;){if((l=o>=(s=(d+g)/2))?d=s:g=s,(p=i>=(u=(f+h)/2))?f=u:h=u,e=m,!(m=m[c=p<<1|l]))return this;if(!m.length)break;(e[c+1&3]||e[c+2&3]||e[c+3&3])&&(n=e,b=c)}for(;m.data!==t;)if(r=m,!(m=m.next))return this;return(a=m.next)&&delete m.next,r?(a?r.next=a:delete r.next,this):e?(a?e[c]=a:delete e[c],(m=e[0]||e[1]||e[2]||e[3])&&m===(e[3]||e[2]||e[1]||e[0])&&!m.length&&(n?n[b]=m:this._root=m),this):(this._root=a,this)},t.removeAll=function(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this},t.root=function(){return this._root},t.size=function(){var e=0;return this.visit(function(t){if(!t.length)do{++e}while(t=t.next)}),e},t.visit=function(t){var e,n,r,a,o,i,s=[],u=this._root;for(u&&s.push(new I(u,this._x0,this._y0,this._x1,this._y1));e=s.pop();)if(!t(u=e.node,r=e.x0,a=e.y0,o=e.x1,i=e.y1)&&u.length){var l=(r+o)/2,p=(a+i)/2;(n=u[3])&&s.push(new I(n,l,p,o,i)),(n=u[2])&&s.push(new I(n,r,p,l,i)),(n=u[1])&&s.push(new I(n,l,a,o,p)),(n=u[0])&&s.push(new I(n,r,a,l,p))}return this},t.visitAfter=function(t){var e,n=[],r=[];for(this._root&&n.push(new I(this._root,this._x0,this._y0,this._x1,this._y1));e=n.pop();){var a=e.node;if(a.length){var o,i=e.x0,s=e.y0,u=e.x1,l=e.y1,p=(i+u)/2,c=(s+l)/2;(o=a[0])&&n.push(new I(o,i,s,p,c)),(o=a[1])&&n.push(new I(o,p,s,u,c)),(o=a[2])&&n.push(new I(o,i,c,p,l)),(o=a[3])&&n.push(new I(o,p,c,u,l))}r.push(e)}for(;e=r.pop();)t(e.node,e.x0,e.y0,e.x1,e.y1);return this},t.x=function(t){return arguments.length?(this._x=t,this):this._x},t.y=function(t){return arguments.length?(this._y=t,this):this._y};const ml=1664525,dl=1013904223,fl=4294967296;function gl(t){return t.x}function hl(t){return t.y}var Ol=Math.PI*(3-Math.sqrt(5));function vl(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function jl(t){return(t=vl(Math.abs(t)))?t[1]:NaN}var yl,Il=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function Al(t){if(!(e=Il.exec(t)))throw new Error("invalid format: "+t);var e;return new xl({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}function xl(t){this.fill=void 0===t.fill?" ":t.fill+"",this.align=void 0===t.align?">":t.align+"",this.sign=void 0===t.sign?"-":t.sign+"",this.symbol=void 0===t.symbol?"":t.symbol+"",this.zero=!!t.zero,this.width=void 0===t.width?void 0:+t.width,this.comma=!!t.comma,this.precision=void 0===t.precision?void 0:+t.precision,this.trim=!!t.trim,this.type=void 0===t.type?"":t.type+""}function kl(t,e){var n=vl(t,e);if(!n)return t+"";var r=n[0],a=n[1];return a<0?"0."+new Array(-a).join("0")+r:r.length>a+1?r.slice(0,a+1)+"."+r.slice(a+1):r+new Array(a-r.length+2).join("0")}Al.prototype=xl.prototype,xl.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(void 0===this.width?"":Math.max(1,0|this.width))+(this.comma?",":"")+(void 0===this.precision?"":"."+Math.max(0,0|this.precision))+(this.trim?"~":"")+this.type};var Sl={"%":(t,e)=>(100*t).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:function(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)},e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>kl(100*t,e),r:kl,s:function(t,e){var n=vl(t,e);if(!n)return t+"";var r=n[0],a=n[1],o=a-(yl=3*Math.max(-8,Math.min(8,Math.floor(a/3))))+1,i=r.length;return o===i?r:o>i?r+new Array(o-i+1).join("0"):o>0?r.slice(0,o)+"."+r.slice(o):"0."+new Array(1-o).join("0")+vl(t,Math.max(0,e+o-1))[0]},X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function _l(t){return t}var Nl,Cl=Array.prototype.map,wl=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function Tl(t){var s,u,I=void 0===t.grouping||void 0===t.thousands?_l:(s=Cl.call(t.grouping,Number),u=t.thousands+"",function(t,e){for(var n=t.length,r=[],a=0,o=s[0],i=0;n>0&&o>0&&(i+o+1>e&&(o=Math.max(1,e-i)),r.push(t.substring(n-=o,n+o)),!((i+=o+1)>e));)o=s[a=(a+1)%s.length];return r.reverse().join(u)}),r=void 0===t.currency?"":t.currency[0]+"",a=void 0===t.currency?"":t.currency[1]+"",A=void 0===t.decimal?".":t.decimal+"",x=void 0===t.numerals?_l:function(e){return function(t){return t.replace(/[0-9]/g,function(t){return e[+t]})}}(Cl.call(t.numerals,String)),o=void 0===t.percent?"%":t.percent+"",k=void 0===t.minus?"":t.minus+"",S=void 0===t.nan?"NaN":t.nan+"";function i(t){var l=(t=Al(t)).fill,p=t.align,c=t.sign,e=t.symbol,b=t.zero,m=t.width,d=t.comma,f=t.precision,g=t.trim,h=t.type;"n"===h?(d=!0,h="g"):Sl[h]||(void 0===f&&(f=12),g=!0,h="g"),(b||"0"===l&&"="===p)&&(b=!0,l="0",p="=");var O="$"===e?r:"#"===e&&/[boxX]/.test(h)?"0"+h.toLowerCase():"",v="$"===e?a:/[%p]/.test(h)?o:"",j=Sl[h],y=/[defgprs%]/.test(h);function n(t){var e,n,r,a=O,o=v;if("c"===h)o=j(t)+o,t="";else{var i=(t=+t)<0||1/t<0;if(t=isNaN(t)?S:j(Math.abs(t),f),g&&(t=function(t){t:for(var e,n=t.length,r=1,a=-1;r<n;++r)switch(t[r]){case".":a=e=r;break;case"0":0===a&&(a=r),e=r;break;default:if(!+t[r])break t;a>0&&(a=0)}return a>0?t.slice(0,a)+t.slice(e+1):t}(t)),i&&0==+t&&"+"!==c&&(i=!1),a=(i?"("===c?c:k:"-"===c||"("===c?"":c)+a,o=("s"===h?wl[8+yl/3]:"")+o+(i&&"("===c?")":""),y)for(e=-1,n=t.length;++e<n;)if(48>(r=t.charCodeAt(e))||r>57){o=(46===r?A+t.slice(e+1):t.slice(e))+o,t=t.slice(0,e);break}}d&&!b&&(t=I(t,1/0));var s=a.length+t.length+o.length,u=s<m?new Array(m-s+1).join(l):"";switch(d&&b&&(t=I(u+t,u.length?m-o.length:1/0),u=""),p){case"<":t=a+t+o+u;break;case"=":t=a+u+t+o;break;case"^":t=u.slice(0,s=u.length>>1)+a+t+o+u.slice(s);break;default:t=u+a+t+o}return x(t)}return f=void 0===f?6:/[gprs]/.test(h)?Math.max(1,Math.min(21,f)):Math.max(0,Math.min(20,f)),n.toString=function(){return t+""},n}return{format:i,formatPrefix:function(t,e){var n=i(((t=Al(t)).type="f",t)),r=3*Math.max(-8,Math.min(8,Math.floor(jl(e)/3))),a=Math.pow(10,-r),o=wl[8+r/3];return function(t){return n(a*t)+o}}}}function El(t){return Nl=Tl(t),s.format=Nl.format,s.formatPrefix=Nl.formatPrefix,Nl}function Vl(t){return Math.max(0,-jl(Math.abs(t)))}function Pl(t,e){return Math.max(0,3*Math.max(-8,Math.min(8,Math.floor(jl(e)/3)))-jl(Math.abs(t)))}function zl(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,jl(e)-jl(t))+1}s.format=void 0,s.formatPrefix=void 0,El({thousands:",",grouping:[3],currency:["$",""]});var V=1e-6,Rl=1e-12,R=Math.PI,L=R/2,Ll=R/4,Ml=2*R,T=180/R,M=R/180,q=Math.abs,ql=Math.atan,Bl=Math.atan2,B=Math.cos,Dl=Math.ceil,Ul=Math.exp,Gl=Math.hypot,Fl=Math.log,Hl=Math.pow,F=Math.sin,Jl=Math.sign||function(t){return t>0?1:t<0?-1:0},H=Math.sqrt,Kl=Math.tan;function Xl(t){return t>1?0:t<-1?R:Math.acos(t)}function Zl(t){return t>1?L:t<-1?-L:Math.asin(t)}function Wl(t){return(t=F(t/2))*t}function n(){}function Yl(t,e){t&&Ql.hasOwnProperty(t.type)&&Ql[t.type](t,e)}var $l={Feature:function(t,e){Yl(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)Yl(n[r].geometry,e)}},Ql={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){tp(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)tp(n[r],e,0)},Polygon:function(t,e){ep(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)ep(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)Yl(n[r],e)}};function tp(t,e,n){var r,a=-1,o=t.length-n;for(e.lineStart();++a<o;)r=t[a],e.point(r[0],r[1],r[2]);e.lineEnd()}function ep(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)tp(t[n],e,1);e.polygonEnd()}function np(t,e){t&&$l.hasOwnProperty(t.type)?$l[t.type](t,e):Yl(t,e)}var rp,ap,op,ip,sp,c,up,b,lp,pp,cp,bp,mp,dp,fp,gp,hp=new E,Op=new E,vp={point:n,lineStart:n,lineEnd:n,polygonStart:function(){hp=new E,vp.lineStart=jp,vp.lineEnd=yp},polygonEnd:function(){var t=+hp;Op.add(t<0?Ml+t:t),this.lineStart=this.lineEnd=this.point=n},sphere:function(){Op.add(Ml)}};function jp(){vp.point=Ip}function yp(){Ap(rp,ap)}function Ip(t,e){vp.point=Ap,rp=t,ap=e,op=t*=M,ip=B(e=(e*=M)/2+Ll),sp=F(e)}function Ap(t,e){var n=(t*=M)-op,r=n>=0?1:-1,a=r*n,o=B(e=(e*=M)/2+Ll),i=F(e),s=sp*i,u=ip*o+s*B(a),l=s*r*F(a);hp.add(Bl(l,u)),op=t,ip=o,sp=i}function xp(t){return[Bl(t[1],t[0]),Zl(t[2])]}function kp(t){var e=t[0],n=t[1],r=B(n);return[r*B(e),r*F(e),F(n)]}function Sp(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function _p(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Np(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Cp(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function wp(t){var e=H(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Tp,Ep,Vp,Pp,zp,Rp,Lp,Mp,qp,Bp,Dp,Up,Gp,Fp,Hp,Jp,Kp={point:Xp,lineStart:Wp,lineEnd:Yp,polygonStart:function(){Kp.point=$p,Kp.lineStart=Qp,Kp.lineEnd=tc,dp=new E,vp.polygonStart()},polygonEnd:function(){vp.polygonEnd(),Kp.point=Xp,Kp.lineStart=Wp,Kp.lineEnd=Yp,hp<0?(c=-(b=180),up=-(lp=90)):dp>V?lp=90:dp<-V&&(up=-90),gp[0]=c,gp[1]=b},sphere:function(){c=-(b=180),up=-(lp=90)}};function Xp(t,e){fp.push(gp=[c=t,b=t]),e<up&&(up=e),e>lp&&(lp=e)}function Zp(t,e){var n=kp([t*M,e*M]);if(mp){var r=_p(mp,n),a=_p([r[1],-r[0],0],r);wp(a),a=xp(a);var o,i=t-pp,s=i>0?1:-1,u=a[0]*T*s,l=q(i)>180;l^(s*pp<u&&u<s*t)?(o=a[1]*T)>lp&&(lp=o):l^(s*pp<(u=(u+360)%360-180)&&u<s*t)?(o=-a[1]*T)<up&&(up=o):(e<up&&(up=e),e>lp&&(lp=e)),l?t<pp?ec(c,t)>ec(c,b)&&(b=t):ec(t,b)>ec(c,b)&&(c=t):b>=c?(t<c&&(c=t),t>b&&(b=t)):t>pp?ec(c,t)>ec(c,b)&&(b=t):ec(t,b)>ec(c,b)&&(c=t)}else fp.push(gp=[c=t,b=t]);e<up&&(up=e),e>lp&&(lp=e),mp=n,pp=t}function Wp(){Kp.point=Zp}function Yp(){gp[0]=c,gp[1]=b,Kp.point=Xp,mp=null}function $p(t,e){if(mp){var n=t-pp;dp.add(q(n)>180?n+(n>0?360:-360):n)}else cp=t,bp=e;vp.point(t,e),Zp(t,e)}function Qp(){vp.lineStart()}function tc(){$p(cp,bp),vp.lineEnd(),q(dp)>V&&(c=-(b=180)),gp[0]=c,gp[1]=b,mp=null}function ec(t,e){return(e-=t)<0?e+360:e}function nc(t,e){return t[0]-e[0]}function rc(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var ac={sphere:n,point:oc,lineStart:sc,lineEnd:pc,polygonStart:function(){ac.lineStart=cc,ac.lineEnd=bc},polygonEnd:function(){ac.lineStart=sc,ac.lineEnd=pc}};function oc(t,e){t*=M;var n=B(e*=M);ic(n*B(t),n*F(t),F(e))}function ic(t,e,n){++Tp,Vp+=(t-Vp)/Tp,Pp+=(e-Pp)/Tp,zp+=(n-zp)/Tp}function sc(){ac.point=uc}function uc(t,e){t*=M;var n=B(e*=M);Fp=n*B(t),Hp=n*F(t),Jp=F(e),ac.point=lc,ic(Fp,Hp,Jp)}function lc(t,e){t*=M;var n=B(e*=M),r=n*B(t),a=n*F(t),o=F(e),i=Bl(H((i=Hp*o-Jp*a)*i+(i=Jp*r-Fp*o)*i+(i=Fp*a-Hp*r)*i),Fp*r+Hp*a+Jp*o);Ep+=i,Rp+=i*(Fp+(Fp=r)),Lp+=i*(Hp+(Hp=a)),Mp+=i*(Jp+(Jp=o)),ic(Fp,Hp,Jp)}function pc(){ac.point=oc}function cc(){ac.point=mc}function bc(){dc(Up,Gp),ac.point=oc}function mc(t,e){Up=t,Gp=e,t*=M,e*=M,ac.point=dc;var n=B(e);Fp=n*B(t),Hp=n*F(t),Jp=F(e),ic(Fp,Hp,Jp)}function dc(t,e){t*=M;var n=B(e*=M),r=n*B(t),a=n*F(t),o=F(e),i=Hp*o-Jp*a,s=Jp*r-Fp*o,u=Fp*a-Hp*r,l=Gl(i,s,u),p=Zl(l),c=l&&-p/l;qp.add(c*i),Bp.add(c*s),Dp.add(c*u),Ep+=p,Rp+=p*(Fp+(Fp=r)),Lp+=p*(Hp+(Hp=a)),Mp+=p*(Jp+(Jp=o)),ic(Fp,Hp,Jp)}function fc(t){return function(){return t}}function gc(n,r){function t(t,e){return t=n(t,e),r(t[0],t[1])}return n.invert&&r.invert&&(t.invert=function(t,e){return(t=r.invert(t,e))&&n.invert(t[0],t[1])}),t}function hc(t,e){return q(t)>R&&(t-=Math.round(t/Ml)*Ml),[t,e]}function Oc(t,e,n){return(t%=Ml)?e||n?gc(jc(t),yc(e,n)):jc(t):e||n?yc(e,n):hc}function vc(n){return function(t,e){return q(t+=n)>R&&(t-=Math.round(t/Ml)*Ml),[t,e]}}function jc(t){var e=vc(t);return e.invert=vc(-t),e}function yc(t,e){var s=B(t),u=F(t),l=B(e),p=F(e);function n(t,e){var n=B(e),r=B(t)*n,a=F(t)*n,o=F(e),i=o*s+r*u;return[Bl(a*l-i*p,r*s-o*u),Zl(i*l+a*p)]}return n.invert=function(t,e){var n=B(e),r=B(t)*n,a=F(t)*n,o=F(e),i=o*l-a*p;return[Bl(a*l+o*p,r*s+i*u),Zl(i*s-r*u)]},n}function Ic(e){function t(t){return(t=e(t[0]*M,t[1]*M))[0]*=T,t[1]*=T,t}return e=Oc(e[0]*M,e[1]*M,e.length>2?e[2]*M:0),t.invert=function(t){return(t=e.invert(t[0]*M,t[1]*M))[0]*=T,t[1]*=T,t},t}function Ac(t,e,n,r,a,o){if(n){var i=B(e),s=F(e),u=r*n;null==a?(a=e+r*Ml,o=e-u/2):(a=xc(i,a),o=xc(i,o),(r>0?a<o:a>o)&&(a+=r*Ml));for(var l,p=a;r>0?p>o:p<o;p-=u)l=xp([i,-s*B(p),-s*F(p)]),t.point(l[0],l[1])}}function xc(t,e){(e=kp(e))[0]-=t,wp(e);var n=Xl(-e[1]);return((-e[2]<0?-n:n)+Ml-V)%Ml}function kc(){var r,e=[];return{point:function(t,e,n){r.push([t,e,n])},lineStart:function(){e.push(r=[])},lineEnd:n,rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))},result:function(){var t=e;return e=[],r=null,t}}}function Sc(t,e){return q(t[0]-e[0])<V&&q(t[1]-e[1])<V}function _c(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Nc(t,e,n,r,o){var i,a,s=[],u=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n,r=t[0],a=t[e];if(Sc(r,a)){if(!r[2]&&!a[2]){for(o.lineStart(),i=0;i<e;++i)o.point((r=t[i])[0],r[1]);return void o.lineEnd()}a[0]+=2*V}s.push(n=new _c(r,t,null,!0)),u.push(n.o=new _c(r,null,n,!1)),s.push(n=new _c(a,t,null,!1)),u.push(n.o=new _c(a,null,n,!0))}}),s.length){for(u.sort(e),Cc(s),Cc(u),i=0,a=u.length;i<a;++i)u[i].e=n=!n;for(var l,p,c=s[0];;){for(var b=c,m=!0;b.v;)if((b=b.n)===c)return;l=b.z,o.lineStart();do{if(b.v=b.o.v=!0,b.e){if(m)for(i=0,a=l.length;i<a;++i)o.point((p=l[i])[0],p[1]);else r(b.x,b.n.x,1,o);b=b.n}else{if(m)for(l=b.p.z,i=l.length-1;i>=0;--i)o.point((p=l[i])[0],p[1]);else r(b.x,b.p.x,-1,o);b=b.p}l=(b=b.o).z,m=!m}while(!b.v);o.lineEnd()}}}function Cc(t){if(e=t.length){for(var e,n,r=0,a=t[0];++r<e;)a.n=n=t[r],n.p=a,a=n;a.n=n=t[0],n.p=a}}function wc(t){return q(t[0])<=R?t[0]:Jl(t[0])*((q(t[0])+R)%Ml-R)}function Tc(t,e){var n=wc(e),r=e[1],a=F(r),o=[F(n),-B(n),0],i=0,s=0,u=new E;1===a?r=L+V:-1===a&&(r=-L-V);for(var l=0,p=t.length;l<p;++l)if(b=(c=t[l]).length)for(var c,b,m=c[b-1],d=wc(m),f=m[1]/2+Ll,g=F(f),h=B(f),O=0;O<b;++O,d=j,g=I,h=A,m=v){var v=c[O],j=wc(v),y=v[1]/2+Ll,I=F(y),A=B(y),x=j-d,k=x>=0?1:-1,S=k*x,_=S>R,N=g*I;if(u.add(Bl(N*k*F(S),h*A+N*B(S))),i+=_?x+k*Ml:x,_^d>=n^j>=n){var C=_p(kp(m),kp(v));wp(C);var w=_p(o,C);wp(w);var T=(_^x>=0?-1:1)*Zl(w[2]);(r>T||r===T&&(C[0]||C[1]))&&(s+=_^x>=0?1:-1)}}return(i<-V||i<V&&u<-Rl)^1&s}function Ec(g,h,O,v){return function(s){var u,l,p,n=h(s),c=kc(),b=h(c),m=!1,e={point:r,lineStart:a,lineEnd:o,polygonStart:function(){e.point=d,e.lineStart=i,e.lineEnd=f,l=[],u=[]},polygonEnd:function(){e.point=r,e.lineStart=a,e.lineEnd=o,l=Ft(l);var t=Tc(u,v);l.length?(m||(s.polygonStart(),m=!0),Nc(l,Pc,t,O,s)):t&&(m||(s.polygonStart(),m=!0),s.lineStart(),O(null,null,1,s),s.lineEnd()),m&&(s.polygonEnd(),m=!1),l=u=null},sphere:function(){s.polygonStart(),s.lineStart(),O(null,null,1,s),s.lineEnd(),s.polygonEnd()}};function r(t,e){g(t,e)&&s.point(t,e)}function t(t,e){n.point(t,e)}function a(){e.point=t,n.lineStart()}function o(){e.point=r,n.lineEnd()}function d(t,e){p.push([t,e]),b.point(t,e)}function i(){b.lineStart(),p=[]}function f(){d(p[0][0],p[0][1]),b.lineEnd();var t,e,n,r,a=b.clean(),o=c.result(),i=o.length;if(p.pop(),u.push(p),p=null,i)if(1&a){if((e=(n=o[0]).length-1)>0){for(m||(s.polygonStart(),m=!0),s.lineStart(),t=0;t<e;++t)s.point((r=n[t])[0],r[1]);s.lineEnd()}}else i>1&&2&a&&o.push(o.pop().concat(o.shift())),l.push(o.filter(Vc))}return e}}function Vc(t){return t.length>1}function Pc(t,e){return((t=t.x)[0]<0?t[1]-L-V:L-t[1])-((e=e.x)[0]<0?e[1]-L-V:L-e[1])}hc.invert=hc;var zc=Ec(function(){return!0},function(a){var o,i=NaN,s=NaN,u=NaN;return{lineStart:function(){a.lineStart(),o=1},point:function(t,e){var n=t>0?R:-R,r=q(t-i);q(r-R)<V?(a.point(i,s=(s+e)/2>0?L:-L),a.point(u,s),a.lineEnd(),a.lineStart(),a.point(n,s),a.point(t,s),o=0):u!==n&&r>=R&&(q(i-u)<V&&(i-=u*V),q(t-n)<V&&(t-=n*V),s=function(t,e,n,r){var a,o,i=F(t-n);return q(i)>V?ql((F(e)*(o=B(r))*F(n)-F(r)*(a=B(e))*F(t))/(a*o*i)):(e+r)/2}(i,s,t,e),a.point(u,s),a.lineEnd(),a.lineStart(),a.point(n,s),o=0),a.point(i=t,s=e),u=n},lineEnd:function(){a.lineEnd(),i=s=NaN},clean:function(){return 2-o}}},function(t,e,n,r){var a;if(null==t)a=n*L,r.point(-R,a),r.point(0,a),r.point(R,a),r.point(R,0),r.point(R,-a),r.point(0,-a),r.point(-R,-a),r.point(-R,0),r.point(-R,a);else if(q(t[0]-e[0])>V){var o=t[0]<e[0]?R:-R;a=n*o/2,r.point(-o,a),r.point(0,a),r.point(o,a)}else r.point(e[0],e[1])},[-R,-L]);function Rc(a){var S=B(a),o=2*M,m=S>0,d=q(S)>V;function f(t,e){return B(t)*B(e)>S}function g(t,e,n){var r=[1,0,0],a=_p(kp(t),kp(e)),o=Sp(a,a),i=a[0],s=o-i*i;if(!s)return!n&&t;var u=S*o/s,l=-S*i/s,p=_p(r,a),c=Cp(r,u);Np(c,Cp(a,l));var b=p,m=Sp(c,b),d=Sp(b,b),f=m*m-d*(Sp(c,c)-1);if(!(f<0)){var g=H(f),h=Cp(b,(-m-g)/d);if(Np(h,c),h=xp(h),!n)return h;var O,v=t[0],j=e[0],y=t[1],I=e[1];j<v&&(O=v,v=j,j=O);var A=j-v,x=q(A-R)<V;if(!x&&I<y&&(O=y,y=I,I=O),x||A<V?x?y+I>0^h[1]<(q(h[0]-v)<V?y:I):y<=h[1]&&h[1]<=I:A>R^(v<=h[0]&&h[0]<=j)){var k=Cp(b,(-m+g)/d);return Np(k,c),[h,xp(k)]}}}function h(t,e){var n=m?a:R-a,r=0;return t<-n?r|=1:t>n&&(r|=2),e<-n?r|=4:e>n&&(r|=8),r}return Ec(f,function(s){var u,l,p,c,b;return{lineStart:function(){c=p=!1,b=1},point:function(t,e){var n,r=[t,e],a=f(t,e),o=m?a?0:h(t,e):a?h(t+(t<0?R:-R),e):0;if(!u&&(c=p=a)&&s.lineStart(),a!==p&&(!(n=g(u,r))||Sc(u,n)||Sc(r,n))&&(r[2]=1),a!==p)b=0,a?(s.lineStart(),n=g(r,u),s.point(n[0],n[1])):(n=g(u,r),s.point(n[0],n[1],2),s.lineEnd()),u=n;else if(d&&u&&m^a){var i;o&l||!(i=g(r,u,!0))||(b=0,m?(s.lineStart(),s.point(i[0][0],i[0][1]),s.point(i[1][0],i[1][1]),s.lineEnd()):(s.point(i[1][0],i[1][1]),s.lineEnd(),s.lineStart(),s.point(i[0][0],i[0][1],3)))}!a||u&&Sc(u,r)||s.point(r[0],r[1]),u=r,p=a,l=o},lineEnd:function(){p&&s.lineEnd(),u=null},clean:function(){return b|(c&&p)<<1}}},function(t,e,n,r){Ac(r,a,o,n,t,e)},m?[0,-a]:[-R,a-R])}var Lc,Mc,qc,Bc,Dc=1e9,Uc=-Dc;function Gc(h,O,v,j){function y(t,e){return h<=t&&t<=v&&O<=e&&e<=j}function I(t,e,n,r){var a=0,o=0;if(null==t||(a=i(t,n))!==(o=i(e,n))||s(t,e)<0^n>0)do{r.point(0===a||3===a?h:v,a>1?j:O)}while((a=(a+n+4)%4)!==o);else r.point(e[0],e[1])}function i(t,e){return q(t[0]-h)<V?e>0?0:3:q(t[0]-v)<V?e>0?2:1:q(t[1]-O)<V?e>0?1:0:e>0?3:2}function A(t,e){return s(t.x,e.x)}function s(t,e){var n=i(t,1),r=i(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(r){var a,c,o,i,s,u,l,p,b,m,d,f=r,t=kc(),e={point:n,lineStart:function(){e.point=g,c&&c.push(o=[]);m=!0,b=!1,l=p=NaN},lineEnd:function(){a&&(g(i,s),u&&b&&t.rejoin(),a.push(t.result()));e.point=n,b&&f.lineEnd()},polygonStart:function(){f=t,a=[],c=[],d=!0},polygonEnd:function(){var t=function(){for(var t=0,e=0,n=c.length;e<n;++e)for(var r,a,o=c[e],i=1,s=o.length,u=o[0],l=u[0],p=u[1];i<s;++i)r=l,a=p,l=(u=o[i])[0],p=u[1],a<=j?p>j&&(l-r)*(j-a)>(p-a)*(h-r)&&++t:p<=j&&(l-r)*(j-a)<(p-a)*(h-r)&&--t;return t}(),e=d&&t,n=(a=Ft(a)).length;(e||n)&&(r.polygonStart(),e&&(r.lineStart(),I(null,null,1,r),r.lineEnd()),n&&Nc(a,A,t,I,r),r.polygonEnd());f=r,a=c=o=null}};function n(t,e){y(t,e)&&f.point(t,e)}function g(t,e){var n=y(t,e);if(c&&o.push([t,e]),m)i=t,s=e,u=n,m=!1,n&&(f.lineStart(),f.point(t,e));else if(n&&b)f.point(t,e);else{var r=[l=Math.max(Uc,Math.min(Dc,l)),p=Math.max(Uc,Math.min(Dc,p))],a=[t=Math.max(Uc,Math.min(Dc,t)),e=Math.max(Uc,Math.min(Dc,e))];!function(t,e,n,r,a,o){var i,s=t[0],u=t[1],l=0,p=1,c=e[0]-s,b=e[1]-u;if(i=n-s,c||!(i>0)){if(i/=c,c<0){if(i<l)return;i<p&&(p=i)}else if(c>0){if(i>p)return;i>l&&(l=i)}if(i=a-s,c||!(i<0)){if(i/=c,c<0){if(i>p)return;i>l&&(l=i)}else if(c>0){if(i<l)return;i<p&&(p=i)}if(i=r-u,b||!(i>0)){if(i/=b,b<0){if(i<l)return;i<p&&(p=i)}else if(b>0){if(i>p)return;i>l&&(l=i)}if(i=o-u,b||!(i<0)){if(i/=b,b<0){if(i>p)return;i>l&&(l=i)}else if(b>0){if(i<l)return;i<p&&(p=i)}return l>0&&(t[0]=s+l*c,t[1]=u+l*b),p<1&&(e[0]=s+p*c,e[1]=u+p*b),!0}}}}}(r,a,h,O,v,j)?n&&(f.lineStart(),f.point(t,e),d=!1):(b||(f.lineStart(),f.point(r[0],r[1])),f.point(a[0],a[1]),n||f.lineEnd(),d=!1)}l=t,p=e,b=n}return e}}var Fc={sphere:n,point:n,lineStart:function(){Fc.point=Jc,Fc.lineEnd=Hc},lineEnd:n,polygonStart:n,polygonEnd:n};function Hc(){Fc.point=Fc.lineEnd=n}function Jc(t,e){Mc=t*=M,qc=F(e*=M),Bc=B(e),Fc.point=Kc}function Kc(t,e){t*=M;var n=F(e*=M),r=B(e),a=q(t-Mc),o=B(a),i=r*F(a),s=Bc*n-qc*r*o,u=qc*n+Bc*r*o;Lc.add(Bl(H(i*i+s*s),u)),Mc=t,qc=n,Bc=r}function Xc(t){return Lc=new E,np(t,Fc),+Lc}var Zc=[null,null],Wc={type:"LineString",coordinates:Zc};function Yc(t,e){return Zc[0]=t,Zc[1]=e,Xc(Wc)}var $c={Feature:function(t,e){return tb(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,a=n.length;++r<a;)if(tb(n[r].geometry,e))return!0;return!1}},Qc={Sphere:function(){return!0},Point:function(t,e){return eb(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)if(eb(n[r],e))return!0;return!1},LineString:function(t,e){return nb(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)if(nb(n[r],e))return!0;return!1},Polygon:function(t,e){return rb(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,a=n.length;++r<a;)if(rb(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,a=n.length;++r<a;)if(tb(n[r],e))return!0;return!1}};function tb(t,e){return!(!t||!Qc.hasOwnProperty(t.type))&&Qc[t.type](t,e)}function eb(t,e){return 0===Yc(t,e)}function nb(t,e){for(var n,r,a,o=0,i=t.length;o<i;o++){if(0===(r=Yc(t[o],e)))return!0;if(o>0&&(a=Yc(t[o],t[o-1]))>0&&n<=a&&r<=a&&(n+r-a)*(1-Math.pow((n-r)/a,2))<Rl*a)return!0;n=r}return!1}function rb(t,e){return!!Tc(t.map(ab),ob(e))}function ab(t){return(t=t.map(ob)).pop(),t}function ob(t){return[t[0]*M,t[1]*M]}function ib(t,e,n){var r=Jt(t,e-V,n).concat(e);return function(e){return r.map(function(t){return[e,t]})}}function sb(t,e,n){var r=Jt(t,e-V,n).concat(e);return function(e){return r.map(function(t){return[t,e]})}}function ub(){var e,n,r,a,o,i,s,u,l,p,c,b,m=10,d=m,f=90,g=360,h=2.5;function O(){return{type:"MultiLineString",coordinates:t()}}function t(){return Jt(Dl(a/f)*f,r,f).map(c).concat(Jt(Dl(u/g)*g,s,g).map(b)).concat(Jt(Dl(n/m)*m,e,m).filter(function(t){return q(t%f)>V}).map(l)).concat(Jt(Dl(i/d)*d,o,d).filter(function(t){return q(t%g)>V}).map(p))}return O.lines=function(){return t().map(function(t){return{type:"LineString",coordinates:t}})},O.outline=function(){return{type:"Polygon",coordinates:[c(a).concat(b(s).slice(1),c(r).reverse().slice(1),b(u).reverse().slice(1))]}},O.extent=function(t){return arguments.length?O.extentMajor(t).extentMinor(t):O.extentMinor()},O.extentMajor=function(t){return arguments.length?(a=+t[0][0],r=+t[1][0],u=+t[0][1],s=+t[1][1],a>r&&(t=a,a=r,r=t),u>s&&(t=u,u=s,s=t),O.precision(h)):[[a,u],[r,s]]},O.extentMinor=function(t){return arguments.length?(n=+t[0][0],e=+t[1][0],i=+t[0][1],o=+t[1][1],n>e&&(t=n,n=e,e=t),i>o&&(t=i,i=o,o=t),O.precision(h)):[[n,i],[e,o]]},O.step=function(t){return arguments.length?O.stepMajor(t).stepMinor(t):O.stepMinor()},O.stepMajor=function(t){return arguments.length?(f=+t[0],g=+t[1],O):[f,g]},O.stepMinor=function(t){return arguments.length?(m=+t[0],d=+t[1],O):[m,d]},O.precision=function(t){return arguments.length?(h=+t,l=ib(i,o,90),p=sb(n,e,h),c=ib(u,s,90),b=sb(a,r,h),O):h},O.extentMajor([[-180,-90+V],[180,90-V]]).extentMinor([[-180,-80-V],[180,80+V]])}var lb,pb,cb,bb,mb=t=>t,db=new E,fb=new E,gb={point:n,lineStart:n,lineEnd:n,polygonStart:function(){gb.lineStart=hb,gb.lineEnd=jb},polygonEnd:function(){gb.lineStart=gb.lineEnd=gb.point=n,db.add(q(fb)),fb=new E},result:function(){var t=db/2;return db=new E,t}};function hb(){gb.point=Ob}function Ob(t,e){gb.point=vb,lb=cb=t,pb=bb=e}function vb(t,e){fb.add(bb*t-cb*e),cb=t,bb=e}function jb(){vb(lb,pb)}var yb=gb,Ib=1/0,Ab=Ib,xb=-Ib,kb=xb,Sb={point:function(t,e){t<Ib&&(Ib=t);t>xb&&(xb=t);e<Ab&&(Ab=e);e>kb&&(kb=e)},lineStart:n,lineEnd:n,polygonStart:n,polygonEnd:n,result:function(){var t=[[Ib,Ab],[xb,kb]];return xb=kb=-(Ab=Ib=1/0),t}};var _b,Nb,Cb,wb,Tb=Sb,Eb=0,Vb=0,Pb=0,zb=0,Rb=0,Lb=0,Mb=0,qb=0,Bb=0,Db={point:Ub,lineStart:Gb,lineEnd:Jb,polygonStart:function(){Db.lineStart=Kb,Db.lineEnd=Xb},polygonEnd:function(){Db.point=Ub,Db.lineStart=Gb,Db.lineEnd=Jb},result:function(){var t=Bb?[Mb/Bb,qb/Bb]:Lb?[zb/Lb,Rb/Lb]:Pb?[Eb/Pb,Vb/Pb]:[NaN,NaN];return Eb=Vb=Pb=zb=Rb=Lb=Mb=qb=Bb=0,t}};function Ub(t,e){Eb+=t,Vb+=e,++Pb}function Gb(){Db.point=Fb}function Fb(t,e){Db.point=Hb,Ub(Cb=t,wb=e)}function Hb(t,e){var n=t-Cb,r=e-wb,a=H(n*n+r*r);zb+=a*(Cb+t)/2,Rb+=a*(wb+e)/2,Lb+=a,Ub(Cb=t,wb=e)}function Jb(){Db.point=Ub}function Kb(){Db.point=Zb}function Xb(){Wb(_b,Nb)}function Zb(t,e){Db.point=Wb,Ub(_b=Cb=t,Nb=wb=e)}function Wb(t,e){var n=t-Cb,r=e-wb,a=H(n*n+r*r);zb+=a*(Cb+t)/2,Rb+=a*(wb+e)/2,Lb+=a,Mb+=(a=wb*t-Cb*e)*(Cb+t),qb+=a*(wb+e),Bb+=3*a,Ub(Cb=t,wb=e)}var Yb=Db;function $b(t){this._context=t}$b.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){0===this._line&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:this._context.moveTo(t,e),this._point=1;break;case 1:this._context.lineTo(t,e);break;default:this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,Ml)}},result:n};var Qb,tm,em,nm,rm,am=new E,om={point:n,lineStart:function(){om.point=im},lineEnd:function(){Qb&&sm(tm,em),om.point=n},polygonStart:function(){Qb=!0},polygonEnd:function(){Qb=null},result:function(){var t=+am;return am=new E,t}};function im(t,e){om.point=sm,tm=nm=t,em=rm=e}function sm(t,e){nm-=t,rm-=e,am.add(H(nm*nm+rm*rm)),nm=t,rm=e}var um=om;let lm,pm,cm,bm;class mm{constructor(t){this._append=null==t?dm:function(r){const t=Math.floor(r);if(!(t>=0))throw new RangeError(`invalid digits: ${r}`);if(t>15)return dm;if(t!==lm){const r=10**t;lm=t,pm=function(e){let n=1;this._+=e[0];for(const t=e.length;n<t;++n)this._+=Math.round(arguments[n]*r)/r+e[n]}}return pm}(t),this._radius=4.5,this._=""}pointRadius(t){return this._radius=+t,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){0===this._line&&(this._+="Z"),this._point=NaN}point(t,e){switch(this._point){case 0:this._append`M${t},${e}`,this._point=1;break;case 1:this._append`L${t},${e}`;break;default:if(this._append`M${t},${e}`,this._radius!==cm||this._append!==pm){const t=this._radius,e=this._;this._="",this._append`m0,${t}a${t},${t} 0 1,1 0,${-2*t}a${t},${t} 0 1,1 0,${2*t}z`,cm=t,pm=this._append,bm=this._,this._=e}this._+=bm}}result(){const t=this._;return this._="",t.length?t:null}}function dm(e){let n=1;this._+=e[0];for(const t=e.length;n<t;++n)this._+=arguments[n]+e[n]}function fm(r){return function(t){var e=new gm;for(var n in r)e[n]=r[n];return e.stream=t,e}}function gm(){}function hm(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),null!=r&&t.clipExtent(null),np(n,t.stream(Tb)),e(Tb.result()),null!=r&&t.clipExtent(r),t}function Om(i,s,t){return hm(i,function(t){var e=s[1][0]-s[0][0],n=s[1][1]-s[0][1],r=Math.min(e/(t[1][0]-t[0][0]),n/(t[1][1]-t[0][1])),a=+s[0][0]+(e-r*(t[1][0]+t[0][0]))/2,o=+s[0][1]+(n-r*(t[1][1]+t[0][1]))/2;i.scale(150*r).translate([a,o])},t)}function vm(t,e,n){return Om(t,[[0,0],e],n)}function jm(o,i,t){return hm(o,function(t){var e=+i,n=e/(t[1][0]-t[0][0]),r=(e-n*(t[1][0]+t[0][0]))/2,a=-n*t[0][1];o.scale(150*n).translate([r,a])},t)}function ym(o,i,t){return hm(o,function(t){var e=+i,n=e/(t[1][1]-t[0][1]),r=-n*t[0][0],a=(e-n*(t[1][1]+t[0][1]))/2;o.scale(150*n).translate([r,a])},t)}gm.prototype={constructor:gm,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};var Im=16,Am=B(30*M);function xm(t,e){return+e?function(C,w){function T(t,e,n,r,a,o,i,s,u,l,p,c,b,m){var d=i-t,f=s-e,g=d*d+f*f;if(g>4*w&&b--){var h=r+l,O=a+p,v=o+c,j=H(h*h+O*O+v*v),y=Zl(v/=j),I=q(q(v)-1)<V||q(n-u)<V?(n+u)/2:Bl(O,h),A=C(I,y),x=A[0],k=A[1],S=x-t,_=k-e,N=f*S-d*_;(N*N/g>w||q((d*S+f*_)/g-.5)>.3||r*l+a*p+o*c<Am)&&(T(t,e,n,r,a,o,x,k,I,h/=j,O/=j,v,b,m),m.point(x,k),T(x,k,I,h,O,v,i,s,u,l,p,c,b,m))}}return function(a){var n,r,o,i,s,u,l,p,c,b,m,d,f={point:t,lineStart:e,lineEnd:h,polygonStart:function(){a.polygonStart(),f.lineStart=O},polygonEnd:function(){a.polygonEnd(),f.lineStart=e}};function t(t,e){t=C(t,e),a.point(t[0],t[1])}function e(){p=NaN,f.point=g,a.lineStart()}function g(t,e){var n=kp([t,e]),r=C(t,e);T(p,c,l,b,m,d,p=r[0],c=r[1],l=t,b=n[0],m=n[1],d=n[2],Im,a),a.point(p,c)}function h(){f.point=t,a.lineEnd()}function O(){e(),f.point=v,f.lineEnd=j}function v(t,e){g(n=t,e),r=p,o=c,i=b,s=m,u=d,f.point=g}function j(){T(p,c,l,b,m,d,r,o,n,i,s,u,Im,a),f.lineEnd=h,h()}return f}}(t,e):function(n){return fm({point:function(t,e){t=n(t,e),this.stream.point(t[0],t[1])}})}(t)}var km=fm({point:function(t,e){this.stream.point(t*M,e*M)}});function Sm(t,n,r,a,o,e){if(!e)return function(n,r,a,o,i){function t(t,e){return[r+n*(t*=o),a-n*(e*=i)]}return t.invert=function(t,e){return[(t-r)/n*o,(a-e)/n*i]},t}(t,n,r,a,o);var i=B(e),s=F(e),u=i*t,l=s*t,p=i/t,c=s/t,b=(s*r-i*n)/t,m=(s*n+i*r)/t;function d(t,e){return[u*(t*=a)-l*(e*=o)+n,r-l*t-u*e]}return d.invert=function(t,e){return[a*(p*t-c*e+b),o*(m-c*t-p*e)]},d}function _m(t){return Nm(function(){return t})()}function Nm(t){var n,r,e,a,o,i,s,u,l,p,c=150,b=480,m=250,d=0,f=0,g=0,h=0,O=0,v=0,j=1,y=1,I=null,A=zc,x=null,k=mb,S=.5;function _(t){return u(t[0]*M,t[1]*M)}function N(t){return(t=u.invert(t[0],t[1]))&&[t[0]*T,t[1]*T]}function C(){var t=Sm(c,0,0,j,y,v).apply(null,n(d,f)),e=Sm(c,b-t[0],m-t[1],j,y,v);return r=Oc(g,h,O),s=gc(n,e),u=gc(r,s),i=xm(s,S),w()}function w(){return l=p=null,_}return _.stream=function(t){return l&&p===t?l:l=km(function(r){return fm({point:function(t,e){var n=r(t,e);return this.stream.point(n[0],n[1])}})}(r)(A(i(k(p=t)))))},_.preclip=function(t){return arguments.length?(A=t,I=void 0,w()):A},_.postclip=function(t){return arguments.length?(k=t,x=e=a=o=null,w()):k},_.clipAngle=function(t){return arguments.length?(A=+t?Rc(I=t*M):(I=null,zc),w()):I*T},_.clipExtent=function(t){return arguments.length?(k=null==t?(x=e=a=o=null,mb):Gc(x=+t[0][0],e=+t[0][1],a=+t[1][0],o=+t[1][1]),w()):null==x?null:[[x,e],[a,o]]},_.scale=function(t){return arguments.length?(c=+t,C()):c},_.translate=function(t){return arguments.length?(b=+t[0],m=+t[1],C()):[b,m]},_.center=function(t){return arguments.length?(d=t[0]%360*M,f=t[1]%360*M,C()):[d*T,f*T]},_.rotate=function(t){return arguments.length?(g=t[0]%360*M,h=t[1]%360*M,O=t.length>2?t[2]%360*M:0,C()):[g*T,h*T,O*T]},_.angle=function(t){return arguments.length?(v=t%360*M,C()):v*T},_.reflectX=function(t){return arguments.length?(j=t?-1:1,C()):j<0},_.reflectY=function(t){return arguments.length?(y=t?-1:1,C()):y<0},_.precision=function(t){return arguments.length?(i=xm(s,S=t*t),w()):H(S)},_.fitExtent=function(t,e){return Om(_,t,e)},_.fitSize=function(t,e){return vm(_,t,e)},_.fitWidth=function(t,e){return jm(_,t,e)},_.fitHeight=function(t,e){return ym(_,t,e)},function(){return n=t.apply(this,arguments),_.invert=n.invert&&N,C()}}function Cm(t){var e=0,n=R/3,r=Nm(t),a=r(e,n);return a.parallels=function(t){return arguments.length?r(e=t[0]*M,n=t[1]*M):[e*T,n*T]},a}function wm(t,e){var n=F(t),a=(n+F(e))/2;if(q(a)<V)return function(t){var n=B(t);function e(t,e){return[t*n,F(e)/n]}return e.invert=function(t,e){return[t/n,Zl(e*n)]},e}(t);var o=1+n*(2*a-n),i=H(o)/a;function r(t,e){var n=H(o-2*a*F(e))/a;return[n*F(t*=a),i-n*B(t)]}return r.invert=function(t,e){var n=i-e,r=Bl(t,q(n))*Jl(n);return n*a<0&&(r-=R*Jl(t)*Jl(n)),[r/a,Zl((o-(t*t+n*n)*a*a)/(2*a))]},r}function Tm(){return Cm(wm).scale(155.424).center([0,33.6442])}function Em(){return Tm().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function Vm(o){return function(t,e){var n=B(t),r=B(e),a=o(n*r);return a===1/0?[2,0]:[a*r*F(t),a*F(e)]}}function Pm(i){return function(t,e){var n=H(t*t+e*e),r=i(n),a=F(r),o=B(r);return[Bl(t*a,n*o),Zl(n&&e*a/n)]}}var zm=Vm(function(t){return H(2/(1+t))});zm.invert=Pm(function(t){return 2*Zl(t/2)});var Rm=Vm(function(t){return(t=Xl(t))&&t/F(t)});function Lm(t,e){return[t,Fl(Kl((L+e)/2))]}function Mm(n){var r,a,o,i=_m(n),e=i.center,s=i.scale,u=i.translate,l=i.clipExtent,p=null;function c(){var t=R*s(),e=i(Ic(i.rotate()).invert([0,0]));return l(null==p?[[e[0]-t,e[1]-t],[e[0]+t,e[1]+t]]:n===Lm?[[Math.max(e[0]-t,p),r],[Math.min(e[0]+t,a),o]]:[[p,Math.max(e[1]-t,r)],[a,Math.min(e[1]+t,o)]])}return i.scale=function(t){return arguments.length?(s(t),c()):s()},i.translate=function(t){return arguments.length?(u(t),c()):u()},i.center=function(t){return arguments.length?(e(t),c()):e()},i.clipExtent=function(t){return arguments.length?(null==t?p=r=a=o=null:(p=+t[0][0],r=+t[0][1],a=+t[1][0],o=+t[1][1]),c()):null==p?null:[[p,r],[a,o]]},c()}function qm(t){return Kl((L+t)/2)}function Bm(t,e){var n=B(t),o=t===e?F(t):Fl(n/B(e))/Fl(qm(e)/qm(t)),i=n*Hl(qm(t),o)/o;if(!o)return Lm;function r(t,e){i>0?e<-L+V&&(e=-L+V):e>L-V&&(e=L-V);var n=i/Hl(qm(e),o);return[n*F(o*t),i-n*B(o*t)]}return r.invert=function(t,e){var n=i-e,r=Jl(o)*H(t*t+n*n),a=Bl(t,q(n))*Jl(n);return n*o<0&&(a-=R*Jl(t)*Jl(n)),[a/o,2*ql(Hl(i/r,1/o))-L]},r}function Dm(t,e){return[t,e]}function Um(t,e){var n=B(t),a=t===e?F(t):(n-B(e))/(e-t),o=n/a+t;if(q(a)<V)return Dm;function r(t,e){var n=o-e,r=a*t;return[n*F(r),o-n*B(r)]}return r.invert=function(t,e){var n=o-e,r=Bl(t,q(n))*Jl(n);return n*a<0&&(r-=R*Jl(t)*Jl(n)),[r/a,o-Jl(a)*H(t*t+n*n)]},r}Rm.invert=Pm(function(t){return t}),Lm.invert=function(t,e){return[t,2*ql(Ul(e))-L]},Dm.invert=Dm;var Gm=1.340264,Fm=-.081106,Hm=893e-6,Jm=.003796,Km=H(3)/2;function Xm(t,e){var n=Zl(Km*F(e)),r=n*n,a=r*r*r;return[t*B(n)/(Km*(Gm+3*Fm*r+a*(7*Hm+9*Jm*r))),n*(Gm+Fm*r+a*(Hm+Jm*r))]}function Zm(t,e){var n=B(e),r=B(t)*n;return[n*F(t)/r,F(e)/r]}function Wm(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(r*(.003971*n-.001529*r)-.013791)),e*(1.007226+n*(.015085+r*(.028874*n-.044475-.005916*r)))]}function Ym(t,e){return[B(e)*F(t),F(e)]}function $m(t,e){var n=B(e),r=1+B(t)*n;return[n*F(t)/r,F(e)/r]}function Qm(t,e){return[Fl(Kl((L+e)/2)),-t]}function td(t,e){return t.parent===e.parent?1:2}function ed(t,e){return t+e.x}function nd(t,e){return Math.max(t,e.y)}function rd(t){var e=0,n=t.children,r=n&&n.length;if(r)for(;--r>=0;)e+=n[r].value;else e=1;t.value=e}function ad(t,e){t instanceof Map?(t=[void 0,t],void 0===e&&(e=id)):void 0===e&&(e=od);for(var n,r,a,o,i,s=new ld(t),u=[s];n=u.pop();)if((a=e(n.data))&&(i=(a=Array.from(a)).length))for(n.children=a,o=i-1;o>=0;--o)u.push(r=a[o]=new ld(a[o])),r.parent=n,r.depth=n.depth+1;return s.eachBefore(ud)}function od(t){return t.children}function id(t){return Array.isArray(t)?t[1]:null}function sd(t){void 0!==t.data.value&&(t.value=t.data.value),t.data=t.data.data}function ud(t){var e=0;do{t.height=e}while((t=t.parent)&&t.height<++e)}function ld(t){this.data=t,this.depth=this.height=0,this.parent=null}function pd(t){return null==t?null:cd(t)}function cd(t){if("function"!=typeof t)throw new Error;return t}function bd(){return 0}function md(t){return function(){return t}}Xm.invert=function(t,e){for(var n,r=e,a=r*r,o=a*a*a,i=0;i<12&&(o=(a=(r-=n=(r*(Gm+Fm*a+o*(Hm+Jm*a))-e)/(Gm+3*Fm*a+o*(7*Hm+9*Jm*a)))*r)*a*a,!(q(n)<Rl));++i);return[Km*t*(Gm+3*Fm*a+o*(7*Hm+9*Jm*a))/B(r),Zl(F(r)/Km)]},Zm.invert=Pm(ql),Wm.invert=function(t,e){var n,r=e,a=25;do{var o=r*r,i=o*o;r-=n=(r*(1.007226+o*(.015085+i*(.028874*o-.044475-.005916*i)))-e)/(1.007226+o*(.045255+i*(.259866*o-.311325-.005916*11*i)))}while(q(n)>V&&--a>0);return[t/(.8707+(o=r*r)*(o*(o*o*o*(.003971-.001529*o)-.013791)-.131979)),r]},Ym.invert=Pm(Zl),$m.invert=Pm(function(t){return 2*ql(t)}),Qm.invert=function(t,e){return[-e,2*ql(Ul(t))-L]},ld.prototype=ad.prototype={constructor:ld,count:function(){return this.eachAfter(rd)},each:function(e,n){let r=-1;for(const t of this)e.call(n,t,++r,this);return this},eachAfter:function(t,e){for(var n,r,a,o=this,i=[o],s=[],u=-1;o=i.pop();)if(s.push(o),n=o.children)for(r=0,a=n.length;r<a;++r)i.push(n[r]);for(;o=s.pop();)t.call(e,o,++u,this);return this},eachBefore:function(t,e){for(var n,r,a=this,o=[a],i=-1;a=o.pop();)if(t.call(e,a,++i,this),n=a.children)for(r=n.length-1;r>=0;--r)o.push(n[r]);return this},find:function(e,n){let r=-1;for(const t of this)if(e.call(n,t,++r,this))return t},sum:function(a){return this.eachAfter(function(t){for(var e=+a(t.data)||0,n=t.children,r=n&&n.length;--r>=0;)e+=n[r].value;t.value=e})},sort:function(e){return this.eachBefore(function(t){t.children&&t.children.sort(e)})},path:function(t){for(var e=this,n=function(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),a=null;t=n.pop(),e=r.pop();for(;t===e;)a=t,t=n.pop(),e=r.pop();return a}(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var a=r.length;t!==n;)r.splice(a,0,t),t=t.parent;return r},ancestors:function(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e},descendants:function(){return Array.from(this)},leaves:function(){var e=[];return this.eachBefore(function(t){t.children||e.push(t)}),e},links:function(){var e=this,n=[];return e.each(function(t){t!==e&&n.push({source:t.parent,target:t})}),n},copy:function(){return ad(this).eachBefore(sd)},[Symbol.iterator]:function*(){var t,e,n,r,a=this,o=[a];do{for(t=o.reverse(),o=[];a=t.pop();)if(yield a,e=a.children)for(n=0,r=e.length;n<r;++n)o.push(e[n])}while(o.length)}};const dd=1664525,fd=1013904223,gd=4294967296;function hd(){let t=1;return()=>(t=(dd*t+fd)%gd)/gd}function Od(t,e){for(var n,r,a=0,o=(t=function(t,e){let n,r,a=t.length;for(;a;)r=e()*a--|0,n=t[a],t[a]=t[r],t[r]=n;return t}(Array.from(t),e)).length,i=[];a<o;)n=t[a],r&&yd(r,n)?++a:(r=Ad(i=vd(i,n)),a=0);return r}function vd(t,e){var n,r;if(Id(e,t))return[e];for(n=0;n<t.length;++n)if(jd(e,t[n])&&Id(xd(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(jd(xd(t[n],t[r]),e)&&jd(xd(t[n],e),t[r])&&jd(xd(t[r],e),t[n])&&Id(kd(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function jd(t,e){var n=t.r-e.r,r=e.x-t.x,a=e.y-t.y;return n<0||n*n<r*r+a*a}function yd(t,e){var n=t.r-e.r+1e-9*Math.max(t.r,e.r,1),r=e.x-t.x,a=e.y-t.y;return n>0&&n*n>r*r+a*a}function Id(t,e){for(var n=0;n<e.length;++n)if(!yd(t,e[n]))return!1;return!0}function Ad(t){switch(t.length){case 1:return function(t){return{x:t.x,y:t.y,r:t.r}}(t[0]);case 2:return xd(t[0],t[1]);case 3:return kd(t[0],t[1],t[2])}}function xd(t,e){var n=t.x,r=t.y,a=t.r,o=e.x,i=e.y,s=e.r,u=o-n,l=i-r,p=s-a,c=Math.sqrt(u*u+l*l);return{x:(n+o+u/c*p)/2,y:(r+i+l/c*p)/2,r:(c+a+s)/2}}function kd(t,e,n){var r=t.x,a=t.y,o=t.r,i=e.x,s=e.y,u=e.r,l=n.x,p=n.y,c=n.r,b=r-i,m=r-l,d=a-s,f=a-p,g=u-o,h=c-o,O=r*r+a*a-o*o,v=O-i*i-s*s+u*u,j=O-l*l-p*p+c*c,y=m*d-b*f,I=(d*j-f*v)/(2*y)-r,A=(f*g-d*h)/y,x=(m*v-b*j)/(2*y)-a,k=(b*h-m*g)/y,S=A*A+k*k-1,_=2*(o+I*A+x*k),N=I*I+x*x-o*o,C=-(Math.abs(S)>1e-6?(_+Math.sqrt(_*_-4*S*N))/(2*S):N/_);return{x:r+I+A*C,y:a+x+k*C,r:C}}function Sd(t,e,n){var r,a,o,i,s=t.x-e.x,u=t.y-e.y,l=s*s+u*u;l?(a=e.r+n.r,a*=a,i=t.r+n.r,a>(i*=i)?(r=(l+i-a)/(2*l),o=Math.sqrt(Math.max(0,i/l-r*r)),n.x=t.x-r*s-o*u,n.y=t.y-r*u+o*s):(r=(l+a-i)/(2*l),o=Math.sqrt(Math.max(0,a/l-r*r)),n.x=e.x+r*s-o*u,n.y=e.y+r*u+o*s)):(n.x=e.x+n.r,n.y=e.y)}function _d(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,a=e.y-t.y;return n>0&&n*n>r*r+a*a}function Nd(t){var e=t._,n=t.next._,r=e.r+n.r,a=(e.x*n.r+n.x*e.r)/r,o=(e.y*n.r+n.y*e.r)/r;return a*a+o*o}function Cd(t){this._=t,this.next=null,this.previous=null}function wd(t,e){if(!(o=(t=function(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}(t)).length))return 0;var n,r,a,o,i,s,u,l,p,c,b;if((n=t[0]).x=0,n.y=0,!(o>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(o>2))return n.r+r.r;Sd(r,n,a=t[2]),n=new Cd(n),r=new Cd(r),a=new Cd(a),n.next=a.previous=r,r.next=n.previous=a,a.next=r.previous=n;t:for(u=3;u<o;++u){Sd(n._,r._,a=t[u]),a=new Cd(a),l=r.next,p=n.previous,c=r._.r,b=n._.r;do{if(c<=b){if(_d(l._,a._)){r=l,n.next=r,r.previous=n,--u;continue t}c+=l._.r,l=l.next}else{if(_d(p._,a._)){(n=p).next=r,r.previous=n,--u;continue t}b+=p._.r,p=p.previous}}while(l!==p.next);for(a.previous=n,a.next=r,n.next=r.previous=r=a,i=Nd(n);(a=a.next)!==r;)(s=Nd(a))<i&&(n=a,i=s);r=n.next}for(n=[r._],a=r;(a=a.next)!==r;)n.push(a._);for(a=Od(n,e),u=0;u<o;++u)(n=t[u]).x-=a.x,n.y-=a.y;return a.r}function Td(t){return Math.sqrt(t.value)}function Ed(e){return function(t){t.children||(t.r=Math.max(0,+e(t)||0))}}function Vd(i,s,u){return function(t){if(e=t.children){var e,n,r,a=e.length,o=i(t)*s||0;if(o)for(n=0;n<a;++n)e[n].r+=o;if(r=wd(e,u),o)for(n=0;n<a;++n)e[n].r-=o;t.r=r+o}}}function Pd(n){return function(t){var e=t.parent;t.r*=n,e&&(t.x=e.x+n*t.x,t.y=e.y+n*t.y)}}function zd(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function Rd(t,e,n,r,a){for(var o,i=t.children,s=-1,u=i.length,l=t.value&&(r-e)/t.value;++s<u;)(o=i[s]).y0=n,o.y1=a,o.x0=e,o.x1=e+=o.value*l}var Ld={depth:-1},Md={},qd={};function Bd(t){return t.id}function Dd(t){return t.parentId}function Ud(t){let e=t.length;if(e<2)return"";for(;--e>1&&!Gd(t,e););return t.slice(0,e)}function Gd(e,n){if("/"===e[n]){let t=0;for(;n>0&&"\\"===e[--n];)++t;if(!(1&t))return!0}return!1}function Fd(t,e){return t.parent===e.parent?1:2}function Hd(t){var e=t.children;return e?e[0]:t.t}function Jd(t){var e=t.children;return e?e[e.length-1]:t.t}function Kd(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Xd(t,e,n){return t.a.parent===e.parent?t.a:n}function Zd(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}function Wd(t,e,n,r,a){for(var o,i=t.children,s=-1,u=i.length,l=t.value&&(a-n)/t.value;++s<u;)(o=i[s]).x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*l}Zd.prototype=Object.create(ld.prototype);var Yd=(1+Math.sqrt(5))/2;function $d(t,e,n,r,a,o){for(var i,s,u,l,p,c,b,m,d,f,g,h=[],O=e.children,v=0,j=0,y=O.length,I=e.value;v<y;){u=a-n,l=o-r;do{p=O[j++].value}while(!p&&j<y);for(c=b=p,g=p*p*(f=Math.max(l/u,u/l)/(I*t)),d=Math.max(b/g,g/c);j<y;++j){if(p+=s=O[j].value,s<c&&(c=s),s>b&&(b=s),g=p*p*f,(m=Math.max(b/g,g/c))>d){p-=s;break}d=m}h.push(i={value:p,dice:u<l,children:O.slice(v,j)}),i.dice?Rd(i,n,r,a,I?r+=l*p/I:o):Wd(i,n,r,I?n+=u*p/I:a,o),I-=p,v=j}return h}var Qd=function e(o){function t(t,e,n,r,a){$d(o,t,e,n,r,a)}return t.ratio=function(t){return e((t=+t)>1?t:1)},t}(Yd);var tf=function e(m){function t(t,e,n,r,a){if((o=t._squarify)&&o.ratio===m)for(var o,i,s,u,l,p=-1,c=o.length,b=t.value;++p<c;){for(s=(i=o[p]).children,u=i.value=0,l=s.length;u<l;++u)i.value+=s[u].value;i.dice?Rd(i,e,n,r,b?n+=(a-n)*i.value/b:a):Wd(i,e,n,b?e+=(r-e)*i.value/b:r,a),b-=i.value}else t._squarify=o=$d(m,t,e,n,r,a),o.ratio=m}return t.ratio=function(t){return e((t=+t)>1?t:1)},t}(Yd);function ef(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function nf(t,e){return t[0]-e[0]||t[1]-e[1]}function rf(t){const e=t.length,n=[0,1];let r,a=2;for(r=2;r<e;++r){for(;a>1&&ef(t[n[a-2]],t[n[a-1]],t[r])<=0;)--a;n[a++]=r}return n.slice(0,a)}var e=Math.random,af=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,1===arguments.length?(e=t,t=0):e-=t,function(){return n()*e+t}}return e.source=t,e}(e),of=function t(n){function e(t,e){return arguments.length<2&&(e=t,t=0),t=Math.floor(t),e=Math.floor(e)-t,function(){return Math.floor(n()*e+t)}}return e.source=t,e}(e),sf=function t(o){function e(e,n){var r,a;return e=null==e?0:+e,n=null==n?1:+n,function(){var t;if(null!=r)t=r,r=null;else do{r=2*o()-1,t=2*o()-1,a=r*r+t*t}while(!a||a>1);return e+n*t*Math.sqrt(-2*Math.log(a)/a)}}return e.source=t,e}(e),uf=function t(e){var n=sf.source(e);function r(){var t=n.apply(this,arguments);return function(){return Math.exp(t())}}return r.source=t,r}(e),lf=function t(r){function e(n){return(n=+n)<=0?()=>0:function(){for(var t=0,e=n;e>1;--e)t+=r();return t+e*r()}}return e.source=t,e}(e),pf=function t(n){var r=lf.source(n);function e(t){if(0==(t=+t))return n;var e=r(t);return function(){return e()/t}}return e.source=t,e}(e),cf=function t(e){function n(t){return function(){return-Math.log1p(-e())/t}}return n.source=t,n}(e),bf=function t(e){function n(t){if((t=+t)<0)throw new RangeError("invalid alpha");return t=1/-t,function(){return Math.pow(1-e(),t)}}return n.source=t,n}(e),mf=function t(e){function n(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return function(){return Math.floor(e()+t)}}return n.source=t,n}(e),df=function t(e){function n(t){if((t=+t)<0||t>1)throw new RangeError("invalid p");return 0===t?()=>1/0:1===t?()=>1:(t=Math.log1p(-t),function(){return 1+Math.floor(Math.log1p(-e())/t)})}return n.source=t,n}(e),ff=function t(s){var u=sf.source(s)();function e(t,r){if((t=+t)<0)throw new RangeError("invalid k");if(0===t)return()=>0;if(r=null==r?1:+r,1===t)return()=>-Math.log1p(-s())*r;var a=(t<1?t+1:t)-1/3,o=1/(3*Math.sqrt(a)),i=t<1?()=>Math.pow(s(),1/t):()=>1;return function(){do{do{var t=u(),e=1+o*t}while(e<=0);e*=e*e;var n=1-s()}while(n>=1-.0331*t*t*t*t&&Math.log(n)>=.5*t*t+a*(1-e+Math.log(e)));return a*e*i()*r}}return e.source=t,e}(e),gf=function t(e){var a=ff.source(e);function n(t,e){var n=a(t),r=a(e);return function(){var t=n();return 0===t?0:t/(t+r())}}return n.source=t,n}(e),hf=function t(e){var c=df.source(e),b=gf.source(e);function n(l,p){return l=+l,(p=+p)>=1?()=>l:p<=0?()=>0:function(){for(var t=0,e=l,n=p;e*n>16&&e*(1-n)>16;){var r=Math.floor((e+1)*n),a=b(r,e-r+1)();a<=n?(t+=r,e-=r,n=(n-a)/(1-a)):(e=r-1,n/=a)}for(var o=n<.5,i=c(o?n:1-n),s=i(),u=0;s<=e;++u)s+=i();return t+(o?u:e-u)}}return n.source=t,n}(e),Of=function t(a){function e(e,t,n){var r;return 0==(e=+e)?r=t=>-Math.log(t):(e=1/e,r=t=>Math.pow(t,e)),t=null==t?0:+t,n=null==n?1:+n,function(){return t+n*r(-Math.log1p(-a()))}}return e.source=t,e}(e),vf=function t(n){function e(t,e){return t=null==t?0:+t,e=null==e?1:+e,function(){return t+e*Math.tan(Math.PI*n())}}return e.source=t,e}(e),jf=function t(r){function e(e,n){return e=null==e?0:+e,n=null==n?1:+n,function(){var t=r();return e+n*Math.log(t/(1-t))}}return e.source=t,e}(e),yf=function t(s){var u=ff.source(s),l=hf.source(s);function e(i){return function(){for(var t=0,e=i;e>16;){var n=Math.floor(.875*e),r=u(n)();if(r>e)return t+l(n-1,e/r)();t+=n,e-=r}for(var a=-Math.log1p(-s()),o=0;a<=e;++o)a-=Math.log1p(-s());return t+o}}return e.source=t,e}(e);const If=1/4294967296;function Af(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t)}return this}function xf(t,e){switch(arguments.length){case 0:break;case 1:"function"==typeof t?this.interpolator(t):this.range(t);break;default:this.domain(t),"function"==typeof e?this.interpolator(e):this.range(e)}return this}const kf=Symbol("implicit");function Sf(){var n=new at,r=[],a=[],o=kf;function i(t){let e=n.get(t);if(void 0===e){if(o!==kf)return o;n.set(t,e=r.push(t)-1)}return a[e%a.length]}return i.domain=function(e){if(!arguments.length)return r.slice();r=[],n=new at;for(const t of e)n.has(t)||n.set(t,r.push(t)-1);return i},i.range=function(t){return arguments.length?(a=Array.from(t),i):a.slice()},i.unknown=function(t){return arguments.length?(o=t,i):o},i.copy=function(){return Sf(r,a).unknown(o)},Af.apply(i,arguments),i}function _f(){var o,i,t=Sf().unknown(void 0),s=t.domain,u=t.range,l=0,p=1,c=!1,b=0,m=0,d=.5;function e(){var t=s().length,e=p<l,n=e?p:l,r=e?l:p;o=(r-n)/Math.max(1,t-b+2*m),c&&(o=Math.floor(o)),n+=(r-n-o*(t-b))*d,i=o*(1-b),c&&(n=Math.round(n),i=Math.round(i));var a=Jt(t).map(function(t){return n+o*t});return u(e?a.reverse():a)}return delete t.unknown,t.domain=function(t){return arguments.length?(s(t),e()):s()},t.range=function(t){return arguments.length?([l,p]=t,l=+l,p=+p,e()):[l,p]},t.rangeRound=function(t){return[l,p]=t,l=+l,p=+p,c=!0,e()},t.bandwidth=function(){return i},t.step=function(){return o},t.round=function(t){return arguments.length?(c=!!t,e()):c},t.padding=function(t){return arguments.length?(b=Math.min(1,m=+t),e()):b},t.paddingInner=function(t){return arguments.length?(b=Math.min(1,t),e()):b},t.paddingOuter=function(t){return arguments.length?(m=+t,e()):m},t.align=function(t){return arguments.length?(d=Math.max(0,Math.min(1,t)),e()):d},t.copy=function(){return _f(s(),[l,p]).round(c).paddingInner(b).paddingOuter(m).align(d)},Af.apply(e(),arguments)}function Nf(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Nf(e())},t}function Cf(t){return+t}var wf=[0,1];function Tf(t){return t}function Ef(e,n){return(n-=e=+e)?function(t){return(t-e)/n}:function(t){return function(){return t}}(isNaN(n)?NaN:.5)}function Vf(t,e,n){var r=t[0],a=t[1],o=e[0],i=e[1];return a<r?(r=Ef(a,r),o=n(i,o)):(r=Ef(r,a),o=n(o,i)),function(t){return o(r(t))}}function Pf(n,t,e){var r=Math.min(n.length,t.length)-1,a=new Array(r),o=new Array(r),i=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),t=t.slice().reverse());++i<r;)a[i]=Ef(n[i],n[i+1]),o[i]=e(t[i],t[i+1]);return function(t){var e=S(n,t,1,r)-1;return o[e](a[e](t))}}function zf(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Rf(){var n,r,e,a,o,i,s=wf,u=wf,l=xa,p=Tf;function c(){var t=Math.min(s.length,u.length);return p!==Tf&&(p=function(e,n){var t;return e>n&&(t=e,e=n,n=t),function(t){return Math.max(e,Math.min(n,t))}}(s[0],s[t-1])),a=t>2?Pf:Vf,o=i=null,b}function b(t){return null==t||isNaN(t=+t)?e:(o||(o=a(s.map(n),u,l)))(n(p(t)))}return b.invert=function(t){return p(r((i||(i=a(u,s.map(n),va)))(t)))},b.domain=function(t){return arguments.length?(s=Array.from(t,Cf),c()):s.slice()},b.range=function(t){return arguments.length?(u=Array.from(t),c()):u.slice()},b.rangeRound=function(t){return u=Array.from(t),l=ka,c()},b.clamp=function(t){return arguments.length?(p=!!t||Tf,c()):p!==Tf},b.interpolate=function(t){return arguments.length?(l=t,c()):l},b.unknown=function(t){return arguments.length?(e=t,b):e},function(t,e){return n=t,r=e,c()}}function Lf(){return Rf()(Tf,Tf)}function Mf(t,e,n,r){var a,o=wt(t,e,n);switch((r=Al(null==r?",f":r)).type){case"s":var i=Math.max(Math.abs(t),Math.abs(e));return null!=r.precision||isNaN(a=Pl(o,i))||(r.precision=a),s.formatPrefix(r,i);case"":case"e":case"g":case"p":case"r":null!=r.precision||isNaN(a=zl(o,Math.max(Math.abs(t),Math.abs(e))))||(r.precision=a-("e"===r.type));break;case"f":case"%":null!=r.precision||isNaN(a=Vl(o))||(r.precision=a-2*("%"===r.type))}return s.format(r)}function qf(l){var p=l.domain;return l.ticks=function(t){var e=p();return Nt(e[0],e[e.length-1],null==t?10:t)},l.tickFormat=function(t,e){var n=p();return Mf(n[0],n[n.length-1],null==t?10:t,e)},l.nice=function(t){null==t&&(t=10);var e,n,r=p(),a=0,o=r.length-1,i=r[a],s=r[o],u=10;for(s<i&&(n=i,i=s,s=n,n=a,a=o,o=n);u-- >0;){if((n=Ct(i,s,t))===e)return r[a]=i,r[o]=s,p(r);if(n>0)i=Math.floor(i/n)*n,s=Math.ceil(s/n)*n;else{if(!(n<0))break;i=Math.ceil(i*n)/n,s=Math.floor(s*n)/n}e=n}return l},l}function Bf(t,e){var n,r=0,a=(t=t.slice()).length-1,o=t[r],i=t[a];return i<o&&(n=r,r=a,a=n,n=o,o=i,i=n),t[r]=e.floor(o),t[a]=e.ceil(i),t}function Df(t){return Math.log(t)}function Uf(t){return Math.exp(t)}function Gf(t){return-Math.log(-t)}function Ff(t){return-Math.exp(-t)}function Hf(t){return isFinite(t)?+("1e"+t):t<0?0:t}function Jf(n){return(t,e)=>-n(-t,e)}function Kf(t){const e=t(Df,Uf),c=e.domain;let b,m,d=10;function n(){return b=function(e){return e===Math.E?Math.log:10===e&&Math.log10||2===e&&Math.log2||(e=Math.log(e),t=>Math.log(t)/e)}(d),m=function(e){return 10===e?Hf:e===Math.E?Math.exp:t=>Math.pow(e,t)}(d),c()[0]<0?(b=Jf(b),m=Jf(m),t(Gf,Ff)):t(Df,Uf),e}return e.base=function(t){return arguments.length?(d=+t,n()):d},e.domain=function(t){return arguments.length?(c(t),n()):c()},e.ticks=t=>{const e=c();let n=e[0],r=e[e.length-1];const a=r<n;a&&([n,r]=[r,n]);let o,i,s=b(n),u=b(r);const l=null==t?10:+t;let p=[];if(!(d%1)&&u-s<l){if(s=Math.floor(s),u=Math.ceil(u),n>0){for(;s<=u;++s)for(o=1;o<d;++o)if(i=s<0?o/m(-s):o*m(s),!(i<n)){if(i>r)break;p.push(i)}}else for(;s<=u;++s)for(o=d-1;o>=1;--o)if(i=s>0?o/m(-s):o*m(s),!(i<n)){if(i>r)break;p.push(i)}2*p.length<l&&(p=Nt(n,r,l))}else p=Nt(s,u,Math.min(u-s,l)).map(m);return a?p.reverse():p},e.tickFormat=(t,n)=>{if(null==t&&(t=10),null==n&&(n=10===d?"s":","),"function"!=typeof n&&(d%1||null!=(n=Al(n)).precision||(n.trim=!0),n=s.format(n)),t===1/0)return n;const r=Math.max(1,d*t/e.ticks().length);return t=>{let e=t/m(Math.round(b(t)));return e*d<d-.5&&(e*=d),e<=r?n(t):""}},e.nice=()=>c(Bf(c(),{floor:t=>m(Math.floor(b(t))),ceil:t=>m(Math.ceil(b(t)))})),e}function Xf(e){return function(t){return Math.sign(t)*Math.log1p(Math.abs(t/e))}}function Zf(e){return function(t){return Math.sign(t)*Math.expm1(Math.abs(t))*e}}function Wf(e){var n=1,t=e(Xf(n),Zf(n));return t.constant=function(t){return arguments.length?e(Xf(n=+t),Zf(n)):n},qf(t)}function Yf(e){return function(t){return t<0?-Math.pow(-t,e):Math.pow(t,e)}}function $f(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function Qf(t){return t<0?-t*t:t*t}function tg(e){var t=e(Tf,Tf),n=1;return t.exponent=function(t){return arguments.length?1===(n=+t)?e(Tf,Tf):.5===n?e($f,Qf):e(Yf(n),Yf(1/n)):n},qf(t)}function eg(){var t=tg(Rf());return t.copy=function(){return zf(t,eg()).exponent(t.exponent())},Af.apply(t,arguments),t}function ng(t){return Math.sign(t)*t*t}const rg=new Date,ag=new Date;function a(o,i,n,r){function s(t){return o(t=0===arguments.length?new Date:new Date(+t)),t}return s.floor=t=>(o(t=new Date(+t)),t),s.ceil=t=>(o(t=new Date(t-1)),i(t,1),o(t),t),s.round=t=>{const e=s(t),n=s.ceil(t);return t-e<n-t?e:n},s.offset=(t,e)=>(i(t=new Date(+t),null==e?1:Math.floor(e)),t),s.range=(t,e,n)=>{const r=[];if(t=s.ceil(t),n=null==n?1:Math.floor(n),!(t<e&&n>0))return r;let a;do{r.push(a=new Date(+t)),i(t,n),o(t)}while(a<t&&t<e);return r},s.filter=n=>a(t=>{if(t>=t)for(;o(t),!n(t);)t.setTime(t-1)},(t,e)=>{if(t>=t)if(e<0)for(;++e<=0;)for(;i(t,-1),!n(t););else for(;--e>=0;)for(;i(t,1),!n(t););}),n&&(s.count=(t,e)=>(rg.setTime(+t),ag.setTime(+e),o(rg),o(ag),Math.floor(n(rg,ag))),s.every=e=>(e=Math.floor(e),isFinite(e)&&e>0?e>1?s.filter(r?t=>r(t)%e==0:t=>s.count(0,t)%e==0):s:null)),s}const og=a(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);og.every=n=>(n=Math.floor(n),isFinite(n)&&n>0?n>1?a(t=>{t.setTime(Math.floor(t/n)*n)},(t,e)=>{t.setTime(+t+e*n)},(t,e)=>(e-t)/n):og:null);const ig=og.range,sg=1e3,ug=6e4,lg=36e5,pg=864e5,cg=6048e5,bg=2592e6,mg=31536e6,dg=a(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*sg)},(t,e)=>(e-t)/sg,t=>t.getUTCSeconds()),fg=dg.range,gg=a(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*sg)},(t,e)=>{t.setTime(+t+e*ug)},(t,e)=>(e-t)/ug,t=>t.getMinutes()),hg=gg.range,Og=a(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*ug)},(t,e)=>(e-t)/ug,t=>t.getUTCMinutes()),vg=Og.range,jg=a(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*sg-t.getMinutes()*ug)},(t,e)=>{t.setTime(+t+e*lg)},(t,e)=>(e-t)/lg,t=>t.getHours()),yg=jg.range,Ig=a(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*lg)},(t,e)=>(e-t)/lg,t=>t.getUTCHours()),Ag=Ig.range,xg=a(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ug)/pg,t=>t.getDate()-1),kg=xg.range,Sg=a(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/pg,t=>t.getUTCDate()-1),_g=Sg.range,Ng=a(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/pg,t=>Math.floor(t/pg)),Cg=Ng.range;function wg(e){return a(t=>{t.setDate(t.getDate()-(t.getDay()+7-e)%7),t.setHours(0,0,0,0)},(t,e)=>{t.setDate(t.getDate()+7*e)},(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*ug)/cg)}const Tg=wg(0),Eg=wg(1),Vg=wg(2),Pg=wg(3),zg=wg(4),Rg=wg(5),Lg=wg(6),Mg=Tg.range,qg=Eg.range,Bg=Vg.range,Dg=Pg.range,Ug=zg.range,Gg=Rg.range,Fg=Lg.range;function Hg(e){return a(t=>{t.setUTCDate(t.getUTCDate()-(t.getUTCDay()+7-e)%7),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+7*e)},(t,e)=>(e-t)/cg)}const Jg=Hg(0),Kg=Hg(1),Xg=Hg(2),Zg=Hg(3),Wg=Hg(4),Yg=Hg(5),$g=Hg(6),Qg=Jg.range,th=Kg.range,eh=Xg.range,nh=Zg.range,rh=Wg.range,ah=Yg.range,oh=$g.range,ih=a(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+12*(e.getFullYear()-t.getFullYear()),t=>t.getMonth()),sh=ih.range,uh=a(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+12*(e.getUTCFullYear()-t.getUTCFullYear()),t=>t.getUTCMonth()),lh=uh.range,ph=a(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());ph.every=n=>isFinite(n=Math.floor(n))&&n>0?a(t=>{t.setFullYear(Math.floor(t.getFullYear()/n)*n),t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e*n)}):null;const ch=ph.range,bh=a(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());bh.every=n=>isFinite(n=Math.floor(n))&&n>0?a(t=>{t.setUTCFullYear(Math.floor(t.getUTCFullYear()/n)*n),t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e*n)}):null;const mh=bh.range;function dh(s,t,e,n,r,a){const u=[[dg,1,sg],[dg,5,5e3],[dg,15,15e3],[dg,30,3e4],[a,1,ug],[a,5,3e5],[a,15,9e5],[a,30,18e5],[r,1,lg],[r,3,108e5],[r,6,216e5],[r,12,432e5],[n,1,pg],[n,2,1728e5],[e,1,cg],[t,1,bg],[t,3,7776e6],[s,1,mg]];function i(t,e,n){const r=Math.abs(e-t)/n,a=f(([,,t])=>t).right(u,r);if(a===u.length)return s.every(wt(t/mg,e/mg,n));if(0===a)return og.every(Math.max(wt(t,e,n),1));const[o,i]=u[r/u[a-1][2]<u[a][2]/r?a-1:a];return o.every(i)}return[function(t,e,n){const r=e<t;r&&([t,e]=[e,t]);const a=n&&"function"==typeof n.range?n:i(t,e,n),o=a?a.range(t,+e+1):[];return r?o.reverse():o},i]}const[fh,gh]=dh(bh,uh,Jg,Ng,Ig,Og),[hh,Oh]=dh(ph,ih,Tg,xg,jg,gg);function vh(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function jh(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function yh(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function Ih(t){var r=t.dateTime,a=t.date,o=t.time,e=t.periods,n=t.days,i=t.shortDays,s=t.months,u=t.shortMonths,l=Nh(e),p=Ch(e),c=Nh(n),b=Ch(n),m=Nh(i),d=Ch(i),f=Nh(s),g=Ch(s),h=Nh(u),O=Ch(u),v={a:function(t){return i[t.getDay()]},A:function(t){return n[t.getDay()]},b:function(t){return u[t.getMonth()]},B:function(t){return s[t.getMonth()]},c:null,d:Wh,e:Wh,f:eO,g:bO,G:dO,H:Yh,I:$h,j:Qh,L:tO,m:nO,M:rO,p:function(t){return e[+(t.getHours()>=12)]},q:function(t){return 1+~~(t.getMonth()/3)},Q:LO,s:MO,S:aO,u:oO,U:iO,V:uO,w:lO,W:pO,x:null,X:null,y:cO,Y:mO,Z:fO,"%":RO},j={a:function(t){return i[t.getUTCDay()]},A:function(t){return n[t.getUTCDay()]},b:function(t){return u[t.getUTCMonth()]},B:function(t){return s[t.getUTCMonth()]},c:null,d:gO,e:gO,f:yO,g:EO,G:PO,H:hO,I:OO,j:vO,L:jO,m:IO,M:AO,p:function(t){return e[+(t.getUTCHours()>=12)]},q:function(t){return 1+~~(t.getUTCMonth()/3)},Q:LO,s:MO,S:xO,u:kO,U:SO,V:NO,w:CO,W:wO,x:null,X:null,y:TO,Y:VO,Z:zO,"%":RO},y={a:function(t,e,n){var r=m.exec(e.slice(n));return r?(t.w=d.get(r[0].toLowerCase()),n+r[0].length):-1},A:function(t,e,n){var r=c.exec(e.slice(n));return r?(t.w=b.get(r[0].toLowerCase()),n+r[0].length):-1},b:function(t,e,n){var r=h.exec(e.slice(n));return r?(t.m=O.get(r[0].toLowerCase()),n+r[0].length):-1},B:function(t,e,n){var r=f.exec(e.slice(n));return r?(t.m=g.get(r[0].toLowerCase()),n+r[0].length):-1},c:function(t,e,n){return x(t,r,e,n)},d:Bh,e:Bh,f:Jh,g:Rh,G:zh,H:Uh,I:Uh,j:Dh,L:Hh,m:qh,M:Gh,p:function(t,e,n){var r=l.exec(e.slice(n));return r?(t.p=p.get(r[0].toLowerCase()),n+r[0].length):-1},q:Mh,Q:Xh,s:Zh,S:Fh,u:Th,U:Eh,V:Vh,w:wh,W:Ph,x:function(t,e,n){return x(t,a,e,n)},X:function(t,e,n){return x(t,o,e,n)},y:Rh,Y:zh,Z:Lh,"%":Kh};function I(u,l){return function(t){var e,n,r,a=[],o=-1,i=0,s=u.length;for(t instanceof Date||(t=new Date(+t));++o<s;)37===u.charCodeAt(o)&&(a.push(u.slice(i,o)),null!=(n=xh[e=u.charAt(++o)])?e=u.charAt(++o):n="e"===e?" ":"0",(r=l[e])&&(e=r(t,n)),a.push(e),i=o+1);return a.push(u.slice(i,o)),a.join("")}}function A(a,o){return function(t){var e,n,r=yh(1900,void 0,1);if(x(r,a,t+="",0)!=t.length)return null;if("Q"in r)return new Date(r.Q);if("s"in r)return new Date(1e3*r.s+("L"in r?r.L:0));if(o&&!("Z"in r)&&(r.Z=0),"p"in r&&(r.H=r.H%12+12*r.p),void 0===r.m&&(r.m="q"in r?r.q:0),"V"in r){if(r.V<1||r.V>53)return null;"w"in r||(r.w=1),"Z"in r?(n=(e=jh(yh(r.y,0,1))).getUTCDay(),e=n>4||0===n?Kg.ceil(e):Kg(e),e=Sg.offset(e,7*(r.V-1)),r.y=e.getUTCFullYear(),r.m=e.getUTCMonth(),r.d=e.getUTCDate()+(r.w+6)%7):(n=(e=vh(yh(r.y,0,1))).getDay(),e=n>4||0===n?Eg.ceil(e):Eg(e),e=xg.offset(e,7*(r.V-1)),r.y=e.getFullYear(),r.m=e.getMonth(),r.d=e.getDate()+(r.w+6)%7)}else("W"in r||"U"in r)&&("w"in r||(r.w="u"in r?r.u%7:"W"in r?1:0),n="Z"in r?jh(yh(r.y,0,1)).getUTCDay():vh(yh(r.y,0,1)).getDay(),r.m=0,r.d="W"in r?(r.w+6)%7+7*r.W-(n+5)%7:r.w+7*r.U-(n+6)%7);return"Z"in r?(r.H+=r.Z/100|0,r.M+=r.Z%100,jh(r)):vh(r)}}function x(t,e,n,r){for(var a,o,i=0,s=e.length,u=n.length;i<s;){if(r>=u)return-1;if(37===(a=e.charCodeAt(i++))){if(a=e.charAt(i++),!(o=y[a in xh?e.charAt(i++):a])||(r=o(t,n,r))<0)return-1}else if(a!=n.charCodeAt(r++))return-1}return r}return v.x=I(a,v),v.X=I(o,v),v.c=I(r,v),j.x=I(a,j),j.X=I(o,j),j.c=I(r,j),{format:function(t){var e=I(t+="",v);return e.toString=function(){return t},e},parse:function(t){var e=A(t+="",!1);return e.toString=function(){return t},e},utcFormat:function(t){var e=I(t+="",j);return e.toString=function(){return t},e},utcParse:function(t){var e=A(t+="",!0);return e.toString=function(){return t},e}}}var Ah,xh={"-":"",_:" ",0:"0"},o=/^\s*\d+/,kh=/^%/,Sh=/[\\^$*+?|[\]().{}]/g;function r(t,e,n){var r=t<0?"-":"",a=(r?-t:t)+"",o=a.length;return r+(o<n?new Array(n-o+1).join(e)+a:a)}function _h(t){return t.replace(Sh,"\\$&")}function Nh(t){return new RegExp("^(?:"+t.map(_h).join("|")+")","i")}function Ch(t){return new Map(t.map((t,e)=>[t.toLowerCase(),e]))}function wh(t,e,n){var r=o.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Th(t,e,n){var r=o.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function Eh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function Vh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function Ph(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function zh(t,e,n){var r=o.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Rh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function Lh(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function Mh(t,e,n){var r=o.exec(e.slice(n,n+1));return r?(t.q=3*r[0]-3,n+r[0].length):-1}function qh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Bh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Dh(t,e,n){var r=o.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function Uh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Gh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Fh(t,e,n){var r=o.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function Hh(t,e,n){var r=o.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function Jh(t,e,n){var r=o.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function Kh(t,e,n){var r=kh.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function Xh(t,e,n){var r=o.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function Zh(t,e,n){var r=o.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function Wh(t,e){return r(t.getDate(),e,2)}function Yh(t,e){return r(t.getHours(),e,2)}function $h(t,e){return r(t.getHours()%12||12,e,2)}function Qh(t,e){return r(1+xg.count(ph(t),t),e,3)}function tO(t,e){return r(t.getMilliseconds(),e,3)}function eO(t,e){return tO(t,e)+"000"}function nO(t,e){return r(t.getMonth()+1,e,2)}function rO(t,e){return r(t.getMinutes(),e,2)}function aO(t,e){return r(t.getSeconds(),e,2)}function oO(t){var e=t.getDay();return 0===e?7:e}function iO(t,e){return r(Tg.count(ph(t)-1,t),e,2)}function sO(t){var e=t.getDay();return e>=4||0===e?zg(t):zg.ceil(t)}function uO(t,e){return t=sO(t),r(zg.count(ph(t),t)+(4===ph(t).getDay()),e,2)}function lO(t){return t.getDay()}function pO(t,e){return r(Eg.count(ph(t)-1,t),e,2)}function cO(t,e){return r(t.getFullYear()%100,e,2)}function bO(t,e){return r((t=sO(t)).getFullYear()%100,e,2)}function mO(t,e){return r(t.getFullYear()%1e4,e,4)}function dO(t,e){var n=t.getDay();return r((t=n>=4||0===n?zg(t):zg.ceil(t)).getFullYear()%1e4,e,4)}function fO(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+r(e/60|0,"0",2)+r(e%60,"0",2)}function gO(t,e){return r(t.getUTCDate(),e,2)}function hO(t,e){return r(t.getUTCHours(),e,2)}function OO(t,e){return r(t.getUTCHours()%12||12,e,2)}function vO(t,e){return r(1+Sg.count(bh(t),t),e,3)}function jO(t,e){return r(t.getUTCMilliseconds(),e,3)}function yO(t,e){return jO(t,e)+"000"}function IO(t,e){return r(t.getUTCMonth()+1,e,2)}function AO(t,e){return r(t.getUTCMinutes(),e,2)}function xO(t,e){return r(t.getUTCSeconds(),e,2)}function kO(t){var e=t.getUTCDay();return 0===e?7:e}function SO(t,e){return r(Jg.count(bh(t)-1,t),e,2)}function _O(t){var e=t.getUTCDay();return e>=4||0===e?Wg(t):Wg.ceil(t)}function NO(t,e){return t=_O(t),r(Wg.count(bh(t),t)+(4===bh(t).getUTCDay()),e,2)}function CO(t){return t.getUTCDay()}function wO(t,e){return r(Kg.count(bh(t)-1,t),e,2)}function TO(t,e){return r(t.getUTCFullYear()%100,e,2)}function EO(t,e){return r((t=_O(t)).getUTCFullYear()%100,e,2)}function VO(t,e){return r(t.getUTCFullYear()%1e4,e,4)}function PO(t,e){var n=t.getUTCDay();return r((t=n>=4||0===n?Wg(t):Wg.ceil(t)).getUTCFullYear()%1e4,e,4)}function zO(){return"+0000"}function RO(){return"%"}function LO(t){return+t}function MO(t){return Math.floor(+t/1e3)}function qO(t){return Ah=Ih(t),s.timeFormat=Ah.format,s.timeParse=Ah.parse,s.utcFormat=Ah.utcFormat,s.utcParse=Ah.utcParse,Ah}s.timeFormat=void 0,s.timeParse=void 0,s.utcFormat=void 0,s.utcParse=void 0,qO({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});var BO="%Y-%m-%dT%H:%M:%S.%LZ";var DO=Date.prototype.toISOString?function(t){return t.toISOString()}:s.utcFormat(BO),UO=DO;var GO=+new Date("2000-01-01T00:00:00.000Z")?function(t){var e=new Date(t);return isNaN(e)?null:e}:s.utcParse(BO),FO=GO;function HO(t){return new Date(t)}function JO(t){return t instanceof Date?+t:+new Date(+t)}function KO(n,r,e,a,o,i,s,u,l,p){var c=Lf(),b=c.invert,m=c.domain,d=p(".%L"),f=p(":%S"),g=p("%I:%M"),h=p("%I %p"),O=p("%a %d"),v=p("%b %d"),j=p("%B"),y=p("%Y");function I(t){return(l(t)<t?d:u(t)<t?f:s(t)<t?g:i(t)<t?h:a(t)<t?o(t)<t?O:v:e(t)<t?j:y)(t)}return c.invert=function(t){return new Date(b(t))},c.domain=function(t){return arguments.length?m(Array.from(t,JO)):m().map(HO)},c.ticks=function(t){var e=m();return n(e[0],e[e.length-1],null==t?10:t)},c.tickFormat=function(t,e){return null==e?I:p(e)},c.nice=function(t){var e=m();return t&&"function"==typeof t.range||(t=r(e[0],e[e.length-1],null==t?10:t)),t?m(Bf(e,t)):c},c.copy=function(){return zf(c,KO(n,r,e,a,o,i,s,u,l,p))},c}function XO(){var e,n,r,a,o,i=0,s=1,u=Tf,l=!1;function p(t){return null==t||isNaN(t=+t)?o:u(0===r?.5:(t=(a(t)-e)*r,l?Math.max(0,Math.min(1,t)):t))}function t(r){return function(t){var e,n;return arguments.length?([e,n]=t,u=r(e,n),p):[u(0),u(1)]}}return p.domain=function(t){return arguments.length?([i,s]=t,e=a(i=+i),n=a(s=+s),r=e===n?0:1/(n-e),p):[i,s]},p.clamp=function(t){return arguments.length?(l=!!t,p):l},p.interpolator=function(t){return arguments.length?(u=t,p):u},p.range=t(xa),p.rangeRound=t(ka),p.unknown=function(t){return arguments.length?(o=t,p):o},function(t){return a=t,e=t(i),n=t(s),r=e===n?0:1/(n-e),p}}function ZO(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function WO(){var t=tg(XO());return t.copy=function(){return ZO(t,WO()).exponent(t.exponent())},xf.apply(t,arguments)}function YO(){var e,n,r,a,o,i,s,u=0,l=.5,p=1,c=1,b=Tf,m=!1;function d(t){return isNaN(t=+t)?s:(t=.5+((t=+i(t))-n)*(c*t<c*n?a:o),b(m?Math.max(0,Math.min(1,t)):t))}function t(a){return function(t){var e,n,r;return arguments.length?([e,n,r]=t,b=Fa(a,[e,n,r]),d):[b(0),b(.5),b(1)]}}return d.domain=function(t){return arguments.length?([u,l,p]=t,e=i(u=+u),n=i(l=+l),r=i(p=+p),a=e===n?0:.5/(n-e),o=n===r?0:.5/(r-n),c=n<e?-1:1,d):[u,l,p]},d.clamp=function(t){return arguments.length?(m=!!t,d):m},d.interpolator=function(t){return arguments.length?(b=t,d):b},d.range=t(xa),d.rangeRound=t(ka),d.unknown=function(t){return arguments.length?(s=t,d):s},function(t){return i=t,e=t(u),n=t(l),r=t(p),a=e===n?0:.5/(n-e),o=n===r?0:.5/(r-n),c=n<e?-1:1,d}}function $O(){var t=tg(YO());return t.copy=function(){return ZO(t,$O()).exponent(t.exponent())},xf.apply(t,arguments)}function i(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(6*r,6*++r);return n}var QO=i("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),tv=i("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),ev=i("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),nv=i("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),rv=i("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),av=i("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),ov=i("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),iv=i("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),sv=i("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),uv=i("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),lv=i("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),m=t=>ma(t[t.length-1]),pv=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(i),cv=m(pv),bv=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(i),mv=m(bv),dv=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(i),fv=m(dv),gv=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(i),hv=m(gv),Ov=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(i),vv=m(Ov),jv=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(i),yv=m(jv),Iv=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(i),Av=m(Iv),xv=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(i),kv=m(xv),Sv=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(i),_v=m(Sv),Nv=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(i),Cv=m(Nv),wv=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(i),Tv=m(wv),Ev=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(i),Vv=m(Ev),Pv=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(i),zv=m(Pv),Rv=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(i),Lv=m(Rv),Mv=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(i),qv=m(Mv),Bv=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(i),Dv=m(Bv),Uv=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(i),Gv=m(Uv),Fv=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(i),Hv=m(Fv),Jv=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(i),Kv=m(Jv),Xv=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(i),Zv=m(Xv),Wv=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(i),Yv=m(Wv),$v=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(i),Qv=m($v),t0=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(i),e0=m(t0),n0=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(i),r0=m(n0),a0=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(i),o0=m(a0),i0=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(i),s0=m(i0),u0=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(i),l0=m(u0);var p0=Ga(na(300,.5,0),na(-240,.5,1)),c0=Ga(na(-100,.75,.35),na(80,1.5,.8)),b0=Ga(na(260,.75,.35),na(80,1.5,.8)),m0=na();var d0=fr(),f0=Math.PI/3,g0=2*Math.PI/3;function h0(e){var n=e.length;return function(t){return e[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}}var O0=h0(i("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725")),v0=h0(i("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),j0=h0(i("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),y0=h0(i("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));function j(t){return function(){return t}}const I0=Math.abs,K=Math.atan2,A0=Math.cos,x0=Math.max,k0=Math.min,S0=Math.sin,X=Math.sqrt,Z=1e-12,_0=Math.PI,N0=_0/2,C0=2*_0;function w0(t){return t>=1?N0:t<=-1?-N0:Math.asin(t)}function T0(e){let n=3;return e.digits=function(t){if(!arguments.length)return n;if(null==t)n=null;else{const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);n=e}return e},()=>new ms(n)}function E0(t){return t.innerRadius}function V0(t){return t.outerRadius}function P0(t){return t.startAngle}function z0(t){return t.endAngle}function R0(t){return t&&t.padAngle}function L0(t,e,n,r,a,o,i){var s=t-n,u=e-r,l=(i?o:-o)/X(s*s+u*u),p=l*u,c=-l*s,b=t+p,m=e+c,d=n+p,f=r+c,g=(b+d)/2,h=(m+f)/2,O=d-b,v=f-m,j=O*O+v*v,y=a-o,I=b*f-d*m,A=(v<0?-1:1)*X(x0(0,y*y*j-I*I)),x=(I*v-O*A)/j,k=(-I*O-v*A)/j,S=(I*v+O*A)/j,_=(-I*O+v*A)/j,N=x-g,C=k-h,w=S-g,T=_-h;return N*N+C*C>w*w+T*T&&(x=S,k=_),{cx:x,cy:k,x01:-p,y01:-c,x11:x*(a/y-1),y11:k*(a/y-1)}}var M0=Array.prototype.slice;function q0(t){return"object"==typeof t&&"length"in t?t:Array.from(t)}function B0(t){this._context=t}function D0(t){return new B0(t)}function U0(t){return t[0]}function G0(t){return t[1]}function F0(i,s){var u=j(!0),l=null,p=D0,c=null,b=T0(e);function e(t){var e,n,r,a=(t=q0(t)).length,o=!1;for(null==l&&(c=p(r=b())),e=0;e<=a;++e)!(e<a&&u(n=t[e],e,t))===o&&((o=!o)?c.lineStart():c.lineEnd()),o&&c.point(+i(n,e,t),+s(n,e,t));if(r)return c=null,r+""||null}return i="function"==typeof i?i:void 0===i?U0:j(i),s="function"==typeof s?s:void 0===s?G0:j(s),e.x=function(t){return arguments.length?(i="function"==typeof t?t:j(+t),e):i},e.y=function(t){return arguments.length?(s="function"==typeof t?t:j(+t),e):s},e.defined=function(t){return arguments.length?(u="function"==typeof t?t:j(!!t),e):u},e.curve=function(t){return arguments.length?(p=t,null!=l&&(c=p(l)),e):p},e.context=function(t){return arguments.length?(null==t?l=c=null:c=p(l=t),e):l},e}function H0(p,c,b){var m=null,d=j(!0),f=null,g=D0,h=null,O=T0(e);function e(t){var e,n,r,a,o,i=(t=q0(t)).length,s=!1,u=new Array(i),l=new Array(i);for(null==f&&(h=g(o=O())),e=0;e<=i;++e){if(!(e<i&&d(a=t[e],e,t))===s)if(s=!s)n=e,h.areaStart(),h.lineStart();else{for(h.lineEnd(),h.lineStart(),r=e-1;r>=n;--r)h.point(u[r],l[r]);h.lineEnd(),h.areaEnd()}s&&(u[e]=+p(a,e,t),l[e]=+c(a,e,t),h.point(m?+m(a,e,t):u[e],b?+b(a,e,t):l[e]))}if(o)return h=null,o+""||null}function t(){return F0().defined(d).curve(g).context(f)}return p="function"==typeof p?p:void 0===p?U0:j(+p),c="function"==typeof c?c:j(void 0===c?0:+c),b="function"==typeof b?b:void 0===b?G0:j(+b),e.x=function(t){return arguments.length?(p="function"==typeof t?t:j(+t),m=null,e):p},e.x0=function(t){return arguments.length?(p="function"==typeof t?t:j(+t),e):p},e.x1=function(t){return arguments.length?(m=null==t?null:"function"==typeof t?t:j(+t),e):m},e.y=function(t){return arguments.length?(c="function"==typeof t?t:j(+t),b=null,e):c},e.y0=function(t){return arguments.length?(c="function"==typeof t?t:j(+t),e):c},e.y1=function(t){return arguments.length?(b=null==t?null:"function"==typeof t?t:j(+t),e):b},e.lineX0=e.lineY0=function(){return t().x(p).y(c)},e.lineY1=function(){return t().x(p).y(b)},e.lineX1=function(){return t().x(m).y(c)},e.defined=function(t){return arguments.length?(d="function"==typeof t?t:j(!!t),e):d},e.curve=function(t){return arguments.length?(g=t,null!=f&&(h=g(f)),e):g},e.context=function(t){return arguments.length?(null==t?f=h=null:h=g(f=t),e):f},e}function J0(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function K0(t){return t}B0.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e)}}};var X0=W0(D0);function Z0(t){this._curve=t}function W0(e){function t(t){return new Z0(e(t))}return t._curve=e,t}function Y0(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(t){return arguments.length?e(W0(t)):e()._curve},t}function $0(){return Y0(F0().curve(X0))}function Q0(){var t=H0().curve(X0),e=t.curve,n=t.lineX0,r=t.lineX1,a=t.lineY0,o=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return Y0(n())},delete t.lineX0,t.lineEndAngle=function(){return Y0(r())},delete t.lineX1,t.lineInnerRadius=function(){return Y0(a())},delete t.lineY0,t.lineOuterRadius=function(){return Y0(o())},delete t.lineY1,t.curve=function(t){return arguments.length?e(W0(t)):e()._curve},t}function tj(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}Z0.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};class ej{constructor(t,e){this._context=t,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line}point(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,e,t,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,t,this._y0,t,e)}this._x0=t,this._y0=e}}class nj{constructor(t){this._context=t}lineStart(){this._point=0}lineEnd(){}point(a,o){if(a=+a,o=+o,0===this._point)this._point=1;else{const t=tj(this._x0,this._y0),e=tj(this._x0,this._y0=(this._y0+o)/2),n=tj(a,this._y0),r=tj(a,o);this._context.moveTo(...t),this._context.bezierCurveTo(...e,...n,...r)}this._x0=a,this._y0=o}}function rj(t){return new ej(t,!0)}function aj(t){return new ej(t,!1)}function oj(t){return new nj(t)}function ij(t){return t.source}function sj(t){return t.target}function uj(a){let o=ij,i=sj,s=U0,u=G0,l=null,p=null,c=T0(e);function e(){let t;const e=M0.call(arguments),n=o.apply(this,e),r=i.apply(this,e);if(null==l&&(p=a(t=c())),p.lineStart(),e[0]=n,p.point(+s.apply(this,e),+u.apply(this,e)),e[0]=r,p.point(+s.apply(this,e),+u.apply(this,e)),p.lineEnd(),t)return p=null,t+""||null}return e.source=function(t){return arguments.length?(o=t,e):o},e.target=function(t){return arguments.length?(i=t,e):i},e.x=function(t){return arguments.length?(s="function"==typeof t?t:j(+t),e):s},e.y=function(t){return arguments.length?(u="function"==typeof t?t:j(+t),e):u},e.context=function(t){return arguments.length?(null==t?l=p=null:p=a(l=t),e):l},e}const lj=X(3);var pj={draw(t,e){const n=.59436*X(e+k0(e/28,.75)),r=n/2,a=r*lj;t.moveTo(0,n),t.lineTo(0,-n),t.moveTo(-a,-r),t.lineTo(a,r),t.moveTo(-a,r),t.lineTo(a,-r)}},cj={draw(t,e){const n=X(e/_0);t.moveTo(n,0),t.arc(0,0,n,0,C0)}},bj={draw(t,e){const n=X(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}};const mj=X(1/3),dj=2*mj;var fj={draw(t,e){const n=X(e/dj),r=n*mj;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},gj={draw(t,e){const n=.62625*X(e);t.moveTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.lineTo(-n,0),t.closePath()}},hj={draw(t,e){const n=.87559*X(e-k0(e/7,2));t.moveTo(-n,0),t.lineTo(n,0),t.moveTo(0,n),t.lineTo(0,-n)}},Oj={draw(t,e){const n=X(e),r=-n/2;t.rect(r,r,n,n)}},vj={draw(t,e){const n=.4431*X(e);t.moveTo(n,n),t.lineTo(n,-n),t.lineTo(-n,-n),t.lineTo(-n,n),t.closePath()}};const jj=S0(_0/10)/S0(7*_0/10),yj=S0(C0/10)*jj,Ij=-A0(C0/10)*jj;var Aj={draw(a,t){const o=X(.8908130915292852*t),i=yj*o,s=Ij*o;a.moveTo(0,-o),a.lineTo(i,s);for(let r=1;r<5;++r){const t=C0*r/5,e=A0(t),n=S0(t);a.lineTo(n*o,-e*o),a.lineTo(e*i-n*s,n*i+e*s)}a.closePath()}};const xj=X(3);var kj={draw(t,e){const n=-X(e/(3*xj));t.moveTo(0,2*n),t.lineTo(-xj*n,-n),t.lineTo(xj*n,-n),t.closePath()}};const Sj=X(3);var _j={draw(t,e){const n=.6824*X(e),r=n/2,a=n*Sj/2;t.moveTo(0,-n),t.lineTo(a,r),t.lineTo(-a,r),t.closePath()}};const Nj=-.5,Cj=X(3)/2,wj=1/X(12),Tj=3*(wj/2+1);var Ej={draw(t,e){const n=X(e/Tj),r=n/2,a=n*wj,o=r,i=n*wj+n,s=-o,u=i;t.moveTo(r,a),t.lineTo(o,i),t.lineTo(s,u),t.lineTo(Nj*r-Cj*a,Cj*r+Nj*a),t.lineTo(Nj*o-Cj*i,Cj*o+Nj*i),t.lineTo(Nj*s-Cj*u,Cj*s+Nj*u),t.lineTo(Nj*r+Cj*a,Nj*a-Cj*r),t.lineTo(Nj*o+Cj*i,Nj*i-Cj*o),t.lineTo(Nj*s+Cj*u,Nj*u-Cj*s),t.closePath()}},Vj={draw(t,e){const n=.6189*X(e-k0(e/6,1.7));t.moveTo(-n,-n),t.lineTo(n,n),t.moveTo(-n,n),t.lineTo(n,-n)}};const Pj=[cj,bj,fj,Oj,Aj,kj,Ej],zj=[cj,hj,Vj,_j,pj,vj,gj];function Rj(){}function Lj(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function Mj(t){this._context=t}function qj(t){this._context=t}function Bj(t){this._context=t}function Dj(t,e){this._basis=new Mj(t),this._beta=e}Mj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Lj(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Lj(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},qj.prototype={areaStart:Rj,areaEnd:Rj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x2,this._y2),this._context.closePath();break;case 2:this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break;case 3:this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Lj(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Bj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Lj(this,t,e)}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}},Dj.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r,a=t[0],o=e[0],i=t[n]-a,s=e[n]-o,u=-1;++u<=n;)r=u/n,this._basis.point(this._beta*t[u]+(1-this._beta)*(a+r*i),this._beta*e[u]+(1-this._beta)*(o+r*s));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};var Uj=function e(n){function t(t){return 1===n?new Mj(t):new Dj(t,n)}return t.beta=function(t){return e(+t)},t}(.85);function Gj(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function Fj(t,e){this._context=t,this._k=(1-e)/6}Fj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Gj(this,this._x1,this._y1)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Gj(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Hj=function e(n){function t(t){return new Fj(t,n)}return t.tension=function(t){return e(+t)},t}(0);function Jj(t,e){this._context=t,this._k=(1-e)/6}Jj.prototype={areaStart:Rj,areaEnd:Rj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Gj(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Kj=function e(n){function t(t){return new Jj(t,n)}return t.tension=function(t){return e(+t)},t}(0);function Xj(t,e){this._context=t,this._k=(1-e)/6}Xj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Gj(this,t,e)}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var Zj=function e(n){function t(t){return new Xj(t,n)}return t.tension=function(t){return e(+t)},t}(0);function Wj(t,e,n){var r=t._x1,a=t._y1,o=t._x2,i=t._y2;if(t._l01_a>Z){var s=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,u=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*s-t._x0*t._l12_2a+t._x2*t._l01_2a)/u,a=(a*s-t._y0*t._l12_2a+t._y2*t._l01_2a)/u}if(t._l23_a>Z){var l=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,p=3*t._l23_a*(t._l23_a+t._l12_a);o=(o*l+t._x1*t._l23_2a-e*t._l12_2a)/p,i=(i*l+t._y1*t._l23_2a-n*t._l12_2a)/p}t._context.bezierCurveTo(r,a,o,i,t._x2,t._y2)}function Yj(t,e){this._context=t,this._alpha=e}Yj.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2)}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Wj(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var $j=function e(n){function t(t){return n?new Yj(t,n):new Fj(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function Qj(t,e){this._context=t,this._alpha=e}Qj.prototype={areaStart:Rj,areaEnd:Rj,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:this._context.moveTo(this._x3,this._y3),this._context.closePath();break;case 2:this._context.lineTo(this._x3,this._y3),this._context.closePath();break;case 3:this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5)}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Wj(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var t1=function e(n){function t(t){return n?new Qj(t,n):new Jj(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function e1(t,e){this._context=t,this._alpha=e}e1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||0!==this._line&&3===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Wj(this,t,e)}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};var n1=function e(n){function t(t){return n?new e1(t,n):new Xj(t,0)}return t.alpha=function(t){return e(+t)},t}(.5);function r1(t){this._context=t}function a1(t){return t<0?-1:1}function o1(t,e,n){var r=t._x1-t._x0,a=e-t._x1,o=(t._y1-t._y0)/(r||a<0&&-0),i=(n-t._y1)/(a||r<0&&-0),s=(o*a+i*r)/(r+a);return(a1(o)+a1(i))*Math.min(Math.abs(o),Math.abs(i),.5*Math.abs(s))||0}function i1(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function s1(t,e,n){var r=t._x0,a=t._y0,o=t._x1,i=t._y1,s=(o-r)/3;t._context.bezierCurveTo(r+s,a+s*e,o-s,i-s*n,o,i)}function u1(t){this._context=t}function l1(t){this._context=new p1(t)}function p1(t){this._context=t}function c1(t){this._context=t}function b1(t){var e,n,r=t.length-1,a=new Array(r),o=new Array(r),i=new Array(r);for(a[0]=0,o[0]=2,i[0]=t[0]+2*t[1],e=1;e<r-1;++e)a[e]=1,o[e]=4,i[e]=4*t[e]+2*t[e+1];for(a[r-1]=2,o[r-1]=7,i[r-1]=8*t[r-1]+t[r],e=1;e<r;++e)n=a[e]/o[e-1],o[e]-=n,i[e]-=n*i[e-1];for(a[r-1]=i[r-1]/o[r-1],e=r-2;e>=0;--e)a[e]=(i[e]-a[e+1])/o[e];for(o[r-1]=(t[r]+a[r-1])/2,e=0;e<r-1;++e)o[e]=2*t[e+1]-a[e+1];return[a,o]}function m1(t,e){this._context=t,this._t=e}function d1(t,e){if((a=t.length)>1)for(var n,r,a,o=1,i=t[e[0]],s=i.length;o<a;++o)for(r=i,i=t[e[o]],n=0;n<s;++n)i[n][1]+=i[n][0]=isNaN(r[n][1])?r[n][0]:r[n][1]}function f1(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function g1(t,e){return t[e]}function h1(t){const e=[];return e.key=t,e}function O1(t){var n=t.map(v1);return f1(t).sort(function(t,e){return n[t]-n[e]})}function v1(t){for(var e,n=-1,r=0,a=t.length,o=-1/0;++n<a;)(e=+t[n][1])>o&&(o=e,r=n);return r}function j1(t){var n=t.map(y1);return f1(t).sort(function(t,e){return n[t]-n[e]})}function y1(t){for(var e,n=0,r=-1,a=t.length;++r<a;)(e=+t[r][1])&&(n+=e);return n}r1.prototype={areaStart:Rj,areaEnd:Rj,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}},u1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:s1(this,this._t0,i1(this,this._t0))}(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(e=+e,(t=+t)!==this._x1||e!==this._y1){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,s1(this,i1(this,n=o1(this,t,e)),n);break;default:s1(this,this._t0,n=o1(this,t,e))}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}},(l1.prototype=Object.create(u1.prototype)).point=function(t,e){u1.prototype.point.call(this,e,t)},p1.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,a,o){this._context.bezierCurveTo(e,t,r,n,o,a)}},c1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),2===n)this._context.lineTo(t[1],e[1]);else for(var r=b1(t),a=b1(e),o=0,i=1;i<n;++o,++i)this._context.bezierCurveTo(r[0][o],a[0][o],r[1][o],a[1][o],t[i],e[i]);(this._line||0!==this._line&&1===n)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}},m1.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&2===this._point&&this._context.lineTo(this._x,this._y),(this._line||0!==this._line&&1===this._point)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}}this._x=t,this._y=e}};var I1=t=>()=>t;function A1(t,{sourceEvent:e,target:n,transform:r,dispatch:a}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:a}})}function x1(t,e,n){this.k=t,this.x=e,this.y=n}x1.prototype={constructor:x1,scale:function(t){return 1===t?this:new x1(this.k*t,this.x,this.y)},translate:function(t,e){return 0===t&0===e?this:new x1(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var k1=new x1(1,0,0);function S1(t){for(;!t.__zoom;)if(!(t=t.parentNode))return k1;return t.__zoom}function _1(t){t.stopImmediatePropagation()}function N1(t){t.preventDefault(),t.stopImmediatePropagation()}function C1(t){return!(t.ctrlKey&&"wheel"!==t.type||t.button)}function w1(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t).hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]:[[0,0],[t.clientWidth,t.clientHeight]]}function T1(){return this.__zoom||k1}function E1(t){return-t.deltaY*(1===t.deltaMode?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function V1(){return navigator.maxTouchPoints||"ontouchstart"in this}function P1(t,e,n){var r=t.invertX(e[0][0])-n[0][0],a=t.invertX(e[1][0])-n[1][0],o=t.invertY(e[0][1])-n[0][1],i=t.invertY(e[1][1])-n[1][1];return t.translate(a>r?(r+a)/2:Math.min(0,r)||Math.max(0,a),i>o?(o+i)/2:Math.min(0,o)||Math.max(0,i))}S1.prototype=x1.prototype,s.Adder=E,s.Delaunay=gu,s.FormatSpecifier=xl,s.InternMap=at,s.InternSet=ot,s.Node=ld,s.Path=ms,s.Voronoi=pu,s.ZoomTransform=x1,s.active=function(t,e){var n,r,a=t.__transition;if(a)for(r in e=null==e?null:e+"",a)if((n=a[r]).state>fo&&n.name===e)return new Ho([[t]],_i,e,+r);return null},s.arc=function(){var M=E0,q=V0,B=j(0),D=null,U=P0,G=z0,F=R0,H=null,J=T0(e);function e(){var t,z,e=+M.apply(this,arguments),n=+q.apply(this,arguments),r=U.apply(this,arguments)-N0,a=G.apply(this,arguments)-N0,o=I0(a-r),i=a>r;if(H||(H=t=J()),n<e&&(z=n,n=e,e=z),n>Z)if(o>C0-Z)H.moveTo(n*A0(r),n*S0(r)),H.arc(0,0,n,r,a,!i),e>Z&&(H.moveTo(e*A0(a),e*S0(a)),H.arc(0,0,e,a,r,i));else{var s,u,l=r,p=a,c=r,b=a,m=o,d=o,f=F.apply(this,arguments)/2,g=f>Z&&(D?+D.apply(this,arguments):X(e*e+n*n)),h=k0(I0(n-e)/2,+B.apply(this,arguments)),O=h,v=h;if(g>Z){var j=w0(g/e*S0(f)),y=w0(g/n*S0(f));(m-=2*j)>Z?(c+=j*=i?1:-1,b-=j):(m=0,c=b=(r+a)/2),(d-=2*y)>Z?(l+=y*=i?1:-1,p-=y):(d=0,l=p=(r+a)/2)}var I=n*A0(l),A=n*S0(l),x=e*A0(b),k=e*S0(b);if(h>Z){var S,_=n*A0(p),N=n*S0(p),C=e*A0(c),w=e*S0(c);if(o<_0)if(S=function(t,e,n,r,a,o,i,s){var u=n-t,l=r-e,p=i-a,c=s-o,b=c*u-p*l;if(!(b*b<Z))return[t+(b=(p*(e-o)-c*(t-a))/b)*u,e+b*l]}(I,A,C,w,_,N,x,k)){var T=I-S[0],E=A-S[1],V=_-S[0],P=N-S[1],R=1/S0(function(t){return t>1?0:t<-1?_0:Math.acos(t)}((T*V+E*P)/(X(T*T+E*E)*X(V*V+P*P)))/2),L=X(S[0]*S[0]+S[1]*S[1]);O=k0(h,(e-L)/(R-1)),v=k0(h,(n-L)/(R+1))}else O=v=0}d>Z?v>Z?(s=L0(C,w,I,A,n,v,i),u=L0(_,N,x,k,n,v,i),H.moveTo(s.cx+s.x01,s.cy+s.y01),v<h?H.arc(s.cx,s.cy,v,K(s.y01,s.x01),K(u.y01,u.x01),!i):(H.arc(s.cx,s.cy,v,K(s.y01,s.x01),K(s.y11,s.x11),!i),H.arc(0,0,n,K(s.cy+s.y11,s.cx+s.x11),K(u.cy+u.y11,u.cx+u.x11),!i),H.arc(u.cx,u.cy,v,K(u.y11,u.x11),K(u.y01,u.x01),!i))):(H.moveTo(I,A),H.arc(0,0,n,l,p,!i)):H.moveTo(I,A),e>Z&&m>Z?O>Z?(s=L0(x,k,_,N,e,-O,i),u=L0(I,A,C,w,e,-O,i),H.lineTo(s.cx+s.x01,s.cy+s.y01),O<h?H.arc(s.cx,s.cy,O,K(s.y01,s.x01),K(u.y01,u.x01),!i):(H.arc(s.cx,s.cy,O,K(s.y01,s.x01),K(s.y11,s.x11),!i),H.arc(0,0,e,K(s.cy+s.y11,s.cx+s.x11),K(u.cy+u.y11,u.cx+u.x11),i),H.arc(u.cx,u.cy,O,K(u.y11,u.x11),K(u.y01,u.x01),!i))):H.arc(0,0,e,b,c,i):H.lineTo(x,k)}else H.moveTo(0,0);if(H.closePath(),t)return H=null,t+""||null}return e.centroid=function(){var t=(+M.apply(this,arguments)+ +q.apply(this,arguments))/2,e=(+U.apply(this,arguments)+ +G.apply(this,arguments))/2-_0/2;return[A0(e)*t,S0(e)*t]},e.innerRadius=function(t){return arguments.length?(M="function"==typeof t?t:j(+t),e):M},e.outerRadius=function(t){return arguments.length?(q="function"==typeof t?t:j(+t),e):q},e.cornerRadius=function(t){return arguments.length?(B="function"==typeof t?t:j(+t),e):B},e.padRadius=function(t){return arguments.length?(D=null==t?null:"function"==typeof t?t:j(+t),e):D},e.startAngle=function(t){return arguments.length?(U="function"==typeof t?t:j(+t),e):U},e.endAngle=function(t){return arguments.length?(G="function"==typeof t?t:j(+t),e):G},e.padAngle=function(t){return arguments.length?(F="function"==typeof t?t:j(+t),e):F},e.context=function(t){return arguments.length?(H=null==t?null:t,e):H},e},s.area=H0,s.areaRadial=Q0,s.ascending=u,s.autoType=function(t){for(var e in t){var n,r,a=t[e].trim();if(a)if("true"===a)a=!0;else if("false"===a)a=!1;else if("NaN"===a)a=NaN;else if(isNaN(n=+a)){if(!(r=a.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;Gu&&r[4]&&!r[7]&&(a=a.replace(/-/g,"/").replace(/T/," ")),a=new Date(a)}else a=n;else a=null;t[e]=a}return t},s.axisBottom=function(t){return be(ae,t)},s.axisLeft=function(t){return be(oe,t)},s.axisRight=function(t){return be(re,t)},s.axisTop=function(t){return be(ne,t)},s.bin=Vt,s.bisect=S,s.bisectCenter=k,s.bisectLeft=x,s.bisectRight=A,s.bisector=f,s.blob=function(t,e){return fetch(t,e).then(Fu)},s.blur=function(t,e){if(!((e=+e)>=0))throw new RangeError("invalid r");let n=t.length;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid length");if(!n||!e)return t;const r=W(e),a=t.slice();return r(t,a,0,n,1),r(a,t,0,n,1),r(t,a,0,n,1),t},s.blur2=_,s.blurImage=N,s.brush=function(){return Yi(Bi)},s.brushSelection=function(t){var e=t.__brush;return e?e.dim.output(e.selection):null},s.brushX=function(){return Yi(Mi)},s.brushY=function(){return Yi(qi)},s.buffer=function(t,e){return fetch(t,e).then(Hu)},s.chord=function(){return ss(!1,!1)},s.chordDirected=function(){return ss(!0,!1)},s.chordTranspose=function(){return ss(!1,!0)},s.cluster=function(){var s=td,u=1,l=1,p=!1;function e(e){var n,r=0;e.eachAfter(function(t){var e=t.children;e?(t.x=function(t){return t.reduce(ed,0)/t.length}(e),t.y=function(t){return 1+t.reduce(nd,0)}(e)):(t.x=n?r+=s(t,n):0,t.y=0,n=t)});var t=function(t){for(var e;e=t.children;)t=e[0];return t}(e),a=function(t){for(var e;e=t.children;)t=e[e.length-1];return t}(e),o=t.x-s(t,a)/2,i=a.x+s(a,t)/2;return e.eachAfter(p?function(t){t.x=(t.x-e.x)*u,t.y=(e.y-t.y)*l}:function(t){t.x=(t.x-o)/(i-o)*u,t.y=(1-(e.y?t.y/e.y:1))*l})}return e.separation=function(t){return arguments.length?(s=t,e):s},e.size=function(t){return arguments.length?(p=!1,u=+t[0],l=+t[1],e):p?null:[u,l]},e.nodeSize=function(t){return arguments.length?(p=!0,u=+t[0],l=+t[1],e):p?[u,l]:null},e},s.color=cr,s.contourDensity=function(){var c=Ms,b=qs,m=Bs,r=960,a=500,d=20,f=2,g=3*d,h=r+2*g>>f,O=a+2*g>>f,o=_s(20);function i(t){var e=new Float32Array(h*O),n=Math.pow(2,-f),r=-1;for(const d of t){var a=(c(d,++r,t)+g)*n,o=(b(d,r,t)+g)*n,i=+m(d,r,t);if(i&&a>=0&&a<h&&o>=0&&o<O){var s=Math.floor(a),u=Math.floor(o),l=a-s-.5,p=o-u-.5;e[s+u*h]+=(1-l)*(1-p)*i,e[s+1+u*h]+=l*(1-p)*i,e[s+1+(u+1)*h]+=l*p*i,e[s+(u+1)*h]+=(1-l)*p*i}}return _({data:e,width:h,height:O},d*n),e}function e(t){var e=i(t),n=o(e),r=Math.pow(2,2*f);return Array.isArray(n)||(n=Nt(Number.MIN_VALUE,Pt(e)/r,n)),Vs().size([h,O]).thresholds(n.map(t=>t*r))(e).map((t,e)=>(t.value=+n[e],s(t)))}function s(t){return t.coordinates.forEach(n),t}function n(t){t.forEach(u)}function u(t){t.forEach(l)}function l(t){t[0]=t[0]*Math.pow(2,f)-g,t[1]=t[1]*Math.pow(2,f)-g}function p(){return h=r+2*(g=3*d)>>f,O=a+2*g>>f,e}return e.contours=function(t){var n=i(t),r=Vs().size([h,O]),a=Math.pow(2,2*f),e=t=>{t=+t;var e=s(r.contour(n,t*a));return e.value=t,e};return Object.defineProperty(e,"max",{get:()=>Pt(n)/a}),e},e.x=function(t){return arguments.length?(c="function"==typeof t?t:_s(+t),e):c},e.y=function(t){return arguments.length?(b="function"==typeof t?t:_s(+t),e):b},e.weight=function(t){return arguments.length?(m="function"==typeof t?t:_s(+t),e):m},e.size=function(t){if(!arguments.length)return[r,a];var e=+t[0],n=+t[1];if(!(e>=0&&n>=0))throw new Error("invalid size");return r=e,a=n,p()},e.cellSize=function(t){if(!arguments.length)return 1<<f;if(!((t=+t)>=1))throw new Error("invalid cell size");return f=Math.floor(Math.log(t)/Math.LN2),p()},e.thresholds=function(t){return arguments.length?(o="function"==typeof t?t:Array.isArray(t)?_s(ks.call(t)):_s(t),e):o},e.bandwidth=function(t){if(!arguments.length)return Math.sqrt(d*(d+1));if(!((t=+t)>=0))throw new Error("invalid bandwidth");return d=(Math.sqrt(4*t*t+1)-1)/2,p()},e},s.contours=Vs,s.count=Y,s.create=function(t){return D(Ae(t).call(document.documentElement))},s.creator=Ae,s.cross=function(...n){const e="function"==typeof n[n.length-1]&&function(e){return t=>e(...t)}(n.pop()),r=(n=n.map(tt)).map($),a=n.length-1,o=new Array(a+1).fill(0),i=[];if(a<0||r.some(Q))return i;for(;;){i.push(o.map((t,e)=>n[e][t]));let t=a;for(;++o[t]===r[t];){if(0===t)return e?i.map(e):i;o[t--]=0}}},s.csv=Zu,s.csvFormat=wu,s.csvFormatBody=Tu,s.csvFormatRow=Vu,s.csvFormatRows=Eu,s.csvFormatValue=Pu,s.csvParse=Nu,s.csvParseRows=Cu,s.cubehelix=na,s.cumsum=function(e,n){var r=0,a=0;return Float64Array.from(e,void 0===n?t=>r+=+t||0:t=>r+=+n(t,a++,e)||0)},s.curveBasis=function(t){return new Mj(t)},s.curveBasisClosed=function(t){return new qj(t)},s.curveBasisOpen=function(t){return new Bj(t)},s.curveBumpX=rj,s.curveBumpY=aj,s.curveBundle=Uj,s.curveCardinal=Hj,s.curveCardinalClosed=Kj,s.curveCardinalOpen=Zj,s.curveCatmullRom=$j,s.curveCatmullRomClosed=t1,s.curveCatmullRomOpen=n1,s.curveLinear=D0,s.curveLinearClosed=function(t){return new r1(t)},s.curveMonotoneX=function(t){return new u1(t)},s.curveMonotoneY=function(t){return new l1(t)},s.curveNatural=function(t){return new c1(t)},s.curveStep=function(t){return new m1(t,.5)},s.curveStepAfter=function(t){return new m1(t,1)},s.curveStepBefore=function(t){return new m1(t,0)},s.descending=d,s.deviation=nt,s.difference=function(e,...n){e=new ot(e);for(const t of n)for(const n of t)e.delete(n);return e},s.disjoint=function(t,n){const r=n[Symbol.iterator](),a=new ot;for(const n of t){if(a.has(n))return!1;let t,e;for(;({value:t,done:e}=r.next())&&!e;){if(Object.is(n,t))return!1;a.add(t)}}return!0},s.dispatch=de,s.drag=function(){var r,a,o,i,s=Gn,u=Fn,n=Hn,e=Jn,f={},g=de("start","drag","end"),h=0,l=0;function O(t){t.on("mousedown.drag",p).filter(e).on("touchstart.drag",m).on("touchmove.drag",d,zn).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function p(t,e){if(!i&&s.call(this,t,e)){var n=j(this,u.call(this,t,e),t,e,"mouse");n&&(D(t.view).on("mousemove.drag",c,Rn).on("mouseup.drag",b,Rn),qn(t.view),Ln(t),o=!1,r=t.clientX,a=t.clientY,n("start",t))}}function c(t){if(Mn(t),!o){var e=t.clientX-r,n=t.clientY-a;o=e*e+n*n>l}f.mouse("drag",t)}function b(t){D(t.view).on("mousemove.drag mouseup.drag",null),Bn(t.view,o),Mn(t),f.mouse("end",t)}function m(t,e){if(s.call(this,t,e)){var n,r,a=t.changedTouches,o=u.call(this,t,e),i=a.length;for(n=0;n<i;++n)(r=j(this,o,t,e,a[n].identifier,a[n]))&&(Ln(t),r("start",t,a[n]))}}function d(t){var e,n,r=t.changedTouches,a=r.length;for(e=0;e<a;++e)(n=f[r[e].identifier])&&(Mn(t),n("drag",t,r[e]))}function v(t){var e,n,r=t.changedTouches,a=r.length;for(i&&clearTimeout(i),i=setTimeout(function(){i=null},500),e=0;e<a;++e)(n=f[r[e].identifier])&&(Ln(t),n("end",t,r[e]))}function j(i,s,t,u,l,e){var p,c,b,m=g.copy(),d=Pn(e||t,s);if(null!=(b=n.call(i,new Un("beforestart",{sourceEvent:t,target:O,identifier:l,active:h,x:d[0],y:d[1],dx:0,dy:0,dispatch:m}),u)))return p=b.x-d[0]||0,c=b.y-d[1]||0,function t(e,n,r){var a,o=d;switch(e){case"start":f[l]=t,a=h++;break;case"end":delete f[l],--h;case"drag":d=Pn(r||n,s),a=h}m.call(e,i,new Un(e,{sourceEvent:n,subject:b,target:O,identifier:l,active:a,x:d[0]+p,y:d[1]+c,dx:d[0]-o[0],dy:d[1]-o[1],dispatch:m}),u)}}return O.filter=function(t){return arguments.length?(s="function"==typeof t?t:Dn(!!t),O):s},O.container=function(t){return arguments.length?(u="function"==typeof t?t:Dn(t),O):u},O.subject=function(t){return arguments.length?(n="function"==typeof t?t:Dn(t),O):n},O.touchable=function(t){return arguments.length?(e="function"==typeof t?t:Dn(!!t),O):e},O.on=function(){var t=g.on.apply(g,arguments);return t===g?O:t},O.clickDistance=function(t){return arguments.length?(l=(t=+t)*t,O):Math.sqrt(l)},O},s.dragDisable=qn,s.dragEnable=Bn,s.dsv=function(t,e,n,r){3===arguments.length&&"function"==typeof n&&(r=n,n=void 0);var a=Su(t);return Ku(e,n).then(function(t){return a.parse(t,r)})},s.dsvFormat=Su,s.easeBack=ji,s.easeBackIn=Oi,s.easeBackInOut=ji,s.easeBackOut=vi,s.easeBounce=gi,s.easeBounceIn=function(t){return 1-gi(1-t)},s.easeBounceInOut=function(t){return((t*=2)<=1?1-gi(1-t):gi(t-1)+1)/2},s.easeBounceOut=gi,s.easeCircle=oi,s.easeCircleIn=function(t){return 1-Math.sqrt(1-t*t)},s.easeCircleInOut=oi,s.easeCircleOut=function(t){return Math.sqrt(1- --t*t)},s.easeCubic=Wo,s.easeCubicIn=function(t){return t*t*t},s.easeCubicInOut=Wo,s.easeCubicOut=function(t){return--t*t*t+1},s.easeElastic=Ai,s.easeElasticIn=Ii,s.easeElasticInOut=xi,s.easeElasticOut=Ai,s.easeExp=ai,s.easeExpIn=function(t){return ri(1-+t)},s.easeExpInOut=ai,s.easeExpOut=function(t){return 1-ri(t)},s.easeLinear=t=>+t,s.easePoly=Qo,s.easePolyIn=Yo,s.easePolyInOut=Qo,s.easePolyOut=$o,s.easeQuad=Zo,s.easeQuadIn=function(t){return t*t},s.easeQuadInOut=Zo,s.easeQuadOut=function(t){return t*(2-t)},s.easeSin=ni,s.easeSinIn=function(t){return 1==+t?1:1-Math.cos(t*ei)},s.easeSinInOut=ni,s.easeSinOut=function(t){return Math.sin(t*ei)},s.every=function(e,n){if("function"!=typeof n)throw new TypeError("test is not a function");let r=-1;for(const t of e)if(!n(t,++r,e))return!1;return!0},s.extent=rt,s.fcumsum=function(e,n){const r=new E;let a=-1;return Float64Array.from(e,void 0===n?t=>r.add(+t||0):t=>r.add(+n(t,++a,e)||0))},s.filter=function(e,n){if("function"!=typeof n)throw new TypeError("test is not a function");const r=[];let a=-1;for(const t of e)n(t,++a,e)&&r.push(t);return r},s.flatGroup=function(t,...e){return mt(bt(t,...e),e)},s.flatRollup=function(t,e,...n){return mt(ft(t,e,...n),n)},s.forceCenter=function(o,i){var s,u=1;function e(){var t,e,n=s.length,r=0,a=0;for(t=0;t<n;++t)r+=(e=s[t]).x,a+=e.y;for(r=(r/n-o)*u,a=(a/n-i)*u,t=0;t<n;++t)(e=s[t]).x-=r,e.y-=a}return null==o&&(o=0),null==i&&(i=0),e.initialize=function(t){s=t},e.x=function(t){return arguments.length?(o=+t,e):o},e.y=function(t){return arguments.length?(i=+t,e):i},e.strength=function(t){return arguments.length?(u=+t,e):u},e},s.forceCollide=function(r){var o,i,g,h=1,s=1;function e(){for(var t,e,c,b,m,d,f,n=o.length,r=0;r<s;++r)for(e=ol(o,ll,pl).visitAfter(u),t=0;t<n;++t)c=o[t],d=i[c.index],f=d*d,b=c.x+c.vx,m=c.y+c.vy,e.visit(a);function a(t,e,n,r,a){var o=t.data,i=t.r,s=d+i;if(!o)return e>b+s||r<b-s||n>m+s||a<m-s;if(o.index>c.index){var u=b-o.x-o.vx,l=m-o.y-o.vy,p=u*u+l*l;p<s*s&&(0===u&&(p+=(u=ul(g))*u),0===l&&(p+=(l=ul(g))*l),p=(s-(p=Math.sqrt(p)))/p*h,c.vx+=(u*=p)*(s=(i*=i)/(f+i)),c.vy+=(l*=p)*s,o.vx-=u*(s=1-s),o.vy-=l*s)}}}function u(t){if(t.data)return t.r=i[t.data.index];for(var e=t.r=0;e<4;++e)t[e]&&t[e].r>t.r&&(t.r=t[e].r)}function n(){if(o){var t,e,n=o.length;for(i=new Array(n),t=0;t<n;++t)e=o[t],i[e.index]=+r(e,t,o)}}return"function"!=typeof r&&(r=O(null==r?1:+r)),e.initialize=function(t,e){o=t,g=e,n()},e.iterations=function(t){return arguments.length?(s=+t,e):s},e.strength=function(t){return arguments.length?(h=+t,e):h},e.radius=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),n(),e):r},e},s.forceLink=function(c){var b,m,o,i,d,f,s=cl,n=function(t){return 1/Math.min(i[t.source.index],i[t.target.index])},r=O(30),g=1;function e(t){for(var e=0,n=c.length;e<g;++e)for(var r,a,o,i,s,u,l,p=0;p<n;++p)a=(r=c[p]).source,i=(o=r.target).x+o.vx-a.x-a.vx||ul(f),s=o.y+o.vy-a.y-a.vy||ul(f),i*=u=((u=Math.sqrt(i*i+s*s))-m[p])/u*t*b[p],s*=u,o.vx-=i*(l=d[p]),o.vy-=s*l,a.vx+=i*(l=1-l),a.vy+=s*l}function a(){if(o){var t,e,n=o.length,r=c.length,a=new Map(o.map((t,e)=>[s(t,e,o),t]));for(t=0,i=new Array(n);t<r;++t)(e=c[t]).index=t,"object"!=typeof e.source&&(e.source=bl(a,e.source)),"object"!=typeof e.target&&(e.target=bl(a,e.target)),i[e.source.index]=(i[e.source.index]||0)+1,i[e.target.index]=(i[e.target.index]||0)+1;for(t=0,d=new Array(r);t<r;++t)e=c[t],d[t]=i[e.source.index]/(i[e.source.index]+i[e.target.index]);b=new Array(r),u(),m=new Array(r),l()}}function u(){if(o)for(var t=0,e=c.length;t<e;++t)b[t]=+n(c[t],t,c)}function l(){if(o)for(var t=0,e=c.length;t<e;++t)m[t]=+r(c[t],t,c)}return null==c&&(c=[]),e.initialize=function(t,e){o=t,f=e,a()},e.links=function(t){return arguments.length?(c=t,a(),e):c},e.id=function(t){return arguments.length?(s=t,e):s},e.iterations=function(t){return arguments.length?(g=+t,e):g},e.strength=function(t){return arguments.length?(n="function"==typeof t?t:O(+t),u(),e):n},e.distance=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),l(),e):r},e},s.forceManyBody=function(){var a,u,l,p,c,r=O(-30),b=1,m=1/0,d=.81;function e(t){var e,n=a.length,r=ol(a,gl,hl).visitAfter(o);for(p=t,e=0;e<n;++e)u=a[e],r.visit(i)}function n(){if(a){var t,e,n=a.length;for(c=new Array(n),t=0;t<n;++t)e=a[t],c[e.index]=+r(e,t,a)}}function o(t){var e,n,r,a,o,i=0,s=0;if(t.length){for(r=a=o=0;o<4;++o)(e=t[o])&&(n=Math.abs(e.value))&&(i+=e.value,s+=n,r+=n*e.x,a+=n*e.y);t.x=r/s,t.y=a/s}else{(e=t).x=e.data.x,e.y=e.data.y;do{i+=c[e.data.index]}while(e=e.next)}t.value=i}function i(t,e,n,r){if(!t.value)return!0;var a=t.x-u.x,o=t.y-u.y,i=r-e,s=a*a+o*o;if(i*i/d<s)return s<m&&(0===a&&(s+=(a=ul(l))*a),0===o&&(s+=(o=ul(l))*o),s<b&&(s=Math.sqrt(b*s)),u.vx+=a*t.value*p/s,u.vy+=o*t.value*p/s),!0;if(!(t.length||s>=m)){(t.data!==u||t.next)&&(0===a&&(s+=(a=ul(l))*a),0===o&&(s+=(o=ul(l))*o),s<b&&(s=Math.sqrt(b*s)));do{t.data!==u&&(i=c[t.data.index]*p/s,u.vx+=a*i,u.vy+=o*i)}while(t=t.next)}}return e.initialize=function(t,e){a=t,l=e,n()},e.strength=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),n(),e):r},e.distanceMin=function(t){return arguments.length?(b=t*t,e):Math.sqrt(b)},e.distanceMax=function(t){return arguments.length?(m=t*t,e):Math.sqrt(m)},e.theta=function(t){return arguments.length?(d=t*t,e):Math.sqrt(d)},e},s.forceRadial=function(n,u,l){var p,c,b,r=O(.1);function e(t){for(var e=0,n=p.length;e<n;++e){var r=p[e],a=r.x-u||1e-6,o=r.y-l||1e-6,i=Math.sqrt(a*a+o*o),s=(b[e]-i)*c[e]*t/i;r.vx+=a*s,r.vy+=o*s}}function a(){if(p){var t,e=p.length;for(c=new Array(e),b=new Array(e),t=0;t<e;++t)b[t]=+n(p[t],t,p),c[t]=isNaN(b[t])?0:+r(p[t],t,p)}}return"function"!=typeof n&&(n=O(+n)),null==u&&(u=0),null==l&&(l=0),e.initialize=function(t){p=t,a()},e.strength=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),a(),e):r},e.radius=function(t){return arguments.length?(n="function"==typeof t?t:O(+t),a(),e):n},e.x=function(t){return arguments.length?(u=+t,e):u},e.y=function(t){return arguments.length?(l=+t,e):l},e},s.forceSimulation=function(p){var o,i=1,e=.001,s=1-Math.pow(e,1/300),u=0,l=.6,c=new Map,t=oo(a),n=de("tick","end"),r=function(){let t=1;return()=>(t=(ml*t+dl)%fl)/fl}();function a(){b(),n.call("tick",o),i<e&&(t.stop(),n.call("end",o))}function b(t){var e,n,r=p.length;void 0===t&&(t=1);for(var a=0;a<t;++a)for(i+=(u-i)*s,c.forEach(function(t){t(i)}),e=0;e<r;++e)null==(n=p[e]).fx?n.x+=n.vx*=l:(n.x=n.fx,n.vx=0),null==n.fy?n.y+=n.vy*=l:(n.y=n.fy,n.vy=0);return o}function m(){for(var t,e=0,n=p.length;e<n;++e){if((t=p[e]).index=e,null!=t.fx&&(t.x=t.fx),null!=t.fy&&(t.y=t.fy),isNaN(t.x)||isNaN(t.y)){var r=10*Math.sqrt(.5+e),a=e*Ol;t.x=r*Math.cos(a),t.y=r*Math.sin(a)}(isNaN(t.vx)||isNaN(t.vy))&&(t.vx=t.vy=0)}}function d(t){return t.initialize&&t.initialize(p,r),t}return null==p&&(p=[]),m(),o={tick:b,restart:function(){return t.restart(a),o},stop:function(){return t.stop(),o},nodes:function(t){return arguments.length?(p=t,m(),c.forEach(d),o):p},alpha:function(t){return arguments.length?(i=+t,o):i},alphaMin:function(t){return arguments.length?(e=+t,o):e},alphaDecay:function(t){return arguments.length?(s=+t,o):+s},alphaTarget:function(t){return arguments.length?(u=+t,o):u},velocityDecay:function(t){return arguments.length?(l=1-t,o):1-l},randomSource:function(t){return arguments.length?(r=t,c.forEach(d),o):r},force:function(t,e){return arguments.length>1?(null==e?c.delete(t):c.set(t,d(e)),o):c.get(t)},find:function(t,e,n){var r,a,o,i,s,u=0,l=p.length;for(null==n?n=1/0:n*=n,u=0;u<l;++u)(o=(r=t-(i=p[u]).x)*r+(a=e-i.y)*a)<n&&(s=i,n=o);return s},on:function(t,e){return arguments.length>1?(n.on(t,e),o):n.on(t)}}},s.forceX=function(n){var a,o,i,r=O(.1);function e(t){for(var e,n=0,r=a.length;n<r;++n)(e=a[n]).vx+=(i[n]-e.x)*o[n]*t}function s(){if(a){var t,e=a.length;for(o=new Array(e),i=new Array(e),t=0;t<e;++t)o[t]=isNaN(i[t]=+n(a[t],t,a))?0:+r(a[t],t,a)}}return"function"!=typeof n&&(n=O(null==n?0:+n)),e.initialize=function(t){a=t,s()},e.strength=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),s(),e):r},e.x=function(t){return arguments.length?(n="function"==typeof t?t:O(+t),s(),e):n},e},s.forceY=function(n){var a,o,i,r=O(.1);function e(t){for(var e,n=0,r=a.length;n<r;++n)(e=a[n]).vy+=(i[n]-e.y)*o[n]*t}function s(){if(a){var t,e=a.length;for(o=new Array(e),i=new Array(e),t=0;t<e;++t)o[t]=isNaN(i[t]=+n(a[t],t,a))?0:+r(a[t],t,a)}}return"function"!=typeof n&&(n=O(null==n?0:+n)),e.initialize=function(t){a=t,s()},e.strength=function(t){return arguments.length?(r="function"==typeof t?t:O(+t),s(),e):r},e.y=function(t){return arguments.length?(n="function"==typeof t?t:O(+t),s(),e):n},e},s.formatDefaultLocale=El,s.formatLocale=Tl,s.formatSpecifier=Al,s.fsum=function(n,r){const a=new E;if(void 0===r)for(let t of n)(t=+t)&&a.add(t);else{let e=-1;for(let t of n)(t=+r(t,++e,n))&&a.add(t)}return+a},s.geoAlbers=Em,s.geoAlbersUsa=function(){var e,n,a,o,i,r,s=Em(),u=Tm().rotate([154,0]).center([-2,58.5]).parallels([55,65]),l=Tm().rotate([157,0]).center([-3,19.9]).parallels([8,18]),p={point:function(t,e){r=[t,e]}};function c(t){var e=t[0],n=t[1];return r=null,a.point(e,n),r||(o.point(e,n),r)||(i.point(e,n),r)}function b(){return e=n=null,c}return c.invert=function(t){var e=s.scale(),n=s.translate(),r=(t[0]-n[0])/e,a=(t[1]-n[1])/e;return(a>=.12&&a<.234&&r>=-.425&&r<-.214?u:a>=.166&&a<.234&&r>=-.214&&r<-.115?l:s).invert(t)},c.stream=function(t){return e&&n===t?e:(r=[s.stream(n=t),u.stream(t),l.stream(t)],a=r.length,e={point:function(t,e){for(var n=-1;++n<a;)r[n].point(t,e)},sphere:function(){for(var t=-1;++t<a;)r[t].sphere()},lineStart:function(){for(var t=-1;++t<a;)r[t].lineStart()},lineEnd:function(){for(var t=-1;++t<a;)r[t].lineEnd()},polygonStart:function(){for(var t=-1;++t<a;)r[t].polygonStart()},polygonEnd:function(){for(var t=-1;++t<a;)r[t].polygonEnd()}});var r,a},c.precision=function(t){return arguments.length?(s.precision(t),u.precision(t),l.precision(t),b()):s.precision()},c.scale=function(t){return arguments.length?(s.scale(t),u.scale(.35*t),l.scale(t),c.translate(s.translate())):s.scale()},c.translate=function(t){if(!arguments.length)return s.translate();var e=s.scale(),n=+t[0],r=+t[1];return a=s.translate(t).clipExtent([[n-.455*e,r-.238*e],[n+.455*e,r+.238*e]]).stream(p),o=u.translate([n-.307*e,r+.201*e]).clipExtent([[n-.425*e+V,r+.12*e+V],[n-.214*e-V,r+.234*e-V]]).stream(p),i=l.translate([n-.205*e,r+.212*e]).clipExtent([[n-.214*e+V,r+.166*e+V],[n-.115*e-V,r+.234*e-V]]).stream(p),b()},c.fitExtent=function(t,e){return Om(c,t,e)},c.fitSize=function(t,e){return vm(c,t,e)},c.fitWidth=function(t,e){return jm(c,t,e)},c.fitHeight=function(t,e){return ym(c,t,e)},c.scale(1070)},s.geoArea=function(t){return Op=new E,np(t,vp),2*Op},s.geoAzimuthalEqualArea=function(){return _m(zm).scale(124.75).clipAngle(179.999)},s.geoAzimuthalEqualAreaRaw=zm,s.geoAzimuthalEquidistant=function(){return _m(Rm).scale(79.4188).clipAngle(179.999)},s.geoAzimuthalEquidistantRaw=Rm,s.geoBounds=function(t){var e,n,r,a,o,i,s;if(lp=b=-(c=up=1/0),fp=[],np(t,Kp),n=fp.length){for(fp.sort(nc),e=1,o=[r=fp[0]];e<n;++e)rc(r,(a=fp[e])[0])||rc(r,a[1])?(ec(r[0],a[1])>ec(r[0],r[1])&&(r[1]=a[1]),ec(a[0],r[1])>ec(r[0],r[1])&&(r[0]=a[0])):o.push(r=a);for(i=-1/0,e=0,r=o[n=o.length-1];e<=n;r=a,++e)a=o[e],(s=ec(r[1],a[0]))>i&&(i=s,c=a[0],b=r[1])}return fp=gp=null,c===1/0||up===1/0?[[NaN,NaN],[NaN,NaN]]:[[c,up],[b,lp]]},s.geoCentroid=function(t){Tp=Ep=Vp=Pp=zp=Rp=Lp=Mp=0,qp=new E,Bp=new E,Dp=new E,np(t,ac);var e=+qp,n=+Bp,r=+Dp,a=Gl(e,n,r);return a<Rl&&(e=Rp,n=Lp,r=Mp,Ep<V&&(e=Vp,n=Pp,r=zp),(a=Gl(e,n,r))<Rl)?[NaN,NaN]:[Bl(n,e)*T,Zl(r/a)*T]},s.geoCircle=function(){var r,a,o=fc([0,0]),i=fc(90),s=fc(2),u={point:function(t,e){r.push(t=a(t,e)),t[0]*=T,t[1]*=T}};function e(){var t=o.apply(this,arguments),e=i.apply(this,arguments)*M,n=s.apply(this,arguments)*M;return r=[],a=Oc(-t[0]*M,-t[1]*M,0).invert,Ac(u,e,n,1),t={type:"Polygon",coordinates:[r]},r=a=null,t}return e.center=function(t){return arguments.length?(o="function"==typeof t?t:fc([+t[0],+t[1]]),e):o},e.radius=function(t){return arguments.length?(i="function"==typeof t?t:fc(+t),e):i},e.precision=function(t){return arguments.length?(s="function"==typeof t?t:fc(+t),e):s},e},s.geoClipAntimeridian=zc,s.geoClipCircle=Rc,s.geoClipExtent=function(){var e,n,r,a=0,o=0,i=960,s=500;return r={stream:function(t){return e&&n===t?e:e=Gc(a,o,i,s)(n=t)},extent:function(t){return arguments.length?(a=+t[0][0],o=+t[0][1],i=+t[1][0],s=+t[1][1],e=n=null,r):[[a,o],[i,s]]}}},s.geoClipRectangle=Gc,s.geoConicConformal=function(){return Cm(Bm).scale(109.5).parallels([30,30])},s.geoConicConformalRaw=Bm,s.geoConicEqualArea=Tm,s.geoConicEqualAreaRaw=wm,s.geoConicEquidistant=function(){return Cm(Um).scale(131.154).center([0,13.9389])},s.geoConicEquidistantRaw=Um,s.geoContains=function(t,e){return(t&&$c.hasOwnProperty(t.type)?$c[t.type]:tb)(t,e)},s.geoDistance=Yc,s.geoEqualEarth=function(){return _m(Xm).scale(177.158)},s.geoEqualEarthRaw=Xm,s.geoEquirectangular=function(){return _m(Dm).scale(152.63)},s.geoEquirectangularRaw=Dm,s.geoGnomonic=function(){return _m(Zm).scale(144.049).clipAngle(60)},s.geoGnomonicRaw=Zm,s.geoGraticule=ub,s.geoGraticule10=function(){return ub()()},s.geoIdentity=function(){var a,o,e,n,r,i,s,u=1,l=0,p=0,c=1,b=1,m=0,d=null,f=1,g=1,h=fm({point:function(t,e){var n=j([t,e]);this.stream.point(n[0],n[1])}}),O=mb;function v(){return f=u*c,g=u*b,i=s=null,j}function j(t){var e=t[0]*f,n=t[1]*g;if(m){var r=n*a-e*o;e=e*a+n*o,n=r}return[e+l,n+p]}return j.invert=function(t){var e=t[0]-l,n=t[1]-p;if(m){var r=n*a+e*o;e=e*a-n*o,n=r}return[e/f,n/g]},j.stream=function(t){return i&&s===t?i:i=h(O(s=t))},j.postclip=function(t){return arguments.length?(O=t,d=e=n=r=null,v()):O},j.clipExtent=function(t){return arguments.length?(O=null==t?(d=e=n=r=null,mb):Gc(d=+t[0][0],e=+t[0][1],n=+t[1][0],r=+t[1][1]),v()):null==d?null:[[d,e],[n,r]]},j.scale=function(t){return arguments.length?(u=+t,v()):u},j.translate=function(t){return arguments.length?(l=+t[0],p=+t[1],v()):[l,p]},j.angle=function(t){return arguments.length?(o=F(m=t%360*M),a=B(m),v()):m*T},j.reflectX=function(t){return arguments.length?(c=t?-1:1,v()):c<0},j.reflectY=function(t){return arguments.length?(b=t?-1:1,v()):b<0},j.fitExtent=function(t,e){return Om(j,t,e)},j.fitSize=function(t,e){return vm(j,t,e)},j.fitWidth=function(t,e){return jm(j,t,e)},j.fitHeight=function(t,e){return ym(j,t,e)},j},s.geoInterpolate=function(t,e){var n=t[0]*M,r=t[1]*M,a=e[0]*M,o=e[1]*M,i=B(r),s=F(r),u=B(o),l=F(o),p=i*B(n),c=i*F(n),b=u*B(a),m=u*F(a),d=2*Zl(H(Wl(o-r)+i*u*Wl(a-n))),f=F(d),g=d?function(t){var e=F(t*=d)/f,n=F(d-t)/f,r=n*p+e*b,a=n*c+e*m,o=n*s+e*l;return[Bl(a,r)*T,Bl(o,H(r*r+a*a))*T]}:function(){return[n*T,r*T]};return g.distance=d,g},s.geoLength=Xc,s.geoMercator=function(){return Mm(Lm).scale(961/Ml)},s.geoMercatorRaw=Lm,s.geoNaturalEarth1=function(){return _m(Wm).scale(175.295)},s.geoNaturalEarth1Raw=Wm,s.geoOrthographic=function(){return _m(Ym).scale(249.5).clipAngle(90+V)},s.geoOrthographicRaw=Ym,s.geoPath=function(e,n){let r,a,o=3,i=4.5;function s(t){return t&&("function"==typeof i&&a.pointRadius(+i.apply(this,arguments)),np(t,r(a))),a.result()}return s.area=function(t){return np(t,r(yb)),yb.result()},s.measure=function(t){return np(t,r(um)),um.result()},s.bounds=function(t){return np(t,r(Tb)),Tb.result()},s.centroid=function(t){return np(t,r(Yb)),Yb.result()},s.projection=function(t){return arguments.length?(r=null==t?(e=null,mb):(e=t).stream,s):e},s.context=function(t){return arguments.length?(a=null==t?(n=null,new mm(o)):new $b(n=t),"function"!=typeof i&&a.pointRadius(i),s):n},s.pointRadius=function(t){return arguments.length?(i="function"==typeof t?t:(a.pointRadius(+t),+t),s):i},s.digits=function(t){if(!arguments.length)return o;if(null==t)o=null;else{const n=Math.floor(t);if(!(n>=0))throw new RangeError(`invalid digits: ${t}`);o=n}return null===n&&(a=new mm(o)),s},s.projection(e).digits(o).context(n)},s.geoProjection=_m,s.geoProjectionMutator=Nm,s.geoRotation=Ic,s.geoStereographic=function(){return _m($m).scale(250).clipAngle(142)},s.geoStereographicRaw=$m,s.geoStream=np,s.geoTransform=function(t){return{stream:fm(t)}},s.geoTransverseMercator=function(){var t=Mm(Qm),e=t.center,n=t.rotate;return t.center=function(t){return arguments.length?e([-t[1],t[0]]):[(t=e())[1],-t[0]]},t.rotate=function(t){return arguments.length?n([t[0],t[1],t.length>2?t[2]+90:90]):[(t=n())[0],t[1],t[2]-90]},n([0,0,90]).scale(159.155)},s.geoTransverseMercatorRaw=Qm,s.gray=function(t,e){return new qr(t,0,0,null==e?1:e)},s.greatest=Bt,s.greatestIndex=function(t,e=u){if(1===e.length)return zt(t,e);let n,r=-1,a=-1;for(const u of t)++a,(r<0?0===e(u,u):e(u,n)>0)&&(n=u,r=a);return r},s.group=ct,s.groupSort=function(t,a,e){return(2!==a.length?vt(dt(t,a,e),([t,e],[n,r])=>u(e,r)||u(t,n)):vt(ct(t,e),([t,e],[n,r])=>a(e,r)||u(t,n))).map(([t])=>t)},s.groups=bt,s.hcl=Hr,s.hierarchy=ad,s.histogram=Vt,s.hsl=Ar,s.html=tl,s.image=function(a,o){return new Promise(function(t,e){var n=new Image;for(var r in o)n[r]=o[r];n.onerror=e,n.onload=function(){t(n)},n.src=a})},s.index=function(t,...e){return ht(t,pt,gt,e)},s.indexes=function(t,...e){return ht(t,Array.from,gt,e)},s.interpolate=xa,s.interpolateArray=function(t,e){return(ga(e)?fa:ha)(t,e)},s.interpolateBasis=oa,s.interpolateBasisClosed=ia,s.interpolateBlues=Qv,s.interpolateBrBG=cv,s.interpolateBuGn=Cv,s.interpolateBuPu=Tv,s.interpolateCividis=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-2710.57*t)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-67.37*t)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-2475.67*t)))))))+")"},s.interpolateCool=b0,s.interpolateCubehelix=Ua,s.interpolateCubehelixDefault=p0,s.interpolateCubehelixLong=Ga,s.interpolateDate=Oa,s.interpolateDiscrete=function(e){var n=e.length;return function(t){return e[Math.max(0,Math.min(n-1,Math.floor(t*n)))]}},s.interpolateGnBu=Vv,s.interpolateGreens=e0,s.interpolateGreys=r0,s.interpolateHcl=qa,s.interpolateHclLong=Ba,s.interpolateHsl=Ra,s.interpolateHslLong=La,s.interpolateHue=function(t,e){var n=la(+t,+e);return function(t){var e=n(t);return e-360*Math.floor(e/360)}},s.interpolateInferno=j0,s.interpolateLab=function(e,t){var n=p((e=Mr(e)).l,(t=Mr(t)).l),r=p(e.a,t.a),a=p(e.b,t.b),o=p(e.opacity,t.opacity);return function(t){return e.l=n(t),e.a=r(t),e.b=a(t),e.opacity=o(t),e+""}},s.interpolateMagma=v0,s.interpolateNumber=va,s.interpolateNumberArray=fa,s.interpolateObject=ja,s.interpolateOrRd=zv,s.interpolateOranges=l0,s.interpolatePRGn=mv,s.interpolatePiYG=fv,s.interpolatePlasma=y0,s.interpolatePuBu=qv,s.interpolatePuBuGn=Lv,s.interpolatePuOr=hv,s.interpolatePuRd=Dv,s.interpolatePurples=o0,s.interpolateRainbow=function(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return m0.h=360*t-100,m0.s=1.5-1.5*e,m0.l=.8-.9*e,m0+""},s.interpolateRdBu=vv,s.interpolateRdGy=yv,s.interpolateRdPu=Gv,s.interpolateRdYlBu=Av,s.interpolateRdYlGn=kv,s.interpolateReds=s0,s.interpolateRgb=ca,s.interpolateRgbBasis=ma,s.interpolateRgbBasisClosed=da,s.interpolateRound=ka,s.interpolateSinebow=function(t){var e;return t=(.5-t)*Math.PI,d0.r=255*(e=Math.sin(t))*e,d0.g=255*(e=Math.sin(t+f0))*e,d0.b=255*(e=Math.sin(t+g0))*e,d0+""},s.interpolateSpectral=_v,s.interpolateString=Aa,s.interpolateTransformCss=Ta,s.interpolateTransformSvg=Ea,s.interpolateTurbo=function(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-14825.05*t)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+707.56*t)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-6838.66*t)))))))+")"},s.interpolateViridis=O0,s.interpolateWarm=c0,s.interpolateYlGn=Kv,s.interpolateYlGnBu=Hv,s.interpolateYlOrBr=Zv,s.interpolateYlOrRd=Yv,s.interpolateZoom=Pa,s.interrupt=ko,s.intersection=function(n,...r){n=new ot(n),r=r.map($t);t:for(const e of n)for(const t of r)if(!t.has(e)){n.delete(e);continue t}return n},s.interval=function(t,e,n){var o=new ao,i=e;return null==e?(o.restart(t,e,n),o):(o._restart=o.restart,o.restart=function(n,r,a){r=+r,a=null==a?no():+a,o._restart(function t(e){e+=i,o._restart(t,i+=r,a),n(e)},r,a)},o.restart(t,e,n),o)},s.isoFormat=UO,s.isoParse=FO,s.json=function(t,e){return fetch(t,e).then(Yu)},s.lab=Mr,s.lch=function(t,e,n,r){return 1===arguments.length?Fr(t):new Jr(n,e,t,null==r?1:r)},s.least=function(n,r=u){let a,o=!1;if(1===r.length){let e;for(const t of n){const n=r(t);(o?u(n,e)<0:0===u(n,n))&&(a=t,e=n,o=!0)}}else for(const u of n)(o?r(u,a)<0:0===r(u,u))&&(a=u,o=!0);return a},s.leastIndex=Kt,s.line=F0,s.lineRadial=$0,s.link=uj,s.linkHorizontal=function(){return uj(rj)},s.linkRadial=function(){const t=uj(oj);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t},s.linkVertical=function(){return uj(aj)},s.local=Tn,s.map=function(n,r){if("function"!=typeof n[Symbol.iterator])throw new TypeError("values is not iterable");if("function"!=typeof r)throw new TypeError("mapper is not a function");return Array.from(n,(t,e)=>r(t,e,n))},s.matcher=Ce,s.max=Pt,s.maxIndex=zt,s.mean=function(n,r){let a=0,o=0;if(void 0===r)for(let t of n)null!=t&&(t=+t)>=t&&(++a,o+=t);else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&(t=+t)>=t&&(++a,o+=t)}if(a)return o/a},s.median=function(t,e){return Dt(t,.5,e)},s.medianIndex=function(t,e){return Gt(t,.5,e)},s.merge=Ft,s.min=Rt,s.minIndex=Lt,s.mode=function(n,r){const a=new at;if(void 0===r)for(let t of n)null!=t&&t>=t&&a.set(t,(a.get(t)||0)+1);else{let e=-1;for(let t of n)null!=(t=r(t,++e,n))&&t>=t&&a.set(t,(a.get(t)||0)+1)}let t,e=0;for(const[n,r]of a)r>e&&(e=r,t=n);return t},s.namespace=je,s.namespaces=ve,s.nice=Tt,s.now=no,s.pack=function(){var n=null,r=1,a=1,o=bd;function e(t){const e=hd();return t.x=r/2,t.y=a/2,n?t.eachBefore(Ed(n)).eachAfter(Vd(o,.5,e)).eachBefore(Pd(1)):t.eachBefore(Ed(Td)).eachAfter(Vd(bd,1,e)).eachAfter(Vd(o,t.r/Math.min(r,a),e)).eachBefore(Pd(Math.min(r,a)/(2*t.r))),t}return e.radius=function(t){return arguments.length?(n=pd(t),e):n},e.size=function(t){return arguments.length?(r=+t[0],a=+t[1],e):[r,a]},e.padding=function(t){return arguments.length?(o="function"==typeof t?t:md(+t),e):o},e},s.packEnclose=function(t){return Od(t,hd())},s.packSiblings=function(t){return wd(t,hd()),t},s.pairs=function(e,n=Ht){const r=[];let a,o=!1;for(const t of e)o&&r.push(n(a,t)),a=t,o=!0;return r},s.partition=function(){var n=1,r=1,s=0,a=!1;function e(t){var e=t.height+1;return t.x0=t.y0=s,t.x1=n,t.y1=r/e,t.eachBefore(function(o,i){return function(t){t.children&&Rd(t,t.x0,o*(t.depth+1)/i,t.x1,o*(t.depth+2)/i);var e=t.x0,n=t.y0,r=t.x1-s,a=t.y1-s;r<e&&(e=r=(e+r)/2),a<n&&(n=a=(n+a)/2),t.x0=e,t.y0=n,t.x1=r,t.y1=a}}(r,e)),a&&t.eachBefore(zd),t}return e.round=function(t){return arguments.length?(a=!!t,e):a},e.size=function(t){return arguments.length?(n=+t[0],r=+t[1],e):[n,r]},e.padding=function(t){return arguments.length?(s=+t,e):s},e},s.path=ds,s.pathRound=function(t=3){return new ms(+t)},s.permute=Ot,s.pie=function(){var d=K0,f=J0,g=null,h=j(0),O=j(C0),v=j(0);function e(n){var t,e,r,a,o,i=(n=q0(n)).length,s=0,u=new Array(i),l=new Array(i),p=+h.apply(this,arguments),c=Math.min(C0,Math.max(-C0,O.apply(this,arguments)-p)),b=Math.min(Math.abs(c)/i,v.apply(this,arguments)),m=b*(c<0?-1:1);for(t=0;t<i;++t)(o=l[u[t]=t]=+d(n[t],t,n))>0&&(s+=o);for(null!=f?u.sort(function(t,e){return f(l[t],l[e])}):null!=g&&u.sort(function(t,e){return g(n[t],n[e])}),t=0,r=s?(c-i*m)/s:0;t<i;++t,p=a)e=u[t],a=p+((o=l[e])>0?o*r:0)+m,l[e]={data:n[e],index:t,value:o,startAngle:p,endAngle:a,padAngle:b};return l}return e.value=function(t){return arguments.length?(d="function"==typeof t?t:j(+t),e):d},e.sortValues=function(t){return arguments.length?(f=t,g=null,e):f},e.sort=function(t){return arguments.length?(g=t,f=null,e):g},e.startAngle=function(t){return arguments.length?(h="function"==typeof t?t:j(+t),e):h},e.endAngle=function(t){return arguments.length?(O="function"==typeof t?t:j(+t),e):O},e.padAngle=function(t){return arguments.length?(v="function"==typeof t?t:j(+t),e):v},e},s.piecewise=Fa,s.pointRadial=tj,s.pointer=Pn,s.pointers=function(t,e){return t.target&&(t=Vn(t),void 0===e&&(e=t.currentTarget),t=t.touches||[t]),Array.from(t,t=>Pn(t,e))},s.polygonArea=function(t){for(var e,n=-1,r=t.length,a=t[r-1],o=0;++n<r;)e=a,a=t[n],o+=e[1]*a[0]-e[0]*a[1];return o/2},s.polygonCentroid=function(t){for(var e,n,r=-1,a=t.length,o=0,i=0,s=t[a-1],u=0;++r<a;)e=s,s=t[r],u+=n=e[0]*s[1]-s[0]*e[1],o+=(e[0]+s[0])*n,i+=(e[1]+s[1])*n;return[o/(u*=3),i/u]},s.polygonContains=function(t,e){for(var n,r,a=t.length,o=t[a-1],i=e[0],s=e[1],u=o[0],l=o[1],p=!1,c=0;c<a;++c)n=(o=t[c])[0],(r=o[1])>s!=l>s&&i<(u-n)*(s-r)/(l-r)+n&&(p=!p),u=n,l=r;return p},s.polygonHull=function(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),a=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(nf),e=0;e<n;++e)a[e]=[r[e][0],-r[e][1]];var o=rf(r),i=rf(a),s=i[0]===o[0],u=i[i.length-1]===o[o.length-1],l=[];for(e=o.length-1;e>=0;--e)l.push(t[r[o[e]][2]]);for(e=+s;e<i.length-u;++e)l.push(t[r[i[e]][2]]);return l},s.polygonLength=function(t){for(var e,n,r=-1,a=t.length,o=t[a-1],i=o[0],s=o[1],u=0;++r<a;)e=i,n=s,e-=i=(o=t[r])[0],n-=s=o[1],u+=Math.hypot(e,n);return u},s.precisionFixed=Vl,s.precisionPrefix=Pl,s.precisionRound=zl,s.quadtree=ol,s.quantile=Dt,s.quantileIndex=Gt,s.quantileSorted=Ut,s.quantize=function(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n},s.quickselect=Mt,s.radialArea=Q0,s.radialLine=$0,s.randomBates=pf,s.randomBernoulli=mf,s.randomBeta=gf,s.randomBinomial=hf,s.randomCauchy=vf,s.randomExponential=cf,s.randomGamma=ff,s.randomGeometric=df,s.randomInt=of,s.randomIrwinHall=lf,s.randomLcg=function(t=Math.random()){let e=0|(0<=t&&t<1?t/If:Math.abs(t));return()=>(e=1664525*e+1013904223|0,If*(e>>>0))},s.randomLogNormal=uf,s.randomLogistic=jf,s.randomNormal=sf,s.randomPareto=bf,s.randomPoisson=yf,s.randomUniform=af,s.randomWeibull=Of,s.range=Jt,s.rank=function(t,n=u){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");let r=Array.from(t);const a=new Float64Array(r.length);2!==n.length&&(r=r.map(n),n=u);const o=(t,e)=>n(r[t],r[e]);let i,s;return(t=Uint32Array.from(r,(t,e)=>e)).sort(n===u?(t,e)=>yt(r[t],r[e]):jt(o)),t.forEach((t,e)=>{const n=o(t,void 0===i?t:i);n>=0?((void 0===i||n>0)&&(i=t,s=e),a[t]=s):a[t]=NaN}),a},s.reduce=function(t,e,n){if("function"!=typeof e)throw new TypeError("reducer is not a function");const r=t[Symbol.iterator]();let a,o,i=-1;if(arguments.length<3){if({done:a,value:n}=r.next(),a)return;++i}for(;{done:a,value:o}=r.next(),!a;)n=e(n,o,++i,t);return n},s.reverse=function(t){if("function"!=typeof t[Symbol.iterator])throw new TypeError("values is not iterable");return Array.from(t).reverse()},s.rgb=fr,s.ribbon=function(){return xs()},s.ribbonArrow=function(){return xs(As)},s.rollup=dt,s.rollups=ft,s.scaleBand=_f,s.scaleDiverging=function t(){var e=qf(YO()(Tf));return e.copy=function(){return ZO(e,t())},xf.apply(e,arguments)},s.scaleDivergingLog=function t(){var e=Kf(YO()).domain([.1,1,10]);return e.copy=function(){return ZO(e,t()).base(e.base())},xf.apply(e,arguments)},s.scaleDivergingPow=$O,s.scaleDivergingSqrt=function(){return $O.apply(null,arguments).exponent(.5)},s.scaleDivergingSymlog=function t(){var e=Wf(YO());return e.copy=function(){return ZO(e,t()).constant(e.constant())},xf.apply(e,arguments)},s.scaleIdentity=function t(e){var n;function r(t){return null==t||isNaN(t=+t)?n:t}return r.invert=r,r.domain=r.range=function(t){return arguments.length?(e=Array.from(t,Cf),r):e.slice()},r.unknown=function(t){return arguments.length?(n=t,r):n},r.copy=function(){return t(e).unknown(n)},e=arguments.length?Array.from(e,Cf):[0,1],qf(r)},s.scaleImplicit=kf,s.scaleLinear=function t(){var e=Lf();return e.copy=function(){return zf(e,t())},Af.apply(e,arguments),qf(e)},s.scaleLog=function t(){const e=Kf(Rf()).domain([1,10]);return e.copy=()=>zf(e,t()).base(e.base()),Af.apply(e,arguments),e},s.scaleOrdinal=Sf,s.scalePoint=function(){return Nf(_f.apply(null,arguments).paddingInner(1))},s.scalePow=eg,s.scaleQuantile=function t(){var e,n=[],r=[],a=[];function o(){var t=0,e=Math.max(1,r.length);for(a=new Array(e-1);++t<e;)a[t-1]=Ut(n,t/e);return i}function i(t){return null==t||isNaN(t=+t)?e:r[S(a,t)]}return i.invertExtent=function(t){var e=r.indexOf(t);return e<0?[NaN,NaN]:[e>0?a[e-1]:n[0],e<a.length?a[e]:n[n.length-1]]},i.domain=function(e){if(!arguments.length)return n.slice();n=[];for(let t of e)null==t||isNaN(t=+t)||n.push(t);return n.sort(u),o()},i.range=function(t){return arguments.length?(r=Array.from(t),o()):r.slice()},i.unknown=function(t){return arguments.length?(e=t,i):e},i.quantiles=function(){return a.slice()},i.copy=function(){return t().domain(n).range(r).unknown(e)},Af.apply(i,arguments)},s.scaleQuantize=function t(){var e,n=0,r=1,a=1,o=[.5],i=[0,1];function s(t){return null!=t&&t<=t?i[S(o,t,0,a)]:e}function u(){var t=-1;for(o=new Array(a);++t<a;)o[t]=((t+1)*r-(t-a)*n)/(a+1);return s}return s.domain=function(t){return arguments.length?([n,r]=t,n=+n,r=+r,u()):[n,r]},s.range=function(t){return arguments.length?(a=(i=Array.from(t)).length-1,u()):i.slice()},s.invertExtent=function(t){var e=i.indexOf(t);return e<0?[NaN,NaN]:e<1?[n,o[0]]:e>=a?[o[a-1],r]:[o[e-1],o[e]]},s.unknown=function(t){return arguments.length?(e=t,s):s},s.thresholds=function(){return o.slice()},s.copy=function(){return t().domain([n,r]).range(i).unknown(e)},Af.apply(qf(s),arguments)},s.scaleRadial=function t(){var n,r=Lf(),e=[0,1],a=!1;function o(t){var e=function(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}(r(t));return isNaN(e)?n:a?Math.round(e):e}return o.invert=function(t){return r.invert(ng(t))},o.domain=function(t){return arguments.length?(r.domain(t),o):r.domain()},o.range=function(t){return arguments.length?(r.range((e=Array.from(t,Cf)).map(ng)),o):e.slice()},o.rangeRound=function(t){return o.range(t).round(!0)},o.round=function(t){return arguments.length?(a=!!t,o):a},o.clamp=function(t){return arguments.length?(r.clamp(t),o):r.clamp()},o.unknown=function(t){return arguments.length?(n=t,o):n},o.copy=function(){return t(r.domain(),e).round(a).clamp(r.clamp()).unknown(n)},Af.apply(o,arguments),qf(o)},s.scaleSequential=function t(){var e=qf(XO()(Tf));return e.copy=function(){return ZO(e,t())},xf.apply(e,arguments)},s.scaleSequentialLog=function t(){var e=Kf(XO()).domain([1,10]);return e.copy=function(){return ZO(e,t()).base(e.base())},xf.apply(e,arguments)},s.scaleSequentialPow=WO,s.scaleSequentialQuantile=function t(){var r=[],n=Tf;function a(t){if(null!=t&&!isNaN(t=+t))return n((S(r,t,1)-1)/(r.length-1))}return a.domain=function(e){if(!arguments.length)return r.slice();r=[];for(let t of e)null==t||isNaN(t=+t)||r.push(t);return r.sort(u),a},a.interpolator=function(t){return arguments.length?(n=t,a):n},a.range=function(){return r.map((t,e)=>n(e/(r.length-1)))},a.quantiles=function(n){return Array.from({length:n+1},(t,e)=>Dt(r,e/n))},a.copy=function(){return t(n).domain(r)},xf.apply(a,arguments)},s.scaleSequentialSqrt=function(){return WO.apply(null,arguments).exponent(.5)},s.scaleSequentialSymlog=function t(){var e=Wf(XO());return e.copy=function(){return ZO(e,t()).constant(e.constant())},xf.apply(e,arguments)},s.scaleSqrt=function(){return eg.apply(null,arguments).exponent(.5)},s.scaleSymlog=function t(){var e=Wf(Rf());return e.copy=function(){return zf(e,t()).constant(e.constant())},Af.apply(e,arguments)},s.scaleThreshold=function t(){var e,n=[.5],r=[0,1],a=1;function o(t){return null!=t&&t<=t?r[S(n,t,0,a)]:e}return o.domain=function(t){return arguments.length?(n=Array.from(t),a=Math.min(n.length,r.length-1),o):n.slice()},o.range=function(t){return arguments.length?(r=Array.from(t),a=Math.min(n.length,r.length-1),o):r.slice()},o.invertExtent=function(t){var e=r.indexOf(t);return[n[e-1],n[e]]},o.unknown=function(t){return arguments.length?(e=t,o):e},o.copy=function(){return t().domain(n).range(r).unknown(e)},Af.apply(o,arguments)},s.scaleTime=function(){return Af.apply(KO(hh,Oh,ph,ih,Tg,xg,jg,gg,dg,s.timeFormat).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)},s.scaleUtc=function(){return Af.apply(KO(fh,gh,bh,uh,Jg,Sg,Ig,Og,dg,s.utcFormat).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)},s.scan=function(t,e){const n=Kt(t,e);return n<0?void 0:n},s.schemeAccent=tv,s.schemeBlues=$v,s.schemeBrBG=pv,s.schemeBuGn=Nv,s.schemeBuPu=wv,s.schemeCategory10=QO,s.schemeDark2=ev,s.schemeGnBu=Ev,s.schemeGreens=t0,s.schemeGreys=n0,s.schemeObservable10=nv,s.schemeOrRd=Pv,s.schemeOranges=u0,s.schemePRGn=bv,s.schemePaired=rv,s.schemePastel1=av,s.schemePastel2=ov,s.schemePiYG=dv,s.schemePuBu=Mv,s.schemePuBuGn=Rv,s.schemePuOr=gv,s.schemePuRd=Bv,s.schemePurples=a0,s.schemeRdBu=Ov,s.schemeRdGy=jv,s.schemeRdPu=Uv,s.schemeRdYlBu=Iv,s.schemeRdYlGn=xv,s.schemeReds=i0,s.schemeSet1=iv,s.schemeSet2=sv,s.schemeSet3=uv,s.schemeSpectral=Sv,s.schemeTableau10=lv,s.schemeYlGn=Jv,s.schemeYlGnBu=Fv,s.schemeYlOrBr=Xv,s.schemeYlOrRd=Wv,s.select=D,s.selectAll=function(t){return"string"==typeof t?new y([document.querySelectorAll(t)],[document.documentElement]):new y([Se(t)],Nn)},s.selection=Cn,s.selector=ke,s.selectorAll=Ne,s.shuffle=Xt,s.shuffler=Zt,s.some=function(e,n){if("function"!=typeof n)throw new TypeError("test is not a function");let r=-1;for(const t of e)if(n(t,++r,e))return!0;return!1},s.sort=vt,s.stack=function(){var i=j([]),s=f1,u=d1,l=g1;function e(t){var e,n,r=Array.from(i.apply(this,arguments),h1),a=r.length,o=-1;for(const i of t)for(e=0,++o;e<a;++e)(r[e][o]=[0,+l(i,r[e].key,o,t)]).data=i;for(e=0,n=q0(s(r));e<a;++e)r[n[e]].index=e;return u(r,n),r}return e.keys=function(t){return arguments.length?(i="function"==typeof t?t:j(Array.from(t)),e):i},e.value=function(t){return arguments.length?(l="function"==typeof t?t:j(+t),e):l},e.order=function(t){return arguments.length?(s=null==t?f1:"function"==typeof t?t:j(Array.from(t)),e):s},e.offset=function(t){return arguments.length?(u=null==t?d1:t,e):u},e},s.stackOffsetDiverging=function(t,e){if((s=t.length)>0)for(var n,r,a,o,i,s,u=0,l=t[e[0]].length;u<l;++u)for(o=i=0,n=0;n<s;++n)(a=(r=t[e[n]][u])[1]-r[0])>0?(r[0]=o,r[1]=o+=a):a<0?(r[1]=i,r[0]=i+=a):(r[0]=0,r[1]=a)},s.stackOffsetExpand=function(t,e){if((r=t.length)>0){for(var n,r,a,o=0,i=t[0].length;o<i;++o){for(a=n=0;n<r;++n)a+=t[n][o][1]||0;if(a)for(n=0;n<r;++n)t[n][o][1]/=a}d1(t,e)}},s.stackOffsetNone=d1,s.stackOffsetSilhouette=function(t,e){if((n=t.length)>0){for(var n,r=0,a=t[e[0]],o=a.length;r<o;++r){for(var i=0,s=0;i<n;++i)s+=t[i][r][1]||0;a[r][1]+=a[r][0]=-s/2}d1(t,e)}},s.stackOffsetWiggle=function(t,e){if((a=t.length)>0&&(r=(n=t[e[0]]).length)>0){for(var n,r,a,o=0,i=1;i<r;++i){for(var s=0,u=0,l=0;s<a;++s){for(var p=t[e[s]],c=p[i][1]||0,b=(c-(p[i-1][1]||0))/2,m=0;m<s;++m){var d=t[e[m]];b+=(d[i][1]||0)-(d[i-1][1]||0)}u+=c,l+=b*c}n[i-1][1]+=n[i-1][0]=o,u&&(o-=l/u)}n[i-1][1]+=n[i-1][0]=o,d1(t,e)}},s.stackOrderAppearance=O1,s.stackOrderAscending=j1,s.stackOrderDescending=function(t){return j1(t).reverse()},s.stackOrderInsideOut=function(t){var e,n,r=t.length,a=t.map(y1),o=O1(t),i=0,s=0,u=[],l=[];for(e=0;e<r;++e)n=o[e],i<s?(i+=a[n],u.push(n)):(s+=a[n],l.push(n));return l.reverse().concat(u)},s.stackOrderNone=f1,s.stackOrderReverse=function(t){return f1(t).reverse()},s.stratify=function(){var m,d=Bd,f=Dd;function e(n){var e,t,r,a,o,i,s,u,l=Array.from(n),p=d,c=f,b=new Map;if(null!=m){const d=l.map((t,e)=>function(t){t=`${t}`;let e=t.length;Gd(t,e-1)&&!Gd(t,e-2)&&(t=t.slice(0,-1));return"/"===t[0]?t:`/${t}`}(m(t,e,n))),f=d.map(Ud),e=new Set(d).add("");for(const m of f)e.has(m)||(e.add(m),d.push(m),f.push(Ud(m)),l.push(qd));p=(t,e)=>d[e],c=(t,e)=>f[e]}for(r=0,e=l.length;r<e;++r)t=l[r],i=l[r]=new ld(t),null!=(s=p(t,r,n))&&(s+="")&&(u=i.id=s,b.set(u,b.has(u)?Md:i)),null!=(s=c(t,r,n))&&(s+="")&&(i.parent=s);for(r=0;r<e;++r)if(s=(i=l[r]).parent){if(!(o=b.get(s)))throw new Error("missing: "+s);if(o===Md)throw new Error("ambiguous: "+s);o.children?o.children.push(i):o.children=[i],i.parent=o}else{if(a)throw new Error("multiple roots");a=i}if(!a)throw new Error("no root");if(null!=m){for(;a.data===qd&&1===a.children.length;)a=a.children[0],--e;for(let t=l.length-1;t>=0&&(i=l[t]).data===qd;--t)i.data=null}if(a.parent=Ld,a.eachBefore(function(t){t.depth=t.parent.depth+1,--e}).eachBefore(ud),a.parent=null,e>0)throw new Error("cycle");return a}return e.id=function(t){return arguments.length?(d=pd(t),e):d},e.parentId=function(t){return arguments.length?(f=pd(t),e):f},e.path=function(t){return arguments.length?(m=pd(t),e):m},e},s.style=$e,s.subset=function(t,e){return Qt(e,t)},s.sum=function(n,r){let a=0;if(void 0===r)for(let t of n)(t=+t)&&(a+=t);else{let e=-1;for(let t of n)(t=+r(t,++e,n))&&(a+=t)}return a},s.superset=Qt,s.svg=el,s.symbol=function(e,n){let r=null,a=T0(o);function o(){let t;if(r||(r=t=a()),e.apply(this,arguments).draw(r,+n.apply(this,arguments)),t)return r=null,t+""||null}return e="function"==typeof e?e:j(e||cj),n="function"==typeof n?n:j(void 0===n?64:+n),o.type=function(t){return arguments.length?(e="function"==typeof t?t:j(t),o):e},o.size=function(t){return arguments.length?(n="function"==typeof t?t:j(+t),o):n},o.context=function(t){return arguments.length?(r=null==t?null:t,o):r},o},s.symbolAsterisk=pj,s.symbolCircle=cj,s.symbolCross=bj,s.symbolDiamond=fj,s.symbolDiamond2=gj,s.symbolPlus=hj,s.symbolSquare=Oj,s.symbolSquare2=vj,s.symbolStar=Aj,s.symbolTimes=Vj,s.symbolTriangle=kj,s.symbolTriangle2=_j,s.symbolWye=Ej,s.symbolX=Vj,s.symbols=Pj,s.symbolsFill=Pj,s.symbolsStroke=zj,s.text=Ku,s.thresholdFreedmanDiaconis=function(t,e,n){const r=Y(t),a=Dt(t,.75)-Dt(t,.25);return r&&a?Math.ceil((n-e)/(2*a*Math.pow(r,-1/3))):1},s.thresholdScott=function(t,e,n){const r=Y(t),a=nt(t);return r&&a?Math.ceil((n-e)*Math.cbrt(r)/(3.49*a)):1},s.thresholdSturges=Et,s.tickFormat=Mf,s.tickIncrement=Ct,s.tickStep=wt,s.ticks=Nt,s.timeDay=xg,s.timeDays=kg,s.timeFormatDefaultLocale=qO,s.timeFormatLocale=Ih,s.timeFriday=Rg,s.timeFridays=Gg,s.timeHour=jg,s.timeHours=yg,s.timeInterval=a,s.timeMillisecond=og,s.timeMilliseconds=ig,s.timeMinute=gg,s.timeMinutes=hg,s.timeMonday=Eg,s.timeMondays=qg,s.timeMonth=ih,s.timeMonths=sh,s.timeSaturday=Lg,s.timeSaturdays=Fg,s.timeSecond=dg,s.timeSeconds=fg,s.timeSunday=Tg,s.timeSundays=Mg,s.timeThursday=zg,s.timeThursdays=Ug,s.timeTickInterval=Oh,s.timeTicks=hh,s.timeTuesday=Vg,s.timeTuesdays=Bg,s.timeWednesday=Pg,s.timeWednesdays=Dg,s.timeWeek=Tg,s.timeWeeks=Mg,s.timeYear=ph,s.timeYears=ch,s.timeout=po,s.timer=oo,s.timerFlush=io,s.transition=Jo,s.transpose=Wt,s.tree=function(){var b=Fd,l=1,p=1,c=null;function e(t){var e=function(t){for(var e,n,r,a,o,i=new Zd(t,0),s=[i];e=s.pop();)if(r=e._.children)for(e.children=new Array(o=r.length),a=o-1;a>=0;--a)s.push(n=e.children[a]=new Zd(r[a],a)),n.parent=e;return(i.parent=new Zd(null,0)).children=[i],i}(t);if(e.eachAfter(m),e.parent.m=-e.z,e.eachBefore(d),c)t.eachBefore(f);else{var n=t,r=t,a=t;t.eachBefore(function(t){t.x<n.x&&(n=t),t.x>r.x&&(r=t),t.depth>a.depth&&(a=t)});var o=n===r?1:b(n,r)/2,i=o-n.x,s=l/(r.x+o+i),u=p/(a.depth||1);t.eachBefore(function(t){t.x=(t.x+i)*s,t.y=t.depth*u})}return t}function m(t){var e=t.children,n=t.parent.children,r=t.i?n[t.i-1]:null;if(e){!function(t){for(var e,n=0,r=0,a=t.children,o=a.length;--o>=0;)(e=a[o]).z+=n,e.m+=n,n+=e.s+(r+=e.c)}(t);var a=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+b(t._,r._),t.m=t.z-a):t.z=a}else r&&(t.z=r.z+b(t._,r._));t.parent.A=function(t,e,n){if(e){for(var r,a=t,o=t,i=e,s=a.parent.children[0],u=a.m,l=o.m,p=i.m,c=s.m;i=Jd(i),a=Hd(a),i&&a;)s=Hd(s),(o=Jd(o)).a=t,(r=i.z+p-a.z-u+b(i._,a._))>0&&(Kd(Xd(i,t,n),t,r),u+=r,l+=r),p+=i.m,u+=a.m,c+=s.m,l+=o.m;i&&!Jd(o)&&(o.t=i,o.m+=p-l),a&&!Hd(s)&&(s.t=a,s.m+=u-c,n=t)}return n}(t,r,t.parent.A||n[0])}function d(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function f(t){t.x*=l,t.y=t.depth*p}return e.separation=function(t){return arguments.length?(b=t,e):b},e.size=function(t){return arguments.length?(c=!1,l=+t[0],p=+t[1],e):c?null:[l,p]},e.nodeSize=function(t){return arguments.length?(c=!0,l=+t[0],p=+t[1],e):c?[l,p]:null},e},s.treemap=function(){var i=Qd,e=!1,n=1,r=1,s=[0],u=bd,l=bd,p=bd,c=bd,b=bd;function a(t){return t.x0=t.y0=0,t.x1=n,t.y1=r,t.eachBefore(o),s=[0],e&&t.eachBefore(zd),t}function o(t){var e=s[t.depth],n=t.x0+e,r=t.y0+e,a=t.x1-e,o=t.y1-e;a<n&&(n=a=(n+a)/2),o<r&&(r=o=(r+o)/2),t.x0=n,t.y0=r,t.x1=a,t.y1=o,t.children&&(e=s[t.depth+1]=u(t)/2,n+=b(t)-e,r+=l(t)-e,(a-=p(t)-e)<n&&(n=a=(n+a)/2),(o-=c(t)-e)<r&&(r=o=(r+o)/2),i(t,n,r,a,o))}return a.round=function(t){return arguments.length?(e=!!t,a):e},a.size=function(t){return arguments.length?(n=+t[0],r=+t[1],a):[n,r]},a.tile=function(t){return arguments.length?(i=cd(t),a):i},a.padding=function(t){return arguments.length?a.paddingInner(t).paddingOuter(t):a.paddingInner()},a.paddingInner=function(t){return arguments.length?(u="function"==typeof t?t:md(+t),a):u},a.paddingOuter=function(t){return arguments.length?a.paddingTop(t).paddingRight(t).paddingBottom(t).paddingLeft(t):a.paddingTop()},a.paddingTop=function(t){return arguments.length?(l="function"==typeof t?t:md(+t),a):l},a.paddingRight=function(t){return arguments.length?(p="function"==typeof t?t:md(+t),a):p},a.paddingBottom=function(t){return arguments.length?(c="function"==typeof t?t:md(+t),a):c},a.paddingLeft=function(t){return arguments.length?(b="function"==typeof t?t:md(+t),a):b},a},s.treemapBinary=function(t,e,n,r,a){var o,i,O=t.children,s=O.length,v=new Array(s+1);for(v[0]=i=o=0;o<s;++o)v[o+1]=i+=O[o].value;!function t(e,n,r,a,o,i,s){if(e>=n-1){var u=O[e];return u.x0=a,u.y0=o,u.x1=i,void(u.y1=s)}var l=v[e],p=r/2+l,c=e+1,b=n-1;for(;c<b;){var m=c+b>>>1;v[m]<p?c=m+1:b=m}p-v[c-1]<v[c]-p&&e+1<c&&--c;var d=v[c]-l,f=r-d;if(i-a>s-o){var g=r?(a*f+i*d)/r:i;t(e,c,d,a,o,g,s),t(c,n,f,g,o,i,s)}else{var h=r?(o*f+s*d)/r:s;t(e,c,d,a,o,i,h),t(c,n,f,a,h,i,s)}}(0,s,t.value,e,n,r,a)},s.treemapDice=Rd,s.treemapResquarify=tf,s.treemapSlice=Wd,s.treemapSliceDice=function(t,e,n,r,a){(1&t.depth?Wd:Rd)(t,e,n,r,a)},s.treemapSquarify=Qd,s.tsv=Wu,s.tsvFormat=Mu,s.tsvFormatBody=qu,s.tsvFormatRow=Du,s.tsvFormatRows=Bu,s.tsvFormatValue=Uu,s.tsvParse=Ru,s.tsvParseRows=Lu,s.union=function(...e){const n=new ot;for(const t of e)for(const e of t)n.add(e);return n},s.unixDay=Ng,s.unixDays=Cg,s.utcDay=Sg,s.utcDays=_g,s.utcFriday=Yg,s.utcFridays=ah,s.utcHour=Ig,s.utcHours=Ag,s.utcMillisecond=og,s.utcMilliseconds=ig,s.utcMinute=Og,s.utcMinutes=vg,s.utcMonday=Kg,s.utcMondays=th,s.utcMonth=uh,s.utcMonths=lh,s.utcSaturday=$g,s.utcSaturdays=oh,s.utcSecond=dg,s.utcSeconds=fg,s.utcSunday=Jg,s.utcSundays=Qg,s.utcThursday=Wg,s.utcThursdays=rh,s.utcTickInterval=gh,s.utcTicks=fh,s.utcTuesday=Xg,s.utcTuesdays=eh,s.utcWednesday=Zg,s.utcWednesdays=nh,s.utcWeek=Jg,s.utcWeeks=Qg,s.utcYear=bh,s.utcYears=mh,s.variance=et,s.version="7.9.0",s.window=Xe,s.xml=Qu,s.zip=function(){return Wt(arguments)},s.zoom=function(){var l,p,u,c=C1,b=w1,f=P1,i=E1,e=V1,s=[0,1/0],g=[[-1/0,-1/0],[1/0,1/0]],m=250,d=Pa,n=de("start","zoom","end"),h=500,O=150,v=0,j=10;function y(t){t.property("__zoom",T1).on("wheel.zoom",a,{passive:!1}).on("mousedown.zoom",o).on("dblclick.zoom",_).filter(e).on("touchstart.zoom",N).on("touchmove.zoom",C).on("touchend.zoom touchcancel.zoom",w).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function I(t,e){return(e=Math.max(s[0],Math.min(s[1],e)))===t.k?t:new x1(e,t.x,t.y)}function A(t,e,n){var r=e[0]-n[0]*t.k,a=e[1]-n[1]*t.k;return r===t.x&&a===t.y?t:new x1(t.k,r,a)}function x(t){return[(+t[0][0]+ +t[1][0])/2,(+t[0][1]+ +t[1][1])/2]}function k(t,l,p,c){t.on("start.zoom",function(){S(this,arguments).event(c).start()}).on("interrupt.zoom end.zoom",function(){S(this,arguments).event(c).end()}).tween("zoom",function(){var t=this,e=arguments,r=S(t,e).event(c),n=b.apply(t,e),a=null==p?x(n):"function"==typeof p?p.apply(t,e):p,o=Math.max(n[1][0]-n[0][0],n[1][1]-n[0][1]),i=t.__zoom,s="function"==typeof l?l.apply(t,e):l,u=d(i.invert(a).concat(o/i.k),s.invert(a).concat(o/s.k));return function(t){if(1===t)t=s;else{var e=u(t),n=o/e[2];t=new x1(n,a[0]-e[0]*n,a[1]-e[1]*n)}r.zoom(null,t)}})}function S(t,e,n){return!n&&t.__zooming||new r(t,e)}function r(t,e){this.that=t,this.args=e,this.active=0,this.sourceEvent=null,this.extent=b.apply(t,e),this.taps=0}function a(t,...e){if(c.apply(this,arguments)){var n=S(this,e).event(t),r=this.__zoom,a=Math.max(s[0],Math.min(s[1],r.k*Math.pow(2,i.apply(this,arguments)))),o=Pn(t);if(n.wheel)n.mouse[0][0]===o[0]&&n.mouse[0][1]===o[1]||(n.mouse[1]=r.invert(n.mouse[0]=o)),clearTimeout(n.wheel);else{if(r.k===a)return;n.mouse=[o,r.invert(o)],ko(this),n.start()}N1(t),n.wheel=setTimeout(function(){n.wheel=null,n.end()},O),n.zoom("mouse",f(A(I(r,a),n.mouse[0],n.mouse[1]),n.extent,g))}}function o(t,...e){if(!u&&c.apply(this,arguments)){var r=t.currentTarget,a=S(this,e,!0).event(t),n=D(t.view).on("mousemove.zoom",function(t){if(N1(t),!a.moved){var e=t.clientX-i,n=t.clientY-s;a.moved=e*e+n*n>v}a.event(t).zoom("mouse",f(A(a.that.__zoom,a.mouse[0]=Pn(t,r),a.mouse[1]),a.extent,g))},!0).on("mouseup.zoom",function(t){n.on("mousemove.zoom mouseup.zoom",null),Bn(t.view,a.moved),N1(t),a.event(t).end()},!0),o=Pn(t,r),i=t.clientX,s=t.clientY;qn(t.view),_1(t),a.mouse=[o,this.__zoom.invert(o)],ko(this),a.start()}}function _(t,...e){if(c.apply(this,arguments)){var n=this.__zoom,r=Pn(t.changedTouches?t.changedTouches[0]:t,this),a=n.invert(r),o=n.k*(t.shiftKey?.5:2),i=f(A(I(n,o),r,a),b.apply(this,e),g);N1(t),m>0?D(this).transition().duration(m).call(k,i,r,t):D(this).call(y.transform,i,r,t)}}function N(t,...e){if(c.apply(this,arguments)){var n,r,a,o,i=t.touches,s=i.length,u=S(this,e,t.changedTouches.length===s).event(t);for(_1(t),r=0;r<s;++r)o=[o=Pn(a=i[r],this),this.__zoom.invert(o),a.identifier],u.touch0?u.touch1||u.touch0[2]===o[2]||(u.touch1=o,u.taps=0):(u.touch0=o,n=!0,u.taps=1+!!l);l&&(l=clearTimeout(l)),n&&(u.taps<2&&(p=o[0],l=setTimeout(function(){l=null},h)),ko(this),u.start())}}function C(t,...e){if(this.__zooming){var n,r,a,o,i=S(this,e).event(t),s=t.changedTouches,u=s.length;for(N1(t),n=0;n<u;++n)a=Pn(r=s[n],this),i.touch0&&i.touch0[2]===r.identifier?i.touch0[0]=a:i.touch1&&i.touch1[2]===r.identifier&&(i.touch1[0]=a);if(r=i.that.__zoom,i.touch1){var l=i.touch0[0],p=i.touch0[1],c=i.touch1[0],b=i.touch1[1],m=(m=c[0]-l[0])*m+(m=c[1]-l[1])*m,d=(d=b[0]-p[0])*d+(d=b[1]-p[1])*d;r=I(r,Math.sqrt(m/d)),a=[(l[0]+c[0])/2,(l[1]+c[1])/2],o=[(p[0]+b[0])/2,(p[1]+b[1])/2]}else{if(!i.touch0)return;a=i.touch0[0],o=i.touch0[1]}i.zoom("touch",f(A(r,a,o),i.extent,g))}}function w(t,...e){if(this.__zooming){var n,r,a=S(this,e).event(t),o=t.changedTouches,i=o.length;for(_1(t),u&&clearTimeout(u),u=setTimeout(function(){u=null},h),n=0;n<i;++n)r=o[n],a.touch0&&a.touch0[2]===r.identifier?delete a.touch0:a.touch1&&a.touch1[2]===r.identifier&&delete a.touch1;if(a.touch1&&!a.touch0&&(a.touch0=a.touch1,delete a.touch1),a.touch0)a.touch0[1]=this.__zoom.invert(a.touch0[0]);else if(a.end(),2===a.taps&&(r=Pn(r,this),Math.hypot(p[0]-r[0],p[1]-r[1])<j)){var s=D(this).on("dblclick.zoom");s&&s.apply(this,arguments)}}}return y.transform=function(t,e,n,r){var a=t.selection?t.selection():t;a.property("__zoom",T1),t!==a?k(t,e,n,r):a.interrupt().each(function(){S(this,arguments).event(r).start().zoom(null,"function"==typeof e?e.apply(this,arguments):e).end()})},y.scaleBy=function(t,e,n,r){y.scaleTo(t,function(){return this.__zoom.k*("function"==typeof e?e.apply(this,arguments):e)},n,r)},y.scaleTo=function(t,o,i,e){y.transform(t,function(){var t=b.apply(this,arguments),e=this.__zoom,n=null==i?x(t):"function"==typeof i?i.apply(this,arguments):i,r=e.invert(n),a="function"==typeof o?o.apply(this,arguments):o;return f(A(I(e,a),n,r),t,g)},i,e)},y.translateBy=function(t,e,n,r){y.transform(t,function(){return f(this.__zoom.translate("function"==typeof e?e.apply(this,arguments):e,"function"==typeof n?n.apply(this,arguments):n),b.apply(this,arguments),g)},null,r)},y.translateTo=function(t,r,a,o,e){y.transform(t,function(){var t=b.apply(this,arguments),e=this.__zoom,n=null==o?x(t):"function"==typeof o?o.apply(this,arguments):o;return f(k1.translate(n[0],n[1]).scale(e.k).translate("function"==typeof r?-r.apply(this,arguments):-r,"function"==typeof a?-a.apply(this,arguments):-a),t,g)},o,e)},r.prototype={event:function(t){return t&&(this.sourceEvent=t),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(t,e){return this.mouse&&"mouse"!==t&&(this.mouse[1]=e.invert(this.mouse[0])),this.touch0&&"touch"!==t&&(this.touch0[1]=e.invert(this.touch0[0])),this.touch1&&"touch"!==t&&(this.touch1[1]=e.invert(this.touch1[0])),this.that.__zoom=e,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(t){var e=D(this.that).datum();n.call(t,this.that,new A1(t,{sourceEvent:this.sourceEvent,target:y,type:t,transform:this.that.__zoom,dispatch:n}),e)}},y.wheelDelta=function(t){return arguments.length?(i="function"==typeof t?t:I1(+t),y):i},y.filter=function(t){return arguments.length?(c="function"==typeof t?t:I1(!!t),y):c},y.touchable=function(t){return arguments.length?(e="function"==typeof t?t:I1(!!t),y):e},y.extent=function(t){return arguments.length?(b="function"==typeof t?t:I1([[+t[0][0],+t[0][1]],[+t[1][0],+t[1][1]]]),y):b},y.scaleExtent=function(t){return arguments.length?(s[0]=+t[0],s[1]=+t[1],y):[s[0],s[1]]},y.translateExtent=function(t){return arguments.length?(g[0][0]=+t[0][0],g[1][0]=+t[1][0],g[0][1]=+t[0][1],g[1][1]=+t[1][1],y):[[g[0][0],g[0][1]],[g[1][0],g[1][1]]]},y.constrain=function(t){return arguments.length?(f=t,y):f},y.duration=function(t){return arguments.length?(m=+t,y):m},y.interpolate=function(t){return arguments.length?(d=t,y):d},y.on=function(){var t=n.on.apply(n,arguments);return t===n?y:t},y.clickDistance=function(t){return arguments.length?(v=(t=+t)*t,y):Math.sqrt(v)},y.tapDistance=function(t){return arguments.length?(j=+t,y):j},y},s.zoomIdentity=k1,s.zoomTransform=S1});if(!window.CABLES||window.CABLES&&!window.CABLES.UI)(function t(e,n){if(typeof exports==="object"&&typeof module==="object")module.exports=n();else if(typeof define==="function"&&define.amd)define([],n);else if(typeof exports==="object")exports.Handlebars=n();else e.Handlebars=n()})(this,function(){return function(n){let r={};function a(t){if(r[t])return r[t].exports;let e=r[t]={exports:{},id:t,loaded:false};n[t].call(e.exports,e,e.exports,a);e.loaded=true;return e.exports}a.m=n;a.c=r;a.p="";return a(0)}([function(t,e,n){let r=n(1).default;e.__esModule=true;let a=n(2);let o=r(a);let i=n(84);let s=r(i);let u=n(85);let l=n(90);let p=n(91);let c=r(p);let b=n(88);let m=r(b);let d=n(83);let f=r(d);let g=o.default.create;function h(){let n=g();n.compile=function(t,e){return l.compile(t,e,n)};n.precompile=function(t,e){return l.precompile(t,e,n)};n.AST=s.default;n.Compiler=l.Compiler;n.JavaScriptCompiler=c.default;n.Parser=u.parser;n.parse=u.parse;n.parseWithoutProcessing=u.parseWithoutProcessing;return n}let O=h();O.create=h;f.default(O);O.Visitor=m.default;O.default=O;e.default=O;t.exports=e.default},function(t,e){e.default=function(t){return t&&t.__esModule?t:{default:t}};e.__esModule=true},function(t,e,n){let r=n(3).default;let a=n(1).default;e.__esModule=true;let o=n(4);let i=r(o);let s=n(77);let u=a(s);let l=n(6);let p=a(l);let c=n(5);let b=r(c);let m=n(78);let d=r(m);let f=n(83);let g=a(f);function h(){let e=new i.HandlebarsEnvironment;b.extend(e,i);e.SafeString=u.default;e.Exception=p.default;e.Utils=b;e.escapeExpression=b.escapeExpression;e.VM=d;e.template=function(t){return d.template(t,e)};return e}let O=h();O.create=h;g.default(O);O.default=O;e.default=O;t.exports=e.default},function(t,e){e.default=function(n){if(n&&n.__esModule){return n}else{let e={};if(n!=null){for(let t in n){if(Object.prototype.hasOwnProperty.call(n,t))e[t]=n[t]}}e.default=n;return e}};e.__esModule=true},function(t,e,n){let r=n(1).default;e.__esModule=true;e.HandlebarsEnvironment=h;let a=n(5);let o=n(6);let i=r(o);let s=n(10);let u=n(70);let l=n(72);let p=r(l);let c=n(73);let b="4.7.8";e.VERSION=b;let m=8;e.COMPILER_REVISION=m;let d=7;e.LAST_COMPATIBLE_COMPILER_REVISION=d;let f={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:"== 1.x.x",5:"== 2.0.0-alpha.x",6:">= 2.0.0-beta.1",7:">= 4.0.0 <4.3.0",8:">= 4.3.0"};e.REVISION_CHANGES=f;let g="[object Object]";function h(t,e,n){this.helpers=t||{};this.partials=e||{};this.decorators=n||{};s.registerDefaultHelpers(this);u.registerDefaultDecorators(this)}h.prototype={constructor:h,logger:p.default,log:p.default.log,registerHelper:function t(e,n){if(a.toString.call(e)===g){if(n){throw new i.default("Arg not supported with multiple helpers")}a.extend(this.helpers,e)}else{this.helpers[e]=n}},unregisterHelper:function t(e){delete this.helpers[e]},registerPartial:function t(e,n){if(a.toString.call(e)===g){a.extend(this.partials,e)}else{if(typeof n==="undefined"){throw new i.default('Attempting to register a partial called "'+e+'" as undefined')}this.partials[e]=n}},unregisterPartial:function t(e){delete this.partials[e]},registerDecorator:function t(e,n){if(a.toString.call(e)===g){if(n){throw new i.default("Arg not supported with multiple decorators")}a.extend(this.decorators,e)}else{this.decorators[e]=n}},unregisterDecorator:function t(e){delete this.decorators[e]},resetLoggedPropertyAccesses:function t(){c.resetLoggedProperties()}};let O=p.default.log;e.log=O;e.createFrame=a.createFrame;e.logger=p.default},function(t,e){e.__esModule=true;e.extend=i;e.indexOf=p;e.escapeExpression=c;e.isEmpty=b;e.createFrame=m;e.blockParams=d;e.appendContextPath=f;let n={"&":"&amp;","<":"<",">":">",'"':"&quot;","'":"&#x27;","`":"&#x60;","=":"&#x3D;"};let r=/[&<>"'`=]/g,a=/[&<>"'`=]/;function o(t){return n[t]}function i(n){for(let e=1;e<arguments.length;e++){for(let t in arguments[e]){if(Object.prototype.hasOwnProperty.call(arguments[e],t)){n[t]=arguments[e][t]}}}return n}let s=Object.prototype.toString;e.toString=s;let u=function t(e){return typeof e==="function"};if(u(/x/)){e.isFunction=u=function(t){return typeof t==="function"&&s.call(t)==="[object Function]"}}e.isFunction=u;let l=Array.isArray||function(t){return t&&typeof t==="object"?s.call(t)==="[object Array]":false};e.isArray=l;function p(n,r){for(let t=0,e=n.length;t<e;t++){if(n[t]===r){return t}}return-1}function c(t){if(typeof t!=="string"){if(t&&t.toHTML){return t.toHTML()}else if(t==null){return""}else if(!t){return t+""}t=""+t}if(!a.test(t)){return t}return t.replace(r,o)}function b(t){if(!t&&t!==0){return true}else if(l(t)&&t.length===0){return true}else{return false}}function m(t){let e=i({},t);e._parent=t;return e}function d(t,e){t.path=e;return t}function f(t,e){return(t?t+".":"")+e}},function(t,e,n){let u=n(7).default;e.__esModule=true;let l=["description","fileName","lineNumber","endLineNumber","message","name","number","stack"];function p(t,e){let n=e&&e.loc,r,a,o,i;if(n){r=n.start.line;a=n.end.line;o=n.start.column;i=n.end.column;t+=" - "+r+":"+o}let s=Error.prototype.constructor.call(this,t);for(let t=0;t<l.length;t++){this[l[t]]=s[l[t]]}if(Error.captureStackTrace){Error.captureStackTrace(this,p)}try{if(n){this.lineNumber=r;this.endLineNumber=a;if(u){Object.defineProperty(this,"column",{value:o,enumerable:true});Object.defineProperty(this,"endColumn",{value:i,enumerable:true})}else{this.column=o;this.endColumn=i}}}catch(t){}}p.prototype=new Error;e.default=p;t.exports=e.default},function(t,e,n){t.exports={default:n(8),__esModule:true}},function(t,e,n){let a=n(9);t.exports=function t(e,n,r){return a.setDesc(e,n,r)}},function(t,e){let n=Object;t.exports={create:n.create,getProto:n.getPrototypeOf,isEnum:{}.propertyIsEnumerable,getDesc:n.getOwnPropertyDescriptor,setDesc:n.defineProperty,setDescs:n.defineProperties,getKeys:n.keys,getNames:n.getOwnPropertyNames,getSymbols:n.getOwnPropertySymbols,each:[].forEach}},function(t,e,n){let r=n(1).default;e.__esModule=true;e.registerDefaultHelpers=O;e.moveHelperToHooks=v;let a=n(11);let o=r(a);let i=n(12);let s=r(i);let u=n(65);let l=r(u);let p=n(66);let c=r(p);let b=n(67);let m=r(b);let d=n(68);let f=r(d);let g=n(69);let h=r(g);function O(t){o.default(t);s.default(t);l.default(t);c.default(t);m.default(t);f.default(t);h.default(t)}function v(t,e,n){if(t.helpers[e]){t.hooks[e]=t.helpers[e];if(!n){delete t.helpers[e]}}}},function(t,e,n){e.__esModule=true;let o=n(5);e.default=function(a){a.registerHelper("blockHelperMissing",function(t,e){let n=e.inverse,r=e.fn;if(t===true){return r(this)}else if(t===false||t==null){return n(this)}else if(o.isArray(t)){if(t.length>0){if(e.ids){e.ids=[e.name]}return a.helpers.each(t,e)}else{return n(this)}}else{if(e.data&&e.ids){let t=o.createFrame(e.data);t.contextPath=o.appendContextPath(e.data.contextPath,e.name);e={data:t}}return r(t,e)}})};t.exports=e.default},function(t,e,n){let c=n(13).default;let b=n(43).default;let m=n(55).default;let d=n(60).default;let r=n(1).default;e.__esModule=true;let f=n(5);let a=n(6);let g=r(a);e.default=function(t){t.registerHelper("each",function(r,t){if(!t){throw new g.default("Must pass iterator to #each")}let a=t.fn,e=t.inverse,o=0,i="",s,u;if(t.data&&t.ids){u=f.appendContextPath(t.data.contextPath,t.ids[0])+"."}if(f.isFunction(r)){r=r.call(this)}if(t.data){s=f.createFrame(t.data)}function l(t,e,n){if(s){s.key=t;s.index=e;s.first=e===0;s.last=!!n;if(u){s.contextPath=u+t}}i+=a(r[t],{data:s,blockParams:f.blockParams([r[t],t],[u+t,null])})}if(r&&typeof r==="object"){if(f.isArray(r)){for(var p=r.length;o<p;o++){if(o in r){l(o,o,o===r.length-1)}}}else if(typeof c==="function"&&r[b]){let e=[];let n=m(r);for(let t=n.next();!t.done;t=n.next()){e.push(t.value)}r=e;for(var p=r.length;o<p;o++){l(o,o,o===r.length-1)}}else{(function(){let e;d(r).forEach(function(t){if(e!==undefined){l(e,o-1)}e=t;o++});if(e!==undefined){l(e,o-1,true)}})()}}if(o===0){i=e(this)}return i})};t.exports=e.default},function(t,e,n){t.exports={default:n(14),__esModule:true}},function(t,e,n){n(15);n(42);t.exports=n(21).Symbol},function(R,L,t){let e=t(9),n=t(16),i=t(17),r=t(18),a=t(20),o=t(24),s=t(19),u=t(27),l=t(28),M=t(30),p=t(29),q=t(31),c=t(36),B=t(37),D=t(38),U=t(39),b=t(32),m=t(26),d=e.getDesc,f=e.setDesc,g=e.create,h=c.get,O=n.Symbol,v=n.JSON,j=v&&v.stringify,y=false,I=p("_hidden"),G=e.isEnum,A=u("symbol-registry"),x=u("symbols"),k=typeof O=="function",S=Object.prototype;let _=r&&s(function(){return g(f({},"a",{get:function(){return f(this,"a",{value:7}).a}})).a!=7})?function(t,e,n){let r=d(S,e);if(r)delete S[e];f(t,e,n);if(r&&t!==S)f(S,e,r)}:f;let N=function(e){let t=x[e]=g(O.prototype);t._k=e;r&&y&&_(S,e,{configurable:true,set:function(t){if(i(this,I)&&i(this[I],e))this[I][e]=false;_(this,e,m(1,t))}});return t};let C=function(t){return typeof t=="symbol"};let w=function t(e,n,r){if(r&&i(x,n)){if(!r.enumerable){if(!i(e,I))f(e,I,m(1,{}));e[I][n]=true}else{if(i(e,I)&&e[I][n])e[I][n]=false;r=g(r,{enumerable:m(0,false)})}return _(e,n,r)}return f(e,n,r)};let T=function t(e,n){U(e);let r=B(n=b(n)),a=0,o=r.length,i;while(o>a)w(e,i=r[a++],n[i]);return e};let E=function t(e,n){return n===undefined?g(e):T(g(e),n)};let V=function t(e){let n=G.call(this,e);return n||!i(this,e)||!i(x,e)||i(this,I)&&this[I][e]?n:true};let P=function t(e,n){let r=d(e=b(e),n);if(r&&i(x,n)&&!(i(e,I)&&e[I][n]))r.enumerable=true;return r};let z=function t(e){let n=h(b(e)),r=[],a=0,o;while(n.length>a)if(!i(x,o=n[a++])&&o!=I)r.push(o);return r};let F=function t(e){let n=h(b(e)),r=[],a=0,o;while(n.length>a)if(i(x,o=n[a++]))r.push(x[o]);return r};let H=function t(e){if(e===undefined||C(e))return;let n=[e],r=1,a=arguments,o,i;while(a.length>r)n.push(a[r++]);o=n[1];if(typeof o=="function")i=o;if(i||!D(o))o=function(t,e){if(i)e=i.call(this,t,e);if(!C(e))return e};n[1]=o;return j.apply(v,n)};let J=s(function(){let t=O();return j([t])!="[null]"||j({a:t})!="{}"||j(Object(t))!="{}"});if(!k){O=function t(){if(C(this))throw TypeError("Symbol is not a constructor");return N(M(arguments.length>0?arguments[0]:undefined))};o(O.prototype,"toString",function t(){return this._k});C=function(t){return t instanceof O};e.create=E;e.isEnum=V;e.getDesc=P;e.setDesc=w;e.setDescs=T;e.getNames=c.get=z;e.getSymbols=F;if(r&&!t(41)){o(S,"propertyIsEnumerable",V,true)}}let K={for:function(t){return i(A,t+="")?A[t]:A[t]=O(t)},keyFor:function t(e){return q(A,e)},useSetter:function(){y=true},useSimple:function(){y=false}};e.each.call(("hasInstance,isConcatSpreadable,iterator,match,replace,search,"+"species,split,toPrimitive,toStringTag,unscopables").split(","),function(t){let e=p(t);K[t]=k?e:N(e)});y=true;a(a.G+a.W,{Symbol:O});a(a.S,"Symbol",K);a(a.S+a.F*!k,"Object",{create:E,defineProperty:w,defineProperties:T,getOwnPropertyDescriptor:P,getOwnPropertyNames:z,getOwnPropertySymbols:F});v&&a(a.S+a.F*(!k||J),"JSON",{stringify:H});l(O,"Symbol");l(Math,"Math",true);l(n.JSON,"JSON",true)},function(t,e){let n=t.exports=typeof window!="undefined"&&window.Math==Math?window:typeof self!="undefined"&&self.Math==Math?self:Function("return this")();if(typeof __g=="number")__g=n},function(t,e){let n={}.hasOwnProperty;t.exports=function(t,e){return n.call(t,e)}},function(t,e,n){t.exports=!n(19)(function(){return Object.defineProperty({},"a",{get:function(){return 7}}).a!=7})},function(t,e){t.exports=function(t){try{return!!t()}catch(t){return true}}},function(t,e,n){let d=n(16),f=n(21),g=n(22),h="prototype";let O=function(t,e,n){let r=t&O.F,a=t&O.G,o=t&O.S,i=t&O.P,s=t&O.B,u=t&O.W,l=a?f:f[e]||(f[e]={}),p=a?d:o?d[e]:(d[e]||{})[h],c,b,m;if(a)n=e;for(c in n){b=!r&&p&&c in p;if(b&&c in l)continue;m=b?p[c]:n[c];l[c]=a&&typeof p[c]!="function"?n[c]:s&&b?g(m,d):u&&p[c]==m?function(e){let t=function(t){return this instanceof e?new e(t):e(t)};t[h]=e[h];return t}(m):i&&typeof m=="function"?g(Function.call,m):m;if(i)(l[h]||(l[h]={}))[c]=m}};O.F=1;O.G=2;O.S=4;O.P=8;O.B=16;O.W=32;t.exports=O},function(t,e){let n=t.exports={version:"1.2.6"};if(typeof __e=="number")__e=n},function(t,e,n){let o=n(23);t.exports=function(r,a,t){o(r);if(a===undefined)return r;switch(t){case 1:return function(t){return r.call(a,t)};case 2:return function(t,e){return r.call(a,t,e)};case 3:return function(t,e,n){return r.call(a,t,e,n)}}return function(){return r.apply(a,arguments)}}},function(t,e){t.exports=function(t){if(typeof t!="function")throw TypeError(t+" is not a function!");return t}},function(t,e,n){t.exports=n(25)},function(t,e,n){let r=n(9),a=n(26);t.exports=n(18)?function(t,e,n){return r.setDesc(t,e,a(1,n))}:function(t,e,n){t[e]=n;return t}},function(t,e){t.exports=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}},function(t,e,n){let r=n(16),a="__core-js_shared__",o=r[a]||(r[a]={});t.exports=function(t){return o[t]||(o[t]={})}},function(t,e,n){let r=n(9).setDesc,a=n(17),o=n(29)("toStringTag");t.exports=function(t,e,n){if(t&&!a(t=n?t:t.prototype,o))r(t,o,{configurable:true,value:e})}},function(t,e,n){let r=n(27)("wks"),a=n(30),o=n(16).Symbol;t.exports=function(t){return r[t]||(r[t]=o&&o[t]||(o||a)("Symbol."+t))}},function(t,e){let n=0,r=Math.random();t.exports=function(t){return"Symbol(".concat(t===undefined?"":t,")_",(++n+r).toString(36))}},function(t,e,n){let s=n(9),u=n(32);t.exports=function(t,e){let n=u(t),r=s.getKeys(n),a=r.length,o=0,i;while(a>o)if(n[i=r[o++]]===e)return i}},function(t,e,n){let r=n(33),a=n(35);t.exports=function(t){return r(a(t))}},function(t,e,n){let r=n(34);t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return r(t)=="String"?t.split(""):Object(t)}},function(t,e){let n={}.toString;t.exports=function(t){return n.call(t).slice(8,-1)}},function(t,e){t.exports=function(t){if(t==undefined)throw TypeError("Can't call method on  "+t);return t}},function(t,e,n){let r=n(32),a=n(9).getNames,o={}.toString;let i=typeof window=="object"&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];let s=function(t){try{return a(t)}catch(t){return i.slice()}};t.exports.get=function t(e){if(i&&o.call(e)=="[object Window]")return s(e);return a(r(e))}},function(t,e,n){let s=n(9);t.exports=function(a){let o=s.getKeys(a),i=s.getSymbols;if(i){let t=i(a),e=s.isEnum,n=0,r;while(t.length>n)if(e.call(a,r=t[n++]))o.push(r)}return o}},function(t,e,n){let r=n(34);t.exports=Array.isArray||function(t){return r(t)=="Array"}},function(t,e,n){let r=n(40);t.exports=function(t){if(!r(t))throw TypeError(t+" is not an object!");return t}},function(t,e){t.exports=function(t){return typeof t==="object"?t!==null:typeof t==="function"}},function(t,e){t.exports=true},function(t,e){},function(t,e,n){t.exports={default:n(44),__esModule:true}},function(t,e,n){n(45);n(51);t.exports=n(29)("iterator")},function(t,e,n){let r=n(46)(true);n(48)(String,"String",function(t){this._t=String(t);this._i=0},function(){let t=this._t,e=this._i,n;if(e>=t.length)return{value:undefined,done:true};n=r(t,e);this._i+=n.length;return{value:n,done:false}})},function(t,e,n){let u=n(47),l=n(35);t.exports=function(s){return function(t,e){let n=String(l(t)),r=u(e),a=n.length,o,i;if(r<0||r>=a)return s?"":undefined;o=n.charCodeAt(r);return o<55296||o>56319||r+1===a||(i=n.charCodeAt(r+1))<56320||i>57343?s?n.charAt(r):o:s?n.slice(r,r+2):(o-55296<<10)+(i-56320)+65536}}},function(t,e){let n=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:n)(t)}},function(t,e,n){let g=n(41),h=n(20),O=n(24),v=n(25),j=n(17),y=n(49),I=n(50),A=n(28),x=n(9).getProto,k=n(29)("iterator"),S=!([].keys&&"next"in[].keys()),_="@@iterator",N="keys",C="values";let w=function(){return this};t.exports=function(e,t,n,r,a,o,i){I(n,t,r);let s=function(e){if(!S&&e in c)return c[e];switch(e){case N:return function t(){return new n(this,e)};case C:return function t(){return new n(this,e)}}return function t(){return new n(this,e)}};var u=t+" Iterator",l=a==C,p=false,c=e.prototype,b=c[k]||c[_]||a&&c[a],m=b||s(a),d,f;if(b){let t=x(m.call(new e));A(t,u,true);if(!g&&j(c,_))v(t,k,w);if(l&&b.name!==C){p=true;m=function t(){return b.call(this)}}}if((!g||i)&&(S||p||!c[k])){v(c,k,m)}y[t]=m;y[u]=w;if(a){d={values:l?m:s(C),keys:o?m:s(N),entries:!l?m:s("entries")};if(i)for(f in d){if(!(f in c))O(c,f,d[f])}else h(h.P+h.F*(S||p),t,d)}return d}},function(t,e){t.exports={}},function(t,e,n){let r=n(9),a=n(26),o=n(28),i={};n(25)(i,n(29)("iterator"),function(){return this});t.exports=function(t,e,n){t.prototype=r.create(i,{next:a(1,n)});o(t,e+" Iterator")}},function(t,e,n){n(52);let r=n(49);r.NodeList=r.HTMLCollection=r.Array},function(t,e,n){let r=n(53),a=n(54),o=n(49),i=n(32);t.exports=n(48)(Array,"Array",function(t,e){this._t=i(t);this._i=0;this._k=e},function(){let t=this._t,e=this._k,n=this._i++;if(!t||n>=t.length){this._t=undefined;return a(1)}if(e=="keys")return a(0,n);if(e=="values")return a(0,t[n]);return a(0,[n,t[n]])},"values");o.Arguments=o.Array;r("keys");r("values");r("entries")},function(t,e){t.exports=function(){}},function(t,e){t.exports=function(t,e){return{value:e,done:!!t}}},function(t,e,n){t.exports={default:n(56),__esModule:true}},function(t,e,n){n(51);n(45);t.exports=n(57)},function(t,e,n){let r=n(39),a=n(58);t.exports=n(21).getIterator=function(t){let e=a(t);if(typeof e!="function")throw TypeError(t+" is not iterable!");return r(e.call(t))}},function(t,e,n){let r=n(59),a=n(29)("iterator"),o=n(49);t.exports=n(21).getIteratorMethod=function(t){if(t!=undefined)return t[a]||t["@@iterator"]||o[r(t)]}},function(t,e,n){let a=n(34),o=n(29)("toStringTag"),i=a(function(){return arguments}())=="Arguments";t.exports=function(t){let e,n,r;return t===undefined?"Undefined":t===null?"Null":typeof(n=(e=Object(t))[o])=="string"?n:i?a(e):(r=a(e))=="Object"&&typeof e.callee=="function"?"Arguments":r}},function(t,e,n){t.exports={default:n(61),__esModule:true}},function(t,e,n){n(62);t.exports=n(21).Object.keys},function(t,e,n){let r=n(63);n(64)("keys",function(n){return function t(e){return n(r(e))}})},function(t,e,n){let r=n(35);t.exports=function(t){return Object(r(t))}},function(t,e,n){let a=n(20),o=n(21),i=n(19);t.exports=function(t,e){let n=(o.Object||{})[t]||Object[t],r={};r[t]=e(n);a(a.S+a.F*i(function(){n(1)}),"Object",r)}},function(t,e,n){let r=n(1).default;e.__esModule=true;let a=n(6);let o=r(a);e.default=function(t){t.registerHelper("helperMissing",function(){if(arguments.length===1){return undefined}else{throw new o.default('Missing helper: "'+arguments[arguments.length-1].name+'"')}})};t.exports=e.default},function(t,e,n){let r=n(1).default;e.__esModule=true;let a=n(5);let o=n(6);let i=r(o);e.default=function(n){n.registerHelper("if",function(t,e){if(arguments.length!=2){throw new i.default("#if requires exactly one argument")}if(a.isFunction(t)){t=t.call(this)}if(!e.hash.includeZero&&!t||a.isEmpty(t)){return e.inverse(this)}else{return e.fn(this)}});n.registerHelper("unless",function(t,e){if(arguments.length!=2){throw new i.default("#unless requires exactly one argument")}return n.helpers.if.call(this,t,{fn:e.inverse,inverse:e.fn,hash:e.hash})})};t.exports=e.default},function(t,e){e.__esModule=true;e.default=function(r){r.registerHelper("log",function(){let e=[undefined],t=arguments[arguments.length-1];for(let t=0;t<arguments.length-1;t++){e.push(arguments[t])}let n=1;if(t.hash.level!=null){n=t.hash.level}else if(t.data&&t.data.level!=null){n=t.data.level}e[0]=n;r.log.apply(r,e)})};t.exports=e.default},function(t,e){e.__esModule=true;e.default=function(t){t.registerHelper("lookup",function(t,e,n){if(!t){return t}return n.lookupProperty(t,e)})};t.exports=e.default},function(t,e,n){let r=n(1).default;e.__esModule=true;let a=n(5);let o=n(6);let i=r(o);e.default=function(t){t.registerHelper("with",function(e,n){if(arguments.length!=2){throw new i.default("#with requires exactly one argument")}if(a.isFunction(e)){e=e.call(this)}let r=n.fn;if(!a.isEmpty(e)){let t=n.data;if(n.data&&n.ids){t=a.createFrame(n.data);t.contextPath=a.appendContextPath(n.data.contextPath,n.ids[0])}return r(e,{data:t,blockParams:a.blockParams([e],[t&&t.contextPath])})}else{return n.inverse(this)}})};t.exports=e.default},function(t,e,n){let r=n(1).default;e.__esModule=true;e.registerDefaultDecorators=i;let a=n(71);let o=r(a);function i(t){o.default(t)}},function(t,e,n){e.__esModule=true;let s=n(5);e.default=function(t){t.registerDecorator("inline",function(a,o,i,t){let e=a;if(!o.partials){o.partials={};e=function(t,e){let n=i.partials;i.partials=s.extend({},n,o.partials);let r=a(t,e);i.partials=n;return r}}o.partials[t.args[0]]=t.fn;return e})};t.exports=e.default},function(t,e,n){e.__esModule=true;let r=n(5);var o={methodMap:["debug","info","warn","error"],level:"info",lookupLevel:function t(e){if(typeof e==="string"){let t=r.indexOf(o.methodMap,e.toLowerCase());if(t>=0){e=t}else{e=parseInt(e,10)}}return e},log:function t(e){e=o.lookupLevel(e);if(typeof console!=="undefined"&&o.lookupLevel(o.level)<=e){let t=o.methodMap[e];if(!console[t]){t="log"}for(var n=arguments.length,r=Array(n>1?n-1:0),a=1;a<n;a++){r[a-1]=arguments[a]}console[t].apply(console,r)}}};e.default=o;t.exports=e.default},function(t,e,n){let r=n(74).default;let a=n(60).default;let o=n(1).default;e.__esModule=true;e.createProtoAccessControl=p;e.resultIsAllowed=c;e.resetLoggedProperties=d;let i=n(76);let s=n(72);let u=o(s);let l=r(null);function p(t){let e=r(null);e.constructor=false;e.__defineGetter__=false;e.__defineSetter__=false;e.__lookupGetter__=false;let n=r(null);n.__proto__=false;return{properties:{whitelist:i.createNewLookupObject(n,t.allowedProtoProperties),defaultValue:t.allowProtoPropertiesByDefault},methods:{whitelist:i.createNewLookupObject(e,t.allowedProtoMethods),defaultValue:t.allowProtoMethodsByDefault}}}function c(t,e,n){if(typeof t==="function"){return b(e.methods,n)}else{return b(e.properties,n)}}function b(t,e){if(t.whitelist[e]!==undefined){return t.whitelist[e]===true}if(t.defaultValue!==undefined){return t.defaultValue}m(e);return false}function m(t){if(l[t]!==true){l[t]=true;u.default.log("error",'Handlebars: Access has been denied to resolve the property "'+t+'" because it is not an "own property" of its parent.\n'+"You can add a runtime option to disable the check or this warning:\n"+"See https://handlebarsjs.com/api-reference/runtime-options.html#options-to-control-prototype-access for details")}}function d(){a(l).forEach(function(t){delete l[t]})}},function(t,e,n){t.exports={default:n(75),__esModule:true}},function(t,e,n){let r=n(9);t.exports=function t(e,n){return r.create(e,n)}},function(t,e,n){let r=n(74).default;e.__esModule=true;e.createNewLookupObject=o;let a=n(5);function o(){for(var t=arguments.length,e=Array(t),n=0;n<t;n++){e[n]=arguments[n]}return a.extend.apply(undefined,[r(null)].concat(e))}},function(t,e){e.__esModule=true;function n(t){this.string=t}n.prototype.toString=n.prototype.toHTML=function(){return""+this.string};e.default=n;t.exports=e.default},function(t,e,n){let a=n(79).default;let o=n(60).default;let r=n(3).default;let i=n(1).default;e.__esModule=true;e.checkRevision=f;e.template=g;e.wrapProgram=h;e.resolvePartial=O;e.invokePartial=v;e.noop=j;let s=n(5);let l=r(s);let u=n(6);let p=i(u);let c=n(4);let b=n(10);let m=n(82);let d=n(73);function f(t){let n=t&&t[0]||1,r=c.COMPILER_REVISION;if(n>=c.LAST_COMPATIBLE_COMPILER_REVISION&&n<=c.COMPILER_REVISION){return}if(n<c.LAST_COMPATIBLE_COMPILER_REVISION){let t=c.REVISION_CHANGES[r],e=c.REVISION_CHANGES[n];throw new p.default("Template was precompiled with an older version of Handlebars than the current runtime. "+"Please update your precompiler to a newer version ("+t+") or downgrade your runtime to an older version ("+e+").")}else{throw new p.default("Template was precompiled with a newer version of Handlebars than the current runtime. "+"Please update your runtime to a newer version ("+t[1]+").")}}function g(i,o){if(!o){throw new p.default("No environment passed to template")}if(!i||!i.main){throw new p.default("Unknown template object: "+typeof i)}i.main.decorator=i.main_d;o.VM.checkRevision(i.compiler);let r=i.compiler&&i.compiler[0]===7;function t(t,e,r){if(r.hash){e=l.extend({},e,r.hash);if(r.ids){r.ids[0]=true}}t=o.VM.resolvePartial.call(this,t,e,r);let n=l.extend({},r,{hooks:this.hooks,protoAccessControl:this.protoAccessControl});let a=o.VM.invokePartial.call(this,t,e,n);if(a==null&&o.compile){r.partials[r.name]=o.compile(t,i.compilerOptions,o);a=r.partials[r.name](e,n)}if(a!=null){if(r.indent){let n=a.split("\n");for(let t=0,e=n.length;t<e;t++){if(!n[t]&&t+1===e){break}n[t]=r.indent+n[t]}a=n.join("\n")}return a}else{throw new p.default("The partial "+r.name+" could not be compiled when running in runtime-only mode")}}var s={strict:function t(e,n,r){if(!e||!(n in e)){throw new p.default('"'+n+'" not defined in '+e,{loc:r})}return s.lookupProperty(e,n)},lookupProperty:function t(e,n){let r=e[n];if(r==null){return r}if(Object.prototype.hasOwnProperty.call(e,n)){return r}if(d.resultIsAllowed(r,s.protoAccessControl,n)){return r}return undefined},lookup:function t(n,r){let a=n.length;for(let e=0;e<a;e++){let t=n[e]&&s.lookupProperty(n[e],r);if(t!=null){return n[e][r]}}},lambda:function t(e,n){return typeof e==="function"?e.call(n):e},escapeExpression:l.escapeExpression,invokePartial:t,fn:function t(e){let n=i[e];n.decorator=i[e+"_d"];return n},programs:[],program:function t(e,n,r,a,o){let i=this.programs[e],s=this.fn(e);if(n||o||a||r){i=h(this,e,s,n,r,a,o)}else if(!i){i=this.programs[e]=h(this,e,s)}return i},data:function t(e,n){while(e&&n--){e=e._parent}return e},mergeIfNeeded:function t(e,n){let r=e||n;if(e&&n&&e!==n){r=l.extend({},n,e)}return r},nullContext:a({}),noop:o.VM.noop,compilerInfo:i.compiler};function u(t){let e=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];let n=e.data;u._setup(e);if(!e.partial&&i.useData){n=y(t,n)}let r,a=i.useBlockParams?[]:undefined;if(i.useDepths){if(e.depths){r=t!=e.depths[0]?[t].concat(e.depths):e.depths}else{r=[t]}}function o(t){return""+i.main(s,t,s.helpers,s.partials,n,a,r)}o=I(i.main,o,s,e.depths||[],n,a);return o(t,e)}u.isTop=true;u._setup=function(n){if(!n.partial){let t=l.extend({},o.helpers,n.helpers);A(t,s);s.helpers=t;if(i.usePartial){s.partials=s.mergeIfNeeded(n.partials,o.partials)}if(i.usePartial||i.useDecorators){s.decorators=l.extend({},o.decorators,n.decorators)}s.hooks={};s.protoAccessControl=d.createProtoAccessControl(n);let e=n.allowCallsToHelperMissing||r;b.moveHelperToHooks(s,"helperMissing",e);b.moveHelperToHooks(s,"blockHelperMissing",e)}else{s.protoAccessControl=n.protoAccessControl;s.helpers=n.helpers;s.partials=n.partials;s.decorators=n.decorators;s.hooks=n.hooks}};u._child=function(t,e,n,r){if(i.useBlockParams&&!n){throw new p.default("must pass block params")}if(i.useDepths&&!r){throw new p.default("must pass parent depths")}return h(s,t,i[t],e,0,n,r)};return u}function h(r,t,a,o,e,i,s){function n(t){let e=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];let n=s;if(s&&t!=s[0]&&!(t===r.nullContext&&s[0]===null)){n=[t].concat(s)}return a(r,t,r.helpers,r.partials,e.data||o,i&&[e.blockParams].concat(i),n)}n=I(a,n,r,s,o,i);n.program=t;n.depth=s?s.length:0;n.blockParams=e||0;return n}function O(t,e,n){if(!t){if(n.name==="@partial-block"){t=n.data["partial-block"]}else{t=n.partials[n.name]}}else if(!t.call&&!n.name){n.name=t;t=n.partials[t]}return t}function v(t,e,n){let a=n.data&&n.data["partial-block"];n.partial=true;if(n.ids){n.data.contextPath=n.ids[0]||n.data.contextPath}let o;if(n.fn&&n.fn!==j){(function(){n.data=c.createFrame(n.data);let r=n.fn;o=n.data["partial-block"]=function t(e){let n=arguments.length<=1||arguments[1]===undefined?{}:arguments[1];n.data=c.createFrame(n.data);n.data["partial-block"]=a;return r(e,n)};if(r.partials){n.partials=l.extend({},n.partials,r.partials)}})()}if(t===undefined&&o){t=o}if(t===undefined){throw new p.default("The partial "+n.name+" could not be found")}else if(t instanceof Function){return t(e,n)}}function j(){return""}function y(t,e){if(!e||!("root"in e)){e=e?c.createFrame(e):{};e.root=t}return e}function I(e,n,r,a,o,i){if(e.decorator){let t={};n=e.decorator(n,t,r,a&&a[0],o,i,a);l.extend(n,t)}return n}function A(n,r){o(n).forEach(function(t){let e=n[t];n[t]=x(e,r)})}function x(t,e){let n=e.lookupProperty;return m.wrapHelper(t,function(t){return l.extend({lookupProperty:n},t)})}},function(t,e,n){t.exports={default:n(80),__esModule:true}},function(t,e,n){n(81);t.exports=n(21).Object.seal},function(t,e,n){let r=n(40);n(64)("seal",function(n){return function t(e){return n&&r(e)?n(e):e}})},function(t,e){e.__esModule=true;e.wrapHelper=n;function n(n,r){if(typeof n!=="function"){return n}let t=function t(){let e=arguments[arguments.length-1];arguments[arguments.length-1]=r(e);return n.apply(this,arguments)};return t}},function(t,e){e.__esModule=true;e.default=function(t){(function(){if(typeof globalThis==="object")return;Object.prototype.__defineGetter__("__magic__",function(){return this});__magic__.globalThis=__magic__;delete Object.prototype.__magic__})();let e=globalThis.Handlebars;t.noConflict=function(){if(globalThis.Handlebars===t){globalThis.Handlebars=e}return t}};t.exports=e.default},function(t,e){e.__esModule=true;var n={helpers:{helperExpression:function t(e){return e.type==="SubExpression"||(e.type==="MustacheStatement"||e.type==="BlockStatement")&&!!(e.params&&e.params.length||e.hash)},scopedId:function t(e){return/^\.|this\b/.test(e.original)},simpleId:function t(e){return e.parts.length===1&&!n.helpers.scopedId(e)&&!e.depth}}};e.default=n;t.exports=e.default},function(t,e,n){let r=n(1).default;let a=n(3).default;e.__esModule=true;e.parseWithoutProcessing=m;e.parse=d;let o=n(86);let i=r(o);let s=n(87);let u=r(s);let l=n(89);let p=a(l);let c=n(5);e.parser=i.default;let b={};c.extend(b,p);function m(t,e){if(t.type==="Program"){return t}i.default.yy=b;b.locInfo=function(t){return new b.SourceLocation(e&&e.srcName,t)};let n=i.default.parse(t);return n}function d(t,e){let n=m(t,e);let r=new u.default(e);return r.accept(n)}},function(t,e){e.__esModule=true;let n=function(){let t={trace:function t(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,program_repetition0:6,statement:7,mustache:8,block:9,rawBlock:10,partial:11,partialBlock:12,content:13,COMMENT:14,CONTENT:15,openRawBlock:16,rawBlock_repetition0:17,END_RAW_BLOCK:18,OPEN_RAW_BLOCK:19,helperName:20,openRawBlock_repetition0:21,openRawBlock_option0:22,CLOSE_RAW_BLOCK:23,openBlock:24,block_option0:25,closeBlock:26,openInverse:27,block_option1:28,OPEN_BLOCK:29,openBlock_repetition0:30,openBlock_option0:31,openBlock_option1:32,CLOSE:33,OPEN_INVERSE:34,openInverse_repetition0:35,openInverse_option0:36,openInverse_option1:37,openInverseChain:38,OPEN_INVERSE_CHAIN:39,openInverseChain_repetition0:40,openInverseChain_option0:41,openInverseChain_option1:42,inverseAndProgram:43,INVERSE:44,inverseChain:45,inverseChain_option0:46,OPEN_ENDBLOCK:47,OPEN:48,mustache_repetition0:49,mustache_option0:50,OPEN_UNESCAPED:51,mustache_repetition1:52,mustache_option1:53,CLOSE_UNESCAPED:54,OPEN_PARTIAL:55,partialName:56,partial_repetition0:57,partial_option0:58,openPartialBlock:59,OPEN_PARTIAL_BLOCK:60,openPartialBlock_repetition0:61,openPartialBlock_option0:62,param:63,sexpr:64,OPEN_SEXPR:65,sexpr_repetition0:66,sexpr_option0:67,CLOSE_SEXPR:68,hash:69,hash_repetition_plus0:70,hashSegment:71,ID:72,EQUALS:73,blockParams:74,OPEN_BLOCK_PARAMS:75,blockParams_repetition_plus0:76,CLOSE_BLOCK_PARAMS:77,path:78,dataName:79,STRING:80,NUMBER:81,BOOLEAN:82,UNDEFINED:83,NULL:84,DATA:85,pathSegments:86,SEP:87,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"COMMENT",15:"CONTENT",18:"END_RAW_BLOCK",19:"OPEN_RAW_BLOCK",23:"CLOSE_RAW_BLOCK",29:"OPEN_BLOCK",33:"CLOSE",34:"OPEN_INVERSE",39:"OPEN_INVERSE_CHAIN",44:"INVERSE",47:"OPEN_ENDBLOCK",48:"OPEN",51:"OPEN_UNESCAPED",54:"CLOSE_UNESCAPED",55:"OPEN_PARTIAL",60:"OPEN_PARTIAL_BLOCK",65:"OPEN_SEXPR",68:"CLOSE_SEXPR",72:"ID",73:"EQUALS",75:"OPEN_BLOCK_PARAMS",77:"CLOSE_BLOCK_PARAMS",80:"STRING",81:"NUMBER",82:"BOOLEAN",83:"UNDEFINED",84:"NULL",85:"DATA",87:"SEP"},productions_:[0,[3,2],[4,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[7,1],[13,1],[10,3],[16,5],[9,4],[9,4],[24,6],[27,6],[38,6],[43,2],[45,3],[45,1],[26,3],[8,5],[8,5],[11,5],[12,3],[59,5],[63,1],[63,1],[64,5],[69,1],[71,3],[74,3],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[20,1],[56,1],[56,1],[79,2],[78,1],[86,3],[86,1],[6,0],[6,2],[17,0],[17,2],[21,0],[21,2],[22,0],[22,1],[25,0],[25,1],[28,0],[28,1],[30,0],[30,2],[31,0],[31,1],[32,0],[32,1],[35,0],[35,2],[36,0],[36,1],[37,0],[37,1],[40,0],[40,2],[41,0],[41,1],[42,0],[42,1],[46,0],[46,1],[49,0],[49,2],[50,0],[50,1],[52,0],[52,2],[53,0],[53,1],[57,0],[57,2],[58,0],[58,1],[61,0],[61,2],[62,0],[62,1],[66,0],[66,2],[67,0],[67,1],[70,1],[70,2],[76,1],[76,2]],performAction:function t(e,n,r,a,o,i,s){let u=i.length-1;switch(o){case 1:return i[u-1];break;case 2:this.$=a.prepareProgram(i[u]);break;case 3:this.$=i[u];break;case 4:this.$=i[u];break;case 5:this.$=i[u];break;case 6:this.$=i[u];break;case 7:this.$=i[u];break;case 8:this.$=i[u];break;case 9:this.$={type:"CommentStatement",value:a.stripComment(i[u]),strip:a.stripFlags(i[u],i[u]),loc:a.locInfo(this._$)};break;case 10:this.$={type:"ContentStatement",original:i[u],value:i[u],loc:a.locInfo(this._$)};break;case 11:this.$=a.prepareRawBlock(i[u-2],i[u-1],i[u],this._$);break;case 12:this.$={path:i[u-3],params:i[u-2],hash:i[u-1]};break;case 13:this.$=a.prepareBlock(i[u-3],i[u-2],i[u-1],i[u],false,this._$);break;case 14:this.$=a.prepareBlock(i[u-3],i[u-2],i[u-1],i[u],true,this._$);break;case 15:this.$={open:i[u-5],path:i[u-4],params:i[u-3],hash:i[u-2],blockParams:i[u-1],strip:a.stripFlags(i[u-5],i[u])};break;case 16:this.$={path:i[u-4],params:i[u-3],hash:i[u-2],blockParams:i[u-1],strip:a.stripFlags(i[u-5],i[u])};break;case 17:this.$={path:i[u-4],params:i[u-3],hash:i[u-2],blockParams:i[u-1],strip:a.stripFlags(i[u-5],i[u])};break;case 18:this.$={strip:a.stripFlags(i[u-1],i[u-1]),program:i[u]};break;case 19:var l=a.prepareBlock(i[u-2],i[u-1],i[u],i[u],false,this._$),p=a.prepareProgram([l],i[u-1].loc);p.chained=true;this.$={strip:i[u-2].strip,program:p,chain:true};break;case 20:this.$=i[u];break;case 21:this.$={path:i[u-1],strip:a.stripFlags(i[u-2],i[u])};break;case 22:this.$=a.prepareMustache(i[u-3],i[u-2],i[u-1],i[u-4],a.stripFlags(i[u-4],i[u]),this._$);break;case 23:this.$=a.prepareMustache(i[u-3],i[u-2],i[u-1],i[u-4],a.stripFlags(i[u-4],i[u]),this._$);break;case 24:this.$={type:"PartialStatement",name:i[u-3],params:i[u-2],hash:i[u-1],indent:"",strip:a.stripFlags(i[u-4],i[u]),loc:a.locInfo(this._$)};break;case 25:this.$=a.preparePartialBlock(i[u-2],i[u-1],i[u],this._$);break;case 26:this.$={path:i[u-3],params:i[u-2],hash:i[u-1],strip:a.stripFlags(i[u-4],i[u])};break;case 27:this.$=i[u];break;case 28:this.$=i[u];break;case 29:this.$={type:"SubExpression",path:i[u-3],params:i[u-2],hash:i[u-1],loc:a.locInfo(this._$)};break;case 30:this.$={type:"Hash",pairs:i[u],loc:a.locInfo(this._$)};break;case 31:this.$={type:"HashPair",key:a.id(i[u-2]),value:i[u],loc:a.locInfo(this._$)};break;case 32:this.$=a.id(i[u-1]);break;case 33:this.$=i[u];break;case 34:this.$=i[u];break;case 35:this.$={type:"StringLiteral",value:i[u],original:i[u],loc:a.locInfo(this._$)};break;case 36:this.$={type:"NumberLiteral",value:Number(i[u]),original:Number(i[u]),loc:a.locInfo(this._$)};break;case 37:this.$={type:"BooleanLiteral",value:i[u]==="true",original:i[u]==="true",loc:a.locInfo(this._$)};break;case 38:this.$={type:"UndefinedLiteral",original:undefined,value:undefined,loc:a.locInfo(this._$)};break;case 39:this.$={type:"NullLiteral",original:null,value:null,loc:a.locInfo(this._$)};break;case 40:this.$=i[u];break;case 41:this.$=i[u];break;case 42:this.$=a.preparePath(true,i[u],this._$);break;case 43:this.$=a.preparePath(false,i[u],this._$);break;case 44:i[u-2].push({part:a.id(i[u]),original:i[u],separator:i[u-1]});this.$=i[u-2];break;case 45:this.$=[{part:a.id(i[u]),original:i[u]}];break;case 46:this.$=[];break;case 47:i[u-1].push(i[u]);break;case 48:this.$=[];break;case 49:i[u-1].push(i[u]);break;case 50:this.$=[];break;case 51:i[u-1].push(i[u]);break;case 58:this.$=[];break;case 59:i[u-1].push(i[u]);break;case 64:this.$=[];break;case 65:i[u-1].push(i[u]);break;case 70:this.$=[];break;case 71:i[u-1].push(i[u]);break;case 78:this.$=[];break;case 79:i[u-1].push(i[u]);break;case 82:this.$=[];break;case 83:i[u-1].push(i[u]);break;case 86:this.$=[];break;case 87:i[u-1].push(i[u]);break;case 90:this.$=[];break;case 91:i[u-1].push(i[u]);break;case 94:this.$=[];break;case 95:i[u-1].push(i[u]);break;case 98:this.$=[i[u]];break;case 99:i[u-1].push(i[u]);break;case 100:this.$=[i[u]];break;case 101:i[u-1].push(i[u]);break}},table:[{3:1,4:2,5:[2,46],6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{1:[3]},{5:[1,4]},{5:[2,2],7:5,8:6,9:7,10:8,11:9,12:10,13:11,14:[1,12],15:[1,20],16:17,19:[1,23],24:15,27:16,29:[1,21],34:[1,22],39:[2,2],44:[2,2],47:[2,2],48:[1,13],51:[1,14],55:[1,18],59:19,60:[1,24]},{1:[2,1]},{5:[2,47],14:[2,47],15:[2,47],19:[2,47],29:[2,47],34:[2,47],39:[2,47],44:[2,47],47:[2,47],48:[2,47],51:[2,47],55:[2,47],60:[2,47]},{5:[2,3],14:[2,3],15:[2,3],19:[2,3],29:[2,3],34:[2,3],39:[2,3],44:[2,3],47:[2,3],48:[2,3],51:[2,3],55:[2,3],60:[2,3]},{5:[2,4],14:[2,4],15:[2,4],19:[2,4],29:[2,4],34:[2,4],39:[2,4],44:[2,4],47:[2,4],48:[2,4],51:[2,4],55:[2,4],60:[2,4]},{5:[2,5],14:[2,5],15:[2,5],19:[2,5],29:[2,5],34:[2,5],39:[2,5],44:[2,5],47:[2,5],48:[2,5],51:[2,5],55:[2,5],60:[2,5]},{5:[2,6],14:[2,6],15:[2,6],19:[2,6],29:[2,6],34:[2,6],39:[2,6],44:[2,6],47:[2,6],48:[2,6],51:[2,6],55:[2,6],60:[2,6]},{5:[2,7],14:[2,7],15:[2,7],19:[2,7],29:[2,7],34:[2,7],39:[2,7],44:[2,7],47:[2,7],48:[2,7],51:[2,7],55:[2,7],60:[2,7]},{5:[2,8],14:[2,8],15:[2,8],19:[2,8],29:[2,8],34:[2,8],39:[2,8],44:[2,8],47:[2,8],48:[2,8],51:[2,8],55:[2,8],60:[2,8]},{5:[2,9],14:[2,9],15:[2,9],19:[2,9],29:[2,9],34:[2,9],39:[2,9],44:[2,9],47:[2,9],48:[2,9],51:[2,9],55:[2,9],60:[2,9]},{20:25,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:36,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:37,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{4:38,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{15:[2,48],17:39,18:[2,48]},{20:41,56:40,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:44,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{5:[2,10],14:[2,10],15:[2,10],18:[2,10],19:[2,10],29:[2,10],34:[2,10],39:[2,10],44:[2,10],47:[2,10],48:[2,10],51:[2,10],55:[2,10],60:[2,10]},{20:45,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:46,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:47,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:41,56:48,64:42,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[2,78],49:49,65:[2,78],72:[2,78],80:[2,78],81:[2,78],82:[2,78],83:[2,78],84:[2,78],85:[2,78]},{23:[2,33],33:[2,33],54:[2,33],65:[2,33],68:[2,33],72:[2,33],75:[2,33],80:[2,33],81:[2,33],82:[2,33],83:[2,33],84:[2,33],85:[2,33]},{23:[2,34],33:[2,34],54:[2,34],65:[2,34],68:[2,34],72:[2,34],75:[2,34],80:[2,34],81:[2,34],82:[2,34],83:[2,34],84:[2,34],85:[2,34]},{23:[2,35],33:[2,35],54:[2,35],65:[2,35],68:[2,35],72:[2,35],75:[2,35],80:[2,35],81:[2,35],82:[2,35],83:[2,35],84:[2,35],85:[2,35]},{23:[2,36],33:[2,36],54:[2,36],65:[2,36],68:[2,36],72:[2,36],75:[2,36],80:[2,36],81:[2,36],82:[2,36],83:[2,36],84:[2,36],85:[2,36]},{23:[2,37],33:[2,37],54:[2,37],65:[2,37],68:[2,37],72:[2,37],75:[2,37],80:[2,37],81:[2,37],82:[2,37],83:[2,37],84:[2,37],85:[2,37]},{23:[2,38],33:[2,38],54:[2,38],65:[2,38],68:[2,38],72:[2,38],75:[2,38],80:[2,38],81:[2,38],82:[2,38],83:[2,38],84:[2,38],85:[2,38]},{23:[2,39],33:[2,39],54:[2,39],65:[2,39],68:[2,39],72:[2,39],75:[2,39],80:[2,39],81:[2,39],82:[2,39],83:[2,39],84:[2,39],85:[2,39]},{23:[2,43],33:[2,43],54:[2,43],65:[2,43],68:[2,43],72:[2,43],75:[2,43],80:[2,43],81:[2,43],82:[2,43],83:[2,43],84:[2,43],85:[2,43],87:[1,50]},{72:[1,35],86:51},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{52:52,54:[2,82],65:[2,82],72:[2,82],80:[2,82],81:[2,82],82:[2,82],83:[2,82],84:[2,82],85:[2,82]},{25:53,38:55,39:[1,57],43:56,44:[1,58],45:54,47:[2,54]},{28:59,43:60,44:[1,58],47:[2,56]},{13:62,15:[1,20],18:[1,61]},{33:[2,86],57:63,65:[2,86],72:[2,86],80:[2,86],81:[2,86],82:[2,86],83:[2,86],84:[2,86],85:[2,86]},{33:[2,40],65:[2,40],72:[2,40],80:[2,40],81:[2,40],82:[2,40],83:[2,40],84:[2,40],85:[2,40]},{33:[2,41],65:[2,41],72:[2,41],80:[2,41],81:[2,41],82:[2,41],83:[2,41],84:[2,41],85:[2,41]},{20:64,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:65,47:[1,66]},{30:67,33:[2,58],65:[2,58],72:[2,58],75:[2,58],80:[2,58],81:[2,58],82:[2,58],83:[2,58],84:[2,58],85:[2,58]},{33:[2,64],35:68,65:[2,64],72:[2,64],75:[2,64],80:[2,64],81:[2,64],82:[2,64],83:[2,64],84:[2,64],85:[2,64]},{21:69,23:[2,50],65:[2,50],72:[2,50],80:[2,50],81:[2,50],82:[2,50],83:[2,50],84:[2,50],85:[2,50]},{33:[2,90],61:70,65:[2,90],72:[2,90],80:[2,90],81:[2,90],82:[2,90],83:[2,90],84:[2,90],85:[2,90]},{20:74,33:[2,80],50:71,63:72,64:75,65:[1,43],69:73,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{72:[1,79]},{23:[2,42],33:[2,42],54:[2,42],65:[2,42],68:[2,42],72:[2,42],75:[2,42],80:[2,42],81:[2,42],82:[2,42],83:[2,42],84:[2,42],85:[2,42],87:[1,50]},{20:74,53:80,54:[2,84],63:81,64:75,65:[1,43],69:82,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{26:83,47:[1,66]},{47:[2,55]},{4:84,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],39:[2,46],44:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{47:[2,20]},{20:85,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{4:86,6:3,14:[2,46],15:[2,46],19:[2,46],29:[2,46],34:[2,46],47:[2,46],48:[2,46],51:[2,46],55:[2,46],60:[2,46]},{26:87,47:[1,66]},{47:[2,57]},{5:[2,11],14:[2,11],15:[2,11],19:[2,11],29:[2,11],34:[2,11],39:[2,11],44:[2,11],47:[2,11],48:[2,11],51:[2,11],55:[2,11],60:[2,11]},{15:[2,49],18:[2,49]},{20:74,33:[2,88],58:88,63:89,64:75,65:[1,43],69:90,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{65:[2,94],66:91,68:[2,94],72:[2,94],80:[2,94],81:[2,94],82:[2,94],83:[2,94],84:[2,94],85:[2,94]},{5:[2,25],14:[2,25],15:[2,25],19:[2,25],29:[2,25],34:[2,25],39:[2,25],44:[2,25],47:[2,25],48:[2,25],51:[2,25],55:[2,25],60:[2,25]},{20:92,72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,31:93,33:[2,60],63:94,64:75,65:[1,43],69:95,70:76,71:77,72:[1,78],75:[2,60],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,66],36:96,63:97,64:75,65:[1,43],69:98,70:76,71:77,72:[1,78],75:[2,66],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,22:99,23:[2,52],63:100,64:75,65:[1,43],69:101,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{20:74,33:[2,92],62:102,63:103,64:75,65:[1,43],69:104,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,105]},{33:[2,79],65:[2,79],72:[2,79],80:[2,79],81:[2,79],82:[2,79],83:[2,79],84:[2,79],85:[2,79]},{33:[2,81]},{23:[2,27],33:[2,27],54:[2,27],65:[2,27],68:[2,27],72:[2,27],75:[2,27],80:[2,27],81:[2,27],82:[2,27],83:[2,27],84:[2,27],85:[2,27]},{23:[2,28],33:[2,28],54:[2,28],65:[2,28],68:[2,28],72:[2,28],75:[2,28],80:[2,28],81:[2,28],82:[2,28],83:[2,28],84:[2,28],85:[2,28]},{23:[2,30],33:[2,30],54:[2,30],68:[2,30],71:106,72:[1,107],75:[2,30]},{23:[2,98],33:[2,98],54:[2,98],68:[2,98],72:[2,98],75:[2,98]},{23:[2,45],33:[2,45],54:[2,45],65:[2,45],68:[2,45],72:[2,45],73:[1,108],75:[2,45],80:[2,45],81:[2,45],82:[2,45],83:[2,45],84:[2,45],85:[2,45],87:[2,45]},{23:[2,44],33:[2,44],54:[2,44],65:[2,44],68:[2,44],72:[2,44],75:[2,44],80:[2,44],81:[2,44],82:[2,44],83:[2,44],84:[2,44],85:[2,44],87:[2,44]},{54:[1,109]},{54:[2,83],65:[2,83],72:[2,83],80:[2,83],81:[2,83],82:[2,83],83:[2,83],84:[2,83],85:[2,83]},{54:[2,85]},{5:[2,13],14:[2,13],15:[2,13],19:[2,13],29:[2,13],34:[2,13],39:[2,13],44:[2,13],47:[2,13],48:[2,13],51:[2,13],55:[2,13],60:[2,13]},{38:55,39:[1,57],43:56,44:[1,58],45:111,46:110,47:[2,76]},{33:[2,70],40:112,65:[2,70],72:[2,70],75:[2,70],80:[2,70],81:[2,70],82:[2,70],83:[2,70],84:[2,70],85:[2,70]},{47:[2,18]},{5:[2,14],14:[2,14],15:[2,14],19:[2,14],29:[2,14],34:[2,14],39:[2,14],44:[2,14],47:[2,14],48:[2,14],51:[2,14],55:[2,14],60:[2,14]},{33:[1,113]},{33:[2,87],65:[2,87],72:[2,87],80:[2,87],81:[2,87],82:[2,87],83:[2,87],84:[2,87],85:[2,87]},{33:[2,89]},{20:74,63:115,64:75,65:[1,43],67:114,68:[2,96],69:116,70:76,71:77,72:[1,78],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{33:[1,117]},{32:118,33:[2,62],74:119,75:[1,120]},{33:[2,59],65:[2,59],72:[2,59],75:[2,59],80:[2,59],81:[2,59],82:[2,59],83:[2,59],84:[2,59],85:[2,59]},{33:[2,61],75:[2,61]},{33:[2,68],37:121,74:122,75:[1,120]},{33:[2,65],65:[2,65],72:[2,65],75:[2,65],80:[2,65],81:[2,65],82:[2,65],83:[2,65],84:[2,65],85:[2,65]},{33:[2,67],75:[2,67]},{23:[1,123]},{23:[2,51],65:[2,51],72:[2,51],80:[2,51],81:[2,51],82:[2,51],83:[2,51],84:[2,51],85:[2,51]},{23:[2,53]},{33:[1,124]},{33:[2,91],65:[2,91],72:[2,91],80:[2,91],81:[2,91],82:[2,91],83:[2,91],84:[2,91],85:[2,91]},{33:[2,93]},{5:[2,22],14:[2,22],15:[2,22],19:[2,22],29:[2,22],34:[2,22],39:[2,22],44:[2,22],47:[2,22],48:[2,22],51:[2,22],55:[2,22],60:[2,22]},{23:[2,99],33:[2,99],54:[2,99],68:[2,99],72:[2,99],75:[2,99]},{73:[1,108]},{20:74,63:125,64:75,65:[1,43],72:[1,35],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,23],14:[2,23],15:[2,23],19:[2,23],29:[2,23],34:[2,23],39:[2,23],44:[2,23],47:[2,23],48:[2,23],51:[2,23],55:[2,23],60:[2,23]},{47:[2,19]},{47:[2,77]},{20:74,33:[2,72],41:126,63:127,64:75,65:[1,43],69:128,70:76,71:77,72:[1,78],75:[2,72],78:26,79:27,80:[1,28],81:[1,29],82:[1,30],83:[1,31],84:[1,32],85:[1,34],86:33},{5:[2,24],14:[2,24],15:[2,24],19:[2,24],29:[2,24],34:[2,24],39:[2,24],44:[2,24],47:[2,24],48:[2,24],51:[2,24],55:[2,24],60:[2,24]},{68:[1,129]},{65:[2,95],68:[2,95],72:[2,95],80:[2,95],81:[2,95],82:[2,95],83:[2,95],84:[2,95],85:[2,95]},{68:[2,97]},{5:[2,21],14:[2,21],15:[2,21],19:[2,21],29:[2,21],34:[2,21],39:[2,21],44:[2,21],47:[2,21],48:[2,21],51:[2,21],55:[2,21],60:[2,21]},{33:[1,130]},{33:[2,63]},{72:[1,132],76:131},{33:[1,133]},{33:[2,69]},{15:[2,12],18:[2,12]},{14:[2,26],15:[2,26],19:[2,26],29:[2,26],34:[2,26],47:[2,26],48:[2,26],51:[2,26],55:[2,26],60:[2,26]},{23:[2,31],33:[2,31],54:[2,31],68:[2,31],72:[2,31],75:[2,31]},{33:[2,74],42:134,74:135,75:[1,120]},{33:[2,71],65:[2,71],72:[2,71],75:[2,71],80:[2,71],81:[2,71],82:[2,71],83:[2,71],84:[2,71],85:[2,71]},{33:[2,73],75:[2,73]},{23:[2,29],33:[2,29],54:[2,29],65:[2,29],68:[2,29],72:[2,29],75:[2,29],80:[2,29],81:[2,29],82:[2,29],83:[2,29],84:[2,29],85:[2,29]},{14:[2,15],15:[2,15],19:[2,15],29:[2,15],34:[2,15],39:[2,15],44:[2,15],47:[2,15],48:[2,15],51:[2,15],55:[2,15],60:[2,15]},{72:[1,137],77:[1,136]},{72:[2,100],77:[2,100]},{14:[2,16],15:[2,16],19:[2,16],29:[2,16],34:[2,16],44:[2,16],47:[2,16],48:[2,16],51:[2,16],55:[2,16],60:[2,16]},{33:[1,138]},{33:[2,75]},{33:[2,32]},{72:[2,101],77:[2,101]},{14:[2,17],15:[2,17],19:[2,17],29:[2,17],34:[2,17],39:[2,17],44:[2,17],47:[2,17],48:[2,17],51:[2,17],55:[2,17],60:[2,17]}],defaultActions:{4:[2,1],54:[2,55],56:[2,20],60:[2,57],73:[2,81],82:[2,85],86:[2,18],90:[2,89],101:[2,53],104:[2,93],110:[2,19],111:[2,77],116:[2,97],119:[2,63],122:[2,69],135:[2,75],136:[2,32]},parseError:function t(e,n){throw new Error(e)},parse:function t(e){let n=this,r=[0],a=[null],o=[],i=this.table,s="",u=0,l=0,p=0,c=2,b=1;this.lexer.setInput(e);this.lexer.yy=this.yy;this.yy.lexer=this.lexer;this.yy.parser=this;if(typeof this.lexer.yylloc=="undefined")this.lexer.yylloc={};let m=this.lexer.yylloc;o.push(m);let d=this.lexer.options&&this.lexer.options.ranges;if(typeof this.yy.parseError==="function")this.parseError=this.yy.parseError;function f(t){r.length-=2*t;a.length-=t;o.length-=t}function g(){let t;t=n.lexer.lex()||1;if(typeof t!=="number"){t=n.symbols_[t]||t}return t}let h,O,v,j,y,I,A={},x,k,S,_;while(true){v=r[r.length-1];if(this.defaultActions[v]){j=this.defaultActions[v]}else{if(h===null||typeof h=="undefined"){h=g()}j=i[v]&&i[v][h]}if(typeof j==="undefined"||!j.length||!j[0]){let t="";if(!p){_=[];for(x in i[v])if(this.terminals_[x]&&x>2){_.push("'"+this.terminals_[x]+"'")}if(this.lexer.showPosition){t="Parse error on line "+(u+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+_.join(", ")+", got '"+(this.terminals_[h]||h)+"'"}else{t="Parse error on line "+(u+1)+": Unexpected "+(h==1?"end of input":"'"+(this.terminals_[h]||h)+"'")}this.parseError(t,{text:this.lexer.match,token:this.terminals_[h]||h,line:this.lexer.yylineno,loc:m,expected:_})}}if(j[0]instanceof Array&&j.length>1){throw new Error("Parse Error: multiple actions possible at state: "+v+", token: "+h)}switch(j[0]){case 1:r.push(h);a.push(this.lexer.yytext);o.push(this.lexer.yylloc);r.push(j[1]);h=null;if(!O){l=this.lexer.yyleng;s=this.lexer.yytext;u=this.lexer.yylineno;m=this.lexer.yylloc;if(p>0)p--}else{h=O;O=null}break;case 2:k=this.productions_[j[1]][1];A.$=a[a.length-k];A._$={first_line:o[o.length-(k||1)].first_line,last_line:o[o.length-1].last_line,first_column:o[o.length-(k||1)].first_column,last_column:o[o.length-1].last_column};if(d){A._$.range=[o[o.length-(k||1)].range[0],o[o.length-1].range[1]]}I=this.performAction.call(A,s,l,u,this.yy,j[1],a,o);if(typeof I!=="undefined"){return I}if(k){r=r.slice(0,-1*k*2);a=a.slice(0,-1*k);o=o.slice(0,-1*k)}r.push(this.productions_[j[1]][0]);a.push(A.$);o.push(A._$);S=i[r[r.length-2]][r[r.length-1]];r.push(S);break;case 3:return true}}return true}};let e=function(){let t={EOF:1,parseError:function t(e,n){if(this.yy.parser){this.yy.parser.parseError(e,n)}else{throw new Error(e)}},setInput:function t(e){this._input=e;this._more=this._less=this.done=false;this.yylineno=this.yyleng=0;this.yytext=this.matched=this.match="";this.conditionStack=["INITIAL"];this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};if(this.options.ranges)this.yylloc.range=[0,0];this.offset=0;return this},input:function t(){let e=this._input[0];this.yytext+=e;this.yyleng++;this.offset++;this.match+=e;this.matched+=e;let n=e.match(/(?:\r\n?|\n).*/g);if(n){this.yylineno++;this.yylloc.last_line++}else{this.yylloc.last_column++}if(this.options.ranges)this.yylloc.range[1]++;this._input=this._input.slice(1);return e},unput:function t(e){let n=e.length;let r=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input;this.yytext=this.yytext.substr(0,this.yytext.length-n-1);this.offset-=n;let a=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1);this.matched=this.matched.substr(0,this.matched.length-1);if(r.length-1)this.yylineno-=r.length-1;let o=this.yylloc.range;this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:r?(r.length===a.length?this.yylloc.first_column:0)+a[a.length-r.length].length-r[0].length:this.yylloc.first_column-n};if(this.options.ranges){this.yylloc.range=[o[0],o[0]+this.yyleng-n]}return this},more:function t(){this._more=true;return this},less:function t(e){this.unput(this.match.slice(e))},pastInput:function t(){let e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function t(){let e=this.match;if(e.length<20){e+=this._input.substr(0,20-e.length)}return(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function t(){let e=this.pastInput();let n=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+n+"^"},next:function t(){if(this.done){return this.EOF}if(!this._input)this.done=true;let e,n,r,a,o,i;if(!this._more){this.yytext="";this.match=""}let s=this._currentRules();for(let t=0;t<s.length;t++){r=this._input.match(this.rules[s[t]]);if(r&&(!n||r[0].length>n[0].length)){n=r;a=t;if(!this.options.flex)break}}if(n){i=n[0].match(/(?:\r\n?|\n).*/g);if(i)this.yylineno+=i.length;this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:i?i[i.length-1].length-i[i.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+n[0].length};this.yytext+=n[0];this.match+=n[0];this.matches=n;this.yyleng=this.yytext.length;if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]}this._more=false;this._input=this._input.slice(n[0].length);this.matched+=n[0];e=this.performAction.call(this,this.yy,this,s[a],this.conditionStack[this.conditionStack.length-1]);if(this.done&&this._input)this.done=false;if(e)return e;else return}if(this._input===""){return this.EOF}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})}},lex:function t(){let e=this.next();if(typeof e!=="undefined"){return e}else{return this.lex()}},begin:function t(e){this.conditionStack.push(e)},popState:function t(){return this.conditionStack.pop()},_currentRules:function t(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function t(){return this.conditionStack[this.conditionStack.length-2]},pushState:function t(e){this.begin(e)}};t.options={};t.performAction=function t(e,n,r,a){function o(t,e){return n.yytext=n.yytext.substring(t,n.yyleng-e+t)}let i=a;switch(r){case 0:if(n.yytext.slice(-2)==="\\\\"){o(0,1);this.begin("mu")}else if(n.yytext.slice(-1)==="\\"){o(0,1);this.begin("emu")}else{this.begin("mu")}if(n.yytext)return 15;break;case 1:return 15;break;case 2:this.popState();return 15;break;case 3:this.begin("raw");return 15;break;case 4:this.popState();if(this.conditionStack[this.conditionStack.length-1]==="raw"){return 15}else{o(5,9);return"END_RAW_BLOCK"}break;case 5:return 15;break;case 6:this.popState();return 14;break;case 7:return 65;break;case 8:return 68;break;case 9:return 19;break;case 10:this.popState();this.begin("raw");return 23;break;case 11:return 55;break;case 12:return 60;break;case 13:return 29;break;case 14:return 47;break;case 15:this.popState();return 44;break;case 16:this.popState();return 44;break;case 17:return 34;break;case 18:return 39;break;case 19:return 51;break;case 20:return 48;break;case 21:this.unput(n.yytext);this.popState();this.begin("com");break;case 22:this.popState();return 14;break;case 23:return 48;break;case 24:return 73;break;case 25:return 72;break;case 26:return 72;break;case 27:return 87;break;case 28:break;case 29:this.popState();return 54;break;case 30:this.popState();return 33;break;case 31:n.yytext=o(1,2).replace(/\\"/g,'"');return 80;break;case 32:n.yytext=o(1,2).replace(/\\'/g,"'");return 80;break;case 33:return 85;break;case 34:return 82;break;case 35:return 82;break;case 36:return 83;break;case 37:return 84;break;case 38:return 81;break;case 39:return 75;break;case 40:return 77;break;case 41:return 72;break;case 42:n.yytext=n.yytext.replace(/\\([\\\]])/g,"$1");return 72;break;case 43:return"INVALID";break;case 44:return 5;break}};t.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:\{\{\{\{(?=[^/]))/,/^(?:\{\{\{\{\/[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.])\}\}\}\})/,/^(?:[^\x00]+?(?=(\{\{\{\{)))/,/^(?:[\s\S]*?--(~)?\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{\{\{)/,/^(?:\}\}\}\})/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#>)/,/^(?:\{\{(~)?#\*?)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^\s*(~)?\}\})/,/^(?:\{\{(~)?\s*else\s*(~)?\}\})/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{(~)?!--)/,/^(?:\{\{(~)?![\s\S]*?\}\})/,/^(?:\{\{(~)?\*?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)|])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:undefined(?=([~}\s)])))/,/^(?:null(?=([~}\s)])))/,/^(?:-?[0-9]+(?:\.[0-9]+)?(?=([~}\s)])))/,/^(?:as\s+\|)/,/^(?:\|)/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)|]))))/,/^(?:\[(\\\]|[^\]])*\])/,/^(?:.)/,/^(?:$)/];t.conditions={mu:{rules:[7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44],inclusive:false},emu:{rules:[2],inclusive:false},com:{rules:[6],inclusive:false},raw:{rules:[3,4,5],inclusive:false},INITIAL:{rules:[0,1,44],inclusive:true}};return t}();t.lexer=e;function n(){this.yy={}}n.prototype=t;t.Parser=n;return new n}();e.default=n;t.exports=e.default},function(t,e,n){let r=n(1).default;e.__esModule=true;let a=n(88);let o=r(a);function i(){let t=arguments.length<=0||arguments[0]===undefined?{}:arguments[0];this.options=t}i.prototype=new o.default;i.prototype.Program=function(t){let u=!this.options.ignoreStandalone;let l=!this.isRootSeen;this.isRootSeen=true;let p=t.body;for(let s=0,t=p.length;s<t;s++){let t=p[s],e=this.accept(t);if(!e){continue}let n=c(p,s,l),r=b(p,s,l),a=e.openStandalone&&n,o=e.closeStandalone&&r,i=e.inlineStandalone&&n&&r;if(e.close){m(p,s,true)}if(e.open){d(p,s,true)}if(u&&i){m(p,s);if(d(p,s)){if(t.type==="PartialStatement"){t.indent=/([ \t]+$)/.exec(p[s-1].original)[1]}}}if(u&&a){m((t.program||t.inverse).body);d(p,s)}if(u&&o){m(p,s);d((t.inverse||t.program).body)}}return t};i.prototype.BlockStatement=i.prototype.DecoratorBlock=i.prototype.PartialBlockStatement=function(e){this.accept(e.program);this.accept(e.inverse);let n=e.program||e.inverse,t=e.program&&e.inverse,r=t,a=t;if(t&&t.chained){r=t.body[0].program;while(a.chained){a=a.body[a.body.length-1].program}}let o={open:e.openStrip.open,close:e.closeStrip.close,openStandalone:b(n.body),closeStandalone:c((r||n).body)};if(e.openStrip.close){m(n.body,null,true)}if(t){let t=e.inverseStrip;if(t.open){d(n.body,null,true)}if(t.close){m(r.body,null,true)}if(e.closeStrip.open){d(a.body,null,true)}if(!this.options.ignoreStandalone&&c(n.body)&&b(r.body)){d(n.body);m(r.body)}}else if(e.closeStrip.open){d(n.body,null,true)}return o};i.prototype.Decorator=i.prototype.MustacheStatement=function(t){return t.strip};i.prototype.PartialStatement=i.prototype.CommentStatement=function(t){let e=t.strip||{};return{inlineStandalone:true,open:e.open,close:e.close}};function c(t,e,n){if(e===undefined){e=t.length}let r=t[e-1],a=t[e-2];if(!r){return n}if(r.type==="ContentStatement"){return(a||!n?/\r?\n\s*?$/:/(^|\r?\n)\s*?$/).test(r.original)}}function b(t,e,n){if(e===undefined){e=-1}let r=t[e+1],a=t[e+2];if(!r){return n}if(r.type==="ContentStatement"){return(a||!n?/^\s*?\r?\n/:/^\s*?(\r?\n|$)/).test(r.original)}}function m(t,e,n){let r=t[e==null?0:e+1];if(!r||r.type!=="ContentStatement"||!n&&r.rightStripped){return}let a=r.value;r.value=r.value.replace(n?/^\s+/:/^[ \t]*\r?\n?/,"");r.rightStripped=r.value!==a}function d(t,e,n){let r=t[e==null?t.length-1:e-1];if(!r||r.type!=="ContentStatement"||!n&&r.leftStripped){return}let a=r.value;r.value=r.value.replace(n?/\s+$/:/[ \t]+$/,"");r.leftStripped=r.value!==a;return r.leftStripped}e.default=i;t.exports=e.default},function(t,e,n){let r=n(1).default;e.__esModule=true;let a=n(6);let o=r(a);function i(){this.parents=[]}i.prototype={constructor:i,mutating:false,acceptKey:function t(e,n){let r=this.accept(e[n]);if(this.mutating){if(r&&!i.prototype[r.type]){throw new o.default('Unexpected node type "'+r.type+'" found when accepting '+n+" on "+e.type)}e[n]=r}},acceptRequired:function t(e,n){this.acceptKey(e,n);if(!e[n]){throw new o.default(e.type+" requires "+n)}},acceptArray:function t(n){for(let t=0,e=n.length;t<e;t++){this.acceptKey(n,t);if(!n[t]){n.splice(t,1);t--;e--}}},accept:function t(e){if(!e){return}if(!this[e.type]){throw new o.default("Unknown type: "+e.type,e)}if(this.current){this.parents.unshift(this.current)}this.current=e;let n=this[e.type](e);this.current=this.parents.shift();if(!this.mutating||n){return n}else if(n!==false){return e}},Program:function t(e){this.acceptArray(e.body)},MustacheStatement:s,Decorator:s,BlockStatement:u,DecoratorBlock:u,PartialStatement:l,PartialBlockStatement:function t(e){l.call(this,e);this.acceptKey(e,"program")},ContentStatement:function t(){},CommentStatement:function t(){},SubExpression:s,PathExpression:function t(){},StringLiteral:function t(){},NumberLiteral:function t(){},BooleanLiteral:function t(){},UndefinedLiteral:function t(){},NullLiteral:function t(){},Hash:function t(e){this.acceptArray(e.pairs)},HashPair:function t(e){this.acceptRequired(e,"value")}};function s(t){this.acceptRequired(t,"path");this.acceptArray(t.params);this.acceptKey(t,"hash")}function u(t){s.call(this,t);this.acceptKey(t,"program");this.acceptKey(t,"inverse")}function l(t){this.acceptRequired(t,"name");this.acceptArray(t.params);this.acceptKey(t,"hash")}e.default=i;t.exports=e.default},function(t,e,n){let r=n(1).default;e.__esModule=true;e.SourceLocation=o;e.id=i;e.stripFlags=s;e.stripComment=u;e.preparePath=c;e.prepareMustache=b;e.prepareRawBlock=m;e.prepareBlock=d;e.prepareProgram=f;e.preparePartialBlock=g;let a=n(6);let l=r(a);function p(e,n){n=n.path?n.path.original:n;if(e.path.original!==n){let t={loc:e.path.loc};throw new l.default(e.path.original+" doesn't match "+n,t)}}function o(t,e){this.source=t;this.start={line:e.first_line,column:e.first_column};this.end={line:e.last_line,column:e.last_column}}function i(t){if(/^\[.*\]$/.test(t)){return t.substring(1,t.length-1)}else{return t}}function s(t,e){return{open:t.charAt(2)==="~",close:e.charAt(e.length-3)==="~"}}function u(t){return t.replace(/^\{\{~?!-?-?/,"").replace(/-?-?~?\}\}$/,"")}function c(t,r,a){a=this.locInfo(a);let o=t?"@":"",i=[],s=0;for(let n=0,t=r.length;n<t;n++){let t=r[n].part,e=r[n].original!==t;o+=(r[n].separator||"")+t;if(!e&&(t===".."||t==="."||t==="this")){if(i.length>0){throw new l.default("Invalid path: "+o,{loc:a})}else if(t===".."){s++}}else{i.push(t)}}return{type:"PathExpression",data:t,depth:s,parts:i,original:o,loc:a}}function b(t,e,n,r,a,o){let i=r.charAt(3)||r.charAt(2),s=i!=="{"&&i!=="&";let u=/\*/.test(r);return{type:u?"Decorator":"MustacheStatement",path:t,params:e,hash:n,escaped:s,strip:a,loc:this.locInfo(o)}}function m(t,e,n,r){p(t,n);r=this.locInfo(r);let a={type:"Program",body:e,strip:{},loc:r};return{type:"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:a,openStrip:{},inverseStrip:{},closeStrip:{},loc:r}}function d(t,e,n,r,a,o){if(r&&r.path){p(t,r)}let i=/\*/.test(t.open);e.blockParams=t.blockParams;let s,u;if(n){if(i){throw new l.default("Unexpected inverse block on decorator",n)}if(n.chain){n.program.body[0].closeStrip=r.strip}u=n.strip;s=n.program}if(a){a=s;s=e;e=a}return{type:i?"DecoratorBlock":"BlockStatement",path:t.path,params:t.params,hash:t.hash,program:e,inverse:s,openStrip:t.strip,inverseStrip:u,closeStrip:r&&r.strip,loc:this.locInfo(o)}}function f(n,r){if(!r&&n.length){let t=n[0].loc,e=n[n.length-1].loc;if(t&&e){r={source:t.source,start:{line:t.start.line,column:t.start.column},end:{line:e.end.line,column:e.end.column}}}}return{type:"Program",body:n,strip:{},loc:r}}function g(t,e,n,r){p(t,n);return{type:"PartialBlockStatement",name:t.path,params:t.params,hash:t.hash,program:e,openStrip:t.strip,closeStrip:n&&n.strip,loc:this.locInfo(r)}}},function(t,e,n){let r=n(74).default;let a=n(1).default;e.__esModule=true;e.Compiler=c;e.precompile=b;e.compile=m;let o=n(6);let u=a(o);let l=n(5);let i=n(84);let s=a(i);let p=[].slice;function c(){}c.prototype={compiler:c,equals:function t(n){let e=this.opcodes.length;if(n.opcodes.length!==e){return false}for(var r=0;r<e;r++){let t=this.opcodes[r],e=n.opcodes[r];if(t.opcode!==e.opcode||!d(t.args,e.args)){return false}}e=this.children.length;for(var r=0;r<e;r++){if(!this.children[r].equals(n.children[r])){return false}}return true},guid:0,compile:function t(e,n){this.sourceNode=[];this.opcodes=[];this.children=[];this.options=n;this.stringParams=n.stringParams;this.trackIds=n.trackIds;n.blockParams=n.blockParams||[];n.knownHelpers=l.extend(r(null),{helperMissing:true,blockHelperMissing:true,each:true,if:true,unless:true,with:true,log:true,lookup:true},n.knownHelpers);return this.accept(e)},compileProgram:function t(e){let n=new this.compiler,r=n.compile(e,this.options),a=this.guid++;this.usePartial=this.usePartial||r.usePartial;this.children[a]=r;this.useDepths=this.useDepths||r.useDepths;return a},accept:function t(e){if(!this[e.type]){throw new u.default("Unknown type: "+e.type,e)}this.sourceNode.unshift(e);let n=this[e.type](e);this.sourceNode.shift();return n},Program:function t(e){this.options.blockParams.unshift(e.blockParams);let n=e.body,r=n.length;for(let t=0;t<r;t++){this.accept(n[t])}this.options.blockParams.shift();this.isSimple=r===1;this.blockParams=e.blockParams?e.blockParams.length:0;return this},BlockStatement:function t(e){f(e);let n=e.program,r=e.inverse;n=n&&this.compileProgram(n);r=r&&this.compileProgram(r);let a=this.classifySexpr(e);if(a==="helper"){this.helperSexpr(e,n,r)}else if(a==="simple"){this.simpleSexpr(e);this.opcode("pushProgram",n);this.opcode("pushProgram",r);this.opcode("emptyHash");this.opcode("blockValue",e.path.original)}else{this.ambiguousSexpr(e,n,r);this.opcode("pushProgram",n);this.opcode("pushProgram",r);this.opcode("emptyHash");this.opcode("ambiguousBlockValue")}this.opcode("append")},DecoratorBlock:function t(e){let n=e.program&&this.compileProgram(e.program);let r=this.setupFullMustacheParams(e,n,undefined),a=e.path;this.useDecorators=true;this.opcode("registerDecorator",r.length,a.original)},PartialStatement:function t(e){this.usePartial=true;let n=e.program;if(n){n=this.compileProgram(e.program)}let r=e.params;if(r.length>1){throw new u.default("Unsupported number of partial arguments: "+r.length,e)}else if(!r.length){if(this.options.explicitPartialContext){this.opcode("pushLiteral","undefined")}else{r.push({type:"PathExpression",parts:[],depth:0})}}let a=e.name.original,o=e.name.type==="SubExpression";if(o){this.accept(e.name)}this.setupFullMustacheParams(e,n,undefined,true);let i=e.indent||"";if(this.options.preventIndent&&i){this.opcode("appendContent",i);i=""}this.opcode("invokePartial",o,a,i);this.opcode("append")},PartialBlockStatement:function t(e){this.PartialStatement(e)},MustacheStatement:function t(e){this.SubExpression(e);if(e.escaped&&!this.options.noEscape){this.opcode("appendEscaped")}else{this.opcode("append")}},Decorator:function t(e){this.DecoratorBlock(e)},ContentStatement:function t(e){if(e.value){this.opcode("appendContent",e.value)}},CommentStatement:function t(){},SubExpression:function t(e){f(e);let n=this.classifySexpr(e);if(n==="simple"){this.simpleSexpr(e)}else if(n==="helper"){this.helperSexpr(e)}else{this.ambiguousSexpr(e)}},ambiguousSexpr:function t(e,n,r){let a=e.path,o=a.parts[0],i=n!=null||r!=null;this.opcode("getContext",a.depth);this.opcode("pushProgram",n);this.opcode("pushProgram",r);a.strict=true;this.accept(a);this.opcode("invokeAmbiguous",o,i)},simpleSexpr:function t(e){let n=e.path;n.strict=true;this.accept(n);this.opcode("resolvePossibleLambda")},helperSexpr:function t(e,n,r){let a=this.setupFullMustacheParams(e,n,r),o=e.path,i=o.parts[0];if(this.options.knownHelpers[i]){this.opcode("invokeKnownHelper",a.length,i)}else if(this.options.knownHelpersOnly){throw new u.default("You specified knownHelpersOnly, but used the unknown helper "+i,e)}else{o.strict=true;o.falsy=true;this.accept(o);this.opcode("invokeHelper",a.length,o.original,s.default.helpers.simpleId(o))}},PathExpression:function t(e){this.addDepth(e.depth);this.opcode("getContext",e.depth);let n=e.parts[0],r=s.default.helpers.scopedId(e),a=!e.depth&&!r&&this.blockParamIndex(n);if(a){this.opcode("lookupBlockParam",a,e.parts)}else if(!n){this.opcode("pushContext")}else if(e.data){this.options.data=true;this.opcode("lookupData",e.depth,e.parts,e.strict)}else{this.opcode("lookupOnContext",e.parts,e.falsy,e.strict,r)}},StringLiteral:function t(e){this.opcode("pushString",e.value)},NumberLiteral:function t(e){this.opcode("pushLiteral",e.value)},BooleanLiteral:function t(e){this.opcode("pushLiteral",e.value)},UndefinedLiteral:function t(){this.opcode("pushLiteral","undefined")},NullLiteral:function t(){this.opcode("pushLiteral","null")},Hash:function t(e){let n=e.pairs,r=0,a=n.length;this.opcode("pushHash");for(;r<a;r++){this.pushParam(n[r].value)}while(r--){this.opcode("assignToHash",n[r].key)}this.opcode("popHash")},opcode:function t(e){this.opcodes.push({opcode:e,args:p.call(arguments,1),loc:this.sourceNode[0].loc})},addDepth:function t(e){if(!e){return}this.useDepths=true},classifySexpr:function t(n){let e=s.default.helpers.simpleId(n.path);let r=e&&!!this.blockParamIndex(n.path.parts[0]);let a=!r&&s.default.helpers.helperExpression(n);let o=!r&&(a||e);if(o&&!a){let t=n.path.parts[0],e=this.options;if(e.knownHelpers[t]){a=true}else if(e.knownHelpersOnly){o=false}}if(a){return"helper"}else if(o){return"ambiguous"}else{return"simple"}},pushParams:function t(n){for(let t=0,e=n.length;t<e;t++){this.pushParam(n[t])}},pushParam:function t(n){let r=n.value!=null?n.value:n.original||"";if(this.stringParams){if(r.replace){r=r.replace(/^(\.?\.\/)*/g,"").replace(/\//g,".")}if(n.depth){this.addDepth(n.depth)}this.opcode("getContext",n.depth||0);this.opcode("pushStringParam",r,n.type);if(n.type==="SubExpression"){this.accept(n)}}else{if(this.trackIds){let e;if(n.parts&&!s.default.helpers.scopedId(n)&&!n.depth){e=this.blockParamIndex(n.parts[0])}if(e){let t=n.parts.slice(1).join(".");this.opcode("pushId","BlockParam",e,t)}else{r=n.original||r;if(r.replace){r=r.replace(/^this(?:\.|$)/,"").replace(/^\.\//,"").replace(/^\.$/,"")}this.opcode("pushId",n.type,r)}}this.accept(n)}},setupFullMustacheParams:function t(e,n,r,a){let o=e.params;this.pushParams(o);this.opcode("pushProgram",n);this.opcode("pushProgram",r);if(e.hash){this.accept(e.hash)}else{this.opcode("emptyHash",a)}return o},blockParamIndex:function t(r){for(let n=0,t=this.options.blockParams.length;n<t;n++){let t=this.options.blockParams[n],e=t&&l.indexOf(t,r);if(t&&e>=0){return[n,e]}}}};function b(t,e,n){if(t==null||typeof t!=="string"&&t.type!=="Program"){throw new u.default("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+t)}e=e||{};if(!("data"in e)){e.data=true}if(e.compat){e.useDepths=true}let r=n.parse(t,e),a=(new n.Compiler).compile(r,e);return(new n.JavaScriptCompiler).compile(a,e)}function m(r,a,o){if(a===undefined)a={};if(r==null||typeof r!=="string"&&r.type!=="Program"){throw new u.default("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+r)}a=l.extend({},a);if(!("data"in a)){a.data=true}if(a.compat){a.useDepths=true}let i;function s(){let t=o.parse(r,a),e=(new o.Compiler).compile(t,a),n=(new o.JavaScriptCompiler).compile(e,a,undefined,true);return o.template(n)}function t(t,e){if(!i){i=s()}return i.call(this,t,e)}t._setup=function(t){if(!i){i=s()}return i._setup(t)};t._child=function(t,e,n,r){if(!i){i=s()}return i._child(t,e,n,r)};return t}function d(e,n){if(e===n){return true}if(l.isArray(e)&&l.isArray(n)&&e.length===n.length){for(let t=0;t<e.length;t++){if(!d(e[t],n[t])){return false}}return true}}function f(e){if(!e.path.parts){let t=e.path;e.path={type:"PathExpression",data:false,depth:0,parts:[t.original+""],original:t.original+"",loc:t.loc}}}},function(t,e,n){let u=n(60).default;let r=n(1).default;e.__esModule=true;let a=n(4);let o=n(6);let c=r(o);let i=n(5);let s=n(92);let l=r(s);function p(t){this.value=t}function b(){}b.prototype={nameLookup:function t(e,n){return this.internalNameLookup(e,n)},depthedLookup:function t(e){return[this.aliasable("container.lookup"),"(depths, ",JSON.stringify(e),")"]},compilerInfo:function t(){let e=a.COMPILER_REVISION,n=a.REVISION_CHANGES[e];return[e,n]},appendToBuffer:function t(e,n,r){if(!i.isArray(e)){e=[e]}e=this.source.wrap(e,n);if(this.environment.isSimple){return["return ",e,";"]}else if(r){return["buffer += ",e,";"]}else{e.appendToBuffer=true;return e}},initializeBuffer:function t(){return this.quotedString("")},internalNameLookup:function t(e,n){this.lookupPropertyFunctionIsUsed=true;return["lookupProperty(",e,",",JSON.stringify(n),")"]},lookupPropertyFunctionIsUsed:false,compile:function t(e,a,n,o){this.environment=e;this.options=a;this.stringParams=this.options.stringParams;this.trackIds=this.options.trackIds;this.precompile=!o;this.name=this.environment.name;this.isChild=!!n;this.context=n||{decorators:[],programs:[],environments:[]};this.preamble();this.stackSlot=0;this.stackVars=[];this.aliases={};this.registers={list:[]};this.hashes=[];this.compileStack=[];this.inlineStack=[];this.blockParams=[];this.compileChildren(e,a);this.useDepths=this.useDepths||e.useDepths||e.useDecorators||this.options.compat;this.useBlockParams=this.useBlockParams||e.useBlockParams;let r=e.opcodes,i,s,u,l;for(u=0,l=r.length;u<l;u++){i=r[u];this.source.currentLocation=i.loc;s=s||i.loc;this[i.opcode].apply(this,i.args)}this.source.currentLocation=s;this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length){throw new c.default("Compile completed with content left on stack")}if(!this.decorators.isEmpty()){this.useDecorators=true;this.decorators.prepend(["var decorators = container.decorators, ",this.lookupPropertyFunctionVarDeclaration(),";\n"]);this.decorators.push("return fn;");if(o){this.decorators=Function.apply(this,["fn","props","container","depth0","data","blockParams","depths",this.decorators.merge()])}else{this.decorators.prepend("function(fn, props, container, depth0, data, blockParams, depths) {\n");this.decorators.push("}\n");this.decorators=this.decorators.merge()}}else{this.decorators=undefined}let p=this.createFunctionContext(o);if(!this.isChild){let t={compiler:this.compilerInfo(),main:p};if(this.decorators){t.main_d=this.decorators;t.useDecorators=true}let e=this.context;let n=e.programs;let r=e.decorators;for(u=0,l=n.length;u<l;u++){if(n[u]){t[u]=n[u];if(r[u]){t[u+"_d"]=r[u];t.useDecorators=true}}}if(this.environment.usePartial){t.usePartial=true}if(this.options.data){t.useData=true}if(this.useDepths){t.useDepths=true}if(this.useBlockParams){t.useBlockParams=true}if(this.options.compat){t.compat=true}if(!o){t.compiler=JSON.stringify(t.compiler);this.source.currentLocation={start:{line:1,column:0}};t=this.objectLiteral(t);if(a.srcName){t=t.toStringWithSourceMap({file:a.destName});t.map=t.map&&t.map.toString()}else{t=t.toString()}}else{t.compilerOptions=this.options}return t}else{return p}},preamble:function t(){this.lastContext=0;this.source=new l.default(this.options.srcName);this.decorators=new l.default(this.options.srcName)},createFunctionContext:function t(e){let n=this;let r="";let a=this.stackVars.concat(this.registers.list);if(a.length>0){r+=", "+a.join(", ")}let o=0;u(this.aliases).forEach(function(t){let e=n.aliases[t];if(e.children&&e.referenceCount>1){r+=", alias"+ ++o+"="+t;e.children[0]="alias"+o}});if(this.lookupPropertyFunctionIsUsed){r+=", "+this.lookupPropertyFunctionVarDeclaration()}let i=["container","depth0","helpers","partials","data"];if(this.useBlockParams||this.useDepths){i.push("blockParams")}if(this.useDepths){i.push("depths")}let s=this.mergeSource(r);if(e){i.push(s);return Function.apply(this,i)}else{return this.source.wrap(["function(",i.join(","),") {\n  ",s,"}"])}},mergeSource:function t(e){let n=this.environment.isSimple,r=!this.forceBuffer,a,o,i,s;this.source.each(function(t){if(t.appendToBuffer){if(i){t.prepend("  + ")}else{i=t}s=t}else{if(i){if(!o){a=true}else{i.prepend("buffer += ")}s.add(";");i=s=undefined}o=true;if(!n){r=false}}});if(r){if(i){i.prepend("return ");s.add(";")}else if(!o){this.source.push('return "";')}}else{e+=", buffer = "+(a?"":this.initializeBuffer());if(i){i.prepend("return buffer + ");s.add(";")}else{this.source.push("return buffer;")}}if(e){this.source.prepend("var "+e.substring(2)+(a?"":";\n"))}return this.source.merge()},lookupPropertyFunctionVarDeclaration:function t(){return"\n      lookupProperty = container.lookupProperty || function(parent, propertyName) {\n        if (Object.prototype.hasOwnProperty.call(parent, propertyName)) {\n          return parent[propertyName];\n        }\n        return undefined\n    }\n    ".trim()},blockValue:function t(e){let n=this.aliasable("container.hooks.blockHelperMissing"),r=[this.contextName(0)];this.setupHelperArgs(e,0,r);let a=this.popStack();r.splice(1,0,a);this.push(this.source.functionCall(n,"call",r))},ambiguousBlockValue:function t(){let e=this.aliasable("container.hooks.blockHelperMissing"),n=[this.contextName(0)];this.setupHelperArgs("",0,n,true);this.flushInline();let r=this.topStack();n.splice(1,0,r);this.pushSource(["if (!",this.lastHelper,") { ",r," = ",this.source.functionCall(e,"call",n),"}"])},appendContent:function t(e){if(this.pendingContent){e=this.pendingContent+e}else{this.pendingLocation=this.source.currentLocation}this.pendingContent=e},append:function t(){if(this.isInline()){this.replaceStack(function(t){return[" != null ? ",t,' : ""']});this.pushSource(this.appendToBuffer(this.popStack()))}else{let t=this.popStack();this.pushSource(["if (",t," != null) { ",this.appendToBuffer(t,undefined,true)," }"]);if(this.environment.isSimple){this.pushSource(["else { ",this.appendToBuffer("''",undefined,true)," }"])}}},appendEscaped:function t(){this.pushSource(this.appendToBuffer([this.aliasable("container.escapeExpression"),"(",this.popStack(),")"]))},getContext:function t(e){this.lastContext=e},pushContext:function t(){this.pushStackLiteral(this.contextName(this.lastContext))},lookupOnContext:function t(e,n,r,a){let o=0;if(!a&&this.options.compat&&!this.lastContext){this.push(this.depthedLookup(e[o++]))}else{this.pushContext()}this.resolvePath("context",e,o,n,r)},lookupBlockParam:function t(e,n){this.useBlockParams=true;this.push(["blockParams[",e[0],"][",e[1],"]"]);this.resolvePath("context",n,1)},lookupData:function t(e,n,r){if(!e){this.pushStackLiteral("data")}else{this.pushStackLiteral("container.data(data, "+e+")")}this.resolvePath("data",n,0,true,r)},resolvePath:function t(n,r,a,o,e){let i=this;if(this.options.strict||this.options.assumeObjects){this.push(m(this.options.strict&&e,this,r,a,n));return}let s=r.length;for(;a<s;a++){this.replaceStack(function(t){let e=i.nameLookup(t,r[a],n);if(!o){return[" != null ? ",e," : ",t]}else{return[" && ",e]}})}},resolvePossibleLambda:function t(){this.push([this.aliasable("container.lambda"),"(",this.popStack(),", ",this.contextName(0),")"])},pushStringParam:function t(e,n){this.pushContext();this.pushString(n);if(n!=="SubExpression"){if(typeof e==="string"){this.pushString(e)}else{this.pushStackLiteral(e)}}},emptyHash:function t(e){if(this.trackIds){this.push("{}")}if(this.stringParams){this.push("{}");this.push("{}")}this.pushStackLiteral(e?"undefined":"{}")},pushHash:function t(){if(this.hash){this.hashes.push(this.hash)}this.hash={values:{},types:[],contexts:[],ids:[]}},popHash:function t(){let e=this.hash;this.hash=this.hashes.pop();if(this.trackIds){this.push(this.objectLiteral(e.ids))}if(this.stringParams){this.push(this.objectLiteral(e.contexts));this.push(this.objectLiteral(e.types))}this.push(this.objectLiteral(e.values))},pushString:function t(e){this.pushStackLiteral(this.quotedString(e))},pushLiteral:function t(e){this.pushStackLiteral(e)},pushProgram:function t(e){if(e!=null){this.pushStackLiteral(this.programExpression(e))}else{this.pushStackLiteral(null)}},registerDecorator:function t(e,n){let r=this.nameLookup("decorators",n,"decorator"),a=this.setupHelperArgs(n,e);this.decorators.push(["fn = ",this.decorators.functionCall(r,"",["fn","props","container",a])," || fn;"])},invokeHelper:function t(e,n,r){let a=this.popStack(),o=this.setupHelper(e,n);let i=[];if(r){i.push(o.name)}i.push(a);if(!this.options.strict){i.push(this.aliasable("container.hooks.helperMissing"))}let s=["(",this.itemsSeparatedBy(i,"||"),")"];let u=this.source.functionCall(s,"call",o.callParams);this.push(u)},itemsSeparatedBy:function t(e,n){let r=[];r.push(e[0]);for(let t=1;t<e.length;t++){r.push(n,e[t])}return r},invokeKnownHelper:function t(e,n){let r=this.setupHelper(e,n);this.push(this.source.functionCall(r.name,"call",r.callParams))},invokeAmbiguous:function t(e,n){this.useRegister("helper");let r=this.popStack();this.emptyHash();let a=this.setupHelper(0,e,n);let o=this.lastHelper=this.nameLookup("helpers",e,"helper");let i=["(","(helper = ",o," || ",r,")"];if(!this.options.strict){i[0]="(helper = ";i.push(" != null ? helper : ",this.aliasable("container.hooks.helperMissing"))}this.push(["(",i,a.paramsInit?["),(",a.paramsInit]:[],"),","(typeof helper === ",this.aliasable('"function"')," ? ",this.source.functionCall("helper","call",a.callParams)," : helper))"])},invokePartial:function t(e,n,r){let a=[],o=this.setupParams(n,1,a);if(e){n=this.popStack();delete o.name}if(r){o.indent=JSON.stringify(r)}o.helpers="helpers";o.partials="partials";o.decorators="container.decorators";if(!e){a.unshift(this.nameLookup("partials",n,"partial"))}else{a.unshift(n)}if(this.options.compat){o.depths="depths"}o=this.objectLiteral(o);a.push(o);this.push(this.source.functionCall("container.invokePartial","",a))},assignToHash:function t(e){let n=this.popStack(),r,a,o;if(this.trackIds){o=this.popStack()}if(this.stringParams){a=this.popStack();r=this.popStack()}let i=this.hash;if(r){i.contexts[e]=r}if(a){i.types[e]=a}if(o){i.ids[e]=o}i.values[e]=n},pushId:function t(e,n,r){if(e==="BlockParam"){this.pushStackLiteral("blockParams["+n[0]+"].path["+n[1]+"]"+(r?" + "+JSON.stringify("."+r):""))}else if(e==="PathExpression"){this.pushString(n)}else if(e==="SubExpression"){this.pushStackLiteral("true")}else{this.pushStackLiteral("null")}},compiler:b,compileChildren:function t(e,n){let r=e.children,a,o;for(let e=0,t=r.length;e<t;e++){a=r[e];o=new this.compiler;let t=this.matchExistingProgram(a);if(t==null){this.context.programs.push("");let t=this.context.programs.length;a.index=t;a.name="program"+t;this.context.programs[t]=o.compile(a,n,this.context,!this.precompile);this.context.decorators[t]=o.decorators;this.context.environments[t]=a;this.useDepths=this.useDepths||o.useDepths;this.useBlockParams=this.useBlockParams||o.useBlockParams;a.useDepths=this.useDepths;a.useBlockParams=this.useBlockParams}else{a.index=t.index;a.name="program"+t.index;this.useDepths=this.useDepths||t.useDepths;this.useBlockParams=this.useBlockParams||t.useBlockParams}}},matchExistingProgram:function t(n){for(let e=0,t=this.context.environments.length;e<t;e++){let t=this.context.environments[e];if(t&&t.equals(n)){return t}}},programExpression:function t(e){let n=this.environment.children[e],r=[n.index,"data",n.blockParams];if(this.useBlockParams||this.useDepths){r.push("blockParams")}if(this.useDepths){r.push("depths")}return"container.program("+r.join(", ")+")"},useRegister:function t(e){if(!this.registers[e]){this.registers[e]=true;this.registers.list.push(e)}},push:function t(e){if(!(e instanceof p)){e=this.source.wrap(e)}this.inlineStack.push(e);return e},pushStackLiteral:function t(e){this.push(new p(e))},pushSource:function t(e){if(this.pendingContent){this.source.push(this.appendToBuffer(this.source.quotedString(this.pendingContent),this.pendingLocation));this.pendingContent=undefined}if(e){this.source.push(e)}},replaceStack:function t(e){let n=["("],r,a,o;if(!this.isInline()){throw new c.default("replaceStack on non-inline")}let i=this.popStack(true);if(i instanceof p){r=[i.value];n=["(",r];o=true}else{a=true;let t=this.incrStack();n=["((",this.push(t)," = ",i,")"];r=this.topStack()}let s=e.call(this,r);if(!o){this.popStack()}if(a){this.stackSlot--}this.push(n.concat(s,")"))},incrStack:function t(){this.stackSlot++;if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)}return this.topStackName()},topStackName:function t(){return"stack"+this.stackSlot},flushInline:function t(){let n=this.inlineStack;this.inlineStack=[];for(let t=0,e=n.length;t<e;t++){let e=n[t];if(e instanceof p){this.compileStack.push(e)}else{let t=this.incrStack();this.pushSource([t," = ",e,";"]);this.compileStack.push(t)}}},isInline:function t(){return this.inlineStack.length},popStack:function t(e){let n=this.isInline(),r=(n?this.inlineStack:this.compileStack).pop();if(!e&&r instanceof p){return r.value}else{if(!n){if(!this.stackSlot){throw new c.default("Invalid stack pop")}this.stackSlot--}return r}},topStack:function t(){let e=this.isInline()?this.inlineStack:this.compileStack,n=e[e.length-1];if(n instanceof p){return n.value}else{return n}},contextName:function t(e){if(this.useDepths&&e){return"depths["+e+"]"}else{return"depth"+e}},quotedString:function t(e){return this.source.quotedString(e)},objectLiteral:function t(e){return this.source.objectLiteral(e)},aliasable:function t(e){let n=this.aliases[e];if(n){n.referenceCount++;return n}n=this.aliases[e]=this.source.wrap(e);n.aliasable=true;n.referenceCount=1;return n},setupHelper:function t(e,n,r){let a=[],o=this.setupHelperArgs(n,e,a,r);let i=this.nameLookup("helpers",n,"helper"),s=this.aliasable(this.contextName(0)+" != null ? "+this.contextName(0)+" : (container.nullContext || {})");return{params:a,paramsInit:o,name:i,callParams:[s].concat(a)}},setupParams:function t(e,n,r){let a={},o=[],i=[],s=[],u=!r,l;if(u){r=[]}a.name=this.quotedString(e);a.hash=this.popStack();if(this.trackIds){a.hashIds=this.popStack()}if(this.stringParams){a.hashTypes=this.popStack();a.hashContexts=this.popStack()}let p=this.popStack(),c=this.popStack();if(c||p){a.fn=c||"container.noop";a.inverse=p||"container.noop"}let b=n;while(b--){l=this.popStack();r[b]=l;if(this.trackIds){s[b]=this.popStack()}if(this.stringParams){i[b]=this.popStack();o[b]=this.popStack()}}if(u){a.args=this.source.generateArray(r)}if(this.trackIds){a.ids=this.source.generateArray(s)}if(this.stringParams){a.types=this.source.generateArray(i);a.contexts=this.source.generateArray(o)}if(this.options.data){a.data="data"}if(this.useBlockParams){a.blockParams="blockParams"}return a},setupHelperArgs:function t(e,n,r,a){let o=this.setupParams(e,n,r);o.loc=JSON.stringify(this.source.currentLocation);o=this.objectLiteral(o);if(a){this.useRegister("options");r.push("options");return["options=",o]}else if(r){r.push(o);return""}else{return o}}};(function(){let n=("break else new var"+" case finally return void"+" catch for switch while"+" continue function this with"+" default if throw"+" delete in try"+" do instanceof typeof"+" abstract enum int short"+" boolean export interface static"+" byte extends long super"+" char final native synchronized"+" class float package throws"+" const goto private transient"+" debugger implements protected volatile"+" double import public let yield await"+" null true false").split(" ");let r=b.RESERVED_WORDS={};for(let t=0,e=n.length;t<e;t++){r[n[t]]=true}})();b.isValidJavaScriptVariableName=function(t){return!b.RESERVED_WORDS[t]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(t)};function m(t,e,n,r,a){let o=e.popStack(),i=n.length;if(t){i--}for(;r<i;r++){o=e.nameLookup(o,n[r],a)}if(t){return[e.aliasable("container.strict"),"(",o,", ",e.quotedString(n[r]),", ",JSON.stringify(e.source.currentLocation)," )"]}else{return o}}e.default=b;t.exports=e.default},function(t,e,n){let o=n(60).default;e.__esModule=true;let i=n(5);let r;try{if(false){let t=require("source-map");r=t.SourceNode}}catch(t){}if(!r){r=function(t,e,n,r){this.src="";if(r){this.add(r)}};r.prototype={add:function t(e){if(i.isArray(e)){e=e.join("")}this.src+=e},prepend:function t(e){if(i.isArray(e)){e=e.join("")}this.src=e+this.src},toStringWithSourceMap:function t(){return{code:this.toString()}},toString:function t(){return this.src}}}function s(r,a,o){if(i.isArray(r)){let n=[];for(let t=0,e=r.length;t<e;t++){n.push(a.wrap(r[t],o))}return n}else if(typeof r==="boolean"||typeof r==="number"){return r+""}return r}function a(t){this.srcFile=t;this.source=[]}a.prototype={isEmpty:function t(){return!this.source.length},prepend:function t(e,n){this.source.unshift(this.wrap(e,n))},push:function t(e,n){this.source.push(this.wrap(e,n))},merge:function t(){let e=this.empty();this.each(function(t){e.add(["  ",t,"\n"])});return e},each:function t(n){for(let t=0,e=this.source.length;t<e;t++){n(this.source[t])}},empty:function t(){let e=this.currentLocation||{start:{}};return new r(e.start.line,e.start.column,this.srcFile)},wrap:function t(e){let n=arguments.length<=1||arguments[1]===undefined?this.currentLocation||{start:{}}:arguments[1];if(e instanceof r){return e}e=s(e,this,n);return new r(n.start.line,n.start.column,this.srcFile,e)},functionCall:function t(e,n,r){r=this.generateList(r);return this.wrap([e,n?"."+n+"(":"(",r,")"])},quotedString:function t(e){return'"'+(e+"").replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},objectLiteral:function t(n){let r=this;let a=[];o(n).forEach(function(t){let e=s(n[t],r);if(e!=="undefined"){a.push([r.quotedString(t),":",e])}});let e=this.generateList(a);e.prepend("{");e.add("}");return e},generateList:function t(n){let r=this.empty();for(let t=0,e=n.length;t<e;t++){if(t){r.add(",")}r.add(s(n[t],this))}return r},generateArray:function t(e){let n=this.generateList(e);n.prepend("[");n.add("]");return n}};e.default=a;t.exports=e.default}])});